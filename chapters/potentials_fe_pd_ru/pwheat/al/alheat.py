import matplotlib.pyplot as plt
import numpy


def make_array(text):
  d = []
  temp = text.split("\n")
  for line in temp:
    f = line.split("\t")
    row = []
    for item in f:
      row.append(float(item)) 
    d.append(row)
  return numpy.asarray(d)

heat_energy = """0	0
0.001560934699461	0.000625045770013
0.002355849782449	0.001476762470191
0.007629540660667	0.011091909292134
0.00491523417184	0.005406496240084
0.001312467083664	0.000525316002963
0.004493308122102	0.004729884875258
0.00766272474665	0.011395996645382
0.001989321426527	0.00078749780386
0.005884383039894	0.006915504213975
0.006443418156339	0.009919642348003
0.005978774938281	0.009043707504618
0.006988986771424	0.009263167413727
0.001085554984045	0.000341775137399
0.004544875670215	0.004455049775948
0.007199761891531	0.014238635140543
0.002210740191806	0.001558668772558
0.00090204926921	0.00026068517447
0.001223123937778	0.000418919443211
0.004390118392957	0.004280624727586
0.005530171903724	0.006876591917574
0.005688085326319	0.008047226179735
0.003029133172035	0.00225323965761
0.00392992245558	0.003404145655846
0.001987293006509	0.000851036416282
0.00430113996563	0.003266319934926
0.006446840496602	0.008489275309445
0.002803427739296	0.001457170264902
0.004513792187123	0.004922813675294
0.006660076435665	0.009699366096362
0.003721191440144	0.003022233712889
0.014070877303451	0.04240161379447
0.031728180811482	0.22276976797188
0.008777258590341	0.016262754843487
0.046998516647814	0.56211669445317
0.02142071020456	0.122338899527836
0.014176811943593	0.038991889802632
0.031496877932642	0.22462150347815
0.050045948092065	0.477705447025556
0.007898252347146	0.014451700371129
0.017748588886727	0.065814026914235
0.017064249725936	0.065449394204514
0.012546309079201	0.042122016698607
0.030510171228715	0.263472846421183
0.039103268996481	0.296604217836412
0.043546000668586	0.405028842066139
0.012976980793155	0.033911522145586
0.061182399567868	0.707582831665823
0.035891385277072	0.288852507421078
0.011753629289232	0.033309606062072
0.036466372580742	0.270496788046598"""



heat_force = """0	0
0.001560934699461	0.00012391985232
0.002355849782449	0.00019256973912
0.007629540660667	0.00053406889272
0.00491523417184	0.00038132775648
0.001312467083664	0.0001149350796
0.004493308122102	0.0003465555192
0.00766272474665	0.00054577632384
0.001989321426527	0.00013481048592
0.005884383039894	0.0004183170156
0.006443418156339	0.00050423633568
0.005978774938281	0.0005003857188
0.006988986771424	0.00047914898328
0.001085554984045	8.80974468E-05
0.004544875670215	0.0003580295796
0.007199761891531	0.00064219732632
0.002210740191806	0.00021011143824
0.00090204926921	7.043906232E-05
0.001223123937778	0.00010167184368
0.004390118392957	0.00033671505384
0.005530171903724	0.00044818846776
0.005688085326319	0.00046425215232
0.003029133172035	0.00025172921664
0.00392992245558	0.00029299693896
0.001987293006509	0.0001431340416
0.00430113996563	0.00029999806056
0.006446840496602	0.0004986354384
0.002803427739296	0.00019089724896
0.004513792187123	0.00037102054968
0.006660076435665	0.00056390144976
0.003721191440144	0.00028969085376
0.014070877303451	0.00104865133032
0.031728180811482	0.00254125156032
0.008777258590341	0.00063507951936
0.046998516647814	0.00410471869896
0.02142071020456	0.001957396914
0.014176811943593	0.00104830127424
0.031496877932642	0.0025960547844
0.050045948092065	0.00354583471968
0.007898252347146	0.00062383882968
0.017748588886727	0.00123807056472
0.017064249725936	0.00136000676592
0.012546309079201	0.00113344269192
0.030510171228715	0.00279029701368
0.039103268996481	0.002862680832
0.043546000668586	0.00342479310624
0.012976980793155	0.00098431880184
0.061182399567868	0.00466873683408
0.035891385277072	0.00288753481368
0.011753629289232	0.00090971796168
0.036466372580742	0.00277998980688"""



he = make_array(heat_energy)
ht = numpy.copy(heat_energy)
hf = make_array(heat_force)




fig, ax1 = plt.subplots(figsize=(8,6))
plt.title("Gaussian Heating")
colour = 'tab:green'
ax1.set_xlabel('Maximum perturbation (angs)')
ax1.set_ylabel('Energy (eV)', color=colour)
ax1.plot(he[:,0], he[:,1], label='Increase in energy', ls='none', marker="+", color=colour)
ax1.tick_params(axis='y', labelcolor=colour)


ax1.axhline(y=0.086, color='tab:purple', linestyle='-', label='1,000K')
ax1.axhline(y=0.172, color='tab:orange', linestyle='-', label='2,000K')
ax1.axhline(y=0.259, color='tab:red', linestyle='-', label='3,000K')

ax2 = ax1.twinx() 

colour = 'tab:blue'
ax2.set_ylabel('Total force (eV/angs)', color=colour)
ax2.plot(hf[:,0], hf[:,1], label='Increase in force', ls='none', marker="x")
ax2.tick_params(axis='y', labelcolor=colour)
fig.legend()
fig.tight_layout()
fig.savefig("alheat.eps", format='eps')
plt.close()


