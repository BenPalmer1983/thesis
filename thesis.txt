Department of Metallurgy & Materials

Irradiation Damage Simulations of Platinum Group Metal Modified
Austenitic Stainless Steels for Reactor Core Components
by Ben Palmer

A thesis submitted to the University of Birmingham for the degree of Doctor of Philosophy
Supervised by Dr Brian J Connolly, Dr Mark S D Read and Prof Alessandro Mottura

Abstract
Austenitic stainless steels have been used since the early days of nuclear power and they will play an important
role in the construction of Generation III+ (Gen III+) and Generation IV (Gen IV) plant designs. Irradiation
of components by neutrons is expensive with relatively few high flux reactors available. The experiments to
represent 30-40 years within a reactor core are time consuming and produce radioactive waste as a by-product.
Two alternatives to testing by irradiating with a neutron source are either irradiating with a proton beam or
by modelling damage events with a computer.
The efficiency and computational power of computers continues to improve. First principles Density Functional
Theory (DFT) and molecular dynamics (MD) are computational methods that are now able to give insights
into why materials behave the way they do.
1. Proton sources are more widespread, they are relatively cheap and may be focused into a much smaller beam
to concentrate the amount of damage per time unit. The radioactive waste may be significant but by carefully
selecting the ion energy the electromagnetic repulsion between ions and nuclei reduces transmutation of target
atoms whilst maintaining the amount and depth of damage into the material required for testing purposes.
A modified Bateman equation is derived to calculate the radioactivity of a proton irradiated target and a
computer program (Activity) is created to implement the calculation using evaluated nuclear reaction cross
section data. The program is compared to data measured from the irradiation of an iron sample using the
University of Birmingham cyclotron. It is also used to model the radioactivity of a target irradiated to 100
displacements per atom (DPA) at a range of beam energies in order to minimise both the irradiation time and
radioactive waste. The results show an increase in target activity of 3 orders of magnitude for a 25MeV proton
beam when compared to a 10MeV proton beam.
2. Sensitisation of austenitic steels, by processes such as welding, depletes Cr from grain boundaries removing
the corrosion resistant Cr2 O3 passive layer. Previous (experimental) work has shown that these steels, when
doped with Pd or Ru, retain corrosion resistance at the grain boundary[1]. This work takes a step towards
investigating whether or not these platinum group metal (PGM)s deplete or saturate at the grain boundary
while under irradiation and this may be studied with MD simulations. A computer program is developed to
fit interatomic potentials to experimental data and DFT generated data. The properties of face centered cubic
(FCC) Fe are computed using DFT. These data along with other properties and DFT generated data are used
to derive interatomic potentials (with a dominant ZBL pair for close range collision interactions) for Fe-Pd.
These potentials are a step towards MD simulations of the irradiated grain boundaries.

Contents
1 Introduction
1.1

1.2

1.3

Motivation

1
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1

1.1.1

Part 1: Activity Computer Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

1.1.2

Part 2: Iron-Palladium and Iron-Ruthenium Potential . . . . . . . . . . . . . . . . . . . .

2

Nuclear Power in the United Kingdom . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

1.2.1

Nuclear Fuel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

1.2.2

Generation I Reactors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3

1.2.3

Generation II Reactors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

1.2.4

Generation III Reactors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

An Approaching Energy Gap for the UK . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

1.3.1

Why choose Nuclear Power? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.3.2

Planned and Under Construction in the UK . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.3.3

Proposed Generation III+ Nuclear Power Plant Designs . . . . . . . . . . . . . . . . . . .

7

1.3.4

Generation IV . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8

1.4

Damage to Nuclear Core Components by Neutrons . . . . . . . . . . . . . . . . . . . . . . . . . . 13

1.5

Radiation Damage: Replacing Neutrons with Protons . . . . . . . . . . . . . . . . . . . . . . . . 14

1.6

Simulation Material Damage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
1.6.1

Molecular Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

1.6.2

Density Functional Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

1.6.3

Interatomic Potentials for Molecular Dynamics . . . . . . . . . . . . . . . . . . . . . . . . 16

2 Consequences of Ionizing Radiation
2.1

17

Radiation Types Relevant to This Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
2.1.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

2.1.2

Protons and other Ions

2.1.3

Neutrons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

2.1.4

High Energy Photons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

2.2

Microscopic and Macroscopic Cross Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

2.3

Quantifying Radiation and its Effects

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
ii

CONTENTS

2.4

2.5

CONTENTS

Effects of Radiation on Organics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
2.4.1

Reference Levels of Radiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23

2.4.2

Levels of Radioactivity from Neutron Irradiated Components . . . . . . . . . . . . . . . . 23

Damage Cascades in Metals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

3 Austenitic Steels in Nuclear Power
3.1

3.2

3.3

28

Stainless Steel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
3.1.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

3.1.2

Grades of Stainless Steel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

Use In Reactors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
3.2.1

The Use of Austenintic Steels in Reactors . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

3.2.2

Atom Damage Cascades . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

3.2.3

Damage Rates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

3.2.4

Swelling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33

3.2.5

Radiation Induced Segregation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

Corrosion Resistance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
3.3.1

Passive Film Protection of Chromium . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

3.3.2

Sensitization and Passive Film Removal . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

3.3.3

Addition of Molybdenum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

3.4

IASCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

3.5

IGSCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
3.5.1

IGSCC in Light Water Reactors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38

3.5.2

IGSCC and Advanced Gas-cooled Reactors . . . . . . . . . . . . . . . . . . . . . . . . . . 39

3.6

SS in Gen III+ and Gen IV . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

3.7

Addition of PGMs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40

4 Isotope Activation and Radioactive Decay
4.1

4.2

43

Ion Sources . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
4.1.1

LINAC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

4.1.2

Cyclotron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

4.1.3

Synchrotron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

Neutron Sources . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
4.2.1

High-Flux Neutron Reactors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

4.2.2

Spallation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

4.3

Source Review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

4.4

Emulating Neutron Damage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
4.4.1

Ion Irradiation at the University of Birmingham . . . . . . . . . . . . . . . . . . . . . . . 48
iii

CONTENTS

4.5

CONTENTS

4.4.2

Transmutation of Nuclei by Neutrons and Protons . . . . . . . . . . . . . . . . . . . . . . 49

4.4.3

Nuclear Reaction Cross Sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

4.4.4

Radioactive Decay . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

4.4.5

Saturation Activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

4.4.6

Decay Constants: Joint Evaluated Fission and Fusion File (JEFF) 3.3 Data File . . . . . 54

4.4.7

Bateman Equation for Radioactive Decay . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

Using SRIM and TRIM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

5 Interatomic Potential Fitting
5.1

5.2

5.3

5.4

5.5

58

Experiment, Modelling and Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
5.1.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

5.1.2

Simulating Materials on a Variety of Scales in Time and Space . . . . . . . . . . . . . . . 59

Properties of Crystals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
5.2.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

5.2.2

Equation of State . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

5.2.3

Voigt Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

5.2.4

Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

5.2.5

Calculating Elastic Constants for a Cubic Crystal

5.2.6

Calculating Elastic Constants for Orthorhombic Crystal . . . . . . . . . . . . . . . . . . . 65

5.2.7

Stability Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

5.2.8

Computing Values from Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

5.2.9

Correlation of Melting Temperature in Metals with Elastic Constants . . . . . . . . . . . 69

. . . . . . . . . . . . . . . . . . . . . . 64

Choice of Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
5.3.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

5.3.2

Pair Potentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

5.3.3

Many Body Potentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73

5.3.4

Function Types used by EAM and Two-Band EAM . . . . . . . . . . . . . . . . . . . . . 78

EAM Potential Fitting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
5.4.1

Sacrificing Physical Elegance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

5.4.2

Exact Fitting to Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82

5.4.3

Force Matching . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82

5.4.4

Pair and Embedding Symmetry Transforms . . . . . . . . . . . . . . . . . . . . . . . . . . 83

Classical Molecular Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
5.5.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

5.5.2

Molecular Dynamics Codes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

5.5.3

Calculating Energy, Force and Stress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86

iv

CONTENTS

CONTENTS

5.5.4

Velocity Verlet Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91

5.5.5

Selecting a Time Scale . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92

5.6

Existing Potential Fitting Programs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93

5.7

Density Functional Theory

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93

5.7.1

Motivation For Using DFT In This Work . . . . . . . . . . . . . . . . . . . . . . . . . . . 94

5.7.2

Brief Overview of DFT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94

5.7.3

Time Independent Schrödinger Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94

5.7.4

Many Body TISE

5.7.5

Born-Oppenheimer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96

5.7.6

Crystals, Reciprocal Space and Bloch Theorem . . . . . . . . . . . . . . . . . . . . . . . . 97

5.7.7

Hohenberg-Kohn Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

5.7.8

Kohn-Sham Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

5.7.9

Self-Consistent Solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95

5.7.10 Exchange-Correlation Energy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
5.7.11 Pseudopotentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
5.7.12 Ecut, K-Point Integration and Smearing . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
5.7.13 Brief History of Magnetism . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113
5.7.14 Magnetism: Moving Charges and Spin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
5.7.15 Ferromagnetism, Antiferromagnetism and Hund’s Rule . . . . . . . . . . . . . . . . . . . . 114
5.7.16 Collinear and Non-Collinear DFT Calculations . . . . . . . . . . . . . . . . . . . . . . . . 115
6 Predicting Activation

117

6.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117

6.2

Activation by Ion Irradiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

6.3

6.2.1

Laplace Transform . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

6.2.2

Constructing the Differential Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

6.2.3

Numerical Inversion of the Laplace Transform . . . . . . . . . . . . . . . . . . . . . . . . . 119

6.2.4

Analytic Solution by Partial Fraction Expansion . . . . . . . . . . . . . . . . . . . . . . . 120

6.2.5

Preference: Analytic over Numeric . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121

Activity Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
6.3.1

Computer Code Development . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122

6.3.2

Extended Bateman Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122

6.3.3

Talys Generated Proton Cross Section Database . . . . . . . . . . . . . . . . . . . . . . . 124

6.3.4

Ion Trajectory Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127

6.3.5

Activity Code Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128

6.3.6

Foil Activation by Neutron Irradiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128

v

CONTENTS

CONTENTS

6.4

Simulating with SRIM - Iron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128

6.5

Cyclotron Irradiated Iron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
6.5.1

Cyclotron Beam Line . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128

6.5.2

Creation of Cobalt-55 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131

6.5.3

Measurement of Sample Activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132

6.5.4

Prediction of Activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134

6.5.5

Estimation of Cobalt-55 Radioactivity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134

6.5.6

Simulating Proton Irradiated Iron with Actvity V1 . . . . . . . . . . . . . . . . . . . . . . 136

6.5.7

Simulating Proton Irradiated Iron with Actvity V2 . . . . . . . . . . . . . . . . . . . . . . 136

6.5.8

Comparing Experimental Results with Calculated Values . . . . . . . . . . . . . . . . . . 139

6.6

100DPA Predicted Activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

6.7

Proton Irradiated Molybdenum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
6.7.1

Experimental Irradiation - Molybdenum . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141

6.7.2

Estimating the Activity of Proton Irradiated Molybdenum . . . . . . . . . . . . . . . . . . 141

6.7.3

Simulated Proton Irradiated Molybdenum . . . . . . . . . . . . . . . . . . . . . . . . . . . 143

6.8

Proton Irradiated Molybdenum Doped Steel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145

6.9

Media Accessible via GitHub . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146

7 Potentials for Fe, Ru, Pd
7.1

7.2

7.3

147

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
7.1.1

Interatomic Potential Fitting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148

7.1.2

Existing Experimental & DFT Bulk Property Data . . . . . . . . . . . . . . . . . . . . . . 148

DFT Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
7.2.1

Quantum Espresso . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150

7.2.2

Pseudopotential Selection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150

7.2.3

Smearing Type . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151

7.2.4

Parameter Convergence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151

7.2.5

QECONVERGE Python Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152

7.2.6

DFT Parameter Convergence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153

DFT Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157
7.3.1

QEEOS Python Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157

7.3.2

DFT Calculations of Bulk Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158

7.3.3

Relaxed Crystal Calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158

7.3.4

Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160

7.3.5

Calibrating the Cohesive Energies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164

7.3.6

DFT Reference Database . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 165

vi

CONTENTS

CONTENTS

7.3.7

Pure Element Defects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 165

7.3.8

Alloy Atom Positions for Pd and Ru . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167

7.3.9

Configurations with Randomised Positions . . . . . . . . . . . . . . . . . . . . . . . . . . . 167

7.3.10 Surface Energy Calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168
7.3.11 Defects in Fe-Pd and Fe-Ru Alloys . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
7.4

7.5

7.6

7.7

Issues to Overcome . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
7.4.1

Insufficient Memory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169

7.4.2

Scratch Restrictions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169

7.4.3

Caching Repeat Calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170

7.4.4

Adjustment of DFT Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170

7.4.5

Not Straying Too Far From Reality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171

7.4.6

Trial Parameters for Iron with and Octahedral Defect . . . . . . . . . . . . . . . . . . . . 172

EAMPA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
7.5.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173

7.5.2

Potentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173

7.5.3

Calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174

7.5.4

Verifying Energy and Force Calculations with LAMMPS . . . . . . . . . . . . . . . . . . . 179

Application of the EAMPA Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
7.6.1

Potential Transferability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179

7.6.2

Fitting Potentials with EAMPA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181

7.6.3

Iron-Palladium and Iron-Ruthenium Potentials . . . . . . . . . . . . . . . . . . . . . . . . 183

DL POLY Contribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187

8 Conclusions

188

8.1

Inter Granular Stress Corrosion Cracking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188

8.2

Predicting Ion Induced Radioactivity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189

8.3

8.2.1

Modified Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189

8.2.2

Activity Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189

8.2.3

Iron Irradiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190

8.2.4

Molybdenum Irradiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190

8.2.5

Beam Flux Reduction and Gamma Attenuation . . . . . . . . . . . . . . . . . . . . . . . . 190

8.2.6

More Experimental Data Required . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191

8.2.7

100DPA Activity Predictions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191

8.2.8

Original Contribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192

Derived Potentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
8.3.1

Restricting Potentials to Binary Alloys . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192

vii

CONTENTS

8.4

CONTENTS

8.3.2

Collinear Spin DFT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192

8.3.3

Automated Convergence Calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192

8.3.4

Bulk Property Calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193

8.3.5

Iron-Palladium and Iron-Ruthenium Configurations as Fitting Data . . . . . . . . . . . . 193

8.3.6

Iron-Palladium and Iron-Ruthenium Potentials . . . . . . . . . . . . . . . . . . . . . . . . 193

8.3.7

Original Contribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194

Two-Band EAM Contribution to DL-Poly . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194

9 Future Work
9.1

9.2

195

Activity Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
9.1.1

Experimental Activity Readings for Ion Irradiated Targets . . . . . . . . . . . . . . . . . . 195

9.1.2

Code Improvements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195

Potential Fitting and MD Simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196
9.2.1

Larger Supercells . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196

9.2.2

Alloy Bulk Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196

9.2.3

Defects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197

9.2.4

MEAM for FCC Iron

9.2.5

Improved Potential: Fe-Ni-Cr-Pd . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197

9.2.6

PKA Cascade Trials in LAMMPS or DL POLY . . . . . . . . . . . . . . . . . . . . . . . . 197

9.2.7

Radiation Induced Segregation Trials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197

10 Acknowledgements

216

Appendices

217

A Useful Laplace Transforms

218

A.1 Table of Transforms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
A.2 Decay with a Source Term . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
B Activity Equation in Python: decay class

220

B.1 Full Source Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 220
B.2 Highlighted Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 220
B.3 Activity Equation Testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 230
B.3.1 Numeric Fortran Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 230
B.3.2 Chromium-49 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 233
B.3.3 Nickel-66 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 234
B.3.4 Caesium-125 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
B.3.5 Bismuth-213 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 236
B.3.6 Polonium-216 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237
B.3.7 Radon-218

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 238
viii

CONTENTS

CONTENTS

C Activity Code

240

C.1 Activity V1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 240
C.1.1 Paper published in Computer Physics Communications . . . . . . . . . . . . . . . . . . . 240
C.1.2 Accompanying Manual . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 248
C.2 Activity V2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 282
C.2.1 Accompanying Manual . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 282
D Activity V1 Full Results

307

D.1 36MeV Proton Irradiated Iron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 307
E Activity V2 Full Results

319

E.1 36MeV Proton Irradiated Iron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 320
E.1.1 Calculation Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 320
E.1.2 Results File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 320
E.1.3 Activity Tallied by Residual Isotope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 325
E.1.4 Gamma Output Tallied by Residual Isotope . . . . . . . . . . . . . . . . . . . . . . . . . . 328
E.1.5 Activity Tallied by Target Isotope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 331
E.1.6 Gamma Output Tallied by Target Isotope . . . . . . . . . . . . . . . . . . . . . . . . . . . 334
E.2 13MeV Proton Irradiated Molybdenum

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 337

E.2.1 Calculation Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 337
E.2.2 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 337
E.2.3 Total Decay Rates Over Time . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 341
E.2.4 Residual Activity Tallied by Target Isotope . . . . . . . . . . . . . . . . . . . . . . . . . . 342
E.2.5 Residual Activity Tallied by Residual Isotope . . . . . . . . . . . . . . . . . . . . . . . . . 343
E.2.6 Residual Gamma Energy Tallied by Residual Isotope . . . . . . . . . . . . . . . . . . . . . 343
E.2.7 Gamma Lines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 345
E.3 13MeV Proton Irradiated Steel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 346
E.3.1 Calculation Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 346
E.3.2 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 346
F Iron Activity: Irradiated to 100DPA

369

F.1 Activity vs Beam Energy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 369
F.1.1 5MeV Proton Beam - 60 microamp 100DPA . . . . . . . . . . . . . . . . . . . . . . . . . . 370
F.1.2 10MeV Proton Beam - 60 microamp 100DPA . . . . . . . . . . . . . . . . . . . . . . . . . 372
F.1.3 15MeV Proton Beam - 60 microamp 100DPA . . . . . . . . . . . . . . . . . . . . . . . . . 374
F.1.4 20MeV Proton Beam - 60 microamp 100DPA . . . . . . . . . . . . . . . . . . . . . . . . . 376
F.1.5 25MeV Proton Beam - 60 microamp 100DPA . . . . . . . . . . . . . . . . . . . . . . . . . 378
F.1.6 30MeV Proton Beam - 60 microamp 100DPA . . . . . . . . . . . . . . . . . . . . . . . . . 380
ix

CONTENTS

CONTENTS

G SRIM Results

382

G.0.1 Ion paths through an iron sample . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 382
H Crystal Structures

384

H.1 Common Cubic Structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 384
H.1.1 Simple Cubic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 384
H.1.2 Body Centered Cubic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 385
H.1.3 Face Centered Cubic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 385
H.1.4 Zincblende . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 386
H.2 FCC Defects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 387
H.2.1 Dumbbell < 100 > . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 387
H.2.2 Dumbbell < 110 > . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 387
H.2.3 Dumbbell < 111 > . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 387
H.2.4 Crowdion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 388
H.2.5 Octahedral Interstitial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 388
H.2.6 Tetrahedral Interstitial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 388
I

Elastic Constants

389

I.1

Elastic Constant Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 389

I.2

Sets of Strains Applied to Calculate Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . 391
I.2.1

Cubic Crystals - Mehl, Singh, Klein and Papaconstantopoulos 1993 . . . . . . . . . . . . . 391

I.2.2

Orthorhombic Crystals - Ravindran, Fast, Korzhavyi and Johansson . . . . . . . . . . . . 392

I.2.3

Cubic Crystals - Connetable and Thomas 2009 . . . . . . . . . . . . . . . . . . . . . . . . 393

I.2.4

Orthorhombic Crystals - Connetable and Thomas 2009

. . . . . . . . . . . . . . . . . . . 393

J PBE Functional

395

K QECONVERGE

398

L DFT Convergence Plots

400

M QEEOS

407

N DFT Calculated Properties

413

N.1 QEEOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 413
N.2 FCC Aluminium . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414
N.2.1 DFT Settings for PWscf . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414
N.2.2 Resulting Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414
N.2.3 Aluminium FCC Results File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 415

x

CONTENTS

CONTENTS

N.2.4 Known and Calculated Values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 416
N.3 BCC Iron [No Magnetism] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 417
N.3.1 Major DFT Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 417
N.3.2 Equation of State and Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . . . . . 417
N.3.3 Iron BCC Results File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 418
N.4 BCC Iron [Ferromagnetic] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421
N.4.1 Major DFT Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421
N.4.2 Equation of State and Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421
N.4.3 Iron Ferromagnetic BCC Results File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 422
N.4.4 Known and Calculated Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 425
N.5 FCC Iron [Antiferromagnetic] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
N.5.1 Major DFT Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
N.5.2 Equation of State and Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
N.5.3 Iron FCC Results File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 427
N.6 FCC Palladium . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 430
N.6.1 Major DFT Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 430
N.6.2 Equation of State and Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . . . . . 430
N.6.3 Palladium FCC Results File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 431
N.6.4 Known and Calculated Values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 433
N.7 FCC Ruthenium . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 434
N.7.1 Major DFT Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 434
N.7.2 Equation of State and Elastic Constants . . . . . . . . . . . . . . . . . . . . . . . . . . . . 434
N.7.3 Ruthenium FCC Results File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 435
N.7.4 Calculated Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 437
O Transferability

438

O.1 Sheng Aluminium Potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 438
O.1.1 FCC Structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 438
O.1.2 BCC Structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 440
O.2 Mendelev et al 2003 Iron Potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 440
O.2.1 BCC Structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 440
O.2.2 FCC Structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 440
O.3 Ackland et al 1997 Iron Potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 440
O.3.1 BCC Structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 440
O.3.2 FCC Structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 440

xi

CONTENTS

CONTENTS

P Optimization

446

P.1 Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 446
P.1.1

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 446

P.1.2

Continuous and Discrete Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 446

P.1.3

Constrained and Unconstrained Optimization . . . . . . . . . . . . . . . . . . . . . . . . . 446

P.1.4

Global and Local Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 447

P.1.5

Global Optimization Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 447

P.1.6

Local Optimization Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 449

Q EAMPA Code

452

Q.1 Energy, Force, and Stress Subroutine . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 452
Q.2 Neighbour List Subroutine . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 455
Q.3 Fortran Programmed Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 457
Q.4 Main fitting class . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 460
Q.5 Global Fitting Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 466
Q.6 Bulk Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 472
Q.7 Interpolation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 484
Q.8 Interpolation (Gradient) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 484
R Potential Functions

486

R.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 486
R.2 Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 486
R.2.1 Ackland Embedding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 486
R.2.2 Buckingham . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 487
R.2.3 Lennard Jones . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 488
R.2.4 Mishin Density . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 489
R.2.5 Morse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 491
R.2.6 Polynomial Embedding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 492
R.2.7 Spline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 493
R.2.8 Slater 4s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 496
R.2.9 Zero . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 498
S Fe-Pd and Fe-Ru Structures

500

xii

CONTENTS

CONTENTS

T Fe-Pd Potential

503

T.1 Tabulated Potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 503
T.2 Potential Function Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 504
T.3 Potential vs DFT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 505
T.4 Bulk Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 506
T.4.1 Iron FCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 506
T.4.2 Palladium FCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 508
T.4.3 Iron BCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 510
U Fe-Ru Potential

512

U.1 Tabulated Potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 512
U.2 Potential Function Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 513
U.3 Potential vs DFT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 514
U.4 Bulk Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 515
U.4.1 Iron FCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 515
U.4.2 Ruthenium FCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 517
U.4.3 Iron BCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 519
V Contribution to the DLPOLY Source Code

521

V.1 Contribution to DLPOLY 4.04 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 521

xiii

List of Figures
1.1

U-235 and U-238 fission cross sections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.2

Remaining reactor locations in the UK. Active as of 2022: Heysham (4 x AGR), Torness (2 x

3

AGR), Hartlepool (2 x AGR), Sizewell B (1 x PWR) . . . . . . . . . . . . . . . . . . . . . . . . .

4

1.3

Electricity in Millions of Tonnes of Oil Equivalent . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

1.4

Safest and cleanest sources of energy [7] - deaths per terawatt hour and tonnes of CO2 per
gigawatt hour . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7

1.5

Typical reactor flux - thermal and fast spectra . . . . . . . . . . . . . . . . . . . . . . . . . . . .

9

1.6

Inelastic scattering - scattering angle vs energy loss for a range of target atoms . . . . . . . . . . 10

1.7

Energy demand to produce hydrogen by electrolysis as temperature changes . . . . . . . . . . . . 11

1.8

Phases of water: pressure vs temperature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

1.9

Neutron energy spectrum from fission[23] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

1.10 PKA energy as a funtion of neutron energy in Fe[24] . . . . . . . . . . . . . . . . . . . . . . . . . 14
1.11 Damage cascades in Fe for a range of energies. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
2.1

Proton and neutron interactions

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

2.2

Pair production Feynman diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.3

Compton Scattering Feynman diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.4

Photoelectric Effect Feynman diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.5

Coherent Scattering Feynman diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

2.6

High Flux Isotope Reactor Neutron Flux . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

2.7

Dependency of absorption and attenuation of photons in soft tissue as a function of photon energy 25

2.8

Interstitials in the cascades of 10keV, 20keV and 40keV PKA displacement cascades [38] . . . . . 26

3.1

Steel Cr-Ni Schaeffler Diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.2

Iron-Chromium-Nickel Phase Diagram[39] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.3

BCC structure of ferritic stainless steel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.4

FCC structure of austenitic stainless steel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.5

Expected DPA during component life time and operating temperatures[42]

3.6

Scattering angle probability of neutrons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

3.7

Energy transfer as a from a neutron dependant on target mass . . . . . . . . . . . . . . . . . . . 32
xiv

. . . . . . . . . . . . 31

LIST OF FIGURES

LIST OF FIGURES

3.8

Recoil energies for neutrons at 102keV, 1.02MeV, 10.1MeV and 14.1MeV[24] . . . . . . . . . . . 33

3.9

Depletion of cr, fe and enrichment of ni at the surface[51] . . . . . . . . . . . . . . . . . . . . . . 34

3.10 Concentration profile after 46DPA irradiation with 75 keV Ni ions[52] . . . . . . . . . . . . . . . 34
3.11 Temperature and DPA dependence of RIS[53] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
3.12 Formation of chromium precipitates at the grain boundary [58] . . . . . . . . . . . . . . . . . . . 36
3.13 Sensitization of an alloy: chromium carbide precipitation [59] . . . . . . . . . . . . . . . . . . . . 36
3.14 Changing water chemistry: radiolysis of water[64] . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
3.15 Three requirements for IGSCC to occur . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
3.16 Inter Granular Stress Corrosion Cracking in Nickel Alloy[65] . . . . . . . . . . . . . . . . . . . . . 38
3.17 Alloy choices for early LWRs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
3.18 Nickel, IGSCC and TGSCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
3.19 Addition of Ru to Fe30Cr and Fe40Cr steels - open current corrosion potential variation with
time in 10% sulphuric acid[73] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
3.20 Failure times for 304SS, Pd doped 304SS (with and without Mn) and Ru doped 304SS in polythionic acid at ambient temperature[1] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
4.1

High Flux Isotope Reactor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

4.2

NBSR building layout[81] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

4.3

An example of a neutron spallation source where high energy ions collide with heavy atoms[83] . 46

4.4

Neutron Spectra from the Fission of U235[85] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48

4.5

Neutron, proton and deuteron cross sections for Fe56 and Ni58 . . . . . . . . . . . . . . . . . . . 48

4.6

TALYS work flow [94] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

4.7

TALYS Fe54-Co55 cross section comparison with experiment [95] . . . . . . . . . . . . . . . . . . 52

4.8

An example decay chain from an unstable parent isotope, through unstable daughter isotopes
ending with a stable daughter isotope. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

4.9

One hundred simulated 13MeV proton energy loss curves in Fe simulated with SRIM [98] . . . . 57

5.1

Time and Size Scales for Computer Packages [99] . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

5.2

Rose-Vinet Equation of State . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

5.3

Correlation between 𝐶11 and temperature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

5.4

Lennard-Jones Potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

5.5

Morse Potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

5.6

Buckingham Potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72

5.7

ZBL universal screening potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73

5.8

Polynomial knot to knot spline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

5.9

Damage in MOX (LAMMPS)[127] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

5.10 Sputtering of plutonium oxide (LAMMPS)[128] . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
5.11 5keV cascade (MOLDY)[129] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
xv

LIST OF FIGURES

LIST OF FIGURES

5.12 20keV cascade (MOLDY)[129] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
5.13 100keV cascade after 50ps in TiO2 (DL POLY)[130] . . . . . . . . . . . . . . . . . . . . . . . . . 85
5.14 Neighbouring atom count dependant upon lattice parameter and cutoff radius . . . . . . . . . . . 87
5.15 A 2D representation of atoms in simulation box with a halo of atoms at the boundary . . . . . . 87
5.16 Partitioning in LAMMPS[132] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
5.17 Damage cascade: 500kev iron projectiles into an iron target calculated with SRIM . . . . . . . . 92
5.18 Common approximations used to enable DFT calculations . . . . . . . . . . . . . . . . . . . . . . 94
5.19 A useful, albeit incorrect, way of visualising an ”infinite” chain of atoms in 1D . . . . . . . . . . 98
5.20 A 2D example of a translation by an integer multiple of the unit cell from the origin unit cell . . 98
5.21 BCC Wigner Seitz Cell and BZ [140] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
5.22 FCC Wigner Seitz Cell and BZ [140] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
5.23 Charge density FCC aluminium xy plane at 𝑧 = 0.0𝑎0 . . . . . . . . . . . . . . . . . . . . . . . . 102
5.24 Charge density FCC aluminium xy plane at 𝑧 = 0.5𝑎0 . . . . . . . . . . . . . . . . . . . . . . . . 102
5.25 SCF algorithm for Quantum Espresso . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
5.26 Replacing the complex potentials with a pseudopotential[152] . . . . . . . . . . . . . . . . . . . . 106
5.27 Successes and failures of the GGA functional[150] . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
5.28 Energy gap between valence and conduction bands[163] . . . . . . . . . . . . . . . . . . . . . . . 111
5.29 Probability F(E) of finding a fermion with energy E at several temperatures[164] . . . . . . . . . 111
5.30 Delta function replaced by successive Hermite polynomials[165] . . . . . . . . . . . . . . . . . . . 112
5.31 The occupancy for the Marzari-Vanderbilt smearing function is always positive, unlike the MethfesslPaxton function[166] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113
6.1

An example of several decay chains including branching factors and possible external source terms
for each isotope on each chain. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

6.2

Decay of Po-218: Analytic and Gaver-Stehfest Calculations [23] . . . . . . . . . . . . . . . . . . . 122

6.3

Decay path of Polonium-216 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

6.4

Decay path of Polonium-216 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124

6.5

Data from pre-existing TENDL files for (56
26 𝐹 𝑒, 𝑝) reactions . . . . . . . . . . . . . . . . . . . . . . 125

6.6

Data from TALYS generated files for (56
26 𝐹 𝑒, 𝑝) reactions . . . . . . . . . . . . . . . . . . . . . . . 126

6.7

36MeV Ion Track . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127

6.8

Protons through a 0.5mm thick iron target - 100 proton histories . . . . . . . . . . . . . . . . . . 129

6.9

Protons through target thick enough to stop all ions - 100 proton histories . . . . . . . . . . . . . 130

6.10 Cyclotron layout - main hall and beam lines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
6.11 Gamma warning alarm during 0.5 microamp 36MeV proton irradiation of iron . . . . . . . . . . 131
6.12 Proton stopping distances in various materials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
6.13 Decay path of Cobalt-55 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
6.14 Cobalt-55 Gamma Intensity Plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
xvi

LIST OF FIGURES

LIST OF FIGURES

6.15 High Purity Germanium Detector . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133
6.16 Gamma counts from the irradiated iron target over 300 seconds . . . . . . . . . . . . . . . . . . . 133
6.17 𝐹 𝑒56(𝑝, 2𝑛)𝐶𝑜55 cross section data from several sources [173][174][175][176][177] . . . . . . . . . 134
6.18 Isotopes with the top 5 radioactivity plotted over approximately 3 days . . . . . . . . . . . . . . 136
6.19 Predicted gamma lines approximately 3 days after irradiation . . . . . . . . . . . . . . . . . . . . 136
6.20 Particle production rate in beam . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137
6.21 Gamma output of residual isotopes, by isotope, at the start and end of irradiation . . . . . . . . 137
6.22 Residual isotope power output, by residual, once beam is off. . . . . . . . . . . . . . . . . . . . . 138
6.23 Expected gamma lines by the end of the experiment (3 days) . . . . . . . . . . . . . . . . . . . . 138
6.24 Change in isotope gamma output over time with proton beam off. . . . . . . . . . . . . . . . . . 140
6.25 Proton irradiated Molybdenum gamma activity measured by colleague John Hewett . . . . . . . 141
6.26 Isotopes in naturally occurring Molybdenum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
6.27 Reaction cross sections for

96
96
42 𝑀 𝑜(𝑝, 𝑛)43 𝑇 𝑐

from various sources . . . . . . . . . . . . . . . . . . . 142

6.28 Tc activity and beam energy as a function of depth into the target, showing a non-uniform
distribution of radioactive atoms in the sample . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144
6.29 The attenuation of Gammas through Mo for a range of energies and thicknesses[30] . . . . . . . . 144
6.30 Comparison of Gamma peaks from experiment, a simple estimate and the Activity code. . . . . . 145
7.1

Work flow used to fit potentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149

7.2

Equation of state fit through data points for Chromium BCC with no magnetism, ferromagnetic
and antiferromagnetic configurations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155

7.3

Equation of state fit through data points for Iron BCC (no magnetism, ferromagnetic) and Iron
FCC (no magnetism and antiferromagnetic) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 156

7.4

Magnetic alignment along the z-axis, antiferromagnetic Fe fcc . . . . . . . . . . . . . . . . . . . . 160

7.5

Isolated atom energies as cell size increase . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164

7.6

Neighbouring atom separations and their frequency over 5 subsections of the DFT reference
database . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166

7.7

Binary alloy configurations with less than 2% PGMs . . . . . . . . . . . . . . . . . . . . . . . . . 167

7.8

Effect of randomly perturbing atom locations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168

7.9

A sample of configurations used for binary alloy DFT calculations for Fe-Pd and Fe-Ru. . . . . . 168

7.10 Fe-Ru calculations failed to converge in 100 iterations when plain mixing was used, but achieved
convergence in under 40 iterations with local-TF convergence . . . . . . . . . . . . . . . . . . . . 171
7.11 Parameter Breed Event . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177
7.12 DIRAC calculated radial electron density for Iron . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
7.13 DIRAC calculated radial electron density for Palladium . . . . . . . . . . . . . . . . . . . . . . . 181
7.14 Rose-Vinet plots for Iron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184
7.15 Rose-Vinet plots for Palladium and Ruthenium . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184
7.16 Plotting how well the potentials reproduce DFT energy values
xvii

. . . . . . . . . . . . . . . . . . . 185

LIST OF FIGURES

LIST OF FIGURES

7.17 Energy plotted as both a slab and two surfaces begin to form. The plots give the energies
predicted by DFT and computed using the potentials from this work. . . . . . . . . . . . . . . . 185
7.18 LAMMPS modelled cube like Fe-Pd particle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 186
B.1 Decay path for Chromium-49 [23] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 233
B.2 Decay path for Nickel-66 [23] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 234
B.3 Decay path for Caesium-125 [23] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
B.4 Decay path for Bismuth-213 [23] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 236
B.5 Decay path for Bismuth-213 [23] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237
B.6 Decay path for Bismuth-213 [23] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 238
E.1 Residual isotope activity by isotope at 3 seconds into irradiation . . . . . . . . . . . . . . . . . . 325
E.2 Residual isotope activity by isotope at 60 seconds into irradiation . . . . . . . . . . . . . . . . . . 325
E.3 Residual isotope activity by isotope at 300 seconds into irradiation - end of irradiation . . . . . . 326
E.4 Residual isotope activity by isotope at 1 day, with approximately 1 day of cooling . . . . . . . . 326
E.5 Residual isotope activity by isotope at 2 days, with approximately 2 days of cooling . . . . . . . 327
E.6 Residual isotope activity by isotope at approximately 3 days, with approximately 3 days of cooling327
E.7 Gamma activity by isotope at 3 seconds into irradiation . . . . . . . . . . . . . . . . . . . . . . . 328
E.8 Gamma activity by isotope at 60 seconds into irradiation . . . . . . . . . . . . . . . . . . . . . . 328
E.9 Gamma activity by isotope at 300 seconds into irradiation . . . . . . . . . . . . . . . . . . . . . . 329
E.10 Gamma activity by isotope with approximately 1 day of cooling . . . . . . . . . . . . . . . . . . . 329
E.11 Gamma activity by isotope with approximately 2 days of cooling . . . . . . . . . . . . . . . . . . 330
E.12 Gamma activity by isotope with approximately 3 days of cooling . . . . . . . . . . . . . . . . . . 330
E.13 Isotope activity contribution by target isotope at 3 seconds into irradiation . . . . . . . . . . . . 331
E.14 Isotope activity contribution by target isotope at 60 seconds into irradiation . . . . . . . . . . . . 331
E.15 Isotope activity contribution by target isotope at 300 seconds into irradiation . . . . . . . . . . . 332
E.16 Isotope activity contribution by target isotope with approximately 1 day of cooling . . . . . . . . 332
E.17 Isotope activity contribution by target isotope with approximately 2 days of cooling . . . . . . . 333
E.18 Isotope activity contribution by target isotope with approximately 3 days of cooling . . . . . . . 333
E.19 Gamma activity contribution by target isotope at 3 seconds into irradiation . . . . . . . . . . . . 334
E.20 Gamma activity contribution by target isotope at 60 seconds into irradiation . . . . . . . . . . . 334
E.21 Gamma activity contribution by target isotope at 300 seconds into irradiation . . . . . . . . . . . 335
E.22 Gamma activity contribution by target isotope with approximately 1 day of cooling . . . . . . . 335
E.23 Gamma activity contribution by target isotope with approximately 2 days of cooling . . . . . . . 336
E.24 Gamma activity contribution by target isotope with approximately 3 days of cooling . . . . . . . 336
E.25 Total activity over time . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 341
E.26 Total gamma power output over time

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 341

xviii

LIST OF FIGURES

LIST OF FIGURES

E.27 Radioactive decay from residual isotopes tallied by target isotope - end of beam (1,500 seconds) . 342
E.28 Radioactive decay from residual isotopes tallied by target isotope - 3 days after irradiation . . . . 342
E.29 Radioactive decay from residual isotopes tallied by residual isotope - end of beam (1,500 seconds) 343
E.30 Radioactive decay from residual isotopes tallied by residual isotope - 3 days after irradiation . . . 343
E.31 Radioactive decay from residual isotopes tallied by residual isotope - end of beam (1,500 seconds) 344
E.32 Radioactive decay from residual isotopes tallied by residual isotope - 3 days after irradiation . . . 344
E.33 Predicted gamma lines - end of beam (1,500 seconds) . . . . . . . . . . . . . . . . . . . . . . . . . 345
E.34 Predicted gamma lines - 3 days after irradiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 345
F.1 Cooling measured by gamma power for iron samples irradiated to 100DPA at a range of proton
energies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 369
F.2 Residual isotope activity over time with 5MeV protons . . . . . . . . . . . . . . . . . . . . . . . . 370
F.3 Residual isotope gamma output at the end of irradiation with 5MeV protons . . . . . . . . . . . 370
F.4 Residual isotope gamma output after 1 week of cooling . . . . . . . . . . . . . . . . . . . . . . . . 371
F.5 Residual isotope activity over time with 10MeV protons . . . . . . . . . . . . . . . . . . . . . . . 372
F.6 Residual isotope gamma output at the end of irradiation with 10MeV protons . . . . . . . . . . . 372
F.7 Residual isotope gamma output after 1 week of cooling . . . . . . . . . . . . . . . . . . . . . . . . 373
F.8 Residual isotope activity over time with 15MeV protons . . . . . . . . . . . . . . . . . . . . . . . 374
F.9 Residual isotope gamma output at the end of irradiation with 15MeV protons . . . . . . . . . . . 374
F.10 Residual isotope gamma output after 1 week of cooling . . . . . . . . . . . . . . . . . . . . . . . . 375
F.11 Residual isotope activity over time with 20MeV protons . . . . . . . . . . . . . . . . . . . . . . . 376
F.12 Residual isotope gamma output at the end of irradiation with 20MeV protons . . . . . . . . . . . 376
F.13 Residual isotope gamma output after 1 week of cooling . . . . . . . . . . . . . . . . . . . . . . . . 377
F.14 Residual isotope activity over time with 25MeV protons . . . . . . . . . . . . . . . . . . . . . . . 378
F.15 Residual isotope gamma output at the end of irradiation with 25MeV protons . . . . . . . . . . . 378
F.16 Residual isotope gamma output after 1 week of cooling . . . . . . . . . . . . . . . . . . . . . . . . 379
F.17 Residual isotope activity over time with 30MeV protons . . . . . . . . . . . . . . . . . . . . . . . 380
F.18 Residual isotope gamma output at the end of irradiation with 30MeV protons . . . . . . . . . . . 380
F.19 Residual isotope gamma output after 1 week of cooling . . . . . . . . . . . . . . . . . . . . . . . . 381
G.1 SRIM trajectories for 12MeV, 14MeV and 16MeV protons in iron . . . . . . . . . . . . . . . . . . 382
G.2 SRIM trajectories for 18MeV, 20MeV and 22MeV protons in iron . . . . . . . . . . . . . . . . . . 382
G.3 SRIM trajectories for 24MeV, 26MeV and 28MeV protons in iron . . . . . . . . . . . . . . . . . . 382
G.4 SRIM trajectories for 30MeV, 32MeV and 34MeV protons in iron . . . . . . . . . . . . . . . . . . 383
G.5 SRIM trajectories for 36MeV protons in iron . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 383
L.1 Ecutwfc and Ecutrho convergence for aluminium (energy and force) . . . . . . . . . . . . . . . . 401
L.2 2D density map - force and energy convergence with k-points and smearing - alluminium . . . . . 402
xix

LIST OF FIGURES

LIST OF FIGURES

L.3 Ecutwfc and Ecutrho convergence for iron (energy and force) . . . . . . . . . . . . . . . . . . . . 403
L.4 2D density map - force and energy convergence with k-points and smearing - iron . . . . . . . . . 404
L.5 Ecutwfc and Ecutrho convergence for palladium (energy and force) . . . . . . . . . . . . . . . . . 405
L.6 2D density map - force and energy convergence with k-points and smearing - palladium . . . . . 406
N.1 Aluminium FCC equation of state plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414
N.2 Aluminium FCC elastic constants plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414
N.3 Iron BCC equation of state plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 417
N.4 Iron BCC elastic constants plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 417
N.5 Iron BCC (magnetic) equation of state plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421
N.6 Iron BCC (magnetic) elastic constants plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421
N.7 Iron FCC (magnetic) equation of state plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
N.8 Iron FCC (magnetic) elastic constants plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
N.9 Palladium FCC equation of state plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 430
N.10 Palladium FCC elastic constants plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 430
O.1 Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to
the Sheng Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 439
O.2 Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng
Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 439
O.3 Birch Murnaghan equation of state for BCC Aluminium - comparison of experimental data to
the Sheng Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 441
O.4 Rose-Vinet equation of state for BCC Aluminium - comparison of experimental data to the Sheng
Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 441
O.5 Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to
the Sheng Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 442
O.6 Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng
Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 442
O.7 Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to
the Sheng Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 443
O.8 Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng
Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 443
O.9 Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to
the Sheng Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 444
O.10 Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng
Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 444
O.11 Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to
the Sheng Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 445
O.12 Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng
Al potential . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 445

xx

LIST OF FIGURES

LIST OF FIGURES

R.1 Ackland Mendelev . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 487
R.2 Buckingham . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 488
R.3 Lennard Jones . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 489
R.4 Mishin Density . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 491
R.5 Morse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 492
R.6 Polynomial Embedding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 493
R.7 Spline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 496
R.8 Slater 4s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 497
R.9 Zero . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 499
S.1 FePd Structure 01 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 500
S.2 FePd Structure 02 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 500
S.3 FePd Structure 03 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 501
S.4 FePd Structure 04 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 501
S.5 FePd Structure 05 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 502
T.1 Binary Alloy Potential for Fe-Pd . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 504
T.2 Fe-Pd - a measure of how well the potential fits to first principles calculations . . . . . . . . . . . 505
T.3 Equation of State plots from this potential for FCC Fe . . . . . . . . . . . . . . . . . . . . . . . . 505
T.4 Equation of State plots from this potential for FCC Fe . . . . . . . . . . . . . . . . . . . . . . . . 506
T.5 Ravindran et al[109] distortion-energy plots for FCC Fe . . . . . . . . . . . . . . . . . . . . . . . 507
T.6 MSKP elastic constant strains, where the solid line is the known value and the points the values
for this potential - FCC Fe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 507
T.7 Equation of State plots from this potential for FCC Pd

. . . . . . . . . . . . . . . . . . . . . . . 508

T.8 Ravindran et al[109] distortion-energy plots for FCC Pd . . . . . . . . . . . . . . . . . . . . . . . 509
T.9 MSKP elastic constant strains, where the solid line is the known value and the points the values
for this potential - FCC Pd . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 509
T.10 Equation of State plots from this potential for FCC Pd

. . . . . . . . . . . . . . . . . . . . . . . 510

T.11 Ravindran et al[109] distortion-energy plots for FCC Pd . . . . . . . . . . . . . . . . . . . . . . . 511
T.12 MSKP elastic constant strains, where the solid line is the known value and the points the values
for this potential - BCC Fe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 511
U.1 Binary Alloy Potential for Fe-Ru . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 513
U.2 Fe-Ru - a measure of how well the potential fits to first principles calculations . . . . . . . . . . . 514
U.3 Equation of State plots from this potential for FCC Fe . . . . . . . . . . . . . . . . . . . . . . . . 514
U.4 Equation of State plots from this potential for FCC Fe . . . . . . . . . . . . . . . . . . . . . . . . 515
U.5 Ravindran et al[109] distortion-energy plots for FCC Fe . . . . . . . . . . . . . . . . . . . . . . . 516
U.6 MSKP elastic constant strains, where the solid line is the known value and the points the values
for this potential - FCC Fe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 516
xxi

LIST OF FIGURES

LIST OF FIGURES

U.7 Equation of State plots from this potential for FCC Ru . . . . . . . . . . . . . . . . . . . . . . . 517
U.8 Ravindran et al[109] distortion-energy plots for FCC Ru . . . . . . . . . . . . . . . . . . . . . . . 518
U.9 MSKP elastic constant strains, where the solid line is the known value and the points the values
for this potential - FCC Ru . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 518
U.10 Equation of State plots from this potential for BCC Fe . . . . . . . . . . . . . . . . . . . . . . . . 519
U.11 Ravindran et al[109] distortion-energy plots for FCC Ru . . . . . . . . . . . . . . . . . . . . . . . 520
U.12 MSKP elastic constant strains, where the solid line is the known value and the points the values
for this potential - BCC Ru . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 520

xxii

List of Tables
1.1

Bulk, shear, Young’s modulus comparison: Zirlo and austenitic stainless steel . . . . . . . . . . .

8

1.2

Approximate simulation sizes by PKA energy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

2.1

Neutron Categories by Energy Range [27] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

2.2

Irradiation dose comparison in mSv[32][33] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23

2.3

Cohesive Energies [36] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

2.4

Average recoil energy of Nickel PKAs[37] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

3.1

Common grades of ferritic, austenitic, duplex and martensitic stainless steel and their properties.
Hardness using the HRB, ultimate tensile strength (UTS) and Young’s modulus E. . . . . . . . . 30

3.2

Radioactive products and their half lives for PGM doped 304SS . . . . . . . . . . . . . . . . . . . 41

4.1

University of Birmingham Cyclotron Ion Beams. The projectiles per area is based on a 0.8cmx0.8cm
beam aperture. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

4.2

Examples of neutron sources, energies and flux, with the MC-40 as a reference for protons . . . . 47

5.1

Seven Crystal Classes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

5.2

Example bulk modulii for three metals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61

5.3

Caesium 2BEAM parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75

5.4

Bravais lattice vector length and angle relationships . . . . . . . . . . . . . . . . . . . . . . . . . 97

5.5

Experimental vs LSDA vs GGA for 𝑇 𝑖𝑆𝑖2 [109] . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109

5.6

Experimental vs LSDA vs GGA vs GGA PBESOL for 𝐿𝑎𝐴𝑙𝑂3 [156] . . . . . . . . . . . . . . . . 109

5.7

Experimental vs LSDA vs GGA - the DFT values were computed with a PWscf[159] using a
2x2x2 cell, 7x7x7 kpoints and ecutwfc=50 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

6.1

Half life of isotopes in the Po-216 decay chain . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

6.2

Parameters used for the decay equation vs numeric calculation comparison . . . . . . . . . . . . . 123

6.3

Beam Characteristics of the Scanditronix MC-40 . . . . . . . . . . . . . . . . . . . . . . . . . . . 129

6.4

Parameters used to estimate Co55 931keV gamma activity . . . . . . . . . . . . . . . . . . . . . . 135

6.5

Estimation of the Cobalt-55 931keV gamma activity based on the TENDL-2009[173], TENDL2017[174], TENDL-2019[175] data files, EXFOR experimental data [176] and TALYS generated
data files[177]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
xxiii

LIST OF TABLES

LIST OF TABLES

6.6

Comparison of proton irradiated iron Co55 931keV gamma rates . . . . . . . . . . . . . . . . . . 139

6.7

Comparison of proton irradiated iron up to 100DPA at a range of proton energies. The first set
of measurements1 are calculated values at the point the proton beam is turned off. The second
set2 are calculated after 1 week of cooling. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

6.8

Gamma emissions measured from a 0.5mm thick sample of Molybdenum irradiated with 13MeV
protons at 5 microamps for 1,500 seconds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141

6.9

A comparison between measured and estimated peaks from a 0.5mm thick sample of Mo irradiated
with 13MeV protons at 5 microamps for 1,500 seconds . . . . . . . . . . . . . . . . . . . . . . . . 143

6.10 A comparison between measured and calculated peaks from a 0.5mm thick sample of Mo irradiated with 13MeV protons at 5 microamps for 1,500 seconds . . . . . . . . . . . . . . . . . . . . . 145
7.1

Predicted lattice parameters based on the density, atomic number and type of structure . . . . . 148

7.2

Predicted lattice parameters based on the density, atomic number and type of structure . . . . . 151

7.3

Experimental vs LSDA vs GGA - the DFT values were computed with a PWscf[159] using a
2x2x2 cell, 7x7x7 kpoints and ecutwfc=50 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154

7.4

Chromium properties with and without collinear spin

. . . . . . . . . . . . . . . . . . . . . . . . 155

7.5

BCC and FCC Iron properties with and without collinear spin . . . . . . . . . . . . . . . . . . . 156

7.6

DFT Settings - pseudopotentials, ecutwfc, ecutrho, k-points, smearing . . . . . . . . . . . . . . . 157

7.7

DFT Settings - other settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157

7.8

Relaxed energies calculated in Quantum Espresso . . . . . . . . . . . . . . . . . . . . . . . . . . . 159

7.9

DFT computed FCC Fe parameters for fitting the potentials in this work . . . . . . . . . . . . . 162

7.10 DFT computed FCC Pd parameters for fitting the potentials in this work . . . . . . . . . . . . . 163
7.11 DFT computed FCC Ru parameters for fitting the potentials in this work . . . . . . . . . . . . . 163
7.12 DFT calculated energies per atom . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164
7.13 Relaxed energies for 32 atoms, using 9x9x9 k-points, and 256 atoms, using the gamma point.
These were used with the known cohesive energy to compute the offset energy. . . . . . . . . . . 165
7.14 Improving convergence SCF calculations of defects in Iron . . . . . . . . . . . . . . . . . . . . . . 172
7.15 Applying the Sheng Al potential, developed for FCC crystals, to the BCC structure. Elastic constants are calculated using the method by Mehl et al with values from the method by Ravindran
et al in brackets. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
7.16 Applying the Mendelev 2003 potential, developed for BCC crystals, to the FCC structure. Elastic constants are calculated using the method by Mehl et al with values from the method by
Ravindran et al in brackets. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
7.17 Applying the Ackland 1997 potential, developed for BCC crystals, to the FCC structure. Elastic constants are calculated using the method by Mehl et al with values from the method by
Ravindran et al in brackets. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
7.18 A summary of bulk properties from these potentials. The bulk modulus is computed from the
Birch-Murnaghan equation of state (a) and an average of the Reuss and Voight bulk modulus (b). 184
A.1 Useful Laplace transforms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218

xxiv

LIST OF TABLES

LIST OF TABLES

B.2 Chromium-49 - numeric vs analytic calculated radioactivity . . . . . . . . . . . . . . . . . . . . . 233
B.4 Nickel-66 - numeric vs analytic calculated radioactivity . . . . . . . . . . . . . . . . . . . . . . . . 234
B.6 Caesium-125 - numeric vs analytic calculated radioactivity . . . . . . . . . . . . . . . . . . . . . . 235
B.8 Bismuth-213 - numeric vs analytic calculated radioactivity . . . . . . . . . . . . . . . . . . . . . . 236
B.10 Polonium-216 - numeric vs analytic calculated radioactivity . . . . . . . . . . . . . . . . . . . . . 237
B.12 Radon-218 - numeric vs analytic calculated radioactivity . . . . . . . . . . . . . . . . . . . . . . . 239
E.1 Simulation settings for 36 MeV proton irradiated iron . . . . . . . . . . . . . . . . . . . . . . . . 320
E.2 Simulation settings for 13 MeV proton irradiated molybdenum . . . . . . . . . . . . . . . . . . . 337
E.3 Simulation settings for 13 MeV proton irradiated steel . . . . . . . . . . . . . . . . . . . . . . . . 346
H.1 Simple cubic configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 384
H.2 Body centered cubic configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 385
H.3 Face centered cubic configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 386
H.4 Zincblende configuration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 386
I.1

Independent elastic constants for a cubic crystal[199] . . . . . . . . . . . . . . . . . . . . . . . . . 389

I.2

Independent elastic constants for an orthorhombic/orthotropic crystal[199] . . . . . . . . . . . . . 390

I.3

Independent elastic constants for a monoclinic crystal[199] . . . . . . . . . . . . . . . . . . . . . . 390

I.4

Independent elastic constants for a triclinic crystal[199] . . . . . . . . . . . . . . . . . . . . . . . 391

I.5

Calculation of elastic constants using the equation of state, a volume conserving orthorhombic
strain and volume conserving monoclinic strain.[110][104] . . . . . . . . . . . . . . . . . . . . . . 391

I.6

Calculation of orthorhombic elastic constants by Ravindran et al.[dfttisiravindran] . . . . . . . 392

I.7

Calculation of elastic constants for a cubic crystal[137] . . . . . . . . . . . . . . . . . . . . . . . . 393

I.8

Calculation of elastic constants for a cubic crystal[137], 𝑢 = (1 − 𝜎 2 )− 3

1

. . . . . . . . . . . . . . 394

N.1 Aluminium DFT settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 414
N.2 FCC Aluminium: Experimental Values vs DFT Calculated Variables . . . . . . . . . . . . . . . . 416
N.3 Iron DFT settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421
N.4 BCC Iron: Experimental Values vs DFT Calculated Variables . . . . . . . . . . . . . . . . . . . . 425
N.5 Iron DFT settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 426
N.6 Iron FCC: DFT Calculated Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 429
N.7 Palladium DFT settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 430
N.8 FCC Palladium: Experimental Values vs DFT Calculated Properties . . . . . . . . . . . . . . . . 433
N.9 Ruthenium DFT settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 434
N.10 Ruthenium FCC: DFT Calculated Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 437

xxv

LIST OF TABLES

LIST OF TABLES

T.1 The lattice parameter, cohesive energy and bulk modulus were determined by fitting the BirchMurnaghan equation of state. The bulk modulus is computed from the Birch-Murnaghan equation
of state (a) and the average Reuss and Voight Bulk Moduldus (b). The elastic constants computed
for the potential in stiffness (1) were computed using the method by Ravindran et al[109] and in
stiffness (2) by Mehl et al[104][110]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 506
T.2 The lattice parameter, cohesive energy and bulk modulus were determined by fitting the BirchMurnaghan equation of state. The bulk modulus is computed from the Birch-Murnaghan equation
of state (a) and the average Reuss and Voight Bulk Moduldus (b). The elastic constants computed
for the potential in stiffness (1) were computed using the method by Ravindran et al[109] and in
stiffness (2) by Mehl et al[104][110]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 508
T.3 The lattice parameter, cohesive energy and bulk modulus were determined by fitting the BirchMurnaghan equation of state. The bulk modulus is computed from the Birch-Murnaghan equation
of state (a) and the average Reuss and Voight Bulk Moduldus (b). The elastic constants computed
for the potential in stiffness (1) were computed using the method by Ravindran et al[109] and in
stiffness (2) by Mehl et al[104][110]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 510
U.1 The lattice parameter, cohesive energy and bulk modulus were determined by fitting the BirchMurnaghan equation of state. The bulk modulus is computed from the Birch-Murnaghan equation
of state (a) and the average Reuss and Voight Bulk Moduldus (b). The elastic constants computed
for the potential in stiffness (1) were computed using the method by Ravindran et al[109] and in
stiffness (2) by Mehl et al[104][110]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 515
U.2 The lattice parameter, cohesive energy and bulk modulus were determined by fitting the BirchMurnaghan equation of state. The bulk modulus is computed from the Birch-Murnaghan equation
of state (a) and the average Reuss and Voight Bulk Moduldus (b). The elastic constants computed
for the potential in stiffness (1) were computed using the method by Ravindran et al[109] and in
stiffness (2) by Mehl et al[104][110]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 517
U.3 The lattice parameter, cohesive energy and bulk modulus were determined by fitting the BirchMurnaghan equation of state. The bulk modulus is computed from the Birch-Murnaghan equation
of state (a) and the average Reuss and Voight Bulk Moduldus (b). The elastic constants computed
for the potential in stiffness (1) were computed using the method by Ravindran et al[109] and in
stiffness (2) by Mehl et al[104][110]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 519

xxvi

Chapter 1

Introduction
Several Gen III+ nuclear reactors have been proposed for construction in the UK and Gen IV nuclear reactors are being researched and developed. At the time of writing Hinkley Point C is under
construction and Sizewell C has had government approval. However, much more must be done
to ensure the energy security of our nation. Well established reactor types and exciting new designs could contribute to solving this problem, but challenges to materials science must be overcome.
New materials are required to withstand the extreme conditions in and around the core of these
reactors. Austenitic stainless steels have been an important structural material in the industry, and
may continue to be so, providing the problem of inter granular stress corrosion cracking (IGSCC)
can be addressed. Doping these steels with platinum group metal (PGM)s has been seen to reduce
IGSCC, but the effects on corrosion resistance are unknown for these steels when irradiated by a
radiation field.

1.1

Motivation

I have often questioned the motivation behind this work, and at times it has been a challenge to see the wood
through the trees. To help me focus throughout I would restate the motivation and objectives to myself.
Mass produced steels are not perfect repeating crystals, but are made up of small grains. Cr is added to steel
to make stainless steel, and this is more resistant to corroding than steel. When steel is in a nuclear reactor, it
will have to perform under extreme conditions, such as:
• high temperatures
• strain cause by high pressures and radiation induced swelling
• radiation damage and strains resulting from this damage
• a changing environment, for example radiolysis of water and transmutation of isotope due to radiation
• corrosive environments while in the reactor
• corrosive environments out of the reactor (e.g. fuel cladding in storage)
Radiation damages the steel in a number of ways, including directly knocking atoms out of their place within
the lattice structure of the crystalline grains that make up the steel as well as changing the isotopes that make

1

1.2. NUCLEAR POWER IN THE UNITED KINGDOM

CHAPTER 1. INTRODUCTION

up the steel into new isotopes. An example of the latter is a neutron reacting with an Fe atom, transmuting it
into a Co atom.
In time, the radiation damage causes the percentage of Cr at the surface of the grains to drop, and as it falls
the steel loses its protection from corrosion at the boundary between the grains it is made of.
This work is divided into two parts.

1.1.1

Part 1: Activity Computer Program

The materials must be tested before being used in a nuclear reactor. One way to do this would be to place samples
of the steel into a test reactor. This is expensive and, as a by-product, the steel sample becomes radioactive. It
is difficult to create a large number of neutrons, but it is much easier, and cheaper, to create a beam of protons.
Protons can be accelerated in a machine such as the Cyclotron at the University of Birmingham.
The damage that protons cause to a sample is not precisely the same as that cause by neutrons, but it is a
cheaper alternative and is a trade-off between the cost and results. One side effect that proton irradiation shares
with neutron irradiation is the creation of radioactive waste.
The first part of this work investigates exactly how radioactive a samples becomes when irradiated with a proton
beam. An existing set of equations, named after Mathematician Harry Bateman, were modified and a computer
program was created to perform the calculation. The user inputs the constituent elements that make up the
material, the ratio of these elements, and the irradiation settings. The program then estimates how radioactive
the sample will be and the predicted gamma energies.

1.1.2

Part 2: Iron-Palladium and Iron-Ruthenium Potential

The addition of Cr to make stainless steel is not the only way to make a steel resistant to corrosion. Adding
metals such as Mo, Pd and Ru to steel can increase the resistance to corrosion, but Mo is several hundred times
the cost of Fe ore, and Pd is thousands of times as expensive.
Simulating radiation damage using a computer is now a feasible and sensible way to investigate how these
materials will be affected by radiation damage, and the simulations may reveal insights that experiments are
not able to show, either because they happen on too small a timescale or within the material at too small a
length scale.
Key to the simulations success is being able to accurately calculate how the atoms interact with one another.
The second part of this work concentrates on deriving a mathematical description of how Pd & Fe and Ru &
Fe atoms interact with one another, which would then allow future simulations of steel with small amounts of
Pd or Ru added to it.
Radiation causes Cr to be depleted at the grain boundary. If these simulations go on to show that Pd and
Ru are not depleted, it would suggest that the corrosion resistance is maintained despite the decrease in the
amount of Cr at the grain boundary due to radiation damage.

1.2
1.2.1

Nuclear Power in the United Kingdom
Nuclear Fuel

The primary fuel of commercial nuclear power stations since those first built in the 1950s has been U.

235
92 𝑈

is

fissile and fissions with a high probability when thermal neutrons are captured, due to its very high thermal
neutron fission cross section (fig. 1.1).
2

CHAPTER 1. INTRODUCTION

1.2. NUCLEAR POWER IN THE UNITED KINGDOM

Cross Section/Barns

Uranium 235 Cross Section
100000

U235

10000
1000
100
10
1
1×e-4

1×e-2

1×e0
1×e2
Neutron Energy/eV

1×e4

1×e6

Cross Section/Barns

Uranium 238 Cross Section
100000

U238

10000
1000
100
10
1
0.1
1×e-4

1×e-2

1×e0
1×e2
Neutron Energy/eV

1×e4

1×e6

Figure 1.1: U-235 and U-238 fission cross sections

Natural U contains a small percentage of fissile

235
92 𝑈

(0.7%) with the rest being its heavier isotope,

heavier isotope is fissionable, but its fission cross section is much lower than
considerations for reactors in operation revolve around the amount of

235
92 𝑈

235
92 𝑈

238
92 𝑈 .

This

(fig. 1.1). Many of the design

there is in the fuel and having a

sufficient flux of thermal neutrons passing through the fuel to sustain a reaction.
A number of Gen IV designs use the fast neutron spectrum to fission
generate energy and breed other fissile isotopes

(233
92 𝑈 ).

238
92 𝑈

By moving away from

and other fuels such as
235
92 𝑈 ,

232
90 𝑇 ℎ

to

this increases the potential

fuel stockpile, but also brings its own set of challenges.

1.2.2

Generation I Reactors

The first generation reactors were primarily prototype reactors. They included graphite moderated reactors,
light water and heavy water reactors. Early reactors were designed to produce electricity, but also fissile material
for nuclear weapons. With a power output of less than 2MW, the Gen I power station Calder Hall generated
much less electricity than a modern nuclear power plant which may produce 1GW per reactor. It did, however,
produce Pu for the UK’s nuclear weapon programme.
Magnox type reactors were the first used in the UK. These reactors used natural U as a fuel and were carefully
designed to produce energy despite using an un-enriched fuel. Graphite was used as a moderator, and the low
neutron capture cross section of the Magnox Mn alloy cladding allowed a nuclear reaction to occur despite the
fuel not being enriched.
In all there were 11 Magnox power stations built in the UK with 26 reactors in total. Construction of the first
commercial reactor in the UK, Calder Hall, started in 1953 and it operated from 1956 to 2003. All have now
shut down with the last, Wylfa in Anglesey, closing in 2015.

3

1.2. NUCLEAR POWER IN THE UNITED KINGDOM

CHAPTER 1. INTRODUCTION

Figure 1.2: Remaining reactor locations in the UK. Active as of 2022: Heysham (4 x AGR), Torness (2 x
AGR), Hartlepool (2 x AGR), Sizewell B (1 x PWR)

1.2.3

Generation II Reactors

Gen II marked the transition from prototype reactors to higher powered commercial reactors. There were a
number of designs including the AGR, a graphite core 𝐶𝑂2 cooled reactor, that was implemented in the UK.
Light water reactors included the PWR and BWR in the west and the VVER in the USSR. The RBMK was
a graphite moderated reactor used in the USSR and the CANDU a heavy water reactor designed and used in
Canada.
There are many of these reactors from this period still in operation around the world, and there have been
recent implementations of these designs. When I started writing this thesis there were 15 reactors operational
in the UK. As of 2022 there are only 9 reactors currently operating in the UK, and they are all Gen II reactors.
Of these, 8 are AGR and 1, Sizewell B, is a PWR (fig. 1.2). Perhaps this says something about the amount of
time I have taken to complete this work, but it also highlights the loss of 40% of the reactors we had within a
decade, and this is concerning.
The planned life span for this generation of reactor was 30-40 years, although this has now been extended to 5060 years in some cases. The AGR reactors in the UK have been operational for over 40 years, with Hunterston
B and Hinkley Point B being operational for 46 years before their service came to a close. Designed with safety
improvements in mind over Gen I reactors, they were also intended to produce more power with less of a focus
on producing fissile material for weapons. Unfortunately, this generation of reactors had the worst track record
of any regarding safety, with Three Mile Island, Fukashima and Chernobyl all being Gen II designs.
Gen II+ reactors have been built recently with 18 CPR-1000s being constructed over the last decade in China.
The UK is currently looking towards Gen III+ reactors while Gen IV proposals are being researched.

4

CHAPTER 1. INTRODUCTION

1.3. AN APPROACHING ENERGY GAP FOR THE UK

Electricity Demand UK: 1956-2013
90

Total
Coal
Oil
Natural Gas
Nuclear
Natural Flow Hydro
Wind
Coke and Breeze
Other Power

80

Electricity in Millions of Tonnes of Oil Equivalent

70

60

50

40

30

20

10

0
1950

1960

1970

1980

1990

2000

2010

2020

Year

Figure 1.3: Electricity in Millions of Tonnes of Oil Equivalent

1.2.4

Generation III Reactors

There are no Gen III reactors operating in the UK. The first was built in Japan in 1996 and the type of reactor
installed was an Advanced Boiling Water Reactor (ABWR). Bradwell B is a proposed site for the Gen III
Hualong One type PWR power plant (HPR1000), and if this goes ahead it would have an expected opening
date between 2030-2035.
This generation of reactor was designed to exceed the service life of the previous generation, and generate power
for at least 60 years. The safety features have been improved and include increased resilience to external factors,
including accidental or intentional aircraft collision into the plant[2].
Gen III+ reactors go further in adding passive safety features, such as natural circulation and gravity coolant
feed [3]. Other aims of future generations are to standardise and simplify designs whilst improve the economy
over Gen II+ and Gen III.

1.3

An Approaching Energy Gap for the UK

Since Calder Hall, the first commercial nuclear power plant, opened in 1956, the demand on electrical power
generation in the UK has tripled (fig 1.3). There is now a reliance on cheap and clean power from nuclear
reactors as these provide a quarter of our electricity. There are sixteen reactors operational in the UK: the
Magnox reactor at Wylfa and the fourteen AGR reactors are due to be decommissioned by 2023[4], and the
remaining PWR reactor, Sizewell B, is expected to remain operational until 2035[4].
There is an obvious concern that within the next ten years the UK will lose a sizeable proportion of its electricity
generation capabilities. There are increasing pressures on countries to reduce their carbon dioxide output, so
the gap created by ageing nuclear plants and coal power needs to be filled.

5

1.3. AN APPROACHING ENERGY GAP FOR THE UK

1.3.1

CHAPTER 1. INTRODUCTION

Why choose Nuclear Power?

As a civilization we need energy, whether it’s in the form of electricity or stored chemically, and whilst we
are becoming more efficient at using that energy, the demand for it will remain (unless something drastically
changes our society). There is a choice between burning fossil fuels or bio fuels, using energy from the Sun,
wind, ground, oceans or rivers and finally using the energy of the nucleus, whether by fission or fusion.
Each has its drawbacks and advantages. Renewable energies are unreliable; wind power only provides energy
when there is a wind, and if the wind is too strong, they must be shut down or risk damage. The Sun is only
available for a portion of the day, and the duration and intensity change with the seasons, not to mention the
impact of clouds on solar power. Renewable sources are not very good at responding to demand; there isn’t a
button to turn up the power of the Sun, or increase the velocity of the wind when the national grid demands
it. If we were completely reliant on renewable energies, there would either need to be an efficient way to store
energy on a large scale, or many more solar, wind, tidal and hydroelectric power stations than would be needed
to produce excess energy. Whilst the energy source may be free, turbines, solar panels, dams and so on require
maintenance, so an excess of these would be wasteful and costly.
Fossil fuels release carbon dioxide, sulphur dioxide, naturally occurring trace radioactive elements and other
pollutants into the atmosphere. These power plants are useful because the fuel is cheap, but the waste is put
back into the environment without much processing and the energy produce may be varied to meet the demand
of the national grid.
Nuclear power has a bad reputation with the public, in part caused by accidents such as the Windscale fire,
Three Mile Island, Chernobyl, and Fukushima. There have been examples of poor handling of nuclear waste
in the past, such as the legacy storage ponds at Sellafield, and long term storage in geologically stable areas is
something that hasn’t been achieved to store the existing waste, let alone waste created in the future.
Modern nuclear power plants are very expensive to build, with the proposed 3.2GWe Sizewell C power plant
expected to cost £20 billion or more [5]. When compared to £0.5 billion for the 0.884GWe Carrington CCGT
Power Station [6], the initial costs are £0.57 billion per GWe for CCGT compared to £6.25 billion per GWe for
Nuclear.
There is an effort around the world of countries aiming to reduce the production of carbon dioxide as a result
of burning fossil fuels. When a power plant is operational, the carbon dioxide produced by nuclear power is
negligible when compared with gas, oil and coal power plants.
Despite its reputation amongst the public, nuclear is much safer than fossil fuels and is on par with renewable
energies. The pollution caused by fossil fuels affects us all and is responsible for many deaths each year, causing
more misery than nuclear power ever has (fig. 1.4). Coal and oil are responsible for 350 and 260 times as many
deaths as nuclear, respectively.
As a species, we have used combustion of chemicals to generate heat for thousands of years, culminating in
high efficiency CCGT power stations, with efficiencies above 60%. We are at the beginning of our journey with
nuclear power, with many new and innovative designs proposed, where safety to plant workers and the general
public are a priority.
Future designs may help to tackle the problematic waste generated in the past, and by using fertile material to
produce fissionable elements other than

1.3.2

235
92 𝑈 ,

the amount of fuel available to reactors will increase.

Planned and Under Construction in the UK

Several sites have been acquired with the aim of building new nuclear power stations in the UK. There are five
sites and three reactor designs[8]:

6

CHAPTER 1. INTRODUCTION

1.3. AN APPROACHING ENERGY GAP FOR THE UK

Figure 1.4: Safest and cleanest sources of energy [7] - deaths per terawatt hour and tonnes of CO2 per gigawatt
hour

• Hinkley Point: two Areva EPRs (EDF Energy), Hinkley Point C under construction
• Sizewell: two Areva EPRs (EDF Energy)
• Wylfa: 2-3 Hitachi ABWRs (Horizon Nuclear Power)
• Oldbury: 2-3 Hitachi ABWRs (Horizon Nuclear Power)
• Sellafield: 3 Westinghouse AP1000s (NuGeneration) . . .
Two Gen III+ reactors are under construction in the UK: Hinkley Point C 1 and C 2. These reactors are Areva
NP designed Gen III+ EPRs, which are PWRs, and the proposed opening years are 2025 and 2026 respectively.
There are also plans to construct a third plant at Sizewell that, if accepted, will be an EPR reactor. Sizewell C
will join the decommissioned Sizewell A and operational Sizewell B, that may operate until 2055.

1.3.3

Proposed Generation III+ Nuclear Power Plant Designs

Areva EPR
The 1.6GW Areva EPR design has four primary loops transferring heat by pressurised water from the reactor
to heat exchangers. It requires U enriched to 5%

235
92 𝑈

in the form of U Oxide Pellets. The inlet temperature

is 568.75𝐾 and the outlet temperature is 602.95𝐾.
There are 241 fuels assemblies, each containing 265 fuel rods giving a total of 63865 rods. The fuel rod cladding
is made from 316 stainless steel and has an inner diameter of 7.72mm and an outer diameter of 9.68mm. The
materials used to construct the control rod drive mechanisms includes 410 stainless steel and 304 stainless steel.
There are two EPR reactors planned for the proposed Sizewell C power plant and they will be designed to
produce a combined power output of 3.2 GWe. The government has authorised planning consent for the power
station and hopefully construction will start within the next couple of years.

7

1.3. AN APPROACHING ENERGY GAP FOR THE UK

CHAPTER 1. INTRODUCTION

Westinghouse AP1000
The 1.1GW Westinghouse AP1000 design is a pressurised water reactor with two primary loops transferring
heat from the reactors to heat exchangers. An enriched 𝑈 𝑂2 fuel, up to 5%

235
92 𝑈 ,

is clad in Zirlo (a proprietary

Zr alloy).
Zirlo is an alternative cladding material to 316 stainless steel, and as a cladding material is absorbs fewer
neutrons that steel cladding.
Property

316SS Fe 20Cr 8Ni 1Mo

Bulk Modulus (GPa)
Shear Modulus (GPa)
Young’s Modulus (GPa)
Poisson’s Ratio

164.9 [9]
74.6 [9]
194.3 [9]
0.30 [9]

Zirlo (Hill Approximaton)
98.5
33.2
89.7
0.35

[10]
[10]
[10]
[10]

Table 1.1: Bulk, shear, Young’s modulus comparison: Zirlo and austenitic stainless steel

The inlet temperature is 552.55𝐾 and the outlet temperature is 597.85𝐾 which is close to the temperature
range of the EPR. The composition of the control rod absorber material includes 304 stainless steel.

1.3.4

Generation IV

Goals of Generation IV Reactors
The GenIV International Forum has put forward four main goals for this next generation of nuclear power[11]:
• sustainability
• safety and reliability
• economics
• proliferation resistance and physical protection
The selection of known materials, and the development of new materials, will play a key part in all four of these
goals.
Carnot’s Theorem
Whatever the motivation, whether it is to increase profits or to supply energy at greater amounts and for less
cost to the consumer, increasing the efficiency of usefully using energy is critical. Solar panels are continually
being improved to edge closer to their theoretical limit and wind turbines are being constructed larger and with
more advanced materials to extract as much energy from the wind as possible.
In the same way, power plants that use heat are constantly being developed to improve efficiency. In the
nineteenth century Carnot showed that the maximum possible efficiency of a heat engine is determined by the
difference in temperature between the heat reservoirs.[12]

𝜂𝑚𝑎𝑥 = 1 −

8

𝑇𝑐
𝑇ℎ

(1.1)

CHAPTER 1. INTRODUCTION

1.3. AN APPROACHING ENERGY GAP FOR THE UK

To increase maximum efficiency, the temperature difference should be increased, and this leads to higher temperature reactors. There will be a trade off between the increased temperature, the ability of the materials
to withstand the temperature, health and safety considerations, the lifetime of components, the effect on the
coolant and more.
The first generation of reactors in the UK were the gas cooled Magnox reactors. With core temperatures
of approximately 620𝐾[13], the thermodynamic efficiency was relatively poor. This was limited by the 𝑀 𝑔𝑂
cladding, which was in turn selected due to the fuel. Combined cycle gas turbines have much higher temperatures
within their turbines, and the temperature of the steam within the secondary steam turbine can reach 850𝐾[14],
significantly higher than in a Magnox reactor.
The second generation of power plants, particularly in the UK, included the advanced gas reactor that used
𝐶𝑂2 as a coolant. This reactor design increased temperatures to over 870𝐾, and thus the maximum possible
thermodynamic efficiency was increased.
Several Gen IV reactors have designed operating temperatures that exceed those of the AGR, and this brings
a new set of challenges to overcome.
Fast Reactors
Examples of thermal neutron reactors include Magnox, AGR, LWR and Candu reactors. These reactors contain
moderators, designed to slow neutrons, decreasing their energy to thermal temperatures and leveraging the large
neutron fission cross section of
but thermal neutrons and

235
92 𝑈

235
92 𝑈 .

The cross section for fast neutrons and

235
92 𝑈

is in the region of 1 barn,

have a fission cross section of over 1,000 barns.

Figure 1.5: Typical reactor flux - thermal and fast spectra

Natural U contains 0.7%

235
92 𝑈

and 99.3%

238
92 𝑈 [15].

The thermal fission cross section for

238
92 𝑈

is small for

thermal neutrons, and can be measured in the microbarn to millibarn range, but it has a much higher fission
cross section with fast neutrons with a cross section closer to 1 barn for neutrons with an energy of 1MeV or
more. The neutron flux in a fast reactor is spread over a higher energy band than that of a thermal neutron
reactor (fig. 1.5).
Fast neutron reactors have been tested and used since the 1950s, and there are several Gen IV reactor designs
238
92 𝑈
239
94 𝑃 𝑢

based on this approach. Given the much larger percentage of

in natural U, Fast Neutron Reactors have

a larger stockpile of fuel. They also breed fissile isotopes,

and

241
94 𝑃 𝑢.

This has its advantages and

disadvantages. The advantage is clear, as it produces fissile fuel as it runs, but the creation of fissile materials
is a concern as these isotopes could be used in nuclear weapons.

9

1.3. AN APPROACHING ENERGY GAP FOR THE UK

CHAPTER 1. INTRODUCTION

Lead-cooled Fast Reactors
Light elements such as the hydrogen in water molecules, or carbon in a graphite stack, allow neutrons to
efficiently lose energy. When neutrons scatter inelastically with heavier elements, such as lead, they lose a much
smaller percentage of their energy (figure 1.6).
The Lead-Cooled Fast Reactor (LFR) uses lead as the coolant. Lead has a low reaction cross section and,
because of its mass relative to a neutron, the kinetic energy lost in collisions is low, keeping more neutrons in
the fast energy group. As the coolant is a liquid, and the boiling point of lead is over 1, 970𝐾, the system will
run at atmospheric pressures and any problems associated with void formation due to boiling is removed. The
molten lead will act as a gamma shield and it will be chemically less reactive than the coolant in a Sodium-Cooled
Fast Reactor (SFR) or Supercritical-Water-Cooled Reactor (SCWR).
There are several disadvantages to using lead as a coolant. The melting point of lead is 600𝐾, so the reactor
would need to be heated first for the coolant to become a liquid. This also restricts the lowest temperature and
thus the maximum efficiency possible that may be extracted from the system without the coolant forming a
solid. The density of lead also poses a problem for the structure needed to support the reactor.

Neutron Inelastic Scattering
Target
Hydrogen
Deutrium
Carbon
Oxygen
Iron
Lead
Uranium

100

Percentage Energy Lost

80

60

40

20

0
0

1

2

3

4

Scattering Angle (Radians)

5

6

Figure 1.6: Inelastic scattering - scattering angle vs energy loss for a range of target atoms

European Lead Fast Reactor (ELSY) is a 600MWe Lead-Bismuth eutectic cooled fast neutron reactor. It has a
lower melting point than lead, but there are concerns for the transmutation of Bismuth to Polonium. The 9,000
tonne molten lead coolant and the high flux of fast neutrons[16] will be challenging conditions to overcome.
VHTR
Traditional nuclear power plants, as well as coal and the secondary cycle of CCGT plants, boil water to drive
turbines. Very-High-Temperature Reactor (VHTR) designs use thermal neutrons and a fissile fuels. Designs
plan to have outlet temperatures of up to 1, 270𝐾[17]. With a helium coolant, there are several options.
• directly drive turbines
• heat water to create steam and drive turbines
10

CHAPTER 1. INTRODUCTION

1.3. AN APPROACHING ENERGY GAP FOR THE UK

Figure 1.7: Energy demand to produce hydrogen by electrolysis as temperature changes

• use the high temperature to help create hydrogen, and combine with steam driven turbine
Hydrogen may be extracted from high temperature water either by a thermo-chemical, high temperature electrolysis or a hybrid process[18]. Each process benefits from the very high temperatures provided by the predicted
outlet temperatures (fig 1.7).
The Pebble-Bed Reactor (PBR) is a type of VHTR where spherical fuel pellets are held in a hopper shaped
reactor. Temperatures within the core may reach 1, 770𝐾, and this will pose a challenge for materials scientists.
GFR
The Gas-Cooled Fast Reactor (GFR) design is similar to the VHTR, but rather than use thermal neutrons, it
will use fast neutrons. The design will use a ceramic core and have outlet temperatures up to 1120𝐾. This
will give similar options to the VHTR where high temperatures would be used to assist in the production of
hydrogen, or it would be used to power a turbine with a secondary steam powered circuit similar to that of a
CCGT.
There are challenges ahead, including the development and testing of advanced materials that can withstand
these temperatures while under high energy neutron flux. However, unlike LFRs, SFRs and SCWRs, the coolant
is chemically inert and isn’t transmuted by neutrons removing the risk of the coolant becoming radioactive.
SFR
Memories of small amounts of sodium, kept under oil in school chemistry labs, being carefully cut and prepared
ahead of a violent reaction with water, probably come to mind at the first mention of an Sodium-Cooled Fast
Reactor (SFR). It may not be the first choice of an element to use as a coolant, but it does have advantages.
In fact Admiral Rickover once remarked “if the oceans were filled with liquid sodium, then some crazy scientist
would want to build a water-cooled reactor” when the idea of a sodium cooled reactor in a submarine was
proposed[19].
Sodium has a low melting point, of just under 370𝐾, and a boiling point of 1, 150𝐾. With an operating
temperature of up to 820𝐾, the reactor would be able to run at atmospheric pressure and without the issues
associated with the coolant boiling. The density of Na is 0.971𝑔𝑐𝑚−3 and comparing this to the LFR the coolant
would be 12 times less dense and this would have advantages when designing the structure.
There have been several SFRs built and operated using this technology, such as the Russian BN-600 reactor.
This particular reactor has a sodium primary loop which heats a secondary sodium loop which in turn heats a
third loop for water and steam.
11

1.3. AN APPROACHING ENERGY GAP FOR THE UK

CHAPTER 1. INTRODUCTION

Figure 1.8: Phases of water: pressure vs temperature

SCWR
At 647K and a pressure of 22.1MPa (approximately 218 atmospheres), water becomes supercritical (fig. 1.8) and
at this point it is neither a liquid or a gas[20]. The current generation PWR and BWR operate at approximately
501 − 598𝐾 at 15.2MPa[8] and 551 − 560𝐾 at 7.1MPa[21] respectively.
Supercritical water exists above 647𝐾 and 22.1MPa, and in this state water has a higher thermodynamic
efficiency. The design of the nuclear power plant is also simplified as there is no phase change of the water,
so a condenser is not needed. The Supercritical-Water-Cooled Reactor (SCWR) is the only Gen IV reactor
design that uses water as the coolant[4]. The economic benefits have already been seen in SCW fossil fuel power
stations, and it is incorporated in Gen IV water cooled fast and thermal reactors.
There are side effects to using supercritical water. It is an oxidant and is now being considered to “burn” organic
waste in future waste processing plants. The combination of supercritical water chemistry and irradiation
damage must be considered, as well as higher temperature and pressure, when considering the materials used
by a SCWR.
Molten Salt Reactor
MSRs have been operated for over 50 years. Chemically, salts are very stable, and this has obvious safety
benefits over reactors like the SFR. The coolants are fluoride salts that have high boiling points which gives
the added safety protection of being able to operate at atmospheric pressure, unlike a PWR where a pressure
vessel is needed.
The fuel is dissolved into the molten salt. There are no solid fuel rods to place into the core, remove or reprocess.
The molten salt is processed on the site to remove poisons, waste and add new fuel.
MSRs may use either thermal or fast neutrons and a range of fuels including Th. This is particularly interesting
as Th is three times as abundant as U and would increase the fuel available to us for the clean production of
electricity by nuclear power.
A safety feature that takes advantage of the fuel being dissolved in the molten salt are large drain tanks under
the reactor. A plug is designed to melt if it reaches a certain temperature and this would quickly drain the
molten salt from the reactor into large and cold drainage tanks. The reactivity would drop and the fuel would
cool reverting it to a solid salt.
Salts considered in various designs are chlorides, nitrates and fluorides. Corrosion of the reactor due to the
molten salts is a concern. Elements that provide protection to corrosion, such as Cr, are prone to dissolution
into the molten salt[22]. Where the fuel is suspended in the molten salt as Tristructural Isotropic (TRISO) fuel
particles, formation of chromium-carbide precipitates may be an issue.
12

CHAPTER 1. INTRODUCTION

1.4. DAMAGE TO NUCLEAR CORE COMPONENTS BY NEUTRONS

Experimental Fusion Reactors
Nuclear Fusion is a very attractive technology and could be the answer to all of our energy problems. Much
work is being invested in developing this technology and the International Thermonuclear Experimental Reactor
(ITER) has been designed to output more energy than is required to start the fusion reaction. The process of
fusion combines two isotopes of hydrogen and creating helium, fast neutrons (eq. 1.2) and an excess of energy.
As neutrons have no charge, they can penetrate shielding causing damage as they lose energy through nuclear
interactions. Any atoms they interact with have a chance to capture the neutron and become unstable.

1𝐷

2

+1 𝑇 3 →2 𝐻𝑒4 (3.5𝑀 𝑒𝑉 ) +0 𝑛2 (14.1𝑀 𝑒𝑉 )

(1.2)

The fast neutron spectrum for fission reactors ranges from a few eV to a few MeV, whereas the neutrons in a
fusion reaction have 2-3 times more energy than the most energetic neutrons from fast fission. Engineers must
develop materials to construct components that will be resilient to this damage, while having a low reaction
cross section and being able to withstand other extreme conditions within the reactor.
Unfortunately, nuclear fusion as a commercial method of creating energy, is often said to be 30 years away, and
this has been the case for some time now. It is a lot to ask, recreating a process that occurs within a star, in a
safe and steady manner. Once this problem is solved, it could mark a turning point for human civilization.

1.4

Damage to Nuclear Core Components by Neutrons

Radiation damage in a reactor is caused by several projectiles. Fission fragments are heavy, contain charged
particles and lose energy close to their source. Gamma rays excite electrons, promoting them to higher energy
levels, or ionise the atoms where there is enough energy to eject electrons completely from atoms. They do not
have the momentum to knock atoms out of place. Fast neutrons, however, may impart a great deal of momentum
to a target atom and, as they are neutral, travel much further into a material than fission fragments. With
enough energy, neutrons cause large damage cascades within the material.
One fuel source for many of the Gen III+ and Gen IV reactors is
The neutron(s) released by the fission of

235
92 𝑈

235
92 𝑈 ,

whether as enriched U or otherwise.

atoms have a spectra of energy (fig. 1.9) which may roughly be

split into four categories: cold (below 0.025eV), thermal (0.025eV), slow and intermediate (above 0.025eV and
below 1MeV) and fast (1MeV and above).
0.4

Fission Spectrum thermal induced fission

0.35

0.3

n(E)

0.25

0.2

0.15

0.1

0.05

0
0

5 106

1 107

1.5 107

2 107

2.5 107

Energy (eV)

Figure 1.9: Neutron energy spectrum from fission[23]

Thermal and slow/intermediate neutrons cause damage in their own particular way, as they are captured by
and transmute the atoms within the target material. Fast neutrons have enough energy to create a great deal
13

1.5. RADIATION DAMAGE: REPLACING NEUTRONS WITH PROTONS

CHAPTER 1. INTRODUCTION

of damage, whereby they transfer kinetic energy to an atom in the material that become the primary knock-on
atom (PKA) in a cascade of atoms through the material. Neutrons can travel deep into a material, creating many
damage cascades through the material until they lose enough energy or pass through the material completely.

Figure 1.10: PKA energy as a funtion of neutron energy in Fe[24]

The intensity of neutron energies from the fission of 235
92 𝑈 peaks around 1MeV (fig. 1.9). The energy transferred
to PKAs will vary depending on the mass of the target nucleus and scattering angle but, in Fe at least, 1MeV
neutrons will create the majority of its Fe PKAs with energies ranging from 1keV to 100keV (fig. 1.10).

1.5

Radiation Damage: Replacing Neutrons with Protons

It is difficult to generate large fluxes of neutrons. When we pick up a cup, press keys on a keyboard, they react
because of the electromagnetic force. Neutrons have no net charge, so they cannot be controlled in a similar
way. Nuclear reactors are the most common way to create large fluxes of neutrons.
This an expensive method, and one that make be inconvenient as the sample being tested would need to be
placed inside a reactor. Rather than do this, ions may be used to replicate the damage cause by neutrons, but
in a more controlled and accessible way.
A major side effect from the process of nuclear fission is the creation of both radioactive fission fragments and
radioactive isotopes within the components and structural material of the reactor. Low energy protons are
not captured as low energy neutrons would be, due to the opposing electromagnetic force between the proton
and nucleus of the target atom. Once the proton energies exceed a few MeV, they have sufficient energy to
transmute target nuclei.
By virtue of detailed reaction cross section data files and decay data, the amount of radioactivity induced by
both protons and neutrons may be calculated. This will assist in the selection of proton beam parameters to
replicate irradiation damage, to the required DPA, whilst keeping the radioactivity at a safe level.

1.6

Simulation Material Damage

Irradiating and testing materials irradiated by both neutrons and protons have a number of drawbacks, including
expensive facilities and the creation of radioactive waste. Simulations may be used to help understand the
processes on a mesoscopic scale and make predictions on how the material in question may behave inside a
reactor under certain specified conditions.
14

CHAPTER 1. INTRODUCTION

1.6. SIMULATION MATERIAL DAMAGE

(a) 5KeV Fe PKA damage cascade in Fe

(b) 10KeV Fe PKA damage cascade in Fe

(c) 20KeV Fe PKA damage cascade in Fe

(d) 20KeV Fe PKA damage cascade in Fe

Figure 1.11: Damage cascades in Fe for a range of energies.

Part of this work focuses on the damage of stainless steel by neutrons. The damage process occurs on time scales
and sizes too small to capture experimentally and play back to study. The theories may not be sufficiently well
understood, or are often unsolvable with current techniques. Modelling helps bridge the gap between theory
and experiment.

1.6.1

Molecular Dynamics

Molecular dynamics models have been used to simulate radiation damage. Damage cascades caused by primary
knock-on atom (PKA)s with energies of 10, 20 and 50KeV have been modelled in BCC W[25], whilst cascades
caused by PKAs of 5, 10 and 20KeV have been simulated in BCC Fe[26].
Neutrons have a long mean path before interacting with a target when compared to ions. It would be impossible
with current and foreseable technology to simulate a neutron travelling through a material because the volume
of the material, and the number of atoms and interactions between atoms, would be so large. Rather than
attempt this, it is more productive to focus on individual damage cascades caused by PKAs in order to conserve
computing resources.
Molecular Dynamics simulations require interatomic potentials to govern how the atoms in the simulation
interact with one another. Typical simulation sizes range from thousands of atoms to millions of atoms.
Fe has a density of approximately 8.5 × 10−2 atoms per cubic angstrom, and this leads to simulation sizes

between almost one million atoms and fifty million atoms for cascades with PKAs ranging from 5KeV to 50KeV
(fig 1.11, table 1.2).
The interatomic potentials used to simulate a damage cascade must be able to model the very close separations
during the collisions event. For very close separations, an exponential potential such as the Ziegler-BiersackLittmark (ZBL) potential may be used, and for other separations a standard potential such as the embeddedatom method (EAM) may be used, in particular for metals.

15

1.6. SIMULATION MATERIAL DAMAGE

CHAPTER 1. INTRODUCTION

PKA Energy (KeV)

Volume (𝐴𝑛𝑔 3 )

5
10
20
50

6

1.0 × 10
6.0 × 106
8.0 × 106
6.4 × 107

Atoms
9.0 × 105
5.4 × 106
6.9 × 106
5.5 × 107

Table 1.2: Approximate simulation sizes by PKA energy

There have been attempts to create potentials based on Physics, but the nuances are still poorly understood
and there aren’t any models that can be applied accurately to any material type under any set of circumstances.
A number of recent interatomic potentials, including a selection of transition metals, have been fit to match the
experimental data rather than the underlying physics.

1.6.2

Density Functional Theory

In quantum mechanics, the Schrödinger equation and the wavefunction of a system describes all that can be
known about that quantum system. Unfortunately, it is very difficult to compute when there are just several
electrons in the system. Many atoms in a system makes this an impossible task with current technology.
Density Functional Theory (DFT) replaces the many electron wavefunction with a single electron wavefunction.
Rather that use the positions of all the electrons, which would result in 3𝑛 parameters, the charge density, which
varies in space with just 3 parameters, is used.
DFT allows for the calculation of the forces between atoms and the energy of that collection of atoms by
replacing the many parameters to give the coordinates of many electrons with the three coordinates for the
charge density. From the forces the optimum (relaxed) basis vector and atom positions may be computed, and
from the energy of multiple configurations other properties are computable (bulk modulus, elastic constants,
etc).
It is important to note that DFT is an exact method for ground state calculations, although in practice approximations do need to be made in order to solve problems.

1.6.3

Interatomic Potentials for Molecular Dynamics

Interatomic potentials help to describe the interaction between atoms. Originally they were used for pairs of
atoms and a collection of atoms on a pair by pair basis, but in the 1980s the complexity of potentials increased
as they started to include the effects of the background electron density that the atoms are embedded in. This
lead to the Finnis-Sinclair (FS) and embedded-atom method (EAM) type potentials.
Whilst DFT is a purer form of computational materials science, more closely linked to physics, it is computationally intensive and suitable for small systems of hundreds to thousands of atoms. By using interatomic
potentials to recreate the forces and energies that would be computed by DFT, the systems may be increased
in size to thousands to millions of atoms, and these calculations may be run over a time frame with hundreds
or thousands of time steps.
There are a wide range of potentials, and these are typically selected based on the type of material and the
required accuracy. Simple pair potentials may still be used, but angularly dependent potentials have been
developed for materials with covalent bonds, and metals use FS and EAM potentials. The potentials are made
up of a set of functions, and these functions change from derivation to derivation.

16

Chapter 2

Consequences of Ionizing Radiation
Ionizing radiation takes on a number of forms and may be damaging to both materials and organic
life. The various radiations interact differently with matter and cause damage in different ways.
Radiation may interact directly with matter. In the case of materials this could mean creating
a damage cascade that displaces atoms from their lattice sites. For organic life, this might mean
the damage of strands of DNA leading to the death of a cell or problems when the cell tries to
replicate. Radiation may also change the environment and an example of this is the radiolysis of
water. This change in water chemistry can affect both materials and organic life.
The amount of damage components in a reactor must withstand are measured in terms of displacements per atom. Dose to organic life, in particular humans, is measured in a variety of units
including Gy, Si and REM. Determining the amount of dose in each case can be a complicated
process, but it is needed to ensure safety of workers and correct testing of materials.

2.1
2.1.1

Radiation Types Relevant to This Work
Introduction

There are three types of radiation that are useful to discuss in this work: neutrons, ions and gammas, and two
of these (neutrons and protons) are of particular interest in this work. Each of these are capable of ionizing the
atoms they interact with, given sufficient energy. Higher energy and momentum radiation it is able to directly
damage materials or the DNA structure of organic life that it interacts with. Lower momentum ionizing radiation
may change the water chemistry of the environment or within the cells of organic lifeforms that is detrimental
to life.

2.1.2

Protons and other Ions

Charged particles interact with matter through the Coulomb interaction. As a charged particle passes through
matter, it may interact with both the nucleus and electrons of an atom. A sufficiently energetic ion may lose
kinetic energy to electrons by either raising the electrons to higher energy levels in their atoms, or by removing
electrons from atoms altogether, causing the ionization of those atoms.
Ions may also lose kinetic energy to the nucleus of an atom through elastic scattering and, where the atom is in
a crystal structure, through knocking atoms in the material out of their lattice positions. Inelastic scattering is
also a possibility, leaving the target nucleus in an excited state.
17

2.1. RADIATION TYPES RELEVANT TO THIS WORK

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

Knock on atoms and electrons with enough kinetic energy that have been removed from atoms (delta rays),
continue the irradiation of the material whilst they have the kinetic energy available to do so.
A large proportion of the energy of a charged projectile is lost to the electrons of the target material. There is
a chance, depending on the energy and type of charged projectile (and the cross section of the target nucleus),
that the charged particle will overcome the coulomb potential and be captured by the nucleus.
This may result in a stable nucleus or an unstable nucleus. If it is unstable, there is a probability that it will
decay releasing energy in the form of photons, nucleons or electrons. The initial ion irradiation creates sources
of further radiation within the target material.

2.1.3

Neutrons

Neutrons interact with matter differently to that of protons, ions and other atoms, as the neutron has no overall
charge. Neutrons do have a magnetic moment and experience a weak interaction with unpaired electrons by
a dipole-dipole interaction. Neutrons also interact with the nucleus of atoms, and this is dependant upon the
target atom and the energy of the projectile neutron. The energy of neutrons may be grouped as shown in table
2.1, and as mentioned earlier, thermal neutrons are of interest to current reactor designs, and fast neutrons are
of interest to several future designs.
Name

Energy Range

Velocity/ms-1

Wavelength Ang

Cold
Thermal
Epithermal
Cadmium
Epicadmium
Slow
Resonance
Intermediate
Fast
Relativistic

0-0.025 eV
0.025 eV
0.025-0.4 eV
0.4-0.6 eV
0.6-1.0 eV
1-10 eV
10-300 eV
300 eV - 1 MeV
1-20 MeV
> 20 MeV

0.0 - 2.2 × 103
2.2 × 103
2.2 × 103 - 8.8 × 103
8.8 × 103 - 1.1 × 104
1.1 × 104 - 1.4 × 104
1.4 × 104 - 4.4 × 104
4.4 × 104 - 2.4 × 105
2.4 × 105
1.4 × 107 - 6.1 × 107
> 6.1 × 107

> 1.8
1.8
0.5-1.8
0.4-0.5
0.3-0.4
0.09-0.3
0.02-0.09
2.9 × 10−4 - 0.02
6.5 × 10−5 - 2.9 × 10−4
< 6.5 × 10−5

Table 2.1: Neutron Categories by Energy Range [27]

The nuclear force holds nuclei together by exchanging pions and the types of interactions are shown in figure
2.1. It is 137 times stronger than the electromagnetic force, but because of the mass of the pion (approximately
130-140MeV) it only acts over a short range of approximately 1fm. The nuclear force is attractive but has a
short-range repulsive core.
For nuclear reaction and damage calculations, the interaction of neutrons with matter is represented by a cross
section (section 4.4.3). Cross sections are used to calculate the probability of a certain interaction occurring
and are dependent upon the target nucleus, how much of the material the pass through and the energy of the
neutron.
The attenuation of neutron radiation is therefore a complicated process. A much larger thickness of shielding is
required to stop neutrons, or at least bring them to thermal temperatures. Not only this, but the thermalized
neutrons must then be captured. During this process various isotopes within the attenuating shielding will have
been transmuted, possibly into radioactive isotopes. As a rough estimate if a certain amoint of material will
attenuate neutrons to 10% their original flux, then the same amount of material will reduce the flux further to
1%. This is however an over simplification and computer codes such as Monte Carlo N-Particle (MCNP) and
TART more accurately model the transport of neutrons through materials.

18

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

𝑝

𝑝

𝑝

𝑝

Π0

𝑝

2.1. RADIATION TYPES RELEVANT TO THIS WORK

𝑛

𝑛

Π0

Π0

𝑝

𝑛

𝑛

𝑛

(c) Direct interaction n-n[28]

(b) Direct interaction p-n[28]

(a) Direct interaction p-p[28]

𝑛

𝑝

𝑝

𝑛

Π+

𝑛

𝑛

Π−

𝑝

𝑝

(d) Exchange interaction n-p[28]

𝑛

(e) Exchange interaction p-n[28]

Figure 2.1: Proton and neutron interactions

2.1.4

High Energy Photons

The electromagnetic spectrum classifies photons based on their energy and/or source, but visible light, x-rays,
gamma rays and so on are all the same elementary “particle”. During the early years of Quantum Mechanics,
the relationship between the energy and wavelength of a photon was discovered: the Planck-Einstein relation
(eq. 2.1).

𝐸 = ℎ𝑓

(2.1)

Pair Production
The energy of photons in the database used for this work ranges from 1keV up to almost 10MeV. There are
several ways high energy photons will interact with the atoms of a target material. The rest mass of an electron
is 511keV. If the photon energy is greater than 1.02MeV, i.e. there is at least enough energy to create an
electron and positron, there is a chance that the photon will create an electron-proton pair.

ℎ𝑓 = (𝑚𝑒 + 𝑚𝑝 )𝑐2 + 𝑇𝑒 + 𝑇𝑝

(2.2)

The creation conserves energy and mass, with excess energy carried away as the kintetic energy of the particle
pair. The charge before the creation is zero, as the photon is neutral, and the charge after is also zero, with the
-1 of the electron and +1 of the positron cancelling out. Angular momentum is also conserved; the photon is a
spin 1 Boson and, as electrons and positrons are Leptons they have half integer spin, adding up to 1. Finally,
momentum is not conserved in a vacuum, and this is why pair production occurs in the coulomb field of a
nucleus. The nucleus carries away excess momentum, fulfilling this conservation law (fig. 2.2).

19

2.1. RADIATION TYPES RELEVANT TO THIS WORK

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

𝑒−
𝛾

𝑒+

𝑍

𝑍

Figure 2.2: Pair production Feynman diagram

Compton Scattering
An incident photon with enough energy may interact with the electron of an atom, and if it transfers enough
kinetic energy it will eject the electron from the atom (fig. 2.3). A lower energy photon is also created that
carries away the remainder of the energy, but also linear momentum, as both energy and momentum must be
conserved.
𝛾

𝛾

𝑒−

𝑒−

Figure 2.3: Compton Scattering Feynman diagram

Photoelectric Effect
Photons of sufficient energy interact with and eject electrons from the surface of a metal (fig. 2.4). At lower
energies, the photons have no effect on the electrons. Ejected electrons have a maximum kinetic energy equal
to the difference between the energy of the interacting photon and the workfunction, 𝑇𝑚𝑎𝑥 = ℎ𝜈 − 𝜑.
𝑒−
1

𝛾

𝑍𝑛+ , 𝑒−
𝑛

𝑍𝑛+ , 𝑒−
𝑛−1

Figure 2.4: Photoelectric Effect Feynman diagram

20

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION
2.2. MICROSCOPIC AND MACROSCOPIC CROSS SECTIONS

Coherent Scattering
Lower energy, non-ionizing photons, have insufficient energy to eject electrons (fig. 2.5). Coherent scattering
is the interaction in which photons change direction, scattering, without losing energy. This is also known as
Rayleigh scattering.
𝛾

𝛾

𝑍+

𝑍+

Figure 2.5: Coherent Scattering Feynman diagram

Gamma Attenuation
Whilst an infinite amount of material is required to reduce the intensity of gammas to zero, they may be
reduced by a significant amount with dense material. Lead, Uranium and other high density elements with a
large number of electrons per unit volume are ideal.

𝐼(𝜇/𝜌(𝐸), 𝑡) = 𝐼0 𝑒𝑥𝑝

(︂

−𝜇
(𝐸)𝜌𝑡
𝜌

)︂

(2.3)

The attenuation is dependent upon the thickness of the material , with a thicker material reducing the intensity
of the gammas (eq. 2.3[29]). It is also dependent upon the mass attenuation coefficients that are in turn
dependent upon the photon energy. A table of attenuation coefficients are available for each element[30].

2.2

Microscopic and Macroscopic Cross Sections

As discussed above there are a range of different ways in which matter interacts. The probability that a certain
interaction will happen, which may be a function of the target, projectile and projectile energy, is described with
the microscopic cross section. The total microscopic cross section is computed by summing all the individual
reaction channels (eq. 2.6)

(2.4)

𝜎𝑡𝑜𝑡𝑎𝑙 = 𝜎𝑒𝑙𝑎𝑠𝑡𝑖𝑐 + 𝜎𝑖𝑛𝑒𝑙𝑎𝑠𝑡𝑖𝑐 + 𝜎𝑎𝑏𝑠𝑜𝑟𝑝𝑡𝑖𝑜𝑛 + 𝜎𝑓 𝑖𝑠𝑠𝑖𝑜𝑛 + . . .

The cross section has units of area and is measured in barns. When this area is multiplied by the target thickness
and number density of the target, the fraction of projectiles that will react in this way is computed (see section
4.4.2).
Multiplying the microscopic cross sections by the number density defines the macroscopic cross section, whether
it be for an individual reaction type or the sum of them all. This has units of atoms per meter and taking the
inverse gives the mean free path of the projectile in the target material.

Σ𝑡𝑜𝑡𝑎𝑙 = 𝑁𝑑 × 𝜎𝑡𝑜𝑡𝑎𝑙

𝜆=

(2.5)

21

1
Σ

(2.6)

2.3. QUANTIFYING RADIATION AND ITS EFFECTS

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

The probabilities and associated libraries of a neutron, proton, deuteron and so on transmuting a target atom
are discussed in more detail in section 4.4.3.

2.3

Quantifying Radiation and its Effects

The reason for attributing a value to a radiation source is usually because we want to quantify it and link that
value to the effects it will have on materials, equipment and, most importantly, people. There are a number
ways of quantifying radiation, an associated number of different units as well as many other factors that affect
how concerned we should be about a particular source.
Parameters most obvious to quantify radiation are the rate at which the particles are being created as well as
the duration the equipment, material or person is exposed to that radiation.
The energy of the particles will determine the type of damage it is able to do. We are regularly exposed to
visible light with several hundred watts or more per square meter courtesy of the Sun. The same power from a
1-2MeV gamma source would require far fewer photons, with a million visible light photons for every gamma,
but the affect wouldn’t be a gentle warming as it would be for sunlight, but a fatal dose of radiation.
How far the radiation is able to travel is another factor as a certain dose may be received very close to the
source, but reduced due to both spherical degradation and attenuation at a distance further away. This is
particularly relevant for charged particle radiation such as alphas and betas.
The material, component or part of the body radiation passes through will also determine its effect. Some parts
of the body are more sensitive to radiation that others.
Radioactivity, the number of decays per second, is measured in either Becquerel, Curie or Rutherford. The
Curie was based on the radioactivity of Radon-226, but for the most of this work, the unit of choice will be
Becquerel.
Fluence (𝜑) is the measure of the total number of particles passing through an area (eq. 2.7). Whilst this is
typically defined as the amount passing through a spherical area, the proton radiation that concerns this work
is directional and it will be the planar fluence[31]. The fluence rate is a measure of how many particles pass
through a sphere (or plane where planar) per second.

𝑑𝜑
𝜑 = 𝑁/𝐴 𝜑˙ =
𝑑𝑡

(2.7)

Absorbed dose is the amount of energy absorbed by a unit mass. This will be the sum of the fluence and
energies of each individual particle and will depend upon the proportion of that energy deposited in the target.
It is measured in the SI unit Gray although a historical unit is Rad, which is equal to 1 centigray.

𝐷𝑒𝑞𝑢𝑖𝑣𝑎𝑙𝑒𝑛𝑡 = 𝑊𝑟 × 𝐷𝑎𝑏𝑠𝑜𝑟𝑏𝑒𝑑
𝐷𝑒𝑞𝑢𝑖𝑣𝑎𝑙𝑒𝑛𝑡 = 𝑊𝑟 × 𝑊𝑡 × 𝐷𝑎𝑏𝑠𝑜𝑟𝑏𝑒𝑑

(2.8)

Both the type of radiation and the type of tissue determine how much of an impact that radiation has per unit
energy per unit mass. Both the equivalent and effective (eq. 2.8) dose are measured in the Si unit Sievert, and
historically they have been measured in Rontgen Equivalent Man where the base unit is cGy rather than Gy.

22

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

2.4

2.4. EFFECTS OF RADIATION ON ORGANICS

Effects of Radiation on Organics

In this work the primary types of radiation considered in this work are neutrons, protons and gammas. The
materials damage will be predominantly due to neutrons, protons and cascade atoms. Damage to humans will
be primarily due to gamma rays.
It is assumed the process causing the material damage is screened from humans and that this radiation will
no longer be present when the proton or neutron irradiated targets are being handled. It is also assumed that
betas and alphas will also be screened during handling with the main source of irradiation that poses a threat
to humans being gammas. For this reason more focus will be given to the effect of gammas on humans.

2.4.1

Reference Levels of Radiation

Although a sievert is only one joule per kg, because of the nature of the damage caused by ionising radiation,
safe levels are measured in millisieverts per year. The annual upper limit for the general public is just 1 mSv
per year. A dose of just 5 Sieverts is enough to kill 50% of people within 1 month (table 2.2).
Exposure

Dose (mSv)

Dental X-ray
Chest X-ray
UK average annual dose limit for the public
UK average annual dose (background)
Whole bodt CT scan
Nuclear industry employee annual exposure limit
Acute radiation effects
50% lethal dose within 60 dyas
50% lethal dose within 1 month
100% lethal dose within 2 weeks
100% lethal dose within 3 days

0.005
0.02
1.0
2.7
10
20
1,000
2,500-5,000
5,000
10,000
50,000

Table 2.2: Irradiation dose comparison in mSv[32][33]

The regulations on ionising radiation[34] also specify limits per square centimetre on skin, where the total dose
might be within the annual limit but when concentrated in a small region it could cause damage to that region.
Certain parts of the body also have limits applied, such as the lens of the eye.

2.4.2

Levels of Radioactivity from Neutron Irradiated Components

In work by Rodenas and Verdu a MCNP5 simulated neutron flux environment and a thermal flux of 2.5 ×
107 𝑛/𝑐𝑚2 𝑠 a stainless steel cylinder (20mm diameter and 70mm depth) was irradiated for 10 hours[35]. The

sample was composed of 65% Fe, 19% Cr, 2.0% Mn, 1.0% Si by weight as well are small amounts of C, Ti, P
and S. After 10 minutes cooling, it was calculated to have an activity of over 1.0 × 107 Bq and, by several orders
of magnitude, it was predominantly due to the creation of

56
25 𝑀 𝑛.

55
25 𝑀 𝑛

(n, 𝛾)

56
25 𝑀 𝑛

just over 2.0 × 10 . As the half life of

56
25 𝑀 𝑛

is short compared to the irradiation time (a half life of 2.5 hours)

The maximum cross section of
6

the creation rate of Mn

56

is 2.0 barns and the estimated reaction rate at this flux is

and decay rate equalise, saturating the sample with this isotope.

A simple neutron activation code was developed and the predicted

56
25 𝑀 𝑛

activity vs time was calculated. The

overall gamma dose, for 1 minute of exposure to an 80kg person standing 2m from the source was also calculated.

23

2.4. EFFECTS OF RADIATION ON ORGANICS

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

Figure 2.6: High Flux Isotope Reactor Neutron Flux

The calculated activity for

56
25 𝑀 𝑛

was less than that predicted by Rodenas and Verdu [35], but it was within

an order of magnitude. It predicts a total activity after cooling of 2.3 × 106 Bq with almost 90% of this due to

56
25 𝑀 𝑛.

The flux in the within the flux trap of the HFIR is much higher, with high energy neutrons having a flux of
1.014 neutrons per cm squared per second (fig. 2.6). A second calculation was performed for this increased flux,
also irradiated over 10 hours. The total activity increased from 2.3 × 106 Bq to 7.1 × 1012 Bq and the overall

dose per minute was much higher, between 40 and 50 milligrey per minute over the first hour of cooling. These
are dangerous levels of radiation.
Damage to Organics by Radiation

Life evolved on Earth from single cell to multicelled organisms such as humans. Prokaryotic cells are single
celled organisms that do not have a nucleus, an example being bacteria. Our cells are eukarytic cells, and these
have a nucleus that contains the genetic information. Millions of cells die in our body every second, and our
body replaces these by replicating living cells. During the replication stage, the DNA within the nucleus is
copied.
DNA is a polymer that is carefully constructed from six components. Stretched out, it is approximately 2m
in length and approximately 25 angstrom wide, and it is neatly contained within the cell nucleus which is on
average just 6 microns across. The structure of DNA is the well known double helix. The sides of the helix are
made from alternating sugars and phosphates, while the “rungs” of the ladder like structure are pairs of either
thymine and adenine or cytosine and guanine. These pairs are covalently bonded to the sugar-phosphate sides,
and by hydrogen bonds to each other.
Mitosis is the part of the cell cycle where the DNA within the nucleus is replicated and the cell splits into two.
There are repair mechanisms, but if the DNA is beyond repair, the cell may die through apoptosis, or it may
replicate in an uncontrolled way leading to cancer.
Direct damage is caused when ionising radiation alters or destroys sections of DNA through a direct collision,
for example a neutron colliding with and knocking out an atom in the DNA strand.

24

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

2.5. DAMAGE CASCADES IN METALS

Our cells are predominantly water, so there is a higher probability of the radiation colliding with water molecules
than DNA directly. The chemistry of the contents of the cell is changed, for example by the creation of free
radicals, and these lead to damage of DNA as an indirect result of radiation passing through the cell.

Attenuation constant (sqcm/g)

Gamma Attenuation in Soft Tissue
Photon attenuation
Photon absorption
100

10−1

10−2

10−1

100

Gamma Energ (MeV)

101

Figure 2.7: Dependency of absorption and attenuation of photons in soft tissue as a function of photon energy

How gamma rays interact with tissue is highly dependent upon the energy of the photons, as shown in figure
2.7. This damage caused by radiation results in either deterministic effects or stochastic effects.
Where there’s a minor exposure to radiation, the damage caused to cells and DNA may lead to cancer later in
life, or it may cause issues that are inherited from the irradiated person. These are stochastic effects as there
is a chance they could happen, but it is not a certainty.
Deterministic effects are due to larger doses where cells are severely damaged. There’s much less chance involved
and the effects will be reproduced if multiple people are exposed. Up to a certain dose, there is still a chance
that a person would survive, but the point where the chance of death is 50% is the LD50, and for radiation the
dose is 5Sv (table 2.2).
The body relies heavily on three types of blood cell: erythrocytes (red cells), leukocytes (white cells) and
thrombocytes (platelets). These are produced from stem cells within bone marrow and in the course of a day
billions are replaced in the body. Large doses of radiation destroy the cells quicker than they can be produced
and this leads to death.
The lens of the eye is very sensitive to radiation and cataracts can be created by gamma rays. Radiation
can also cause damage to the gut including removal of the lining, bleeding and death. These are examples of
deterministic effects.
Whilst it is difficult to predict the effects of radiation, particularly for stochastic effects where the effect is
heavily dependent on chance, this work on calculating activity of proton irradiated targets aims to give the user
a predicted activity and dose value with associated assumptions and caveats. It is then down to the user to
apply the resulting data to the situation and evaluate any health consequences.

2.5

Damage Cascades in Metals

When a metal is damaged by radiation, there are microscopic defects created and removed in a very short space
of time. The result of many months or years of damage is complex and will be discussed in more detail in
chapter 3.
25

2.5. DAMAGE CASCADES IN METALS

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

Element

Cohesive Energy/eV

Aluminium
Iron
Palladium
Platinum
Zirconium

-3.36
-4.32
-3.91
-5.77
-6.32

Table 2.3: Cohesive Energies [36]

Figure 2.8: Interstitials in the cascades of 10keV, 20keV and 40keV PKA displacement cascades [38]

The cohesive energy of atoms are measured in eV (table. 2.3), whereas the energy of incoming neutrons or
fission fragments are measured in MeV and PKAs having energies in the keV range. Radiation in the form of
electrons, protons and heavy ions will lose energy to electrons in the target as they pass through. They may also
lose energy to atoms within the lattice, knocking that atom out of place and creating a PKA. Due to its neutral
charge and magnetic moment, neutrons have a very weak interaction with charged particles. They primarily
lose energy directly with the nucleus of atoms within the target, also creating a PKA.
Projectile

Mean Recoil Energy

1 MeV Electrons
1 MeV protons
1 MeV heavy ions
1 MeV neutrons

60eV
200eV
5keV
35keV

Table 2.4: Average recoil energy of Nickel PKAs[37]

The PKAs create a damage cascade, and their mean recoil energy is dependent upon the energy and type of
radiation. After each cascade, there will be a period of time where the material quenches, with a recombination
of some interstitials and vacancies. The PKA creation and cascade thermal spike cover a time range of 10−18 s
to 10−13 s, with the quenching phase lasting in the region of 10−11 s. However, the cumulative effect of radiation
damage on a component within a reactor core may only become apparent after months or years.
The immediate aftermath of interstitials created three damage cascades is shown in fig. 2.8[38]. Damage
26

CHAPTER 2. CONSEQUENCES OF IONIZING RADIATION

2.5. DAMAGE CASCADES IN METALS

cascades have been the subject of a number of studies and due to their short time scale and complexity,
involving thousands to millions of atoms, are studied with computer simulations.

27

Chapter 3

Austenitic Steels in Nuclear Power
Austenitic stainless steels have played an important role in the nuclear industry. They have a good
resistance to corrosion and behave well at moderately high temperatures, having a good resistance to
creep. They have been used within the primary circuit and secondary circuit of power stations, as
cladding for fuel pellets, in the steam dryers, pre-heater tubing, core structurals, primary piping and
more. Ferritic steel is magnetic and has a BCC structure, whereas austenitic steel is non-magnetic
with a FCC structure, with its high Nickel content stabilising this phase. An area of concern is the
susceptibility of austenitic stainless steels to IGSCC.

3.1
3.1.1

Stainless Steel
Introduction

Stainless steel is a relatively new material, having first been developed and refined from the 1800s to the early
1900s, then being defined as a steel with at least 10.5% Cr in 1911. The addition of Cr to this level causes the
formation of a passive protective layer of chromium oxide.
Fe is alloyed with Cr, Ni and C in varying quantities to make Stainless Steel. Depending on the application,
other elements, such as Mo, may be added to enhance the properties of the steel.

3.1.2

Grades of Stainless Steel

While the criteria that qualifies an alloy as Stainless Steel is containing Fe, C and at least 10.5% Cr, there are
many grades that have a variety of properties and atomic structures. The composition influences the structure
and other properties such as resistance to corrosion, yield strength, creep resistance and whether the steel is
magnetic or not.
Both Fe and Cr are BCC at standard temperatures and pressures, but adding austenite stabilisers such as Ni,
Mn or C, the structure of the steel can be altered from BCC to FCC. Balancing the proportion of these elements
changes the phase of the steel, and this may be represented as a Schaeffler diagram (fig. 3.1) or a ternary phase
diagram (fig. 3.2).
Ferritic Stainless Steel
At room temperatures and pressures, Fe exists in the alpha phase, which is a BCC crystal. It is energetically
favourable for the magnetic moments of the Fe atoms to align with one another ferromagnetically. Ferritic
28

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

Figure 3.1: Steel Cr-Ni Schaeffler Diagram

3.1. STAINLESS STEEL

Figure 3.2: Iron-Chromium-Nickel Phase Diagram[39]

Figure 3.3: BCC structure of ferritic stainless steel

stainless steels also have the natural alpha phase crystal structure of pure Fe at room temperature which is
BCC (fig 3.3). These steels are magnetic and may be hardened by cold working. They are less corrosion resistant
than austenitic stainless steels. Two common examples of this grade of steel are American Society of Engineers
codes 405 and 430.
Austenitic Stainless Steel

Figure 3.4: FCC structure of austenitic stainless steel

Austenite is a FCC allotrope of Fe (fig 3.4), and austenitic stainless steels are useful in many applications,
including a structural material for nuclear plant components, due to their resistance to corrosion. In addition
to 10.5 wt% or more Cr they require an austenite stabilising element to be added.
Two examples of such steels are ASME codes 304 and 316. Both have a high Cr content, in the region of

29

3.2. USE IN REACTORS

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

18-20%, which is in excess of the minimum passive film requirement of around 10-11%. The natural structure
of such an Fe-Cr alloy would be BCC, however 304 and 316 Steels contain Ni (approximately 8% and 10%
respectively) which stabilises the austenite phase and is responsible for the FCC structure of the steel. The 316
grade contains a minimum of 2% Mo to improve its resistance to corrosion.
Ferritic and martensitic have a better resistance to thermal or swelling shock than austenitic [40], but the
corrosion resistance of austenitic steels is a deciding factor when choosing a steel for an application where
corrosion resistance is important.
Martensitic Stainless Steel
Martensitic stainless steels have a FCC structure at high temperature, but when heat treated take on a BCC
structure. This allows martensitic, unlike austenitic and ferritic, to be hardened by heat treatment. These
steels are magnetic, they contain more than 10.5% Cr but have a much lower Ni than austenitic grades, if any.
They are corrosion resistant, but the corrosion resistance of austenitic steel is typically better. Two examples
of such steels are ASME codes 410 and 431. A comparison of properties between common grades of each steel
are detailed in table 3.1.
Grade
Austenitic
Austenitic
Ferritic
Ferritic
Duplex
Martensitic
Martensitic

Code
304
316
405
430
255
410
420

HRB
80
79
75
85
32
90
95

Proof strength (MPa)
230
240
250
280
550
205
345

UTS (MPa)
540-750
530-680
400-600
450-600
750-1000
600
700

Density (𝑘𝑔𝑚3 )
7900
8000
7700
7700
7800
7700
7700

E (GPa)
200
200
220
220
200
215
215

Table 3.1: Common grades of ferritic, austenitic, duplex and martensitic stainless steel and their properties. Hardness
using the HRB, ultimate tensile strength (UTS) and Young’s modulus E.

3.2
3.2.1

Austenitic Steels in Nuclear Reactors
The Use of Austenintic Steels in Reactors

Due to their excellent strength and corrosion resistance, austenitic steels have been widely used in nuclear
reactors. The cheaper to manufacture 304SS and more corrosion resistant 316SS have been particularly popular
choices of steel. There are drawbacks, when compared to other alloys including ferritic and martensitic steels,
and two in particular are IGSCC and swelling.

3.2.2

Atom Damage Cascades

Fission fragments carry away the majority of the energy released during fission, with an approximate energy of
170MeV per 235U fission event. The fragments are large and have a highly charged positive nucleus that stops
rapidly due to the Coulomb interaction with the nuclei of surrounding atoms. Electrons released by beta decay
travel a greater distance; they lose energy by interacting with electrons, but may also knock atoms out of place.
Neutrons travel further still and lose energy by interacting directly with the nuclei of the surrounding material.
When an incoming projectile hits an atom, the primary knock-on atom (PKA), it is knocked out of its place
and loses energy by colliding with other atoms and to the electrons in the metal. Depending on the energy of
the PKA, this causes a damage cascade. Atoms knocked out of their regular position in the crystal lattice leave
30

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

3.2. USE IN REACTORS

vacancies behind. The displaced atoms either recombine with vacancies, become interstitial atoms or diffuse to
defect sinks.
The damage event has four main phases over a short period of time[41]:
• PKA creation ( 10−18 𝑠)
• cascade and thermal spike ( 10−13 𝑠)
• quench ( 10−11 𝑠)
• annealing and defect migration ( 10−9 𝑠)
These individual damage events happen over a very small time length, but a number of complex problems arise
as a result of this damage over time. This can take many years and high damage doses to manifest.

3.2.3

Damage Rates

The safety of a Nuclear reactor is the primary concern; it must generate power, but it must be safe. It must
also be cost efficient. Gen II PWR fuel assembles were expected to withstand several DPA[42]. In BWRs the
materials are designed to be irradiated by a total fluence of 1022 𝑛𝑐𝑚−2 , experiencing approximately 7 DPA over
the lifetime of the components[43]. Components in PWRs are irradiated by up to a total fluence of 1023 𝑛𝑐𝑚−2 ,
and are expected to operate up to an irradiation dose of 70 DPA[43]. To remain cost efficient, components
in Gen IV reactors will be expected to operate safely up to even higher doses or irradiation damage (fig 3.5).
Components in sodium-cooled fast reactors will be expected to withstand up to 200 DPA over their lifetime to
meet the requirements of cost effectiveness and durability[42].

Figure 3.5: Expected DPA during component life time and operating temperatures[42]

Neutrons released during the fission of

235
92 𝑈

range from 0 to 14 MeV (fig 1.9), and the energy transferred to a

target atom depends on the scattering angle of the neutron and the mass of the target nucleus.

𝑚𝑁 − 1 2
)
𝑚𝑁 + 1
(︂
)︂
(1 + 𝛼) + (1 − 𝛼)𝑐𝑜𝑠𝜃𝐶
= 𝐸𝑛 1 −
2
𝛼=(

𝐸𝑁

31

(3.1)

3.2. USE IN REACTORS

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

Energy Transfer: 1MeV Neutrons

Energy Transfer: 1MeV Neutrons Fe Target

0.07

1.0

Maximum Energy Transfer (MeV)

Energy Transfer (MeV)

0.06
0.05
0.04
0.03
0.02

0.8

0.6

0.4

0.2

0.01
0.0

0.00
−3

−2

−1
0
1
Scattering Angle (Radians)

2

0

3

Figure 3.6: Scattering angle probability of neutrons

50

100

150

Target Mass (amu)

200

250

Figure 3.7: Energy transfer as a from a neutron dependant
on target mass

In a collision, the amount of energy transferred to a target atom will depend on both the scattering angle of
neutron recoiling from the target and the mass of the target nucleus. If the neutron does not change direction,
a small amount of energy will be transferred, but if it bounces back at 180 degrees it will transfer the maximum
amount of energy. A neutron will lose more energy per collision with light atoms (hydrogen, helium, carbon),
but much less energy per collision with larger atoms (iron, molybdenum, lead).
The energy of Fe PKAs as a result of neutron irradiation has been calculated for an Fe target[24] (fig. 1.10),
and those created by 1MeV neutrons may have an energy up to 100keV. As nuclear reactions are also possible
between the neutrons and the target nuclei, there is an inelastic (𝑛, 𝑛)56 𝐹 𝑒 channel as well as other elastic
scattering channels where the post collision particles are different to the pre collision particles (fig. 3.8).

32

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

3.2. USE IN REACTORS

Figure 3.8: Recoil energies for neutrons at 102keV, 1.02MeV, 10.1MeV and 14.1MeV[24]

3.2.4

Swelling

Swelling results from damage to the crystalline structure of the metal, and is formed through small voids being
created in the crystal. As vacancies are created by radiation damage, they precipitate into small voids. The
temperature range for such swelling is primarily from 670𝐾 to 870𝐾.
Materials have been known to swell to a 100% increase in their original volume at these intermediate temperatures under irradiation[44]. Swelling is sensitive to the total damage amount, the temperature and composition
of the alloy. An increase in Ni decreases swelling as does the addition of Zr. Small amounts of P and Mo (0.02%
and 0.5-1.0% respectively) cause the swelling of the alloy to increase, however higher concentrations of either
cause swelling to decrease[45].
As a component swells its properties change. By definition the volume changes, but so does the elastic moduli.
Not only this, but the swollen component may stress itself and surrounding components, and this may lead to
SCC.
In the EBR-II structural 304SS was irradiated to 20DPA. At a temperature of approximately 650𝐾 the steel’s
volume increased by 2% due to swelling[46]. With components in future reactors expected to withstand ten times
this damage, swelling is a concern. However, increased temperatures and a careful balance in the composition
of future alloys will help to reduce this.

33

3.2. USE IN REACTORS

3.2.5

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

Radiation Induced Segregation

The diffusion of atoms within an alloy has an impact on the characteristics of the metal [47]. When radiation
causes point defects, these interstitials also diffuse parallel to thermal solute diffusion. At low temperatures,
the atoms are unable to diffuse at an appreciable rate; the mobility of vacancies are low[37] and there are an
excess of vacancies due to radiation damage, and this leads to recombination of defects. At high temperatures,
there is a higher concentration of thermal defects[43]. This increases the defect recombination rate and reduces
migration of defects to sinks, such as grain boundaries.
The melting temperature range of 304 and 316 stainless steel are approximatelyh 1695-1722K and 1644-1672K
respectively. Gen II reactors, such as Sizewell B, have an operating temperature of several hundred degrees
centigrade. The inlet temperature for the Sizewell B PWR reactor is 566K[48] and the outlet temperature
is 597K[48]. Operating at approximately 35% the melting point of the steel this is, unfortunately, a good
temperature for radiation induced segregation (RIS) to occur.
The Kirkendall effect (KE) concerns the diffusion of one material into another and vice versa at an interface. In
the original experiment performed by Kirkendall and Smigelskas, brass (Cu and Zn) was sandwiched between
Cu and left at a temperature of over 1050K for almost two months. Using Mo as a marker, it was discovered
that Zn diffused out of the brass faster than the Cu diffused into the brass. The flux of atoms results in a flux
of defects into and a shrink in volume of the brass[49].
The inverse Kirkendall effect (IKE) is driven by an external force, such as irradiation. Irradiation of the material
causes a flux of defects and, inverse to the KE, this causes a flux of atoms. For an austenitic stainless steel the
diffusion coefficients in order of size are 𝐷𝐶𝑟 > 𝐷𝐹 𝑒 > 𝐷𝑁 𝑖 [50], so Cr will diffuse away from grain boundaries
and other sinks, followed by Fe. As Ni is slowest to diffuse, this will be enriched. An additional mechanism that
is thought to contribute to RIS is interstitial flux where undersized atoms as interstitials are preferential[50].

Figure 3.9: Depletion of cr, fe and enrichment of ni at
the surface[51]

Figure 3.10: Concentration profile after 46DPA irradiation with 75 keV Ni ions[52]

Experimental work by Johnston et al irradiated steel, containing 15% Cr and 20% Ni, with 4MeV Ni ions. It
was irradiated to a damage dose of 8DPA at 950𝐾. Some material will have been sputtered from the surface,
but in the remaining material Cr, and Fe, were depleted. Ni, however, was enriched (fig. 3.9).
In work by Marwick a similar alloy with 14% Cr and 15% Ni was irradiated to a much higher dose of 46 DPA
with lower energy 75KeV Ni ions. In this instance the damage occurs in a much thinner layer of the surface that
was approximately 30nm thick (fig. 3.10). Conversely to Johnston et al, in this thin layer there is a depletion
of Ni and an enrichment of Cr in the first 20nm or so. However, between approximately 25nm and 60nm there
is a similar depletion of Fe and Cr as well as an enrichment of Ni.
The underlying mechanisms of RIS are dependent on both the temperature (relative to the melting point of the
34

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

3.3. CORROSION RESISTANCE

Figure 3.11: Temperature and DPA dependence of RIS[53]

material) and the amount of damage (fig. 3.11). The result of RIS is a breakdown in the passive protection of
Cr, which leads to IGSCC under the correct conditions.

3.3
3.3.1

Corrosion Resistance of Austenitic Stainless Steels
Passive Film Protection of Chromium

The addition of Cr improves the resistance of stainless steel to corrosion by orders of magnitude. A very thin
passive oxide layer, 20-30 angstroms in width, forms when the surface is exposed to an environment containing
O. The protective layer is self repairing and as such, if the surface is damaged, the oxide layer reforms in the
presence of O.
When the steel is in an environment containing O, electrons within the metal tunnel through the surface. As an
oxidizing agent, the nearby O atoms readily accept the electrons. A strong electric field forms between positive
ions within in the metal and the negatively charged O atoms [54].
Fe at the surface of the forming oxide layer is preferentially dissolved away over Cr [55] and Cr ions within the
oxide layer have a lower mobility than Fe ions [56]. Ni remains in place within the alloy, and this leads to an
enrichment of chromium oxide in the passive layer. Once the layer is thick enough to reduce the electric field
across it, the formation of the layer stops. As mentioned previously, this is at a layer thickness of 2-3nm for
stainless steel.
The Cr2 O3 layer may be formed by heating the steel to 770𝐾[57]. However, at higher temperatures, the steel
begins to lose its protective layer due to sensitization.

3.3.2

Sensitization and Passive Film Removal

Steel by definition is Fe alloyed with varying small percentages of C. C changes the property of the alloy, and
one example of this is an increase in hardness over pure Fe. At elevated temperatures, 670K to 1020K, the
35

3.4. IASCC

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

Figure 3.12: Formation of chromium precipitates at the
grain boundary [58]
Figure 3.13: Sensitization of an alloy: chromium carbide precipitation [59]

added Cr within the steel forms precipitates of Fe-Cr carbides (FeCr)23 𝐶6 at the grain boundaries, reducing the
percentage of Cr at the grain boundary and removing the layer of passive protection.
The sensitization of the steel can be reversed. By heating the steel further, to approximately 1,320K to 1,420K,
the steel is solution annealed dissolving the carbides back into the steel.

3.3.3

Addition of Molybdenum

A common austenitic stainless steel is 304SS and this relies heavily on the passive film due to a high content of
Cr, ranging from 17.5% to 20% for grades 304, 304L and 304H. A similar stainless steel, 316, has slightly less
Cr, slightly more Ni and 2-3% Mo, an element not present in 304 stainless steel.
Pure Mo has a BCC crystal structure, and it is a ferrite former. However, high proportions of austenite former
such as Ni and N force 316 stainless steel to keep its FCC structure despite the addition of Mo. Adding it to
austenitic steels improves their strength and resistance to creep at high temperatures.
Steels such as 316SS are known to have better corrosion resistance in chloride rich environments. Where at least
2% Mo has been added it improves resistance to pitting and crevice corrosion resistance[60]. The mechanism
by which Mo helps to protect against corrosion is still unclear. It is possible the addition helps to reduce the
breakdown of the passive film protecting the steel, but it may also be the case that Mo promotes the repair of
the passive film [61].

3.4

Irradiation Assisted Stress Corrosion Cracking

Damage due to irradiation was first identified in high stress stainless steel components in a reactor, such as bolts,
springs, and fuel elements[62][63], and later being found in lower stress austenitic stainless steel components[63].
Irradiation of water causes the radiolysis of water, changing the chemistry of water and creating hydrogen,
radicals and other ions that increase the corrosiveness of the environment (fig 3.14). The radiation also damages
the material directly, changing its properties. A form of IASCC to which high nickel alloys, including austenitic
steels, are particularly susceptible to is inter granular stress corrosion cracking.

36

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

3.5. IGSCC

Figure 3.14: Changing water chemistry: radiolysis of water[64]

3.5

Inter Granular Stress Corrosion Cracking

Stress corrosion cracking may be trans granular (through the grains) or inter granular, at the grain boundary.
IGSCC is a particularly prominent failure mechanism for austenitic stainless steels. For IGSCC to occur, there
must be a material that is susceptible to this form of cracking, an environment that is corrosive to the material
as well as stress (fig. 3.15).
Stress may come from a high pressure environment or residual stresses due to welding. In a nuclear reactor
the atomic structure may be under stress due to damage caused by neutrons passing through the steel, or due
to the swelling of the steel on the macroscopic scale. If Cr is depleted at the grain boundary, protection to
corrosion due to the passive layer is lost. This, coupled with the knowledge that austenitic stainless steels are
susceptible to IGSCC, completes the three requirements and, over time, components of this material in these
conditions will eventually fail to IGSCC.
IGSCC has not only been a defect in stainless steel. High Ni content alloys, such as Alloy 600 (Inconel: Ni-72,
Cr-17, Fe-10), have been known to suffer from IGSCC since the very early days of nuclear energy, in particular
with the prototype S1W reactor, prototype for the first nuclear powered submarine, the USS Nautilus.
After the war, there was a drive to develop a nuclear powered navy for the US. There are obvious benefits

Susceptable material
e.g. sensitised SS

IGSCC
Stress
Environment
Welds
Corrosive
Swelling
High electro
Pressure
chemical potential
Any applied stress

Figure 3.15: Three requirements for IGSCC to occur

37

3.5. IGSCC

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

Figure 3.16: Inter Granular Stress Corrosion Cracking in Nickel Alloy[65]

Figure 3.18: Nickel, IGSCC and TGSCC

Figure 3.17: Alloy choices for early LWRs

in replacing conventional power in vessels with nuclear, in particular for submarines. This was pushed by
Admiral Rickover and the route to building the USS Nautilus began. A number of available Fe-Cr-Ni alloys
were considered for the construction of the reactor (fig. 3.17).
Prototypes developed for the USS Nautilus experienced stress corrosion cracking in the Inconel Alloy 600
components. H. Coriou replicated this damage to Inconel in the laboratory, holding a sample at 620𝐾 in
deoxygenated water for 3 months[65]. Further studies showed that IGSCC became a particular issue to alloys
with a high Ni content in pure water, commencing with a content of approximately 70% Ni. In a weak salt
water solution (0.1% NaCl) IGSCC occurred as with the same alloy in pure water, but TGSCC occurred in
similar alloys with a low Ni content (less that 15%) (fig. 3.18).

3.5.1

IGSCC in Light Water Reactors

In LWRs a major factor in corrosion of components is the water chemistry and electrochemical corrosion
potential that they operate in. Higher levels of oxygen dissolved in the water leads to an increase in the
corrosion potential[44]. Other factors within LWRs include depletion of Cr due to either heat treatment,
welding or irradiation.
The primary circuit of a BWR includes components such as a reactor pressure vessel, piping that leads out of
the containment building, fuel and fuel assembly. 300 series steels, including 304 and 316, are used within the
primary circuit, including the piping and control cod absorbers. In BWRs the purity of the water has been
addressed, and the addition of hydrogen to the water has reduced cracking of components[65].
Higher nickel content steels such as the 600 series alloys are used in PWRs, and components that are made
from these alloys include steam generators and pressure vessels. In the AP-1000 design, the control rod drive
mechanism at the reactor coolant pressure boundary are made from 304, 304L, 304LN, 316, 316L and 316LN

38

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

3.6. SS IN GEN III+ AND GEN IV

steel. Higher nickel content 690 is used for penetration into the pressure vessel[66]. As illustrated by Coriou’s
work in the 1950s and 1960s, higher nickel content steels are susceptible to stress corrosion cracking.

3.5.2

IGSCC and Advanced Gas-cooled Reactors

A major drawback of the first generation Magnox reactors was their relatively low operating temperature of
630𝐾. Carnot’s theorem shows that the maximum amount of energy from an engine is dependent on the
difference between the hot and cold reservoirs (section 1.3.4). The ambient temperature of the power station
will vary a small amount with the seasons. The practical way to improve the maximum possible efficiency is to
increase the engine (reactor) temperature.
AGRs were designed to run at much higher temperatures of 920𝐾. By increasing the temperature, the maximum
possible thermal efficiency was increased from just over 50 percent to almost 70 percent. To withstand higher
temperatures, the magnesium oxide cladding used in the earlier Magnox reactors was replaced with stainless
steel. To counteract the higher neutron absorption cross section of the cladding, the fuel was enriched up to
3.5% U235 .
The cladding holds the fuel elements together and at the required location inside the reactor whilst it is consumed
in the reactor. The cladding also performs several functions once the fuel has been spent. It holds the fuel
elements together and acts as a primary containment for the spent fuel[67].
During its lifetime as a fuel element within the reactor, the cladding has been heated and irradiated. By the
process of RIS the Cr at the grain boundary can drop to 10% concentration[68]. The C rich environment within
the reactor, due to the CO2 coolant, provides yet another mechanism to deplete Cr at the grain boundary by
the formation of Fe-Cr carbides (FeCr)23 𝐶6 ).
This loss of protection at the grain boundary, stress due to the role of the component within the reactor, the
changing environment due to radiation damage and the material’s susceptibility lead to IGSCC.

3.6

Austenitic Stainless Steels in Gen III+ and Gen IV Reactors

The AP1000 is an advanced PWR. As a Westinghouse reactor, the fuel cladding will be their trademarked
Zirlo alloy. Inconel will be used for the steam generator and heat exchanger with carbon steel used for the
construction of the pressure vessel. The control rod absobers, however, will be constructed from 304SS[69].
Areva designed the EPR and this will use 316SS as the fuel cladding material. It will also use the slightly less
corrosion resistant 304SS (forged) in parts of the control rod drive mechanisms[70].
The perforated upper core plate, between the reactor core and the inlet/outlet/control rod mechanisms, is also
made from austenitic stainless steel. The pressuriser is constructed from ferritic steel, but its internals are clad
with austenitic stainless steel to protect the structure from the coolant.
Gen IV designs also include the use of austenitic stainless steels. Experimental fast reactors in many countries, including the US, UK, Japan, France, India and China have used either 304SS, 316SS or both in their
construction.
Austenitic steels are more corrosion resistant than ferritic or martensitic steels. They do expand more as a
result of being irradiated, but they are stronger at higher temperatures. Many of the Gen IV reactors operate
at much higher temperatures than existing reactors and the components will be expected to resist higher doses
of radiation damage throughout their lifetime.
GFRs are expected to use austenitic steels. Due to their chemical compatibility with sodium they are also
expected to be used in SFRs. As well as being used in the reactor core, these steels will also be used outside the

39

3.7. ADDITION OF PGMS

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

Figure 3.19: Addition of Ru to Fe30Cr and Fe40Cr steels - open current corrosion potential variation with time in 10%
sulphuric acid[73]

core. For example, SFRs in France will use austenitic steels in the secondary circuit, primary pump, internal
heat exchanger and more[71].

3.7

The Addition of PGMs to Stainless Steel

Water purity is a concern for light water reactors. The fewer contaminants there are to begin with, the better.
Even so, the radiolysis of the purest water will still create a steady supply of corrosive molecules (fig. 3.14).
Adding hydrogen to the water reduces the electrochemical corrosion potential of the water, but if too much is
added it will combine with the radioactive nitrogen-16 created by the 16 𝑂(𝑛, 𝑝)16 𝑁 reaction to form 16 𝑁 𝐻3 [72].
Cathodic modification is a technique used to improve corrosion resistance, and one way to do this for stainless
steel is to add small amounts of platinum group metal (PGM)s[73]. By adding such metals, the anodic reaction
may be reduced. PGMs also act as a catalyst in the reduction and removal of 𝑂2 and 𝐻2 𝑂2 from the water[72].
The increased corrosion resistance is dependant upon the amount of PGM added, but a higher percentage does
not necessarily mean better protection. This is important for two reasons, to find the optimum amount for the
sake of corrosion resistance, and to keep the price down as the additions are so expensive, even in such small
amounts.
It was found that an addition of 0.15% Ru (out of a selection of 0%, 0.05%, 0.10%, 0.15% and 0.20%) was
optimum for both Fe30Cr and Fe40Cr steel (fig. 3.19)[73]. Other PGMs may be used for cathodic modification,
including Pd, Ir and Pt, but the cost of the metal must be weighed against the possible gains.
Connolly et al recently added Ru and Pd to 304SS samples that were sensitized at 920K for 24 hours[1]. After
sensitization, the steel was analysed by TEM and Cr-rich carbides were found at grain boundaries. Without
the passive protection due to Cr, the samples were exposed to polythionic acid to promote SCC. The Ru doped
steels performed well, but the Pd doped steels showed no improvement over regular 304SS. Further analysis
of the samples by TEM reveals that the low percentage of Mn in the steel allows the formation of Pd-Mn

40

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

3.7. ADDITION OF PGMS

Figure 3.20: Failure times for 304SS, Pd doped 304SS (with and without Mn) and Ru doped
304SS in polythionic acid at ambient temperature[1]

precipitates at the grain boundary[1]. These precipitates form during the sensitization procedure and thus
negate the protection by cathodic modification at the surface of the metal by removing the Pd.
With a low Mn 304SS (less than 0.05% Mn), varied amounts of Pd have been tested. With the reduction in Mn
the corrosion resistance improves greatly over regular 304SS. Palladium remains at the surface, as the amount
of Mn is too low for appreciable amounts of Pd to be lost to precipitate formation during sensitization. No
failures have been observed with either the Ru or Pd (low Mn) samples for 330 hours exposure to polythionic
acid at ambient temperatures (fig. 3.20) [1].
The surface of the metal does not need to have a full coating of PGM but it should be equally spaced across
the surface. Oxidant in the layer at the surface will be consumed at the locations of PGMs and the change in
concentration at those points will naturally cause diffusion of more oxidant to those locations[72].
The PGMs may be coated on the surface of the metal or alloyed to the metal. The first method is the more
cost efficient but if a crack does form, or if a layer is removed, it will expose the regular alloy underneath. If the
PGM is alloyed, there will always be protection, unless a mechanism is removing the PGM from the surface.
This could be through precipitation as a carbide, or it could be due to radiation causing the metals to segregate.
Reaction

Product Halflife

𝐶𝑟(𝑛, 𝛾)55 𝐶𝑟
𝑁 𝑖(𝑛, 𝛾)65 𝑁 𝑖
55
𝑀 𝑛(𝑛, 𝛾)55 𝑀 𝑛
104
𝑅𝑢(𝑛, 𝛾)105 𝑅𝑢
108
𝑃 𝑑(𝑛, 𝛾)109 𝑃 𝑑
196
𝑃 𝑡(𝑛, 𝛾)197 𝑃 𝑡

3.5 mins
2.5 hrs
2.6 hrs
4.4 hrs
13.7 hrs
19.9 hrs

54

64

Table 3.2: Radioactive products and their half lives for PGM doped 304SS

Adding elements to metals, even in small amounts, may be problematic as certain elements have high neutron
reaction cross sections and transmute into radioactive isotopes.

55

𝐶𝑟 is a concern for all neutron irradiated

stainless steels, but with a very short half life it quickly cools and becomes less of a concern, with 65 𝑁 𝑖 becoming
41

3.7. ADDITION OF PGMS

CHAPTER 3. AUSTENITIC STEELS IN NUCLEAR POWER

the dominant source of activity after 10 hours. Adding Mn to steel that is in a reactor is known to result in an
increase in activity due to the

55

𝑀 𝑛(𝑛, 𝛾)56 𝑀 𝑛 reaction (section 2.4).

The addition of PGMs alters the activity of the steel following neutron irradiation and with just a 1% addition
there is an increase in activity comparable to that of the 10% Ni transmuted to
that create

105

𝑅𝑢,

109

𝑃 𝑑 and

197

65

𝑁 𝑖. This is due to reactions

𝑃 𝑡 for Ru, Pd and Pt respectively (table 3.2).

With such small additions required for cathodic modification and the short half lives of the radioactive isotopes,
there isn’t a concern due to neutron activation over regular 304SS, and much less of a concern than that of
304SS containing Mn.

42

Chapter 4

Isotope Activation and Radioactive
Decay
Proton sources are more readily available and are less costly than high flux neutron sources. In
terms of particles per second the University of Birmingham cyclotron is able to dose a target with
up to 5.85 × 1014 protons 𝑐𝑚−2 𝑠−1 with the High Flux Isotope Reactor able to generate 2.3 × 1015

neutrons 𝑐𝑚−2 𝑠−1 .

Where proton or deuteron radiation is used to emulate neutron damage, there still exists an accompanying risk from transmuting atoms in the target material to radioactive isotopes. The probability
of a reaction is arrived at using past experimental work and use of the optical model potential. The
data for these reactions exist now as ENDFs.
The Bateman equation for radioactive decay was derived in the early 1900s and may be used to
calculate the activity of an isotope, and a chain of daughter isotopes, at time t. The transport of
ions through a target may be modelled using the ion transport codes TRIM and SRIM.
The Bateman equation is developed further and is coupled with the aforementioned cross section
data and ion transport codes into a new code called Acivity, and this is discussed in chapter 6.

4.1
4.1.1

Ion Sources
LINAC

Since the development of the first linear accelerator (LINAC) in the 1940s, their modern day versions have
become some of the most powerful accelerators in the world. The longest LINAC, Stanford Linear Accelerator
Center, is 3.2km in length and it accelerates electrons and positrons at energies of up to 50GeV. Several LINACs
for protons include the 800MeV LINAC component of the ISIS neutron source in Oxfordshire, and the 800MeV
LINAC used by the Spallation Neutron Source at Oak Ridge National Laboratory.
The accelerator is constructed of several tubes, connected alternately to opposite terminals of a high frequency
alternating current supply. As protons enter the first tube, a negative voltage is applied. As the protons reach
the gap between the first and second tube, the polarity is reversed. The positive charge that is now applied to
the first tube pushes the protons forward as the negative charge on the second tube pulls the protons forward.

43

4.1. ION SOURCES

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

This process is repeated along the length of the accelerator, with the sections increasing in length due to the
increase in velocity of the protons.

4.1.2

Cyclotron

Cyclotrons are reasonably compact and cost effective. The largest current cyclotron, TRI-University Meson
Facility, is located in Canada and is able to output protons with energies over 500MeV. It is relatively large,
weighing 170 tons. There are approximately 350 cyclotrons[74] around the world today.
The University of Birmingham cyclotron is more compact. The protons it accelerates are in the 8-40MeV range
and the projectiles are not just restricted to protons (table 4.1).
Projectile

Energy (MeV)

Maximum Current (micro A)

Projectiles 𝑐𝑚−2 𝑠−1

proton
deuteron
𝐻𝑒2+

8-40
8-40
8-53

60
30
30

5.85 × 1014
2.93 × 1014
2.93 × 1014

Table 4.1: University of Birmingham Cyclotron Ion Beams. The projectiles per area is based on a 0.8cmx0.8cm beam
aperture.

The moderate size, energy range, availability and cost of these Cyclotrons make them ideal candidates for
damaging targets with light ions, rather than neutrons from a neutron source.
The Scanditronix MC40 is an isochronous cyclotron. As the ions are accelerated to higher and higher velocities,
the effects of special relativity become appreciable.
√︃

𝑣 =𝑐 1−

𝐸𝑟𝑒𝑠𝑡 2
𝐸𝑉 2

(4.1)

The cyclotron has two Dees and these are D shaped hollow electrodes. Ions enter at the center of the cyclotron
and are held in the Dees as they are accelerated. The magnetic field is varied to bend the path of the ions from
a circle into a round cornered triangle.

4.1.3

Synchrotron

Two of the most well known accelerators are Synchrotrons: the Large Hadron Collider at Conseil Européen
pour la Recherche Nucléaire, and the now retired Tevatron at Fermilab. These are typically large machines and
there are approximately 70 around the world[75], approximately a fifth the number of Cyclotrons.
Synchrotrons are used for storing high energy particles in a continuous loop, either to generate light through
magnetobremsstrahlung, or for high energy collisions. Cyclotrons are more commonly used for lower energy
(tens of MeV) projectiles, in materials science for damaging materials and for medical use (creating radioactive
isotopes for use in hospitals).

44

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

4.2
4.2.1

4.2. NEUTRON SOURCES

Neutron Sources
High-Flux Neutron Reactors

There are 250 or so research reactors in 55 countries [76], and a number of these are used for materials research.
In the UK, there is only one remaining research reactor, and this is the Neptune pool type reactor at Rolls
Royce[77]. In Cadrache, France, the Jules Horowitz reactor is under construction and this is being built
specifically as a materials testing reactor. It will be crucial in researching new materials for use in upcomming
Gen IV nuclear power stations [76].
High Flux Isotope Reactor, Oak Ridge
The High Flux Isotope Reactor, at the Oak Ridge National Laboratory in America, is an 85MW research reactor
that provides testing space within the reactor as well as a number of neutron beam lines (figure 4.1). The reactor
uses highly enriched Uranium as its fuel source and is scheduled to operate at 100% capacity for 161 days per
year, in cycles of approximately 23 days. A 30cm surround of Beryllium is used to reflect neutrons, and in the
reactor core there is a high flux of thermal neutrons at a rate of 2.3 × 1015 neutrons 𝑐𝑚−2 𝑠−1 [78].

(a) A cross section of the reactor[79]
(b) Neutron flux in the reactor at 85MW[80]
Figure 4.1: High Flux Isotope Reactor

NIST Center for Neutron Research
The National Bureau of Standards Reactor (fig. 4.2) was designed as a research reactor with a power output of
40MW and a neutron flux of approximately 1.0 × 1015 neutrons 𝑐𝑚−2 𝑠−1 . It uses highly enriched Uranium as
fuel and is both moderated and cooled by heavy water.

45

4.2. NEUTRON SOURCES

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

Figure 4.2: NBSR building layout[81]

4.2.2

Spallation

Neutrons result from fission in nuclear reactors, but spallation sources require protons and high mass targets
to generate neutrons. The energy of the protons required is a magnitude greater than that of the Scanditronix
MC-40 Cyclotron at the University of Birmingham, with spallation source accelerators having a range from
500MeV to over 1GeV.
ISIS is a neutron spallation source located in Harwell, Oxford. Protons are accelerated in a LINAC to 0.37c
before being fed into a 163m circumference synchrotron. The protons are then accelerated to 0.84c before being
projected, in bunches, at a tungsten target. The impact with the tungsten releases neutrons[82].
Oak Ridge National Laboratory also has a neutron spallation source, the SNS (figure 4.3). A LINAC accelerates
a negatively charged proton (a hydrogen atom with two electrons) up to just below 0.9c. It is stripped of the
electrons and enters an accumulation ring as a proton. More protons are accumulated until the beam in the
accumulator is diverted at a mercury target. The collision between the mercury target and the protons releases
approximately 20 neutrons per collision, and these neutrons pass through beam lines to the experiments .
The source creates a pulse of neutrons from the 50 ton mercury target 60 times per second. The protons are
accelerated by the LINAC to between 2.5MeV and 1.0GeV and this results in neutrons with energies almost
as high as the proton projectiles. A spectrum of neutron energies is produced with each pulse, although the
neutrons may be moderated at the end of the beam lines to slow the neutrons down.

Figure 4.3: An example of a neutron spallation source where high energy ions collide with heavy atoms[83]

46

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

4.3

4.3. SOURCE REVIEW

Source Review
Source

Cost

Scanditronix MC-40
HFIR[80]
HFIR[80]
HFIR[80]
HFIR[80]
SNS[84]
ISIS spallation source[84]

£1 million

$1.4 billion

Projectile
Proton
Neutron
Thermal Neutron
Fast Neutron
Fast Neutron
Neutron
Neutron

Flux/Current
14

3.7 × 10
3.0 × 1015
Over 2.0 × 1015
2.0 × 1015
1.0 × 1015
Average 1.2 × 1013
Average 4.0 × 1013

Energy
8-40MeV
Full Spectrum
Thermal
> 0.111𝑀 𝑒𝑉
> 0.821𝑀 𝑒𝑉
Full Spectrum
Full Spectrum

Table 4.2: Examples of neutron sources, energies and flux, with the MC-40 as a reference for protons

The compact proton source that is the cyclotron is compared to neutron sources. It is much smaller and cheaper
in comparison and the energy of the projectile may be controlled, whereas a spectrum of energies of neutrons
is produced by reactors and spallation sources. Faster neutrons will cause more damage to materials in Gen IV
reactors giving the cyclotron an advantage, being able to focus in just one energy range. The three mentioned
isotope sources are national facilities that cost much more than a cyclotron. Access is shared between many
researchers whereas a cyclotron, such as the Scanditronix MC-40 at the University of Birmingham may have a
beam dedicated to a particular task.

4.4

Ion Irradiation to Investigate Neutron Damage

Neutrons emitted during the fission of Uranium-235 have an energy spectra in the intermediate to fast range,
with a peak at 1MeV, and a large proportion in the 1MeV to 10MeV range (fig. 4.4). The higher energy
neutrons are more of a concern to this work as higher energy neutrons, on colliding with atoms within the
target material, cause large damage cascades.
As discussed earlier in this chapter, there are a number of methods available to create both high energy neutrons
and ions, but each has its own set of advantages and disadvantages. At the University of Birmingham high
energy ions are created using a cyclotron.

47

4.4. EMULATING NEUTRON DAMAGE

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

Figure 4.4: Neutron Spectra from the Fission of U235[85]

4.4.1

Ion Irradiation at the University of Birmingham

The Scanditronix MC-40 Cyclotron is used at the University of Birmingham to create a beam of protons or
other light ions. The energies of these ions are typically between 10 MeV and 60 MeV with beam currents
ranging up to 50 microamps (3.1x1014 protons per second). Target materials are irradiated by this cyclotron for
a number of reasons, including purposely creating radioactive isotopes for the nearby Queen Elizabeth Hospital,
investigating ion irradiation damage and emulating neutron irradiation.
The Cyclotron is usually used to create radioactive isotopes for medical use, but an additional beam line
has been devoted to material science investigations into radiation damage. While the creation of radioactive
isotopes is desired in some cases, material being tested for radiation damage should preferably have low levels
of radioactivity.
It is expensive to arrange the irradiation of target materials by high energy neutrons sources, whereas it is
relatively inexpensive to irradiate using an ion beam on the MC-40 Cyclotron. The energies can be controlled,
and a set dose at a single energy, or a range of energies, can be precisely deposited into the target material. The
reaction cross section for neutrons also cover a much larger range including lower energy projectiles, something
Coulomb repulsion reduces for ions (fig. 4.5).
The Activity code discussed in this work was developed to calculate the activity of a target material irradiated
TENDL Fe56 Reaction Cross Sections

TENDL Ni58 Reaction Cross Sections
2

2

1×10

0

1×100

1×10

1×10-2

Cross Section (barns)

Cross Section (barns)

1×10

1×10-4
-6

1×10

1×10-8

1×10-4
1×10-6
1×10-8
1×10-10
1×10-12

1×10-10
1×10-12

1×10-2

Neutron
Proton
Deuteron
1×10-4 1×10-2 1×100 1×102 1×104
Incident Energy (eV)

1×10-14
1×106

1×10-16

1×108

Neutron
Proton
Deuteron
1×10-4 1×10-2 1×100 1×102 1×104
Incident Energy (eV)

1×106

1×108

Figure 4.5: Neutron, proton and deuteron cross sections for Fe56 and Ni58

48

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

4.4. EMULATING NEUTRON DAMAGE

by a proton beam. It has been developed in Python and uses data from the TALYS and TENDL proton
cross section databases, SRIM ion transport code and Nuclear Data Services radioactive decay database. It is
discussed in greater detail in chapter 6.

4.4.2

Transmutation of Nuclei by Neutrons and Protons

Neutron Activation
The fission of Uranium-235 atoms results in neutrons with a varied spectrum of energies. The neutrons will
bounce around inside the reactor losing energy quickly to light atoms within moderators and coolants, such as
water. At lower energies the neutrons may be captured by the nuclei of atoms they interact with. This creates
a new isotope which may or may not be stable.
Proton Activation
Considering a simplified nuclear potential well, energetic protons approaching a nucleus may overcome the
Coulomb potential barrier. They are captured by the nucleus and held within the potential well by the strong
nuclear force. The barrier between a proton and a target nucleus may be approximated using eq. 4.2[86] and eq.
4.3[87]. Using these equations does neglect the probability of lower energy protons being captured via quantum
tunnelling of the Coulomb barrier.

𝑉𝐶𝑜𝑙𝑜𝑢𝑚𝑏 =

𝑒2 𝑍1 𝑍2
4𝜋𝜖0 𝑟1 + 𝑟2

𝑟 = 𝑟0 𝐴1/3 where 𝑟0 = 1.2 × 10−15 𝑚

(4.2)

(4.3)

This process may leave the nucleus in an excited and unstable state, depending on the input energy of the
proton and configuration of nucleons. The process is probabilistic, and the average chance of a reaction (the
microscopic cross section) may be measured as a function of the projectile, projectile energy and target, either
experimentally or by optical model potential calculations.

𝑅=

𝐽
· 𝑛𝜌 · 𝜎 · 10−28 𝛿𝑡
𝑄

(4.4)

The reaction rate is calculated from the microscopic cross section, using eq, 4.4, and the parameters are as
follows:
• R Reaction Rate (reactions per second)
• J Beam current (A)
• 𝑛𝜌 Number density of target (atoms per cubic metre)
• 𝜎 microscopic reaction cross section (barns)
• Q projectile charge e.g 1.602177 × 10−19 𝐶 for a proton
• 𝛿𝑡 target thickness (m)

49

4.4. EMULATING NEUTRON DAMAGE

4.4.3

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

Nuclear Reaction Cross Sections

Reaction Cross Sections
The type of reaction for an individual reaction cannot be determined, but the probability of that reaction
happening may be measured and future events predicted. This data may be gathered experimentally, or it may
be calculated using various models.
EXchange FORmat Data File
EXchange FORmat (EXFOR) is a standard format for storing experimental results from nuclear reactions[88].
It is also associated with an online database hosted by the International Atomic Energy Agency (IAEA) where
nuclear reaction data from a variety of sources are obtained and compared. Thousands of points make up the
database and the work of three groups responsible for subsets of that data was reviewed to give an insight into
the methods used.
The (p,n) reactions with pure Titanium, Vanadium, Chromium, Iron and Nickel were studied by Tanaka and
Furukawa[89]. The 63 inch cyclotron that was used by the Institute for Nuclear Study (INS) in Tokyo provided
the protons. The device output a mono-energetic 14MeV beam of protons at a stack of target foils. The Ti,
2

Fe and Ni foils were 2 − 5mg/cm in thickness, which is roughly 2-10 micrometers (depending on the density

of the material). As the ions passed through the stack of foils their energy dropped and the experimenters
estimated the energy using the Bethe stopping power formula[90]. The ion energies in the resulting data range
from 3-4MeV up to 14MeV.
Similarly the (p,n) reaction in a range of materials with 5 to 10.5MeV protons was investigated by Wing and
Huizenga[91]. A 60 inch cyclotron was used in this instance with foils of Vanadiuim, Chromium, Copper, Silver,
2

Cadmium and Lanthanum. Foils were again stacked and had a thickness of 5mg/cm , or approximately 5
micrometers, depending on the density of the element. Some energies as they passed through the foils were
estimated by the experimenters, based on past work.
Vanadium, Iron and Copper foils were irradiated with 10 to 45MeV protons using the Milan Azimuthally Varying
Field (AVF) cyclotron. In this work Gadioli et al[92] measured reaction cross sections for 17 proton energies.
Thin foils ranging from 10-48 micrometers but is it unknown whether or not they were stacked or irradiated
individually using aluminium absorbers.
The experimental work as a whole ranges over decades using slightly different tools and measuring methods,
but the resulting data has contributed to ever improving models used to compute the probability of a reaction.
TALYS and the Optical Model Potential
In the standard model, protons and neutrons are composed of quarks, held together by the strong nuclear
force. The nucleus of an atom is also held together by the strong nuclear force that on such small separations
overwhelms the electromagnetic force of the protons with one another.
This is a complicated system, not to mention the excited states that nuclei may occupy. The interaction of a
projectile (proton, neutron or a heavier ion) with the nucleus is a challenge to model.
Initially, reaction data for protons and neutrons were gathered through experimentation. In the 1950s, Feshbach
et al put forward a simple model for nuclear reactions between the nucleus and neutrons, and this model was
restricted to 0-20MeV neutrons. The form of the potential used was a complex function[93].

50

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

4.4. EMULATING NEUTRON DAMAGE

Figure 4.6: TALYS work flow [94]

𝑉 = 𝑉0 (1 + 𝑖𝜁)𝑟 < 𝑅
𝑉 = 0𝑟 > 𝑅

(4.5)

1

The potential in equation 4.5 has the parameters 𝑅 = 1.4 × 𝐴 3 , 𝑉0 = 42𝑀 𝑒𝑉 and 𝜁 = 0.03 where A is the

atomic mass of the target atom.

Considering the complexity of the system being modelled, this simple model was very successful. Over the years
since, the models used have become more complex and parameters used have been fit to an increasing amount
of experimental data.
The Talys code uses a range of models (figure 4.6). These include the optical model which is solved using the
Equations Couplées Itérations Séquentielle (ECIS-06) code of Jacques Raynal, implemented as a subroutine
within Talys, and this is accurate up to 180MeV[94]. Whilst the Talys code has been extended up to 1GeV, it is
experimental in the 180MeV to 1GeV range. Fortunately, this work only requires nuclear reaction cross section
data up to approximately 100MeV as the current ion source under consideration produced ions with energies
up to 60MeV.
The Talys code has potentials for protons and neutrons, but it also has potentials for deuterons, tritons, helium3 and alpha particles. The potentials are discussed in detail in the Talys manual[94]. This extension to heavier
ions may be useful for this work as the University of Birmingham cyclotron is capable of accelerating deuterons
and 𝐻𝑒2+ ions.
Comparing experimental data to the Talys data for 𝐹 𝑒54(𝑝, 𝛾)𝐶𝑜55 shows good agreement between 1MeV and
10MeV4.7. There was insufficient experimental data from this source, but the Talys generated data ranges from
micro eV up to 100MeV+ (figure 4.7).

51

4.4. EMULATING NEUTRON DAMAGE

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

Figure 4.7: TALYS Fe54-Co55 cross section comparison with experiment [95]

PADF
The Proton Activation Data File was released in 2007 and contained nuclear reaction data for 2355 target nuclei,
ranging from Magnesium (12) to Radon (86) with proton energies up to 150MeV. The file contains the sum of
all individual reactions as well as certain yields, and the data was generated using the TALYS and ALICE/ASH
codes, as well as experimental data from Exfor[96].
Listing 4.1: A sample of the Iron-56 PADF data file
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26

Proton Activation Data File
***************************

528 1451 12
528 1451 13
528 1451 14
Authors: C.H.M.Broeders, U.Fischer, A.Yu.Konobeyev, L.Mercatali 528 1451 15
528 1451 16
528 1451 17
Data for PADF file were obtained using the TALYS code [1] for 528 1451 18
target nuclei with half-life more than 10 min and using the 528 1451 19
ALICE/ASH code [2] for nuclei with 1 sec < T1/2 < 10 min and 528 1451 20
available experimental data
528 1451 21
MAT numbers are taken according to JEFF-3.1/RDD
528 1451 22
528 1451 23
Evaluation for Fe-56 (stable) : TALYS code
528 1451 24
Experimental data used for the correction of calculated
528 1451 25
excitation functions are taken from Refs.[3-12]
528 1451 26
528 1451 27
528 1451 28
File contains
528 1451 29
528 1451 30
MF=3 MT=5
528 1451 31
Sum of all individual reaction cross-sections (Total 528 1451 32
reaction cross-section)
528 1451 33
528 1451 34
MF=6 MT=5
528 1451 35
Yields of nuclei in nuclear reactions including
528 1451 36
n, p, d, t, He-3, He-4 and photon production
528 1451 37

52

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

4.4. EMULATING NEUTRON DAMAGE

TENDL 2019 Data Files
The cross section data for protons and neutrons is available to download in ENDF format files. The data sources
used by this work are the Talys code and TENDL data files, and these are created by a combination of different
nuclear models and experimental data. The TENDL nuclear reaction simulation code provides the calculated
data.
The nuclear reaction files are rather large, and they all follow a standard format.
Listing 4.2: Sample TENDL File
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19

2.605600+4 5.545443+1
0.000000+0 0.000000+0
46
2
1.000000+3-9.920042-7
3.000000+6-7.609736-3
6.000000+6-5.149510-2
9.000000+6-9.978765-2
1.200000+7-2.743084-1
1.500000+7-3.674350-1
1.800000+7-3.799978-1
2.200000+7-3.342054-1
2.800000+7-2.388019-1
4.000000+7-8.801994-2
5.500000+7-5.480233-3
7.000000+7 1.727774-2
9.000000+7 1.783081-2
1.200000+8 9.641120-3
1.500000+8 5.367555-3
2.000000+8 4.445323-3

4.4.4

0
0

0
0

1.000000+6-9.920042-7
4.000000+6-3.232345-2
7.000000+6-3.685484-2
1.000000+7-1.599116-1
1.300000+7-3.165007-1
1.600000+7-3.788282-1
1.900000+7-3.725944-1
2.400000+7-3.031296-1
3.000000+7-2.077513-1
4.500000+7-5.013441-2
6.000000+7 6.189980-3
7.500000+7 1.906833-2
1.000000+8 1.499871-2
1.300000+8 7.717424-3
1.600000+8 4.771939-3

0
1

02631 3 2
1
462631 3 2
2
2631 3 2
3
2.000000+6-2.167241-42631 3
5.000000+6-5.975554-22631 3
8.000000+6-5.542173-22631 3
1.100000+7-2.206871-12631 3
1.400000+7-3.471231-12631 3
1.700000+7-3.825634-12631 3
2.000000+7-3.617662-12631 3
2.600000+7-2.709398-12631 3
3.500000+7-1.398614-12631 3
5.000000+7-2.349373-22631 3
6.500000+7 1.332313-22631 3
8.000000+7 1.943711-22631 3
1.100000+8 1.211197-22631 3
1.400000+8 6.318436-32631 3
1.800000+8 4.312985-32631 3
2631 3 2 19

2
2
2
2
2
2
2
2
2
2
2
2
2
2
2

4
5
6
7
8
9
10
11
12
13
14
15
16
17
18

Radioactive Decay

Radioactive decay is the random change in nucleons or energy state of an unstable nucleus. It is impossible
to predict when a single nucleus will decay, but the decay of a collection of nuclei is statistical in nature. The
radioactivity and number of unstable nuclei at time t can be predicted using the decay constant, λ, for the
radioactive isotope. This constant is defined as follows:

𝜆=−

𝑁 ′ (𝑡)
𝑁 (𝑡)

(4.6)

The number of radioactive nuclei 𝑁 (𝑡) at time t is given by the following equation, where 𝑁 (0) is the starting
number of nuclei:

𝑁 (𝑡) = 𝑁 (0) exp(−𝑡𝜆)

(4.7)

The activity 𝐴(𝑡) of the radioactive nuclei is predicted at time t by using the following equations, where 𝑁 ′ (𝑡)
is the change in amount of nuclei with respect to time:
𝐴(𝑡) = −𝑁 ′ (𝑡) = 𝜆𝑁 (𝑡)

(4.8)

𝐴(𝑡) = 𝜆𝑁 (0) exp(−𝑡𝜆)

(4.9)

53

4.4. EMULATING NEUTRON DAMAGE

4.4.5

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

Saturation Activity

As a radioactive isotope is created by reactions between target atoms and projectiles (protons, neutrons,
deuterons) it will begin to decay. The amount of the isotope will continue to increase until the decay rate
equals the reaction rate for the creation of the isotope.
For a single isotope:

𝜔=

𝐽
· 𝑛𝜌 · 𝜎 · 10−28 𝛿𝑡
𝑄

𝑑𝑁
= 𝜔 − 𝜆𝑁, 𝑁 (0) = 𝑁0
𝑑𝑡

(4.10)

This equation may be solved using Laplace transforms (appendix A) and this will be explored in more detail
in section 6.2.1. The solution for a single isotope that has a starting amount 𝑁0 , a decay constant 𝜆 and a
creation rate of 𝜔 is given in eq. 4.11.

𝑁 (𝑡) =

𝜔 )︁
𝜔 (︁
+ 𝑁0 −
exp(−𝜆𝑡)
𝜆
𝜆

(4.11)

The saturation activity may be computed as follows. As t approaches infinity the exponential term tends
towards zero due to the negative decay constant. Replacing the exponential terms with zero and noting eq. 4.8
leaves a simple result to compute the saturation activity 𝐴𝑠 (eq. 4.13). This is logical as, once saturated, the
isotope will decay at the same rate as its source.

𝜔
𝜆
𝐴𝑠 = 𝜆𝑁𝑠 = 𝜔
𝑁𝑠 =

(4.12)

The saturation time is trickier to compute. Mathematically the sample would never reach saturation, it would
get ever closer as time elapsed. Rather than compute this time (which would be meaningless) it is more useful
to compute the time at which the saturation reaches a fraction, k, of the maximum saturation amount 𝑁𝑠 .

𝑘𝑁𝑠 =

𝜔 )︁
𝜔 (︁
+ 𝑁0 −
exp(−𝜆𝑡)
𝜆
𝜆[︃
]︃
−1
𝑘−1
𝑡=
ln
𝜆
𝑁0 𝜔𝜆 − 1

(4.13)

The equation is useful in calculating (near to) the maximum possible activity of a isotope being created in a
proton beam or other similar process where radioactive isotopes are created and lost at a constant rate.

4.4.6

Decay Constants: Joint Evaluated Fission and Fusion File (JEFF) 3.3 Data
File

JEFF 3.3 is an evaluated data file[23], meaning it has been evaluated bu a relevant authority. The quality of
the data may affect the health of the public and industry workers, so it must be evaluated. This particular file
is managed by and available through the Nuclear Energy Agency (NEA).

54

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

4.5. USING SRIM AND TRIM

It is a collection of many data files. Released in 2017, it also contains several files for incident gammas, protons,
deuterons, tritons, helium-3 and alphas from the TENDL 2017 data file.
The files that will be important for this work are the ENDF-6 radioactive decay data files only. The nuclear
reaction cross section data will come from Talys and various iterations of the TENDL libraries. The decay data
held in the JEFF 3.3 file includes isotope data, masses, half lives, branching factors, continuous and discrete
gamma data.

4.4.7

Bateman Equation for Radioactive Decay

Parent Isotope, N1 (t)

1st Unstable Daughter Isotope, N2 (t)

2nd Unstable Daughter Isotope, N3 (t)

Stable Daughter Isotope, N4 (t)
Figure 4.8: An example decay chain from an unstable parent isotope, through unstable daughter isotopes ending
with a stable daughter isotope.
The English mathematician Harry Bateman derived an equation (eq. 4.14) to calculate the amount of each
isotope in a decay chain, illustrated in Figure 4.8, at time t.

𝑁𝑛 (𝑡) =

𝑖=𝑛
∑︁
𝑖=1

⎛⎛
⎝⎝

𝑗=𝑛−1
∏︁
𝑗=𝑖

⎞

𝜆(𝑖𝑗+1) ⎠

𝑗=𝑛
∑︁
𝑗=𝑖

(︃

)︃⎞

𝑁𝑖0 exp(−𝜆𝑗 𝑡)
⎠
∏︀𝑝=𝑛
𝑝=𝑖,𝑝̸=𝑗 (𝜆𝑝 − 𝜆𝑗 )

(4.14)

When a radioactive isotope decays, there may be more than one mode of decay, and this leads to branching
factors. Pb-214 only decays via beta decay to Bi-214, giving a branching factor of 1.0, whereas Bi-214 has a
99.979% chance of decaying to Po-214 by beta decay and a 0.021% of emitting an alpha particle and decaying
to Tl-210 (branching factors of 0.99979 and 0.00021 respectively) [23].
When a target material is irradiated, there is a source term for transmuted nuclei due to the irradiation. The
daughter isotopes of these transmuted isotopes will also be affected by the irradiation and will transmute further,
giving a source term for each daughter isotope as a result of the irradiation. Sources for each isotope in the
decay chain, and branching factors between a parent isotope and its daughter isotope/s must be accounted for.
This is addressed in chapter 6.

4.5

Simulating Ion Irradiation with SRIM and TRIM

A package of ion transport codes, SRIM, is freely available to download and use to investigate the transport
of ions through matter. It includes tools to calculate the stopping range of a given ion in a material as well as
TRansport In Matter, a code used to calculate the energy and position of an ion through a target.
55

4.5. USING SRIM AND TRIM

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

TRIM does not take into account the structure of a target. It may be layered in the calculation perpendicular
to the beam, but beyond that the target is treated as amorphous. It will give the same result for BCC iron as it
would for FCC iron, providing the density remains the same. The density and whether or not the target layer
is a gas or solid are options that must be configured when setting up a calculation. Each ion history is tracked
through the same target; the target never changes. TRIM is ignorant to the structure and therefore damage to
the structure that would accumulate over time, and to any swelling and change in composition or density.
The interaction of the ion with the target material is split into two parts: nuclear loss and electronic loss. The
ion is tracked through the target until either its energy drops below a set threshold (10eV) or it leaves the target
(figure 4.9). The code then moves on to the next ion history.
In a projectile-nucleon interaction, the magic formula (eq. 4.15)[97] is used to determine the scattering angle
Θ of the ion and target nucleus, as well as the amount of energy transferred. The azimuthal angle is selected
randomly by multiplying 2𝜋 by a random float [0.0, 1.0].

𝑐𝑜𝑠

(︂

Θ
2

)︂

𝐵 + 𝑅𝑐 + ∆
𝑅0 + 𝑅𝐶
𝑝
𝐵=
𝑎
𝑟0
𝑅0 =
𝑎
𝜌
𝑅𝐶 =
𝑎
𝑅0 − 𝐵
∆=𝐴
1+𝐺

=

𝐴 = 2𝛼𝜖𝐵 𝛽
(︁(︀
)︁−1
)︀ 1
𝐺 = 𝛾 1 + 𝐴2 2 − 𝐴
𝛼 = 1 + 𝐶1 𝜖

(4.15)

− 12
1

𝛽=

𝐶2 + 𝜖 2
1

𝐶3 + 𝜖 2
1

𝛾=

𝐶4 + 𝜖 2
1

𝐶5 + 𝜖 2

where 𝑝 is the impact parameter
where 𝑎 is the screening length
where 𝑟0 is the distance of closest approach
where 𝜖 is the reduced energy
The potential between the projectile and target is calculated at the distance of closest approach, 𝑟0 . It is a
Coulomb type potential (eq. 4.16) than includes the universal screening function (eq. 4.17). This potential will
appear again, although occasionally with differing parameters, in chapter 5.

𝑉 (𝑅) =

𝑍1 𝑍2 𝑒2
Φ(𝑅)
𝑎𝑅

Φ(𝑅) = 0.1818𝑒𝑥𝑝(−3.2𝑥) + 0.5099𝑒𝑥𝑝(−0.9423𝑥) + 0.2802𝑒𝑥𝑝(−0.4028𝑥) + 0.2817𝑒𝑥𝑝(−0.2016𝑥)

(4.16)

(4.17)

The recoil nuclei are also followed through several generations until their energies fall below that set for either
the surface binding energy or displacement energy (3-6eV and 15-30eV respectively)[97].

56

CHAPTER 4. ISOTOPE ACTIVATION AND RADIOACTIVE DECAY

4.5. USING SRIM AND TRIM

14

Proton Energy/Depth

12

Proton Energy/MeV

10

8

6

4

2

0
0

0.05

0.1

0.15

0.2
0.25
Depth/mm

0.3

0.35

0.4

0.45

Figure 4.9: One hundred simulated 13MeV proton energy loss curves in Fe simulated with SRIM [98]

The free flight path between large collisions is calculated based on the projectile energy, type and the target
material. The path length between collisions is randomly generated by taking the maximum free path and
multiplying by a random float [0.0, 1.0]. Smaller projectile-nucleus interactions are not individually calculated,
but the average energy that would have been lost is calculated and applied.
The ion continuously loses energy to the electrons in the material. TRIM calculates this over the free flight
path, L (eq. 4.18).

∆𝐸𝑒 = 𝐿𝑁 𝑆𝑒 (𝐸)
where 𝑆𝑒 (𝐸) is the electronic stopping

(4.18)

and 𝑁 is the atomic density of the target
The target damage is a combination of the incoming ion, the primary knock on atoms and their damage cascades.
The user has the option of running a full damage cascade that plots the entire cascade, or a quicker calculation
where the cascade is treated as just a point. The total number of displacements is the sum of vacancies and
replacement collisions, and the vacancies is sum of interstitials with the number of atoms that leave the target.
One file that SRIM creates is of importance to the Activity code, and that is the trajectory file that contains
the energy and x,y,z co-ordinate data points for simulated ions moving through matter. Figure 4.9 shows the
trajectory of one hundred 13MeV protons entering and passing through an Iron target, and it is this set of data
points (together with the cross section database) that the Activity code uses to calculate the reaction rates for
the transmutation of nuclei in the target. At higher energies, the ions slow as they lose energy due to electronic
stopping, but as the ion energy drops the mechanism of loss through nuclear collisions becomes important. The
spreading of ion depths at lower energies is a result of the higher momentum transfer during nuclear collisions.

57

Chapter 5

Interatomic Potential Fitting
In order to model Fe, Pd and Ru with Molecular Dynamics codes, an interatomic potential is
needed. This will require experimental data and data generated by first principles calculations. The
simplified models will consist of just Fe-Pd and Fe-Ru, but pure Fe does not take the FCC structure
that it does when alloyed with Ni in Austenitic Stainless Steel.
The properties of theoretical pure FCC Fe are estimated using Density Functional Theory that
solves the many body Schrödinger Equation. While it is impossible to solve this equation exactly,
with our current technology and knowledge, it is possible to solve approximately by making several
approximations and by using the Hohenberg-Kohn theorem.
Many body potentials such as the FS and embedded-atom method are often used to model metals. The force matching method is used to fit the potentials to data. Optimization algorithms are
split into global and local, with an example of a global being simulated annealing and a local being
BFGS.

5.1
5.1.1

Experiment, Modelling and Theory
Introduction

We do not have a complete understanding of the world around us, so it may be that experiment is the “best”
method of testing a material, as by its nature it will obey the rules of physics. As far as we know, these do not
change from one place to another. A piece of steel used in an experiment is never going to have precisely the
same composition and structure as similar steel use in a reactor, but it should be close enough.
The scanning electron microscope has a magnification of approximately 1 million times and they are able to
generate a picture of the surface of a specimen using a beam of electrons. The transmission electron microscope
has the ability to magnify a specimen further, with a resolution of less than 1 angstrom. The trade off is that
a it covers a smaller area of the specimen than a SEM and the sample must be prepared in thin slices.
The composition of an irradiated sample may be tested by a number of methods including neutron activation
analysis and secondary-ion mass spectrometry. Scattering techniques, such as x-ray or neutron diffraction,
can give an insight into the structure of a material, but they are statistical methods and do not give detailed
measurements of individual atoms or defects.
There are draw backs to experiments, several of which are particular to this work. Even with our advances
in technology, there are still errors introduced into any experiment. When dealing with smaller and smaller
58

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.1. EXPERIMENT, MODELLING AND THEORY

volumes of atoms quantum effects will also need to be considered.
Radiation damage experiments, whether by neutrons or ions, will result in radioactive waste and the target
must be safe to handle to be examined. The collision event happens up to a micron or more into the material.
They occur on a very short timescale and within small volumes of space at random points along the path of the
projectile, so the events would be very hard or impossible to track as they occur with current technology.
Current theories have been developed and modified over hundreds of years, and in the last 100 years Quantum
Mechanics has been introduced to better describe physics on a small scale. It is a well proven theory that has
been very successful. Unfortunately, using the theory exactly for a large ensemble of atoms and electrons is
impossible with our current level of technology.
Computer models use theory, and a number of approximations, to simulated reality. These models may need
to be fine tuned, to better fit both the theory and experiment, but they allow us to do what is not possible
with either experiment or theory. It is possible to simulate an individual damage cascade and watch it in fine
detail spatially and temporally. As computer power increases, the models used become more complex and the
simulation boxes and time spans grow.
This chapter discusses the background required to link the more accurate DFT to MD by deriving interatomic
potentials based on experiment and calculated data. By doing this, it opens a route to model the concentrations
of PGMs at the grain boundary following irradiation damage.

5.1.2

Simulating Materials on a Variety of Scales in Time and Space

Taking a 1 micron grain in a steel as an example, it would contain tens of billions of atoms. This is too large
a number of atoms to model currently, but by choosing the right type of model a portion of the grain may be
modelled.

Figure 5.1: Time and Size Scales for Computer Packages [99]

The properties of metals may be approximated using small crystals rather than the whole grain, and this is
ideally suited to DFT calculations. Simulations of small ensembles of atoms over time are now also possible
using DFT molecular dynamics. Larger simulations containing thousands to millions of atoms, that are able to
simulate single damage cascades are suitable for MD simulations (figure 5.1).

59

5.2. PROPERTIES OF CRYSTALS

5.2
5.2.1

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Properties of Crystals
Introduction

There are seven crystal classes (table. 5.1) and 14 Bravias lattices (section 5.7.6), although this work is primarily
concerned with cubic and orthorhombic crystals.
Class

Lengths

Angles

Cubic
Hexagonal
Rhombohedral
Tetragonal
Orthorhombic
Monoclinic
Triclinic

𝑎=𝑏=𝑐
𝑎 = 𝑏, 𝑐
𝑎=𝑏=𝑐
𝑎 = 𝑏, 𝑐
𝑎, 𝑏, 𝑐
𝑎, 𝑏, 𝑐
𝑎, 𝑏, 𝑐

𝛼 = 𝛽 = 𝛾 = 90∘
𝛼 = 𝛽, 𝛾 = 120∘
𝛼 = 𝛽 = 𝛾 ̸= 90∘
𝛼 = 𝛽 = 𝛾 = 90∘
𝛼 = 𝛽 = 𝛾 = 90∘
𝛼 = 𝛽 = 90∘ , 𝛾 ̸= 90∘
𝛼, 𝛽, 𝛾,

Table 5.1: Seven Crystal Classes

Metals are rarely single crystals, but are made from many crystals separated by grain boundaries. However, the
knowledge of the microscopic crystals translates well to the properties of the metals on a macroscopic scale.
This work does not attempt to calculate properties based on a collection of many crystals, but on a single
crystal with less that a thousand atoms. The crystals are then assumed to be infinite in size, due to periodic
boundary conditions.

5.2.2

Equation of State

The equation of state of a material relates either the pressure on that material as a function of the volume, or
the energy of a sample of a material to the volume. This not only allows one to predict the energy or pressure
at a certain volume, but also the minimum energy, relaxed volume and the bulk modulus.
Bulk Modulus
The bulk modulus of a material is defined as the bulk stress of a sample divided by the bulk strain on that
sample and several example values are given in table 5.2. It is also the inverse of the compressibility of that
material, which means that materials with a higher bulk modulus are less compressible than those with a lower
value.

𝜕𝑃
𝜕𝑉

(5.1)

𝜕2𝐸
𝜕𝑉 2

(5.2)

𝐵0 = −𝑉

𝐵0 = 𝑉

60

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.2. PROPERTIES OF CRYSTALS

Material

Bulk Modulus/GPa

Aluminium
Iron (BCC)
Stainless Steel 18-8

70
110
163

Table 5.2: Example bulk modulii for three metals

Murnaghan Equation of State
Hooke’s law implies a linear relationship between stress and strain. In practice, where a pressure is applied to
a material, the application of Hooke’s law is limited[100]. Muraghan derived a new equation to improve upon
formulae developed in the 1930’s, using compression data from high pressure experiments.

𝐵0
𝑃 (𝑉 ) = ′
𝐵0

(︃(︂

𝑉0
𝑉

)︂𝐵 ′ 0

)︃

−1

(5.3)

As pressure is the negative derivative of the internal energy of the system with respect to change in volume,
𝑝 = −(𝜕𝐸/𝑑𝑉 ), and the equation can be integrated and written in terms of the energy, volume, bulk modulus
and its derivative[101].

𝐵0 𝑉
𝐸(𝑉 ) = 𝐸0 + ′
𝐵0

[︃(︂

𝑉0
𝑉

)︂𝐵 ′ 0

]︃
𝐵0 𝑉0
1
+1 − ′
𝐵′0 − 1
𝐵 0−1

(5.4)

Birch-Murnaghan Equation of State
Several years after Murnaghan’s equation, Birch developed the equation of state further upon the experimental
data provided by work from Bridgman in high pressure physics. For cubic symmetry, the description of free
energy now includes third order terms in the strain components[102].

3𝐵0
𝑃 (𝑉 ) =
2

[︃(︂

𝑉0
𝑉

)︂ 73

−

(︂

𝑉0
𝑉

(︃(︂ )︂ 2
)︃]︃
)︂ 53 ]︃ [︃
3 ′
𝑉0 3
1 + (𝐵 0 − 4)
−1
4
𝑉

(5.5)

The energy-volume relationship may again be constructed[101].
⎡[︃
⎤
]︃3
[︃(︂ )︂ 2
]︃2 [︃
(︂ )︂ 2
(︂ )︂ 23 ]︃
3
9𝑉0 𝐵0 ⎣ 𝑉0 3
𝑉
𝑉
0
0
⎦
𝐸(𝑉 ) = 𝐸0 +
− 1 𝐵′0 +
−1
6−4
16
𝑉
𝑉
𝑉

(5.6)

In order to fit the Birch-Murnaghan, the first step is to fit a second order polynomial to the energy-volume
data. This may be achieved using least-squares fitting with a vandermode matrix. The coefficients from this
polynomial may then be used to calculate reasonable values for 𝐸0 , 𝑉0 and 𝐵0 ; sane starting values of 𝐵 ′ 0 are
between 1 and 10, and a recommended value in the literature is 2[103].

61

5.2. PROPERTIES OF CRYSTALS

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

𝐸(𝑉 ) = 𝑐0 + 𝑐1 𝑉 + 𝑐2 𝑉 2
𝑐1
𝑉0 = −
2𝑐2
(5.7)

𝐸0 = 𝑐2 × 𝑉0 2 + 𝑐1 𝑉0 + 𝑐0
𝐵0 = 2𝑐2 𝑉0
𝐵′0 = 2

Newton Gauss (eq. 5.8) may then be used to attempt to minimise the fit further for 𝐸0 , 𝑉0 and 𝐵0 whilst trying
values of 𝐵 ′ 0 ∈ 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5, 6.0. The parameters with the lowest residual square sum

are returned.

[︀ 𝑇 ]︀
𝐽 𝐽 𝑃 = 𝐽𝑇 𝑅

(5.8)

Mehl et al used a version of the Birch equation of state[102] and suggest a value for 𝐵 ′ 0 between 3 and 5[104]
and limit the value of N in eq. 5.9 to either 3 or 4 for the best data fit.

9
𝐸(𝑉 ) = 𝐸0 + 𝐵0 𝑉0
8

[︃(︂

𝑉0
𝑉

)︂ 23

]︃2

−1

′
9
+ 𝐵0 (𝐵0 − 4)𝑉0 ×
16

[︃(︂

𝑉0
𝑉

)︂ 23

]︃3

−1

+

𝑠𝑢𝑚𝑁
𝑛=4 𝛾𝑛

[︃(︂

𝑉0
𝑉

)︂ 23

]︃𝑛

−1

(5.9)

In generating the data for a Birch or Birch-Murnaghan fit the atom configuration is relaxed. A small strain
[𝜎, 𝜎, 𝜎, 0.0, 0.0, 0.0] is applied to decrease and increase the volume slightly about the relaxed volume.
Rose-Vinet Equation of State
(︂
(︂
𝐸(𝑎) = 𝐸0 + 1 + −𝛼

𝑎
𝑎0 − 1

)︂)︂

(︂
(︂
𝑒𝑥𝑝 −𝛼

𝑎
𝑎0 − 1

)︂)︂

𝛼=

√︂

9Ω𝐵0
−𝐸0

(5.10)

More recently a Universal form, eq 5.10, was proposed by Rose, Vinet et al[105]. With an exponential cut off,
this fits from the relaxed lattice parameter to much wider separations with a good fit for simple and transition
metals, including K, Mo, Cu (fig. 5.2).

Figure 5.2: Rose-Vinet Equation of State

62

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.2. PROPERTIES OF CRYSTALS

This has been used as a tool to fit interatomic potentials in work by Jelinek et al[106] and Bonny et al[107]. The
version of the equation in this work is that used by Bonny et al and their fitting code, which will be discussed
in more detail in section 5.6.

5.2.3

Voigt Notation

Where a tensor is symmetric, Voigt notation is used to simplify how the tensor is written. It reduces a second
order tensor such as stress or strain, represented by a 3x3 matrix, to a 6 row matrix. It also reduces a fourth
order tensor, such as the compliance or stiffness tensor (represented by a 3x3x3x3 matrix), to a 6x6 matrix.

⎡
𝐴11
⃗=⎢
𝐴
⎣𝐴21
𝐴31

5.2.4

𝐴12
𝐴22
𝐴32

⎡
⎤
𝐴11
⎢
⎥
⎤ ⎢𝐴22 ⎥
⎢
⎥
𝐴13
⎢
⎥
⎥ ⎢𝐴33 ⎥
⃗ is symmetric
⎥ if 𝐴
𝐴23 ⎦ = ⎢
⎢𝐴23 ⎥
⎢
⎥
𝐴33
⎢𝐴 ⎥
⎣ 13 ⎦
𝐴12

(5.11)

Elastic Constants

Stress and strain are both related by either the stiffness tensor 𝐶, filled with the elastic constants, or the
compliance tensor 𝑆 and this is the inverse of the stiffness tensor. Strain is a measure of the deformation of a
material and by definition has no units. In one dimension 𝜖 =

𝛿𝑙
𝑙0

where 𝑙0 is the unstrained length and 𝛿𝑙 is the

change in length. The Generalized Hooke’s law relating these tensors allows the computation of the Cauchy
stress if the elastic constants are known and an input strain is provided.

⎡
𝜖11
⃗=⎢
𝐴
⎣𝜖21
𝜖31

𝜖12
𝜖22
𝜖32

⎡ ⎤
𝜖11
⎢ ⎥
⎤ ⎢𝜖22 ⎥
⎢ ⎥
𝜖13
(︂
)︂
⎢ ⎥
𝜕𝑢𝑗
1 𝜕𝑢𝑖
⎥ ⎢𝜖33 ⎥
+
𝜖23 ⎦ = ⎢ ⎥ where 𝜖𝑖𝑗 ≡
⎢𝜖23 ⎥
2 𝜕𝑥𝑗
𝜕𝑥𝑖
⎢ ⎥
𝜖33
⎢𝜖 ⎥
⎣ 13 ⎦
𝜖12

(5.12)

⃗ 𝜖⃗𝑘𝑙
𝜎⃗𝑖𝑗 = 𝐶𝑖𝑗𝑘𝑙

(5.13)

⃗ 𝜎⃗𝑘𝑙
𝜖⃗𝑖𝑗 = 𝑆𝑖𝑗𝑘𝑙

(5.14)

63

5.2. PROPERTIES OF CRYSTALS

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

⎡
𝜖1
⎢
⎢𝜖2
⎢
⎢𝜖
⎢ 3
𝜖𝑖𝑗 = ⎢
⎢𝜖4
⎢
⎢𝜖
⎣ 5
𝜖6
⎡ ⎤ ⎡
𝐶11
𝜎1
⎢ ⎥ ⎢
⎢𝜎2 ⎥ ⎢𝐶21
⎢ ⎥ ⎢
⎢𝜎 ⎥ ⎢𝐶
⎢ 3 ⎥ ⎢ 31
⎢ ⎥=⎢
⎢𝜎4 ⎥ ⎢𝐶41
⎢ ⎥ ⎢
⎢𝜎 ⎥ ⎢𝐶
⎣ 5 ⎦ ⎣ 51

𝐶61

𝜎6

= 𝜖11 = 𝜖11

⎤

⎥
= 𝜖22 = 𝜖22 ⎥
⎥
= 𝜖33 = 𝜖33 ⎥
⎥
⎥
= 𝜖23 = 𝜖32 ⎥
⎥
= 𝜖13 = 𝜖31 ⎥
⎦
= 𝜖12 = 𝜖21

(5.15)

𝐶12

𝐶13

𝐶14

𝐶15

𝐶22

𝐶23

𝐶24

𝐶25

𝐶32

𝐶33

𝐶34

𝐶35

𝐶42

𝐶43

𝐶44

𝐶45

𝐶52

𝐶53

𝐶54

𝐶55

𝐶62

𝐶63

𝐶64

𝐶65

⎤⎡ ⎤
𝜖1
⎥⎢ ⎥
⎢𝜖2 ⎥
𝐶26 ⎥
⎥⎢ ⎥
⎢ ⎥
𝐶36 ⎥
⎥ ⎢𝜖3 ⎥
⎥⎢ ⎥
⎢ ⎥
𝐶45 ⎥
⎥ ⎢𝜖4 ⎥
⎥
⎥
𝐶55 ⎦ ⎢
⎣𝜖5 ⎦
𝜖6
𝐶66

𝐶16

(5.16)

There are 81 elastic constants, although as the tensor is symmetric it may be written in Voigt notation with
36 values (eq. 5.16). The number of independent elastic constants may be reduced further depending on
the symmetry of the crystal. The tensors in Voigt notation are given for cubic, orthorhombic/orthotropic,
monoclinic and triclinic in appendix I.

5.2.5

Calculating Elastic Constants for a Cubic Crystal

Cubic crystals are the most simple class with primitive unit cells having three orthonormal basis vectors. Four
of the most common variants of the cubic crystal are the simple cubic, body centered cubic, face centered
cubic and zincblende. Due to symmetry, a cubic crystal has only three elastic independent constants; in Voigt
notation these are 𝐶11 , 𝐶12 and 𝐶44 .
Applying two strains to a cubic crystal [108] coupled with the calculation of the bulk modulus, as already
discussed, allows the three independent elastic constants to be calculated.
First, the bulk modulus may be calculated either by finding the second derivative of the energy wrt volume at
the relaxed volume, 𝐵(𝑉 ) = −𝑉 𝑃 ′ (𝑉 ) = 𝑉 𝐸 ′′ (𝑉 )[108], or by fitting the Birch-Murnaghan equation of state.
⎡

𝛿

0

⎢
𝜖(𝐶11−𝐶22) = ⎣0

⎥
⎦
2
2
𝛿 /(1 − 𝛿 )

−𝛿

0

⎤

0

0

0

(5.17)

Second, a volume conserving orthorhombic strain (eq. 5.17) may be applied to the crystal [108]. The relation
between the relaxed energy and that under strain is symmetric about 𝐸(0) and is given by 𝐸(𝛿) = 𝐸(−𝛿) =
𝐸(0) + (𝐶11 − 𝐶12 )𝑉 𝛿 2 + 𝑂[𝛿 4 ][108]. 𝑉 is the volume of the relaxed unit cell and 𝐸(0) is the minimum energy.

By fitting a polynomial to the energy-strain data, the coefficient for the quadratic term is equal to (𝐶11 −𝐶12 )𝑉 .
⎡

0

⎢
𝜖(𝐶44) = ⎣ 2𝛿
0

𝛿
2

0

0

0

0

64

2

⎤
2

𝛿 /(4 − 𝛿 )

⎥
⎦

(5.18)

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.2. PROPERTIES OF CRYSTALS

Third, a volume conserving monoclinic strain (eq. 5.18) is applied and the relation between the relaxed energy,
strained energy and the elastic constant 𝐶44 is 𝐸(𝛿) = 𝐸(−𝛿) = 𝐸(0) + 12 𝐶44 𝑉 𝛿 2 + 𝑂[𝛿 4 ]. Similarly, fitting a
polynomial to the strain-energy data points will calculate the value of 𝐶44 .
Finally, the relation between the bulk modulus, 𝐶11 and 𝐶12 , 𝐵0 = (𝐶11 + 2𝐶12 )/3 allows the computation of
the individual constants eq. 5.19 (this relationship is only for cubic crystals).

𝐶𝑜𝑟𝑡ℎ𝑜 = 𝐶11 − 𝐶12
3𝐵0 + 2𝐶𝑜𝑟𝑡ℎ𝑜
3
3𝐵0 − 𝐶𝑜𝑟𝑡ℎ𝑜
=
3

𝐶11 =
𝐶12

5.2.6

(5.19)

Calculating Elastic Constants for Orthorhombic Crystal

The DFT work here includes Fe, Ru and Pd. Pure iron at room temperature is BCC, but this work is interested
in austenetic stainless steel where the structure of atoms in the alloy are FCC. When modelling FCC iron using
DFT with a non-polarized calculation, the crystal favours a cubic crystal with the atoms fixed in the FCC
positions. When a spin-polarized calculation is computed, with magnetization along the z-axis, the crystal
becomes slightly tetragonal with one side being 5% larger than the other two. This is a non-cubic crystal and
the approach by Mehl et al to compute elastic constants is not applicable.
⎡
𝐶11
⎢
⎢𝐶12
⎢
⎢𝐶
⎢ 12
𝐶𝑖𝑗 = ⎢
⎢ 0
⎢
⎢ 0
⎣
0

⎡
𝐶11
⎢
⎢𝐶12
⎢
⎢𝐶
⎢ 13
𝐶𝑖𝑗 = ⎢
⎢ 0
⎢
⎢ 0
⎣
0

𝐶12

𝐶12

0

0

𝐶11

𝐶12

0

0

𝐶12

𝐶11

0

0

0

0

𝐶44

0

0

0

0

𝐶44

0

0

0

0

0

⎤

⎥
0 ⎥
⎥
0 ⎥
⎥
⎥
0 ⎥
⎥
0 ⎥
⎦
𝐶44

(5.20)

(3 independent values)

𝐶12

𝐶13

0

0

𝐶22

𝐶23

0

0

𝐶23

𝐶33

0

0

0

0

𝐶44

0

0

0

0

𝐶55

0

0

0

0

0

⎤

⎥
0 ⎥
⎥
0 ⎥
⎥
⎥
0 ⎥
⎥
0 ⎥
⎦
𝐶66

(5.21)

(9 independent values)

Once the relaxed crystal basis vectors and atom positions have been determined for the orthorhombic crystal,
nine strains are applied to the crystal [109] in order to calculate the nine independent elastic constants.
As a strain is applied to a crystal its energy can change. The volume may also change, although it may be held
constant. The relationship between the energy and the strain 𝜎 may be represented as a Taylor expansion of
the internal energy in powers of the strain tensor[109]. The equation used by Ravindran et al is in a slightly
different notation to that used by Mehl[110]. It includes a constant 𝑥𝑖 to account for the symmetry of 𝜎 and
the use of Voigt notation.

65

5.2. PROPERTIES OF CRYSTALS

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

⎛

𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 ⎝

∑︁
𝑖

⎞
1 ∑︁
𝜏𝑖 𝜉𝑖 𝜎𝑖 +
𝑐𝑖𝑗 𝜎𝑖 𝜉𝑖 𝜎𝑗 𝜉𝑗 ⎠ + 𝑂(𝜎 3 )
2 𝑖𝑗

where 𝜎 is the strain

(5.22)

and 𝜏 is the stress
if the index 𝑘 of 𝜉 is ∈ 1, 2, 3 then 𝜉𝑘 = 1
if the index 𝑘 of 𝜉 is ∈ 4, 5, 6 then 𝜉𝑘 = 2
The first three strains applied to the orthorhombic crystal are non-volume conserving. They strain the crystal
along each axis and allow the calculation of 𝐶11 , 𝐶22 and 𝐶33 .
⎡
1+𝛿
⎢
𝐷1 = ⎣ 0

0
1

0

⎡
1
⎢
𝐷2 = ⎣0

0
1+𝛿

0

⎡
1
⎢
𝐷3 = ⎣0
0

0

0

0
1
0

⎤
0
⎥
0⎦
1

(5.23)

(︁
𝑐11 2 )︁
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 𝜏1 𝜎 +
𝜎
2

(5.24)

⎤
0
⎥
0⎦
1

(5.25)

(︁
𝑐22 2 )︁
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 𝜏2 𝜎 +
𝜎
2

(5.26)

(5.27)

(︁
𝑐33 2 )︁
𝜎
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 𝜏3 𝜎 +
2

(5.28)

0

⎤

⎥
0 ⎦
1+𝛿

Volume conserving monoclinic distortions (eq. 5.29, eq. 5.31, eq. 5.33) are used to calculate the 𝐶44 , 𝐶55 and
𝐶66 elastic constants (eq. 5.30, eq. 5.32, eq. 5.34).
⎡

⎢
⎢
𝐷4 = ⎢
⎣

⎡

⎢
⎢
𝐷5 = ⎢
⎣

⎡

1

0

0

0

1

𝜎

1
(1−𝜎 2 ) 3

0

1
(1−𝜎 2 ) 3

𝜎

1

(1−𝜎 2 ) 3

1
(1−𝜎 2 ) 3

1

1

(1−𝜎 2 ) 3

⎤
⎥
⎥
⎥
⎦

(︁
𝑐44 2 )︁
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 2𝜏4 𝜎 + 2
𝜎
2

(5.30)

(︁
𝑐55 2 )︁
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 2𝜏5 𝜎 + 2
𝜎
2

(5.32)

(5.29)

1

0

0

1

0

0

1

1
(1−𝜎 2 ) 3

𝜎

1
(1−𝜎 2 ) 3

1
(1−𝜎 2 ) 3

𝜎

1
(1−𝜎 2 ) 3

1
(1−𝜎 2 ) 3

⎤
⎥
⎥
⎥
⎦

(5.31)

1

1
(1−𝜎 2 ) 3

⎢
⎢ 𝜎
1
𝐷6 = ⎢
⎣ (1−𝜎2 ) 3
0

𝜎

0

1

0

0

1

1
(1−𝜎 2 ) 3
1
(1−𝜎 2 ) 3

⎤

1
(1−𝜎 2 ) 3

⎥
⎥
⎥
⎦

(︁
𝑐66 2 )︁
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 2𝜏6 𝜎 + 2
𝜎
2

(5.33)
66

(5.34)

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.2. PROPERTIES OF CRYSTALS

Finally, three orthorhombic strains (eq. 5.35, eq. 5.37, eq. 5.39) that conserve the volume, by altering the strain
along each axis, are used to calculate the 𝐶12 , 𝐶13 and 𝐶23 elastic constants (eq. 5.36, eq. 5.38, eq. 5.40).
⎡

⎢
⎢
𝐷7 = ⎢
⎣

⎡

⎢
⎢
𝐷8 = ⎢
⎣

⎡

⎢
⎢
𝐷9 = ⎢
⎣

5.2.7

1+𝜎

0

0

0

1−𝜎

0

1
(1−𝜎 2 ) 3

1
(1−𝜎 2 ) 3

0

⎤

1

0

1

(1−𝜎 2 ) 3

⎥
⎥
⎥
⎦

(︂
)︂
1
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 (𝜏1 − 𝜏 2𝜎 + (𝑐11 + 𝑐22 − 2𝑐12 )𝜎 2
2
(5.36)

(5.35)

1+𝜎

0

0

0

1

0

1
(1−𝜎 2 ) 3

0

1

(1−𝜎 2 ) 3

1−𝜎

0

⎤
1

(1−𝜎 2 ) 3

⎥
⎥
⎥
⎦

𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0

(︂

)︂
1
2
(𝜏1 − 𝜏 3𝜎 + (𝑐11 + 𝑐33 − 2𝑐13 )𝜎
2
(5.38)

𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0

(︂

)︂
1
2
(𝜏2 − 𝜏 3𝜎 + (𝑐22 + 𝑐33 − 2𝑐23 )𝜎
2
(5.40)

(5.37)

1

0

0

1+𝜎

1
(1−𝜎 2 ) 3

0

1

(1−𝜎 2 ) 3

0

⎤

0
0
1−𝜎

1

(1−𝜎 2 ) 3

⎥
⎥
⎥
⎦

(5.39)

Stability Conditions

Whilst the elastic constants may be computed using first-principles calculations, there are a series of assumptions
and approximations made in order to solve first-principles calculations in a reasonable amount of time. There
must be a sanity check, as it is no use to compute the elastic constants from DFT to find the crystals are
unstable.
For a cubic crystal with three independent elastic constants and zero stress, the Born elastic stability criteria
apply[111]. The bulk modulus should be positive (𝐶11 + 2𝐶12 )/3 > 0, the tetragonal shear should be positive
𝐶11 − 𝐶12 > 0 and the shear modulus should be positive 𝑐44 > 0.
For an orthorhombic crystal, there are additional conditions given there are nine independent elastic constants
(eq. 5.41)[112].

𝐶11 > 0, 𝐶22 > 0, 𝐶33 > 0, 𝐶44 > 0, 𝐶55 > 0, 𝐶66 > 0
(𝐶11 + 𝐶22 − 2𝐶12 ) > 0, (𝐶11 + 𝐶33 − 2𝐶13 ) > 0, (𝐶22 + 𝐶33 − 2𝐶23 ) > 0

(5.41)

(𝐶11 + 𝐶22 + 𝐶33 + 2𝐶12 + 2𝐶13 + 2𝐶23) > 0

5.2.8

Computing Values from Elastic Constants

The bulk modulus, as noted earlier, is a measure of the effect of strain on stress. While it may be calculated by
taking the second derivative of energy with respect to volume, or by fitting an equation of state, it may also be
calculated using the elastic constants of a material or the compliance constants.
For cubic crystals the elastic constants may be used to calculate the bulk modulus, tetragonal shear, shear
modulus and Cauchy pressure (eq. 5.42).
67

5.2. PROPERTIES OF CRYSTALS

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

𝐵0 =

𝐶11 + 2𝐶12
5𝐶11
=
Bulk Modulus
3
9
𝐶11 − 𝐶12
𝐶′ =
Tetragonal Shear
2
𝐶44 Shear Modulus

(5.42)

𝑝𝑐 = 𝐶12 − 𝐶44 Cauchy Pressure
For an orthorhombic crystal, the Voigt bulk modulus (eq. 5.43) and Reuss bulk modulus (eq. 5.44) may be
calculated from the stiffness and compliance matrix respectively. These two values are then averaged to give
the bulk modulus (eq. 5.45)[109].

𝐵𝑉 =

1
(𝐶11 + 𝐶22 + 𝐶33 + 2(𝐶12 + 𝐶13 + 𝐶23 ))
9

−1

𝐵𝑅 = (𝑆11 + 𝑆22 + 𝑆33 + 2(𝑆12 + 𝑆13 + 𝑆23 ))

(5.43)

(5.44)

(5.45)

𝐵 = 0.5(𝐵𝑉 + 𝐵𝑅 )

Calculation by this method is particularly useful for this work, where the FCC iron crystal is orthorhombic,
and not cubic (section 7.3.4).
Elastic constants are also used to calculate the shear modulus 𝐺. Where the crystal is cubic, there are several
elastic constants that can be used (eq. 5.46)[109]. Both the Voigt (eq. 5.47) and Reuss (eq. 5.47) values are
calculated and averaged to give the value of 𝐺 (eq. 5.49).

𝐺 = 𝐶44 = 0.5(𝐶11 − 𝐶12 ) =

𝐶11
3

(5.46)

𝐺𝑉 =

1
1
(𝐶11 + 𝐶22 + 𝐶33 − 𝐶12 − 𝐶13 − 𝐶23 ) + (𝐶44 + 𝐶44 + 𝐶55 )
15
5

(5.47)

𝐺𝑅 =

15
4 (𝑆11 + 𝑆22 + 𝑆33 ) − 4 (𝑆12 + 𝑆23 + 𝑆23 ) + 3 (𝑆44 + 𝑆55 + 𝑆66 )

(5.48)

𝐺 = 0.5(𝐺𝑉 + 𝐺𝑅 )

(5.49)

The Young’s modulus 𝐸 as a scalar is a measure of how easily the length an isotropic material is changed under
tension or compression, and the computed elastic constants for a cubic crystal may be used to calculate 𝐸 (eq.
5.50).
68

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

𝐸=

5.2. PROPERTIES OF CRYSTALS

9𝐵0 𝐺
where 𝐵0 is the bulk modulusand 𝐺 is the shear modulus
3𝐵0 + 𝐺

(5.50)

The Poisson ration is a measure of how much a material changes in the direction perpendicular to a strain
applied transversely.

𝜈=−

𝑑𝜖𝑝𝑒𝑟𝑝

(5.51)

𝑑𝜖𝑡𝑟𝑎𝑛𝑠𝑣𝑒𝑟𝑠𝑒

The bulk modulus may be calculated from the equation of state or elastic constants, and the shear modulus
may be calculated from the elastic constants. In turn, the Poisson ratio is calculated from these.

𝜈=

3𝐵0 − 2𝐺
2(3𝐵 + 𝐺)

(5.52)

The ratio may be used as another data point in order to fit a potential, or at the very least as a check to
compare to the known value once a potential has been derived.

5.2.9

Correlation of Melting Temperature in Metals with Elastic Constants

There is a correlation between the melting temperature of metals and their elastic constants detailed in eq. 5.53
and fig. 5.3) [113].

𝑇 ≈ 598.0 + 6.66 × (𝐶11 + 𝐶22 + 𝐶33 ) − 0.003 × (𝐶11 + 𝐶22 + 𝐶33 )
Where the temperature is in K, and the elastic constants are in GPA

Correlation between C11 and Melting Point
4000

Temperature (K)

3500
3000
2500
2000
1500
1000
500
0

100

200

300

C11 (GPA)

400

500

600

Figure 5.3: Correlation between 𝐶11 and temperature

69

(5.53)

5.3. CHOICE OF FUNCTION

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

The correlation values between the temperature and 𝐶11 are 0.848 and 0.780 for the Pearsons and Spearmans
correlation respectively. An accurate temperature will not be possible to predict, but it will act as a further
sanity check within the computer codes developed in the results section of this work.

5.3
5.3.1

Interatomic Potentials and Choice of Function
Introduction

An interatomic potential, as used in this work and MD computer codes, is a function or a set of functions that
describe the energy and force between atoms. Simpler functions represent the potential energy between pairs
of atoms only, but more complicated functions have been used in molecular dynamics since the 1980s that also
attempt to represent the many body nature of materials, which applies in particular to metals.

5.3.2

Pair Potentials

A pair potential only considers individual pairs of nearby atoms, one pair at a time, and does not consider the
effect of any other nearby atoms. Where an alloy is being modelled, there will be a pair potential function for
each element and element combination; 1 for a single element, 3 for a two element alloy, 6 for a three element
alloy and so on.
Lennard-Jones
The Lennard-Jones potential, figure 5.4, was proposed in the 1920s and has both an attractive term and a
repulsive term; the (𝑟𝑚 /𝑟)12 becomes much larger than the (𝑟𝑚 /𝑟)6 term at close distances, and this mimics
the coulomb repulsion as two atoms are pushed closer together. At larger separations, the attractive term
dominates.

𝑉 (𝑟) = 𝑒

(︂(︁

(︁ 𝑟 )︁6
𝑟𝑚 )︁12
𝑚
−2
𝑟
𝑟

)︂

(5.54)

Lennard-Jones Potential
potential
repulsion
attraction
gradient

4

Energ (eV)

2

0

−2

−4
1

2

3

4

Radius (angs)

5

6

Figure 5.4: Lennard-Jones Potential

70

7

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.3. CHOICE OF FUNCTION

Morse Potential
The Morse potential, figure 5.5, was proposed five years after the Lennard-Jones potential. It also has an
attractive and repulsive term, but it uses the exponential function rather than 6th and 12th powers.

(5.55)

𝑉 (𝑟) = exp(−2𝑎(𝑟 − 𝑟𝑒)) − 2 exp(−𝑎(𝑟 − 𝑟𝑒))

Morse Potential
potential
repulsion
attraction
gradient

4

Energy (eV)

2

0

−2

−4
0

1

2

3

4

Radius (angs)

5

6

7

Figure 5.5: Morse Potential

Buckingham Potential
The Buckingham Potential consists of a repulsive and attractive part. As the separation decreases, the attractive
term dominates and the overall functions tends towards negative infinity. This shouldn’t be problematic when
gasses or solids are being modelled alone, but when collisions and damage cascades are being modelled, the
separation between atoms may be much smaller than that in a typical simulation, ending with these atoms
being pulled together (eq. 5.56 and figure 5.6).

𝑉 (𝑟) = 𝐴 exp(−𝐵𝑟) −

71

𝐶
𝑟6

(5.56)

5.3. CHOICE OF FUNCTION

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

B ckingham Potential
potential
rep lsion
attraction
gradient

4

Energy (eV)

2

0

−2

−4

0

1

2

3

4

Radius (angs)

5

6

7

Figure 5.6: Buckingham Potential

Ziegler-Biersack-Littmark Universal Potential Function
It became clear, while experimenting with a number of existing potentials and MD programs, that at the very
least modifications to those potentials would need to be made for small atom separations. A simulation to
model a projectile failed early on due to the projectile’s proximity to target atoms, resulting in the MD code
returning an error as the separation was out of the range of the potential.
The Ziegler-Biersack-Littmark potential, between an atom of charge 𝑍𝑖 and 𝑍𝑗 is set out in the SRIM manual[97].

1 𝑍𝑖 𝑍𝑗
𝑉𝑧𝑏𝑙 (𝑟𝑖𝑗 , 𝑍𝑖 , 𝑍𝑗 ) =
𝜑
4𝜋𝜖0 𝑟𝑖𝑗

(︂

𝑟𝑖𝑗
𝑎𝑖𝑗

)︂

(5.57)

−12

where 𝜖0 = 8.85419 × 10

The parameters of the Universal screening potential function are as follows:

𝜑(𝑥) = 0.181𝑒−3.2𝑥 + 0.5099𝑒−0.9423𝑥 + 0.2802𝑒−0.4029𝑥 + 0.02817𝑒−0.2016𝑥
0.8854𝑎0
where 𝑎𝑖𝑗 = 0.23
𝑍𝑖 + 𝑍𝑗0.23
and 𝑎0 = 0.529 angstrom

72

(5.58)

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.3. CHOICE OF FUNCTION

ZBL
potential
gradient

4

Energy (eV)

2

0

−2

−4
0

1

2

3

4

5

Radius (angs)

6

7

Figure 5.7: ZBL universal screening potential

5.3.3

Many Body Potentials

This work is focused on metals, and two popular, and closely related potentials, will be discussed in this section.
Finnis-Sinclair
The Finnis-Sinclair potential was published in 1984[114] and it introduced both a pair potential and an embedded
term to take into account the cohesive energy dependent on the local electron density. The pair term represents
the repulsion between the atoms whereas the embedding functional glues the atoms together in the solid.
The tight-binding that this potential is based on is represented by the functional: square root of the density.
The potential for a single element model consists of a pair function, a density funstion and a tight-binding
functional.

𝑢𝐴,𝐴 =

𝑁
∑︁

(𝑟)𝑣 𝐴,𝐴 (𝑟𝑖,𝑗 )

𝑖̸=𝑗

𝜌𝐴
𝑖 (𝑟) =

𝑁
∑︁

𝜑(𝑟𝑖𝑗 )

(5.59)

𝑗,𝑗̸=𝑖

𝐹

𝐴

=

𝑁
∑︁

𝜌𝑖

𝑖

Embedded-atom method
The embedded-atom method was also invented in the 1980s by Daw and Baskes. It was developed with metals
in mind, and in many ways is a more flexible variant of the Finnis-Sinclair potential. It too has a pair and
density function, but the functional of the EAM potential is not restricted to a square root.

73

5.3. CHOICE OF FUNCTION

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

𝑈𝐸𝐴𝑀 =

𝑁 𝑁
𝑁
∑︁
1 ∑︁ ∑︁
𝑉𝑖𝑗 (𝑟𝑖𝑗 ) +
𝐹 [𝜌𝑖 ]
2 𝑖=1
𝑖=1
𝑗̸=𝑖

𝑁
∑︁

where 𝜌𝑖 =

(5.60)

𝜌𝑖𝑗 (𝑟𝑖𝑗 )

𝑗=𝑖,𝑗̸=𝑖

Elastic properties were not reliably calculated from pair functions alone[115], but the advent of Finnis-Sinclair
and EAM type potentials changed this.

𝐴𝑖𝑗 + 𝐹 ′ (⃗
𝜌)𝑉𝑖𝑗 = 0
where
1 ∑︁ ′ 𝑚 𝑚 𝑚
𝜑 𝑎 𝑎 /𝑎
𝐴𝑖𝑗 =
2 𝑚 𝑚 𝑖 𝑗
1 ∑︁ ′ 𝑚 𝑚 𝑚
𝜌 𝑎 𝑎 /𝑎
𝑉𝑖𝑗 =
2 𝑚 𝑚 𝑖 𝑗

(5.61)

For homonuclear cubic crystals, the lattice constant may be calculated by the equilibrium condition in eq 5.61.
The three independent elastic constants, 𝐶11 , 𝐶12 , 𝐶44 , may also be calculated at equilibrium from eq 5.62.

(︀
)︀
𝐶11 = 𝐵11 + 𝐹 ′ (⃗
𝜌)𝑊11 + 𝐹 ′′ (⃗
𝜌)(𝑉11 )2 /Ω0
(︀
)︀
𝐶12 = 𝐵12 + 𝐹 ′ (⃗
𝜌)𝑊12 + 𝐹 ′′ (⃗
𝜌)(𝑉11 )2 /Ω0

𝐶44 = (𝐵12 + 𝐹 ′ (⃗
𝜌)𝑊12 ) /Ω0
where

𝐵𝑖𝑗𝑘𝑙 =
𝑊𝑖𝑗𝑘𝑙

1 ∑︁

2

𝑚

𝑚 𝑚 𝑚
𝑚 2
(𝜑′′𝑚 − 𝜑′𝑚 /𝑎𝑚 ) 𝑎𝑚
𝑖 𝑎𝑗 𝑎𝑘 𝑎𝑙 /(𝑎 )

(5.62)

1 ∑︁ ′′
𝑚 𝑚 𝑚
𝑚 2
=
(𝜌 − 𝜌′𝑚 /𝑎𝑚 ) 𝑎𝑚
𝑖 𝑎𝑗 𝑎𝑘 𝑎𝑙 /(𝑎 )
2 𝑚 𝑚
𝜑′′𝑚
𝜌′′𝑚

(︀

2

2

where
)︀

= 𝑑 𝜑(𝑟)/𝑑𝑟 𝑟=𝑎𝑚 ,
(︀
)︀
= 𝑑2 𝜑(𝑟)/𝑑𝑟2 𝑟=𝑎𝑚 .

There are notable consequences in removing either the pair function or embedding functional. If 𝑉𝑖𝑗 (𝑟𝑖𝑗 ) is
removed, 𝐹 ′ [⃗
𝜌] = 0 and this gives a shear modulus of 0 (𝐶11 = 𝐶12 , 𝐶44 = 0)[115]. If 𝐹 [⃗
𝜌] is removed the
Cauchy discrepancy becomes zero (𝐶12 = 𝐶44 )[115]. Both of these situations are generally untrue, and both
functions are required for a good potential for a metal.
Two band embedded-atom method
There are several variations of the potential, and one of particular interest to us is the two band embedded-atom
method that has two electron density and embedding energy terms. This formalism was originally developed to
model Cs[116], and the transition of electrons between S and D bands under pressure, but it has been modified
to apply to alloys.
Cs changes its structure as pressure is applied. The first change is from BCC to a more compact FCC structure,
but it then compresses further as electrons move from the S-band to the more compact D-band, reducing the
74

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.3. CHOICE OF FUNCTION

size of the atom.
The bond energy may be described with eq. 5.63 where 𝑁1 and 𝑁2 are the capacities of each band, 𝑛𝑖1 and 𝑛𝑖2
are the electrons in each band of the 𝑖th atom. 𝐸𝑝𝑟𝑜𝑚 is the energy required to promote an electron from band
1 to band 2.

𝑈𝑏𝑜𝑛𝑑 =

∑︁ 𝑊𝑖2
∑︁ 𝑊𝑖1
𝑛𝑖1 (𝑛𝑖1 − 𝑁1 ) +
𝑛𝑖2 (𝑛𝑖2 − 𝑁2 ) + 𝐸𝑝𝑟𝑜𝑚
2𝑁1
2𝑁2
𝑖
𝑖

(5.63)

A Finnis-Sinclair type EAM potential was used by Ackland and Reed in this work for both bands. The
parameters fitted in Ackland and Reed’s work are listed in table 5.3.

Pair
∑︁ 𝐴𝑠
𝑉𝑠 (𝑟𝑖𝑗) =
12
𝑟𝑖𝑗
𝑖
∑︁ 𝐴𝑑
𝑉𝑑 (𝑟𝑖𝑗) =
12
𝑟𝑖𝑗
𝑖

𝜌𝑠 (𝑟𝑖𝑗) =

{︃
𝐶𝑠 (𝑑𝑠 − 𝑟𝑖𝑗 )3
0

𝑟𝑖𝑗 < 𝑑𝑠
𝑟𝑖𝑗 > 𝑑𝑠

𝜌𝑑 (𝑟𝑖𝑗) =

(5.64)

{︃
𝐶𝑑 (𝑑𝑑 − 𝑟𝑖𝑗 )3
0

Density
𝑟𝑖𝑗 < 𝑑𝑑
𝑟𝑖𝑗 > 𝑑𝑑

Embedding

Parameter

Value

𝐶𝑠
𝐶𝑑
𝑑𝑠
𝑑𝑑
𝐴𝑠
𝐴𝑑

0.05617𝑒𝑉 2 angs−3
0.1681𝑒𝑉 2 angs−3
9.5097angs
6.9189angs
2.417 × 107 angs12
3.7668 × 106 angs12

(5.65)

(5.66)

Table 5.3: Caesium 2BEAM parameters

The implementation of this two-band potential predicted the transformation of Cs. The I phase, at ambient
pressure, is BCC Cs with a primitive cell volume of 115.9 cubic angstrom per atom. As more pressure is added,
the optimum structure changes from BCC to FCC, and this results in a smaller volume per atom of 67.5 cubic
angstrom. Finally Cs undergoes an isostructural transformation, and the potential predicts a volume of 48.7
cubic angstrom per atom.
There is a transition pressure of 4.3 GPa between the phases II and III. The potentials developed by Ackland
and Reed were “in good agreement with experiment”[116].
An alloy version of the two-band model was developed by Olsson et al. to investigate the 𝛼-prime phase
formation in Fe-Cr[117]. Fe-Cr alloys form ferromagnetic alloys with concentrations of up to 10% chromium at
750∘ 𝐶. As the concentration of chromium in the alloy increases, the alloy begins to decompose into iron rich
and chromium rich precipitates, and this decomposition is accelerated under irradiation.

75

5.3. CHOICE OF FUNCTION

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

The two-band method for Cs was extended to an Fe-Cr alloy in order to describe the heat of mixing in the alloy.

𝑈𝐸𝐴𝑀 =

𝑁 𝑁
𝑁
𝑁
∑︁
∑︁
1 ∑︁ ∑︁
𝑉𝑖𝑗 (𝑟𝑖𝑗 ) +
𝐹𝐷 [𝜌𝑑,𝑖 ] +
𝐹𝑆 [𝜌𝑠,𝑖 ]
2 𝑖=1
𝑖=1
𝑖=1
𝑗̸=𝑖

where 𝜌𝑑,𝑖 =

𝑁
∑︁

𝜌𝑑,𝑖𝑗 (𝑟𝑖𝑗 ) and 𝜌𝑠,𝑖 =

𝑗=𝑖,𝑗̸=𝑖

𝑁
∑︁

(5.67)

𝜌𝑠,𝑖𝑗 (𝑟𝑖𝑗 )

𝑗=𝑖,𝑗̸=𝑖

The embedding functional (eq. 5.71) was in the form of several functionals used in papers by Ackland and
Mendelev, and an extension to the standard Finnis-Sinclair.

√
𝜌𝑏𝑎𝑛𝑑 + 𝐴𝑏𝑎𝑛𝑑
𝜌𝑏𝑎𝑛𝑑 2 + 𝐴𝑏𝑎𝑛𝑑
𝜌𝑏𝑎𝑛𝑑 4
𝐹𝑏𝑎𝑛𝑑 (𝜌𝑏𝑎𝑛𝑑 ) = 𝐴𝑏𝑎𝑛𝑑
2
3
1

(5.68)

The choice of function for both the pair and d-band density functions was a cubic spline, and a 4s Slater
type function was used for the s-band alloy density. The Fe-Fe and Cr-Cr s-band density functions were zero
functions. Where the alloy has high concentrations of Iron or Chromium, the respective d-band density functions
will dominate, but as the elements mix, the s-band density will also contribute.

𝑉 (𝑟) =

∑︁
𝑖

𝜑𝐶𝑟𝐶𝑟
(𝑟) =
𝑑

𝑎𝑖 (𝑟 − 𝑟𝑖 )3 𝐻(𝑟𝑖 − 𝑟)where H is the Heaviside Step function

∑︁
𝑘

𝑏𝑖 (𝑟 − 𝑟𝑘 )3 𝐻(𝑟𝑘 − 𝑟)where H is the Heaviside Step function

(5.69)

(5.70)

𝑒𝐶𝑟
𝜑𝐹
(𝑟) = (𝐻𝑠 𝑟3 exp(−𝜉𝑠 𝑟))2
𝑠
𝑒𝐹 𝑒
𝜑𝐹
(𝑟) = 0.0
𝑠

𝜑𝐶𝑟𝐶𝑟
(𝑟)
𝑠

(5.71)

= 0.0

The resulting potential, with the s-density fitted to the mixing enthalpy of Fe and Cr, reproduces the formation
of 𝛼-prime phase Cr with thermal ageing over a range of Cr concentrations.
The Fe-Cr potentials were further developed by Bonny et al. The mixing enthalpy changes sign in Fe-Cr, having
a positive mixing enthalpy for Cr concentrations above 10% and a negative mixing enthalpy below. This results
in the solubility of Cr in the alloy at lower concentrations, but as the concentration rises there’s a tendency for
Cr to form 𝛼-prime precipitates[118].
In the work by Bonny et al, the base Iron and Chromium potentials were those developed by Mendelev and
Ackland, and from the Fe-Cr potentials of Olsson and Wallenius. In total, 11 functions make up the Bonny et
al potential, higher than the usual 7 functions required for a two species EAM. In a standard EAM potential,
the density contribution from an atom of one species is only dependent on that contributing atom, and not the
embedded atom. This potential splits the density function into multiple bands and multiple permutations of
atom species.

76

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.3. CHOICE OF FUNCTION

𝜌𝑑𝐴𝐴 (𝑟) = 𝜌𝑑𝐵𝐴 = 𝜌𝑑𝐴
𝜌𝑑𝐵𝐵 (𝑟) = 𝜌𝑑𝐴𝐵 = 𝜌𝑑𝐵

(5.72)

𝜌𝑠𝐴𝐵 (𝑟) = 𝜌𝑠𝐵𝐴
𝜌𝑠𝐴𝐴 (𝑟) = 𝜌𝑠𝐵𝐵 = 0

The chosen s-band density function for the Bonny et al Fe-Cr alloy was selected as an exponential style function
with a cut-off function.

𝜌𝑠𝐹 𝑒𝐶𝑟 (𝑟) = 𝑘𝑟6 exp(−2𝜉𝑟)𝑔𝑐𝑢𝑡 (𝑟)

⎧
⎪
1
⎨ (︀
)︀
1
𝑚
𝑔𝑐𝑢𝑡 (𝑟) = 2 1 − 𝑠𝑖𝑛( 𝜋2 𝑟−𝑟
)
𝑑
⎪
⎩
0

(5.73)

𝑟 <= 𝑟𝑐𝑖
𝑟𝑐𝑖 < 𝑟 < 𝑟𝑐𝑓
𝑟𝑐𝑟

(5.74)

<𝑟

√
𝐹 𝑠 (𝜌) = 𝐴1 𝜌 + 𝐴2 𝜌2

(5.75)

The magnetic properties of Cr were considered during the development of these potentials. First-Principles
calculations are equivalent to calculating properties at 0K, and at this temperature Cr is antiferromagnetic.
The Neel temperature for Cr, the point at which it transitions from an antiferromagnetic to a paramagnet, is
310K. The operating temperature of the alloys, within a reactor, will be above the Neel temperature. Cr has a
positive Cauchy pressure as a paramagnet, and a negative Cauchy pressure under the Neel temperature when
an antiferromagnetic, and as a result of this and the operating temperature, a positive Cauchy pressure was
used to fit the potential.
Modified embedded-atom method
All the potential types considered so far are spherically symmetrical about the atom. Typically covalent bonds
tend to be directional but metallic bonds, in contrast, are isotropic about each atom. However, in alloys and
magnetic materials where the system is not isotropic, the modified embedded atom method may be used.

𝑁

𝑈𝑀 𝐸𝐴𝑀,𝑖 =

1 ∑︁
𝑉𝑖𝑗 (𝑟𝑖𝑗 ) + 𝐹𝑖 (⃗
𝜌𝑖 )
2

(5.76)

𝑗̸=𝑖

The original form for the embedding functional is given below (eq. 5.77)[119].

𝜌
⃗
𝐹 (⃗
𝜌) = 𝐴𝐸𝑐𝑜ℎ 𝑙𝑛
⃗
𝜌0

(︃

𝜌
⃗
⃗
𝜌0

)︃

(5.77)

The electron density is made from four contributing functions. The first, 𝜌0 , is not dependent on direction, but
𝜌1 , 𝜌2 and 𝜌3 are dependent on the angle.
77

5.3. CHOICE OF FUNCTION

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

𝜌0 =
1 2

(𝜌 ) =
(︃
∑︁ ∑︁

(︃
∑︁ ∑︁
𝛼

)︃2

𝑁
∑︁

𝜌0𝑖 (𝑟𝑖 )

𝑖

𝑟𝑖
𝜌1𝑖 (𝑟𝑖 ) 𝛼𝑖

𝑖

𝑟

(︃
1 ∑︁

)︃2

)︃2
𝑟𝛽𝑖
2 𝑖
(𝜌 ) =
−
𝜌𝑖 (𝑟 )
𝑟 𝑟𝑖
3
𝛼
𝑖
𝑖
)︃2
(︃
)︃
(︃
𝑖 𝑟𝑖 𝑟𝑖
∑︁ ∑︁
3 ∑︁ 𝑟𝛼𝑖 3 𝑖
2 2
2 𝑖 𝑟𝛼 𝛽 𝛾
−
𝜌 (𝑟 )
(𝜌 ) =
𝜌𝑖 (𝑟 ) 𝑖 𝑖 𝑖
𝑟 𝑟 𝑟
5
𝑟𝑖 𝑖
𝛼
𝛼
𝑖
2 2

𝑟𝑖
𝜌2𝑖 (𝑟𝑖 ) 𝛼𝑖

(5.78)

The partial electron densities may be combined as is eq. 5.79[119].

(0)

𝜌
⃗ 𝑖 = 𝜌𝑖
Γ𝑖 =

· 2/(1 + exp(−Γ𝑖 )

3
∑︁

ℎ=1

[︁
]︁2
(ℎ)
(0)
𝑡(ℎ) 𝜌𝑖 /𝜌𝑖

(5.79)

(︁
)︁
𝜌𝑎(ℎ) (𝑅) = exp −𝛽 (ℎ) (𝑅/𝑟𝑒 − 1)
This form of potential is implemented in LAMMPS and other molecular dynamics codes. It is more applicable
to materials with bonds that depend on their angle, but it may have useful applications to metals where this is
not as pronounced (if at all).

5.3.4

Function Types used by EAM and Two-Band EAM

In previous work, their are a wide range of functions used to represent the pair potential, density and embedding
functional. These range from those that preserve and attempt to replicate the physics, to those that do away
with knowledge of the physics underlying the potentials altogether. The pair potentials already covered here
may also be used as the pair function component of the EAM or Two-Band EAM potentials.
A full list of the functions considered and included in the potential fitting code that resulted from this work is
included in appendix R. Only polynomial splines will be discussed further here.
Polynomial Splines
The form of polynomial spline used in the literature is a sum of N cubic polynomials that, by way of the
Heaviside step function and their form, cutoff neatly at the desired radius. The cutoff radii are fixed and,
during the fit of a potential, just the coefficients of each cubic spline are varied (eq. 7.1).

𝑉 (𝑟) =

𝑁
∑︁
𝑖

𝑎𝑖 (𝑟 − 𝑟𝑖 )3 𝐻(𝑟𝑖 − 𝑟)

𝐻(𝑥) =

{︃

where
0

𝑥<0

1

𝑥 >= 0

(5.80)

If a continuous second derivative is required the cubic spline may be replaced with a quintic spline (eq. 5.81).
78

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

𝑉 (𝑟) =

𝑁
∑︁
𝑖

5.3. CHOICE OF FUNCTION

𝑎𝑖 (𝑟 − 𝑟𝑖 )5 𝐻(𝑟𝑖 − 𝑟)

(5.81)

Polynomial Knot to Knot Splines
So far, analytic potentials have been discussed. There are existing potentials that do not have an analytic form,
but are tabulated data that have the properties that they are continuous and have a continuous first derivatives.
In attempting to fit or re-fit tabulated data, it would be problematic to adjust each data point individually given
the number of data points and the requirement to have a continuous well behaved function with continuous first
derivatives.

Knot to Knot Spline
potential
knots
nodes for interpolation

8

Energy (eV)

6

4

2

0
1

2

3

4

Radius (angs)

5

6

7

Figure 5.8: Polynomial knot to knot spline

The tabulated function is divided into sections, and the start and end of each section forms the knot of the
spline. A polynomial may be splined between these knots, as shown in figure 5.8, but the order of polynomial
will depend on the data available. Immediately, the x and y positions are known: 𝑥𝑎 , 𝑥𝑏 , 𝑓 (𝑥𝑎 ), 𝑓 (𝑥𝑏 ). A first
order polynomial has two unknowns, and so these unknowns may be calculated using linear algebra.

𝑐0 + 𝑐1 𝑥𝑎 = 𝑦𝑎
𝑐0 + 𝑐1 𝑥 𝑏 = 𝑦 𝑏

(5.82)

One of the requirements for the potential is to have a continuous first derivative, and this requires knowledge
of the first derivative at each knot. In the figure, the knots are shown as circles. By taking several points near
to each knot, shown as squares, the derivative at each knot may be calculated by interpolation. This allows a
third order polynomial to be used (eq. 5.83).

79

5.3. CHOICE OF FUNCTION

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

𝑃1 = (𝑥𝐴 , 𝑓 (𝑥𝐴 ))
𝑃2 = (𝑥𝐴 , 𝑓 ′ (𝑥𝐴 ))

(5.83)

𝑃3 = (𝑥𝐵 , 𝑓 (𝑥𝐵 ))
𝑃4 = (𝑥𝐵 , 𝑓 ′ (𝑥𝐵 ))

𝑐0 + 𝑐1 𝑥𝑎 + 𝑐2 𝑥2𝑎 + 𝑐3 𝑥3𝑎 = 𝑦𝑎
0 + 𝑐1 + 2𝑐2 𝑥𝑎 + 3𝑐3 𝑥2𝑎 = 𝑦𝑎′

(5.84)

𝑐0 + 𝑐1 𝑥𝑏 + 𝑐2 𝑥2𝑏 + 𝑐3 𝑥3𝑏 = 𝑦𝑏
0 + 𝑐1 + 2𝑐2 𝑥𝑏 + 3𝑐3 𝑥2𝑏 = 𝑦𝑏′
Rewriting as matrices:
⎡
1
⎢
⎢0
⎢
⎢1
⎣
0

𝑥𝑎

𝑥𝑎 2

1

2𝑥𝑎

𝑥𝑏

𝑥𝑏 2

1

2𝑥𝑏

⎤
⎤⎡ ⎤ ⎡
𝑐0
𝑓 (𝑥𝑎 )
⎥
⎥⎢ ⎥ ⎢ ′
⎢ ⎥ ⎢
⎥
3𝑥𝑎 2 ⎥
⎥ ⎢𝑐1 ⎥ = ⎢𝑓 (𝑥𝑎 )⎥
⎢
3 ⎥⎢ ⎥
𝑥𝑏 ⎦ ⎣𝑐2 ⎦ ⎣ 𝑓 (𝑥𝑏 ) ⎥
⎦
𝑐3
𝑓 ′ (𝑥𝑏 )
3𝑥𝑏 2
𝑥𝑎 3

(5.85)

It is important for the function and its derivative to be continuous. If it is also deemed necessary to have a
continuous second derivative, a quintic spline may be used. By interpolating and calculating the second order
derivative at each knot, a 5th order polynomial may be splined between pairs of knots.
This approach may be modified to spline functions of the form exp(𝑝(𝑟)) between knots, and this is useful for
splining between a ZBL or similar repulsive function at small r and a function of a different form at larger r.

𝑉 (𝑟) =

⎧
⎪
𝑍𝐵𝐿(𝑟, 𝑞1 , 𝑞2 )
⎪
⎪
⎪
⎨exp(︀𝑎 + 𝑏𝑟 + 𝑐𝑟2 + 𝑑𝑟3 )︀
⎪
⎪
⎪
⎪
⎩

where
𝑟 <= 𝑟𝑎
𝑟𝑎 < 𝑟 < 𝑟𝑏

𝑣(𝑟)

𝑟𝑏 < 𝑟 < 𝑟𝑐𝑢𝑡

0

𝑟 >= 𝑟𝑐𝑢𝑡

(5.86)

To spline the exponential the equations are set up in a similar way, but this time the system of equations are
non-linear.

(︀
)︀
exp 𝑐0 + 𝑐1 𝑥𝑎 + 𝑐2 𝑥2𝑎 + 𝑐3 𝑥3𝑎 = 𝑦𝑎
(︀
)︀
(𝑐1 + 2𝑐2 𝑥𝑎 + 3𝑐3 𝑥2𝑎 ) exp 𝑐0 + 𝑐1 𝑥𝑎 + 𝑐2 𝑥2𝑎 + 𝑐3 𝑥3𝑎 = 𝑦𝑎′
(︀
)︀
exp 𝑐0 + 𝑐1 𝑥𝑏 + 𝑐2 𝑥2𝑏 + 𝑐3 𝑥3𝑏 = 𝑦𝑏
(︀
)︀
(𝑐1 + 2𝑐2 𝑥𝑏 + 3𝑐3 𝑥2𝑏 ) exp 𝑐0 + 𝑐1 𝑥𝑏 + 𝑐2 𝑥2𝑏 + 𝑐3 𝑥3𝑏 = 𝑦𝑏′

(5.87)

Newton-Gauss is used to solve this problem where initial parameters are set for the constants in the equation
and varying until the function values and derivatives at point A and point B match the values being fitted to.

80

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.4. EAM POTENTIAL FITTING

Tending to Zero at the Cutoff Radius
It is desirable for the functions to be well behaved and continuous. The coulomb force between two charged
particles reduces smoothly until theoretically at an infinite separation; it doesn’t reach a set separation and
abruptly drop to zero. It is impossible and unhelpful to consider a very large or infinite separation which is
why the cutoff radius has been introduced. It represents the separation where the potential has reached zero;
at the very least it’s a trade off between accuracy and the computing time available for the problem.
The pair potential should therefore drop off to 0 at the cut off radius, and be equal to zero for larger separations.
The electron density spherically around an atom should also smoothly drop off to zero, and similarly it should
be equal to zero for distances larger than the cut off. The embedding energy is dependent on the density at the
location of the atom embedded. The embedding function will not necessarily drop off to zero, and it depends
on the density and not the separation.
In a MD simulation, the neighbour list will usually be built considering atoms slightly more separated than the
cut off radius of the functions. This allows the same neighbour list to be used for several time steps, before the
need to update as atoms will get closer and further apart with each time step.
Collisions and Interatomic Potentials
In a simulation at room temperature the average energy of the atoms in the simulation are approximately
0.05eV, and at temperatures near the melting point of iron the energy is approximately 0.2eV. These are energy
ranges that interatomic potentials are designed to operate in, but in typical damage cascades in nuclear core
components the atoms in the cascade, including the PKAs, have energies up to approximately 100keV.
If a potential is not designed for use in collision simulations, it may not contain the data points required for such
close separations. If a potential, such as the Buckingham potential (section 5.3.2), is used, the energy peaks at
a certain separation and then drops once more. The would cause colliding atoms to stick to one another once
they reached a certain separation.
The ZBL function is designed specifically with collisions in mind and should be used in MD simulations that
involve collisions. In simulations of BCC tungsten[120], the material had an initial temperature of 10K and
523K with PKAs energies at 10keV, 20keV and 50keV. The models were simulated with MOLDY using an EAM
potential where the pair potential is splined to a ZBL for short range interactions.

5.4
5.4.1

EAM Potential Fitting
Sacrificing Physical Elegance

We have no knowledge of a formula that can be applied to any material and describe the energy and forces
between atoms exactly. Even first principles calculations rely on approximations, and the knowledge of an exact
exchange functional eludes us. While it would be satisfying to derive a potential that reflects the fundamental
physics, it may be something that is forever out of our reach.
It is more useful to develop a potential that replicates the properties of a material such as the relaxed lattice
parameter, cohesive energy and elastic constants. The ZBL potential is an approximation to the repulsion
between ions and is an appropriate potential to use to model high energy collisions, but not the bulk material.
The Finnis-Sinclair are rooted in the second moment approximation of tight-binding theory and has been used
to model metals.
Alternative potentials functions that lose physical significance may also be used to give potentials that work for
specific elements under certain conditions. The trade-off for this loss any physical elegance [116] is a potential
81

5.4. EAM POTENTIAL FITTING

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

that replicates the behaviour of a material under the conditions that are being studied, rather than use a more
generic potential that isn’t detailed enough to do so.

5.4.2

Exact Fitting to Parameters

As discussed in in section 5.3.3 the functions may be fit directly to the known parameters for the metal. This
was also the approach taken by Mishin whilst developing an alloy potential to model an Ni-Al system[121].
An exact fitting code was developed by G. Bonny in order to fit cubic spline type functions exactly to relaxed data
including the Rose-Vinet equation of state (see section 5.2.2). Following work by Ackland[116], Mendelev[122],
Olsson and Wallenius[117] the code developed by Bonny et al was used to develop a concentration dependent
potential for Iron-Chromium[107]. More recently a potential has been fit for Tungsten-Rhenium alloys[123].
This code uses a quadratic program[124] to fit the potentials to the desired properties.

5.4.3

Force Matching

Force data, gathered experimentally or by first-principles calculations, has been used to develop potentials since
the 1990s. The force matching method was developed in 1994 by Ercolessi and Adams [125] to link the more
accurate, more processor and memory intensive, world of first-principles calculations to Molecular Dynamics.
The force-matching method uses the difference between the actual force, typically calculated by first-principles
calculations, and that given by the potential.
With a set of M different atomic configurations, and a potential with a set of L parameters (⃗
𝑝), the function 𝑍𝐹
is a measure of the difference between the the forces calculated using the potential for all configurations and
the actual (or DFT generated) forces.

𝑍𝐹 (⃗
𝛼) =

𝑀 ∑︁
𝑘 ∑︁
3
∑︁
𝑘⃗
0 |2
|𝐹𝑖,𝑗
(⃗𝛼) − 𝐹⃗𝑖,𝑗

(5.88)

𝑘=1 𝑖=1 𝑗=1

This may be extended to include the calculation of other properties:
• Lattice Parameter 𝑎0
• Cohesive Energy 𝐸𝑐𝑜ℎ
• Bulk Modulus 𝐵0
• Equation of State (𝐸0 , 𝑉0 , 𝐵0 , 𝐵0𝑝 )
• Stress Tensor
• Elastic Constants
• Shear Modulus, Young’s Modulus, Poisson Ratio
• Melting Temperature
• Surface Energy
Each may be weighted depending on how important the property is to the simulation the potential is required
for.

82

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.4. EAM POTENTIAL FITTING

𝑍(⃗
𝑝) = 𝑤𝐹 𝑍𝐹 (⃗
𝑝) + 𝑤𝑏0 𝑍𝑏0 (⃗
𝑝) + 𝑤𝑒0 𝑍𝑒0 (⃗
𝑝) + 𝑤𝑎0 𝑍𝑎0 (⃗
𝑝) + 𝑤𝑒𝑐 𝑍𝑒𝑐 (⃗
𝑝) + 𝑤𝑒𝑐𝑜ℎ 𝑍𝑒𝑐𝑜ℎ (⃗
𝑝)

(5.89)

The result is a residual squared sum that measures how well or poorly a potential fits the required data.

5.4.4

Pair and Embedding Symmetry Transforms

The combination of density function and embedding functional are not unique. When a potential is developed
for a single element, this isn’t a problem, but it must be considered when fitting to an alloy. If the density is
based on real data, such as density distribution computed using a first principles code such as DIRAC, then
there is some underlying meaning to the function. However, the functions fitted in this work have no real
resemblance to the physics, other than having an effective cut off.
Bonny and Malerba[126] show two transforms that may be applied to the pair function, density function and
embedding functional that the energy of any given atom is invariant to.

𝐸𝛼 =

∑︁
1 ∑︁
𝑉 (𝑅𝛼𝛽 ) + 𝐹 [𝜌¯𝛼 ] where 𝜌¯𝛼 =
𝜌(𝑅𝛼𝛽 )
2
𝛽̸=𝛼

(5.90)

𝛽̸=𝛼

Given the usual definition of the EAM, in eq. 5.90, the first transform scales the value of the density function as
simultaneously, and inversely, with the argument of the embedding functional (eq. 5.91). The second transform
applies to the pair function and embedding functional (eq. 5.92).

𝜌˜(𝑅𝛼𝛽 ) = 𝑆𝜌(𝑅𝛼𝛽 )𝐹˜ [𝜌¯𝛼 ] = 𝐹 [𝜌¯𝛼 /𝑆]

(5.91)

𝐹˜ [𝜌¯𝛼 ] = 𝐹 [𝜌¯𝛼 ] + 𝐶 𝜌¯𝛼 𝑉˜ (𝑅𝛼𝛽 ) = 𝑉 (𝑅𝛼𝛽 ) − 2𝐶𝜌(𝑅𝛼𝛽 )

(5.92)

Mishin’s approach, when fitting a binary alloy of Ni and Al, was to identify three transforms with three
parameters that could be adjusted whilst fitting the alloy potential (eq. 5.93).

𝜌˜𝐵 = 𝑠𝐵 𝜌𝐵 (𝑟) 𝐹˜𝐵 (¯
𝜌) = 𝐹𝐵 (¯
𝜌/𝑠𝐵 )
˜ (𝑟) = 𝑉𝐴𝐴 (𝑟) − 2𝑔𝐴 𝜌𝐴 (𝑟)
𝐹˜𝐴 (¯
𝜌) = 𝐹𝐴 (¯
𝜌) + 𝑔𝐴 𝜌¯ 𝑉𝐴𝐴

(5.93)

˜ (𝑟) = 𝑉𝐵𝐵 (𝑟) − 2𝑔𝐵 𝜌𝐵 (𝑟)
𝐹˜𝐵 (¯
𝜌) = 𝐹𝐵 (¯
𝜌) + 𝑔𝐵 𝜌¯ 𝑉𝐵𝐵
Bonny and Malerba chose to apply an effective gauge to the potentials for pure species. The gauge they chose
sets the gradient of the embedding functional to zero at the equilibrium density, that of the relaxed crystal, as
well as setting the equilibrium density to zero.
To transform the embedding functional such that 𝐹 ′ [𝜌¯𝑒𝑞 ] = 0, the constant C is set as 𝐶 = −𝐹 ′ [𝜌¯𝑒𝑞 ]. To
transform the density such that 𝜌¯𝑒𝑞 = 1 the constant S is set as 𝑆 = 1/𝜌¯𝑒𝑞 [126].

In the case of a binary alloy, the potentials for the pure elements are derived. Following this, the effective gauge
transforms are applied to both pure element potentials. Finally, the cross pair potential is fit whilst the pure
potentials are fixed.
83

5.5. CLASSICAL MOLECULAR DYNAMICS

5.5

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Classical Molecular Dynamics

5.5.1

Introduction

Ab initio (DFT) calculations approximately solve the Schrödinger equation to calculate the energy, forces and
stress of a given simulation. They take a relatively long time to calculate, have relatively small numbers of
atoms (hundreds to thousands) and are fixed at one moment in time, although there are now programs that will
run DFT MD. In comparison, MD models a collection of atoms over a specified period of time. Much larger
collections of atoms are possible (thousands to millions) and the interaction between atoms are predefined by
interatomic potentials.
Molecular dynamics has been used to investigate the effects of radiation on materials. The damage event on
the atomic scale is rapid in time, in the femtosecond to picosecond range, and affects a small volume of the
material whereas the effects of the damage to the material on a mesoscopic and macroscopic scale may range
from days to decades. In reactor pressure vessels, for instance, the damage and defect production will cover a
large range of time and size scales[26]:
• 10−10 𝑚 to 10−3 𝑚 (1018 to 1025 atoms)
• 10−17 𝑠 to 109 𝑠 (tens of attoseconds to 30 years)
As a major element of steel, iron has often been the subject of MD simulations. Damage cascades have been
studied in iron at a range of temperatures and PKA energies.

5.5.2

Molecular Dynamics Codes

Many MD codes are available for researchers to download freely and use from the Internet (although, terms may
apply to the use). These include DL POLY (Fortran), Large-scale Atomic/Molecular Massively Parallel Simulator (LAMMPS) (C++) and MOLDY (C). Most are able to run using Message Parsing Interface (MPI), Open
Multi-Processing (OpenMP) or a hybrid to leverage executing the program in parallel across many compute
nodes. Versions of these codes also exist to take advantage of the massive parallelism that exists in graphical
processing units.

Figure 5.9: Damage in MOX (LAMMPS)[127]

Figure
5.10:
(LAMMPS)[128]

84

Sputtering

of

plutonium

oxide

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.5. CLASSICAL MOLECULAR DYNAMICS

Damage cascades in mixed oxides have been modelled recently using the LAMMPS code. A 70x70x70 box
with sides approximately 40nm in length and containing 4,116,000 atoms was used with PKAs having energies
ranging from 5 to 75keV[127]. The sputtering of material from the surface of plutonium oxide (IV) has also
been modelled with LAMMPS using a box of 393,216 atoms with a PKA of 87.7keV. The timescale of the
sputtering simulation was 7.8 picoseconds (7.8 × 10−12 ) and the entire event was split into 1.0 × 105 time steps
of 7.8 × 10−17 s.

Figure 5.12: 20keV cascade (MOLDY)[129]
Figure 5.11: 5keV cascade (MOLDY)[129]

MOLDY has previously been used to model primary knock on atoms in metals, at energies of 5kev, 10keV and
20keV which would be slightly lower than the typical iron PKAs close to U235 fuel in the reactor (fig. 1.10).
This simulation however was in alpha-zirconium and the higher mass of zirconium, relative to iron, would lead
to lower energy PKAs. The damage cascades were modelled in a 104,832 atom block for the 5keV PKA (figure
5.11) and a 445,536 atom block for the 20keV PKA (figure 5.12).

Figure 5.13:
100keV cascade after 50ps in TiO2
(DL POLY)[130]

DL POLY has also been used to model damage cascades in various oxides (titanium, aluminium, silicon)[130].
The PKA energies are higher than those performed in MOLDY 15 years earlier, but still under 1MeV. The
85

5.5. CLASSICAL MOLECULAR DYNAMICS

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

authors expect 1MeV simulation boxes to require at least 1 billion atoms, but the 100-200keV PKAs they
modelled were within 10 million atom simulation boxes. Slightly larger boxes and damage cascades required
longer simulation times, and with a box size of 43nm per side, a 50ps simulation time was used (fig. 5.13).

5.5.3

Calculating Energy, Force and Stress

Molecular dynamics simulations do not need to include the weak or strong force, and the gravitational forces
between atoms in the simulated material are so weak in comparison to the electromagnetic force, they can also
be ignored. There is a force between all the atoms within a real material, but the electromagnetic force is
inversely proportionally to the separation of the atoms. Above a certain separation, the electromagnetic force
can also be ignored, in order to simplify the computation.
Neighbour List
A cut off radius can be introduced to limit the number of neighbours (section 5.3.4). As the lattice parameter
decreases, the atoms are brought closer together, and as the cut off radius is increased more atoms are considered
to be within the sphere of influence of one another. Both increase the number of neighbours each atom has (fig.
5.14).
Building a neighbour list may take a long time, depending on the parameters. If a simplistic approach is taken,
for N atoms in the supercell, there will be approximately 27𝑁 2 checks between atoms to see whether they are
within the cut off radius of one another. For larger numbers of atoms in a supercell, the whole may may be
decomposed into smaller domains.
For example, a 16x16x16 FCC supercell, containing 16,384 atoms, would require looping 27 × 16, 3842 = 7.25 ×

109 times. Breaking the supercell into 64 smaller domains with 256 atoms in each, reducing the problem to
64 × 27 × 2562 = 1.13 × 108 loops.

For this work, the supercells used to calculate bulk properties from the interatomic potentials, and the configurations generated by DFT, contain fewer than 1,000 atoms, removing the need to decompose the configuration
into smaller sub cells.
To build the neighbour list a halo configuration is created such that it lies on top of the real atoms, but extends
at least as far as the cut off radius on each side of the real simulation box (fig. 5.15). Periodic boundary
conditions are used to construct the halo.
Once the halo list is computed, the neighbour list may also be computed by looping through the real atoms and
halo atoms. A simple pseudo coded sub routine is given (listing 5.1).

86

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.5. CLASSICAL MOLECULAR DYNAMICS

Number of Neighbouring Atoms vs R Cutoff and A0 for FCC

600

No. Neighbouring Atoms

500

400

500

400

300
200
100

300

200

100
10
9
3.0

8
3.5

4.0

4.5

A0 (A

7
5.0

ngs)

5.5

6
6.0

6.5

7.0

R

f
tof
Cu

(

g
An

s)

5

Figure 5.14: Neighbouring atom count dependant upon lattice parameter and cutoff radius

Halo Atoms
04

01

02

03

04

01

16

13

14

15

16

13

12

09

09

08

05

10
11
12
Real Atoms
06
07
08

04

01

02

03

04

01

16

13

14

15

16

13

05

Figure 5.15: A 2D representation of atoms in simulation box with a halo of atoms at the boundary

87

5.5. CLASSICAL MOLECULAR DYNAMICS

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Listing 5.1: Simple subroutine for generating a half size neighbour list
1
2
3
4
5
6
7

!
!
!
!
!
!

real_atoms - array holding coordinates of all real atoms
halo_atoms - array holding coordinates of all halo atoms
real_ids - unique id for each atom
halo_ids - unique atom ids for halo atoms
nlist_ids - array to store ids
nlist_r - array to store separation

8
9
10
11

! Define the cutoff and counter start value
r_cut = 5.0
nl_counter = 1

12
13
14

! Calculate square
r_cut_sq = r_cut ** 2

15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33

! Loop over all real atoms
DO n_real = 1, real_atom_count
! Loop over all halo atoms
DO n_halo = 1, halo_atom_count
IF (real_ids(n_real) .LT. halo_ids(n_halo)) THEN
r(1:3) = halo_atoms(n_halo, :) - real_atoms(n_real, :)
r_sq = SUM(r(1:3) * r(1:3))
IF (r_sq .LE. r_cut_sq) THEN
r_mag = sqrt(r_sq)
nlist_ids(nl_counter, 1) = real_ids(n_real)
nlist_ids(nl_counter, 2) = halo_ids(n_halo)
nlist_r(nl_counter, 1) = r_mag
nlist_r(nl_counter, 2:4) = r(1:3)/r_mag
nl_counter = nl_counter + 1
END IF
END IF
END DO
END DO

The resulting list will contain unique a pair combinations; i.e. the pair atom 1 and atom 2 will only be recorded
once, and not also as atom 2 and atom 1.
Many modern MD codes are designed to run on computers with many thousands of processor cores. This leads
to a choice of approaches, either to keep the configuration in shared memory and allow multiple processes to
work on the same data, or break the data up, distributing it across various nodes.
In the case of DL POLY a link-cell domain decomposition is used[131]. The supercell is divided up into subcells,
and these must be at least the size of the cut-off radius. Each processor will work on a geometric domain and
these will only interact with their immediate neighbours. The halo data for each subcell is only passed between
processors before and after the calculation of the equations of motion of the atoms within each subcell.

Figure 5.16: Partitioning in LAMMPS[132]

This is also the approach used by the LAMMPS code. The simulation is partitioned into either boxes where
the density of atoms is uniform or tiles where there are regions with few or no atoms (fig. 5.16). This ensures
processors are evenly utilised.
88

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.5. CLASSICAL MOLECULAR DYNAMICS

Computing Total Energy
The total energy of the system is the sum of the individual energies for the atoms in the simulation. The type
of atom (or pairs of atoms) will determine which function is used.
First, to compute the pair potentials:
• set the total energy of the system equal to zero
• set the starting energy for each atom in the system to zero
• loop through the atom pairs in the entire neighbour list
• for each atom pair, A and B, use the known separation and the potential function to compute the potential
energy on atom A due to B and vice versa
• add this potential energy to both A and B
• after looping through the neighbour list, add all the energies due to the pair potential to the total energy
For an EAM or 2BEAM potential, the densities and embedding energies must also be computed:
• set the electron density at the position of (for each) atom to zero
• loop through the atom pairs in the entire neighbour list
• for each atom pair, using the density function for the atom A, the density at atom B due to atom A will
be calculated and added to the density at atom B
• if the atoms are both of the same type the same density will be added to atom A due to atom B
• if the atom types are different, using the density function for the atom B, the density at atom A due to
atom B will be calculated and added to the density at atom A
• following looping through the neighbour list, to calculate the densities at each atom, the list of atoms will
be looped through
• for each atom, the density value at the position of that atom, will be input into the appropriate embedding
function to calculate the embedding portion of the energy
• add all the embedding energies to the total energy of the system
For a 2BEAM potential, repeat the above procedure for the second group of density functions and embedding
functions (do not repeat calculation of the pair potentials).
Computing Forces on Atoms
In order to calculate the forces on the atoms with an EAM or 2BEAM potential, the neighbour list and atom
list will need to be looped through several times. First, the pair potential and force due to the pair potential
must be calculated by a complete loop through the neighbour list. At the same time, the density at each atom
location is also calculated. The embedding energy may then be computed by looping through all the atoms and
using the electron density at each atom to give the energy of the atom embedded in that density. The third
and final loop will run through the neighbour pairs in the neighbour list once more computing the force on each
atom due to its embedding in the electron background.

89

5.5. CLASSICAL MOLECULAR DYNAMICS

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

𝑘
𝐹𝑝𝑎𝑖𝑟
=−

𝑘
𝐹𝑒𝑚𝑏𝑒𝑑

=−

𝑁
∑︁

𝑗=1,𝑗̸=𝑘

(︂

𝑁
∑︁

𝑗=1,𝑗̸=𝑘

𝜕𝑉𝑘𝑗 (𝑟𝑘𝑗 ⃗𝑟𝑘𝑗
𝜕𝑟𝑘𝑗 |⃗𝑟𝑘𝑗 |

𝜕𝐹 𝜕𝜌(𝑟𝑘 )
𝜕𝐹 𝜕𝜌(𝑟𝑗 )
+
𝜕𝜌𝑘 𝜕𝑟𝑘𝑗
𝜕𝜌𝑗 𝜕𝑟𝑘𝑗

)︂

(5.94)

𝑟⃗𝑘𝑗
𝑟𝑘𝑗

The force on each atom, due to surrounding atoms, may be split into two; force due to the pair potential, and
the force due to the embedding of the atom (eq. 5.94)[115][131].
Computing Stress
The stress is to be calculated assuming the system is at 0K[133] so the virial stress equation is eq. 5.95.

𝜏𝑖𝑗 =

)︁
1 ∑︁ (︁ (𝑙)
𝑥𝑖 − 𝑥𝑖 (𝑘) 𝑓𝑗 (𝑘𝑙)
2𝑉

(5.95)

𝑘,𝑙∈𝑉

Within the computer code, the individual force components between pairs of atoms are stored as well as an
equal sized array of vectors representing their spatial separation. Those pairs with one atom in the halo around
the simulation box are used to calculate the stress on the simulation box.
Pseudo Code for the Energy, Force and Stress Subroutine
The calculation requires several arrays to temporarily store data. The electron densities and gradients of the
density function are stored for multiple groups of densities and embedding functionals. The overall forces on
each atoms also need to be stored as well as the force between pairs of atoms, as this is required to compute
the virial stress. The Fortran code to compute this is included in the appendix (section Q.1) and a pseudocode
in listing 5.2 explains the process.
Listing 5.2: Pseudo Code for Energy and Stress Force Calculation
1
2
3
4
5
6

electron_density[1:n_atoms, 1:bands] = 0.0 ! electron density at each atom
energy = 0.0
! total energy
forces[:,:] = 0.0
! forces each atom, 3D
force_between_pairs[:,:] = 0.0
! used to store force between pairs, for stress computation
stress[:,:] = 0.0D0

7
8
9
10
11

! LOOP 1 - Pair energy, force and calculate densities
DO n = 1, neighbour_count
E = get_PairEnergy(atom_a, atom_b, r[n,:])
F[:] = get_PairForce(atom_a, atom_b, r[n,:])

12
13
14

! Save energy
energy = energy + E

15
16
17
18
19

! Save Force
f[atom_a, :] = f[atom_a, :] - F[:]
f[atom_b, :] = f[atom_b, :] + F[:]
force_between_pairs[:,:] = force_between_pairs[:,:] - F[:] // Used to calculate stress

20
21
22
23

! Loop through density bands
DO band = 1, bands
! Electron density at A due to atom B

90

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

24

5.5. CLASSICAL MOLECULAR DYNAMICS

electron_density[atom_a, band] = get_Density(atom_b, r)

25
26
27
28
29

! Electron density at B due to atom A
electron_density[atom_b, band] = get_Density(atom_a, r)
END DO
END DO

30
31
32
33
34
35
36
37

! LOOP 2 - Embedding energy
DO n = 1, atom_count
! Loop through density bands
DO band = 1, bands
energy = energy + get_EmbeddingEnergy(n, band)
END DO
END DO

38
39
40
41
42
43
44
45
46

! LOOP 3 - Embedding force
DO n = 1, neighbour_count
! Loop through density bands
DO band = 1, bands
dgradA = get_DensityGradient(atom_b, r, band)
dgradB = get_DensityGradient(atom_a, r, band)
fgradA = get_EmbeddingGradient(atom_a, electron_density[atom_a, band])
fgradB = get_EmbeddingGradient(atom_b, electron_density[atom_b, band])

47
48

F[:] = (fgradA * dgradB + fgradB * dgradA) * r[n, :]

49
50
51

f[atom_a, :) = f(atom_a, :) - F[:]
f(atom_a, :) = f(atom_a, :) + F[:]

52
53
54
55

force_between_pairs[n,:] = force_between_pairs[n,:] - F[:] // Used to calculate stress
END DO
END DO

56
57
58
59
60
61
62
63
64
65
66
67
68

! LOOP 4 STRESS
DO n = 1, neighbour_count
! Only compute if the second atom is in the halo
IF(nlisthalo(n))THEN
DO i = 1,3
DO j = 1,3
stress[i,j] = stress[i,j] + (r[n, i] * force_between_pairs[n,j])
END DO
END DO
END IF
END DO
stress[1:3, 1:3] = stress[1:3, 1:3] / (2.0 * volume)

5.5.4

Velocity Verlet Algorithm

Verlet integration is used by MD codes such as DL POLY, LAMMPS, Democritus as well as MD DFT codes,
as in the case of CASTEP.
First, the forces at time step n are calculated 𝑓⃗𝑛 . Now, using these forces and the velocity at time step n, the
half step velocity is computed (eq. 5.96).

𝑣𝑛+ℎ𝑎𝑙𝑓
⃗
= 𝑣⃗𝑛 +

𝑓⃗𝑛 𝛿𝑡
2𝑚

(5.96)

The position of the next step, n + 1, is calculated using the position at n, the time step 𝑑𝑡 and the half step
91

5.5. CLASSICAL MOLECULAR DYNAMICS

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

velocity (eq. 5.97).

𝑟𝑛+1
⃗ = 𝑟⃗𝑛 + 𝑣𝑛+ℎ𝑎𝑙𝑓
⃗
× 𝛿𝑡

(5.97)

⃗ and this, along with the half step velocity, is
The forces are recalculated at the new position 𝑟𝑛+1
⃗ to give 𝑓𝑛+1
used to compute the velocity at step n+1, 𝑣𝑛+1
⃗ (eq. 5.98).

𝑣𝑛+1
⃗ = 𝑣𝑛+ℎ𝑎𝑙𝑓
⃗
+

⃗ 𝛿𝑡
𝑓𝑛+1
2𝑚

(5.98)

This process is repeated for each time step 𝛿𝑡 from the start of the simulation to the end.

5.5.5

Selecting a Time Scale

Take, for example, a 50x50x50 BCC Iron supercell with a lattice parameter of 2.87 angstrom. The supercell
measures almost 15nm on each side. Simulating a thermal neutron, travelling at 2,200 m/s, would require an
overall time period of at least 7 picosecond to capture the neutron passing through the supercell. Higher energy
particles would require smaller overall time periods, divided up into as many time steps as the user requires.
If PKA damage is being modelled, there may be a point where the depth of the damage cascade becomes larger
than the supercell itself. Damage cascades of 500KeV iron atoms into an iron target travel to a depth of up to
300nm, which would require a simulation supercell at least 1,000 BCC cells deep. Kinetic Monte Carlo would
be better suited at simulating higher energy damage cascades.

Figure 5.17: Damage cascade: 500kev iron projectiles into an iron target calculated with SRIM

To capture the required details the time steps would also need to be very fine, on the order of attoseconds or
tens of attoseconds. This has been shown in the literature with time steps of 7.8 × 10−17 s[127].

92

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.6

5.6. EXISTING POTENTIAL FITTING PROGRAMS

Existing Potential Fitting Programs

Bonny Quadratic Program Fitting
This code has been used to fit a number of potentials, including Fe-Cr and W-Re. It is a Fortran code and
uses know properties of the material in different configurations. The only functional forms available in the 2012
version of the code are cubic spline for the pair and density functions and a polynomial for the embedding
functional. The fitting subroutine uses quadratic programming to find parameters for the pair and embedding
function splines.
Hepburn FitPot
FitPot was created by Hepburn, a co-author of papers with Ackland[134]. It was written in Java and tackles the
fitting as a non-linear least squares problem. The Levenberg-Marquardt Algorithm (LMA) is used to minimise
the response function and uses the derivatives of the response function with respect to the input parameters to
construct the Jacobian that is then used to construct an estimation of the Hessian.
Brommer PotFit
Originally developed in C, the PotFit[135] program uses the force matching method of fitting. In the early
versions of the code, splines were the only function choice available. In the years since, the option to fit analytic
functions has been added. Simulated annealing is the primary search algorithm that attempts to locate the
global minima. Powell’s conjugate direction method is used to locate the local minima once the probable global
minima is located. In order to use PotFit, a database of force, energy and stress for various configurations is
required.
Sheng Modified PotFit
A set of potentials have been derived by Sheng et al[136] and are available to download in tabulated form[36].
They were created using a modified version of the PotFit code by P. Brommer and F. Gähler[135]. The code had
been modified extensively to include quintic spline interpolation, phonon calculation, elastic constant calculation
and optimization techniques[36]. The potentials (typically) used 15 knot splines for pair and density functions
and 6 knot splines for the embedding functional for each element, but the potentials were published as tabulated
functions. Potentials for fourteen FCC metals were derived in the first instance, but more (including alloys) are
available on the website. Unfortunately, the (Sheng et al.) modified PotFit code is not available through the
PotFit website[135], and the latest version of their code has moved on since 2011.

5.7

Density Functional Theory

Density Functional Theory (DFT) is a branch of quantum chemistry that approximately solves the Schrödinger
equation using electron density, rather than the coordinates of each electron in the system. A number of
simplifications are also applied in order for DFT to be practical to use, but despite this calculations are limited
to just hundreds or thousands of atoms. A calculation of a hundred or so atoms may take thousands of CPU
hours at the time of writing, depending on the type of calculation and complexity of the electron structures of
the atoms involved.
It is through DFT that the first principles energy, stress and force calculations will be made, and it’s these
results that the EAM potentials will be trained and fit to using the force matching method. This will allow
much larger scale modelling using the extrapolated behaviour of accurate DFT calculations.
93

5.7. DENSITY FUNCTIONAL THEORY

5.7.1

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Motivation For Using DFT In This Work

The use of interatomic potentials bridges the gap between the quantum scale and macroscopic scale. In order
to develop these potentials either measurements or calculated values are needed for forces, energies and stresses.
DFT is a convenient choice and has been used to fit potentials and calculate crystal properties many times (Sheng
et al[136], Mehl et al.[104] Connetable and Thomes,[137] Ravindran et al[109], Hepburn and Ackland[134] and
more).

5.7.2

Brief Overview of DFT

Several important theories and approximations are used by DFT with the aim of calculating and minimising
energies and forces. The Born-Oppenheimer approximation separates the electron-nucleus wave function. It
treats the nuclei as fixed points, and the system of electrons in a fixed potential created by the nuclei.
The DFT of Kohn, Sham and Hohenburg proved that the potential of a system is uniquely determined by its
ground state density. This makes solving the Schrödinger equation significantly easier.
Time independent Schrödinger equation
for a many body system

Born-Oppenheimer: Nuclei are heavy compared
to electrons, so fix them in place

Hohenberg-Kohn-Sham: Ground state energy is a unique
functional of the density, solve one electron KS equation

Use LDA, GGA etc approximation in place of
the unknown exchange-correlation energy

Use a plane-wave basis set and periodic boundary
conditions to represent an infinite crystal

Valence electrons influence bonding more than core electrons,
so use pseudopotentials to smooth out the core

Reduce the basis set of plane waves further
using an kinetic energy cut off

Integrate k-space with a mesh of points
and appropriate smearing (for metals)

Figure 5.18: Common approximations used to enable DFT calculations

5.7.3

Time Independent Schrödinger Equation

The Schrödinger equation is a linear partial differential wave equation and it was proposed by Erwin Schrödinger
in 1925. There is a time-dependent and time-independent form of the equation. As the DFT calculations in
this work are static only the time-independent version will be discussed.

94

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

ˆ
𝐻|Ψ⟩
= 𝐸|Ψ⟩

(5.99)

ˆ is an operator and it is the total energy in the system. Ψ is the wave function and this
The Hamiltonian 𝐻
contains all the measurable information possible about whatever it represents. E is the energy eigenvalue of
this system and this will depend on the eigenstate of the system. The wave function is also connected to the
probability of a particle being found at a certain point in space, and the integral over all space is equal to 1 i.e.
the probability of it being found somewhere in space is equal to 1 (eq. 5.100).

∫︁

∞

−∞

∫︁

∞

−∞

∫︁

∞

Ψ(𝑥, 𝑦, 𝑧)𝑑𝑥𝑑𝑦𝑑𝑧 = 1

(5.100)

−∞

The Schrödinger equation is set up depending on the system being studied. Starting with the simplest, a free
particle, the only non zero energy of the Hamiltonian is kinetic.

2
ˆ = ~ ∇2
𝐻
2𝑚

−

~2 2
∇ Ψ(⃗𝑟) = 𝐸Ψ(⃗𝑟)
2𝑚

(5.101)

If the particle is in a potential, it will have both kinetic energy 𝑇ˆ and potential energy 𝑉ˆ (eq. 5.102).

2
ˆ = 𝑇ˆ + 𝑉ˆ = ~ ∇2 + 𝑉 (⃗𝑟)
𝐻
[︂
]︂ 2𝑚
~2 2
−
∇ Ψ(⃗𝑟) = 𝐸Ψ(⃗𝑟)
2𝑚

5.7.4

(5.102)

Many Body TISE

Electronic structure calculations are important and allow the calculation of material properties that may be
difficult or impossible to measure with current technology. The next step towards this is to set up the Schrödinger
equation (time-independent) for nuclei and electrons in a crystal.
Relative to the strong force, the electromagnetic force is 1/137th as strong, but the strong force acts over a
range of approximately 1.0 × 10−5 angstrom. In the calculations carried out in this section, the atoms will

never be arranged close enough for the strong force to be considered at all. The gravitational force, as with

the electromagnetic force, acts over an infinite range. The electromagnetic force is more than 1.0 × 1036 times

greater than the gravitational force, so it too can be neglected. Finally, the weak interacting force has a range
of approximately 1.0 × 10−8 angstrom which, as with the strong force, is a range small enough that the weak
force may be neglected.

The energy operators required are kinetic and electromagnetic potential (eq. 5.103).

ˆ = 𝑇ˆ𝑒 + 𝑇ˆ𝑛 + 𝑉𝑒−𝑒
ˆ + 𝑉𝑒−𝑛
ˆ + 𝑉𝑛−𝑛
ˆ
𝐻
The first two terms are the kinetic energy of the electrons and nuclei respectively (eq. 5.104).
95

(5.103)

5.7. DENSITY FUNCTIONAL THEORY

𝑇ˆ𝑒 = −

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

∑︁ ~2
∇2 sum of kinetic energy of electrons
2𝑚
𝑖

𝑇ˆ𝑛 = −

(5.104)

∑︁ ~2
∇2 sum of kinetic energy of nuclei
2𝑀
𝑘

The last three terms are potential energy terms due to the electromagnetic force (eq. 5.105).

𝑉𝑒−𝑒 =
𝑉𝑒−𝑛 =

∑︁
𝑖,𝑘

1
1 ∑︁
sum of potential energy between electrons
2
|⃗𝑟𝑖 − ⃗𝑟𝑗 |
𝑖,𝑗,𝑖̸=𝑗

𝑧𝑖
sum of potential energy between electrons and nuclei
|⃗𝑟𝑖 − ⃗𝑟𝑙 |

(5.105)

𝑧𝑘 𝑧𝑙
1 ∑︁
sum of potential energy between nuclei
2
|⃗𝑟𝑙 − ⃗𝑟𝑘 |

𝑉𝑛−𝑛 =

𝑘,𝑙,𝑘̸=𝑙

These operators are now input into the TISE (eq. 5.106).
⎡(︃

∑︁ ~2
∑︁ ~2
⎣ −
−
2𝑚
2𝑀
𝑖

5.7.5

𝑘

)︃

∇2 +

∑︁
𝑖,𝑘

⎛
⎞⎤
∑︁
𝑧𝑖
1 ⎝ ∑︁
1
𝑧𝑘 𝑧𝑙 ⎠⎦
+
+
|Ψ⟩ = 𝐸|Ψ⟩
|⃗𝑟𝑖 − ⃗𝑟𝑙 | 2
|⃗𝑟𝑖 − ⃗𝑟𝑗 |
|⃗𝑟𝑙 − ⃗𝑟𝑘 |
𝑖,𝑗,𝑖̸=𝑗

(5.106)

𝑘,𝑙,𝑘̸=𝑙

Born-Oppenheimer

The TISE arrived at is far too complicated to solve, even for the simple ensembles of atoms. It represents the
many body system of electrons and nuclei, and it takes the positions of all nuclei and electrons as input variables
(eq. 5.107).

ˆ
𝐻|Ψ(
𝑟⃗𝑒 , 𝑟⃗𝑛 )⟩ = 𝐸|Ψ(𝑟⃗𝑒 , 𝑟⃗𝑛 )⟩
(5.107)

where 𝑟⃗𝑒 = 𝑟𝑒,1 , 𝑟𝑒,1 , ..., 𝑟𝑒,𝑖 (electron positions)
where 𝑟⃗𝑛 = 𝑟𝑛,1 , 𝑟𝑛,1 , ..., 𝑟𝑛,𝑖 (electron positions)

In 1927 the Born-Oppenheimer approximation was proposed to separate the electron components from the
nuclei in the Hamiltonian.
Protons and neutrons are almost 2,000 times the mass of electrons. With respect to the electrons, they move
much slower and may be considered to be fixed or frozen in place. Simplifying for a moment to a single electron
and proton, due to Newton’s second law, we can see that the acceleration of the electron would be similarly
2,000 times that of the proton: 𝑓𝑒 = 𝑓𝑝 and 𝑚𝑒 𝑎𝑒 = 𝑚𝑝 𝑎𝑝 which leads to 𝑎𝑒 =

𝑚𝑝
𝑚𝑒 𝑎𝑝 .

As the nuclei move, the

electrons are assumed to respond instantly, remaining in the ground state and not being promoted into higher
energy levels.
The Hamiltonian for the electrons may be written with the electron co-ordinates as a variable, and the nuclei
co-ordinates as a parameter (eq. 5.108).

ˆ (𝑟⃗𝑒 ) + 𝑉𝑒 ˆ− 𝑛(𝑟⃗𝑒 ; 𝑟⃗𝑛 )
𝐻ˆ𝑒 (𝑟⃗𝑒 ; 𝑟⃗𝑛 ) = 𝑇ˆ𝑒 (𝑟⃗𝑒 ) + 𝑉𝑒−𝑒
96

(5.108)

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

The wavefunction and energy for the electrons may be calculated, although if the nuclear cooridinates are
changed, i.e. by changing the parameter 𝑟𝑛 , the wavefucntion and energy will need to be recalculated.

𝐻ˆ𝑒 (𝑟⃗𝑒 ; 𝑟⃗𝑛 )𝜓𝑒 (𝑟⃗𝑒 ; 𝑟⃗𝑛 ) = 𝐸𝑒 (𝑟⃗𝑛 )𝜓𝑒 (𝑟⃗𝑒 ; 𝑟⃗𝑛 )

(5.109)

Ψ(𝑟⃗𝑒 , 𝑟⃗𝑛 ) = 𝜒𝑛𝑒 (𝑟⃗𝑒 )𝜓𝑒 (𝑟⃗𝑒 ; 𝑟⃗𝑛 )

(5.110)

The electronic Hamiltonian (eq. 5.109) is still dependent on the electronic co-ordinates. As there are three
co-ordinates per electron, there are 3 dimensions when solving for a hydrogen atom. For an Iron atom, with
26 electrons, there are 78 dimensions, and for a 4x4x4 FCC supercell of Iron there would be 256 atoms, 26
electrons per atom and 3 dimensions per electon, giving a total of 19,968 dimensions. Even for small numbers
of electrons, solving this equation is impractical.

5.7.6

Crystals, Reciprocal Space and Bloch Theorem

A Bravais lattice is a construct used to describe a periodic crystal lattice. It has the following properties given
in eq. 5.111.

⃗ = 𝑛1⃗𝑎1 + 𝑛2⃗𝑎2 + 𝑛3⃗𝑎3
𝑅
𝑛1 , 𝑛2 , 𝑛3 ∈ 𝑍

(5.111)

⃗𝑎1 , ⃗𝑎2 , ⃗𝑎3 are independent
There are 14 Bravais lattices and 7 families of these lattices, and these lattices may be grouped by vector
length and angle relationships (table. 5.4). This work is primarily concerned with cubic and tetragonal crystals,
although distortions are applied to these crystals throughout.
Class

Lengths

Angles

Cubic
Hexagonal
Rhombohedral
Tetragonal
Orthorhombic
Monoclinic
Triclinic

𝑎=𝑏=𝑐
𝑎 = 𝑏, 𝑐
𝑎=𝑏=𝑐
𝑎 = 𝑏, 𝑐
𝑎, 𝑏, 𝑐
𝑎, 𝑏, 𝑐
𝑎, 𝑏, 𝑐

𝛼 = 𝛽 = 𝛾 = 90
𝛼 = 𝛽, 𝛾 = 120
𝛼 = 𝛽 = 𝛾 ̸= 90
𝛼 = 𝛽 = 𝛾 = 90
𝛼 = 𝛽 = 𝛾 = 90
𝛼 = 𝛽 = 90, 𝛾 ̸= 90
𝛼, 𝛽, 𝛾,

Table 5.4: Bravais lattice vector length and angle relationships

Bloch Theorem
Metals are made up from grains which in turn are crystal lattices of atoms. Despite the majority of metals
being composed of a large collection of microscopic crystals, rather than being a single perfect crystal, most of
their properties may be calculated as if the metal were a single crystal.

97

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

The grain size of water quenched SS304 is approximately 30 micrometers across[138]. If the crystal were a cube,
it would contain 2.0 × 1015 atoms and it would have sides over 100,000 atoms in length.
In solid state physics, in order to solve the TISE for such a system, it is useful to consider an infinite sized
crystal. It may be helpful to visualise this as a ”ring” of atoms in one dimension (fig. 5.19) or as a super-cell
with periodic boundary conditions in three dimensions.

13

14

15

16

17

12

18

11

19

10

⃗
𝑅

20

9

⃗𝑡
⃗𝑟 + 𝑅

1
8

2
7

6

5

4

3

⃗𝑟

Figure 5.19: A useful, albeit incorrect, way of visualising
an ”infinite” chain of atoms in 1D
Figure 5.20: A 2D example of a translation by an integer
multiple of the unit cell from the origin unit cell

As the structure is a repeating lattice, any point within a unit cell is equivalent to any other point translated
by an integer multiple of the lattice vector (fig. 5.20).

⃗𝑡 )
𝜓(⃗𝑟) = 𝜓(⃗𝑟 + 𝑅
⃗ 𝑡 = 𝑛1 𝑅
⃗ 1 + 𝑛2 𝑅
⃗ 2 + 𝑛3 𝑅
⃗3
where 𝑅

(5.112)

⃗ is the real lattice vector
where 𝑅
Reciprocal space, also known as k-space or momentum space, is a mathematical construct. It is an imaginary
space where the lengths, and volumes, are the inverse of real space and planes of atoms are represented as
points.

(︁
)︁
⃗ points in reciprocal space 𝐺
⃗ only are valid points if exp 𝑖𝐺
⃗ ·𝑅
⃗ =
Starting with a lattice of points in real space 𝑅,
⃗ is transformed to it’s reciprocal in the following way, where Ω is the volume of
1[139]. A real space vector 𝑅
the primitive cell in real space.

2𝜋
𝑟⃗2 × 𝑟⃗3
Ω
2𝜋
𝑔⃗2 =
𝑟⃗3 × 𝑟⃗1
Ω
2𝜋
𝑔⃗3 =
𝑟⃗1 × 𝑟⃗2
Ω
Ω = 𝑟⃗1 · (𝑟⃗2 × 𝑟⃗3 )
𝑔⃗1 =

(5.113)

If the crystal structure is modelled as an infinitely repeating lattice, the potential also has the same periodicity
(eq. 5.113).

98

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

⃗ 𝑡)
𝑉 (⃗𝑟) = 𝑉 (⃗𝑟 + 𝑅

(5.114)

As the potential is a periodic function, it may be written as a fourier series in reciprocal space (eq. 5.115).

𝑉 (⃗𝑟) =

∑︁
⃗
𝐺

(︁
)︁
⃗ 𝑟
𝑉𝐺
⃗ exp 𝑖𝐺 · ⃗

(5.115)

The wave function for an electron in the lattice is also periodic and may be written as the product of a plane
wave.

(︁
)︁
𝜓𝑛⃗𝑘 (⃗𝑟) = 𝑢𝑛⃗𝑘 (⃗𝑟) exp 𝑖⃗𝑘 · ⃗𝑟

⃗𝑡 )
𝑢𝑛⃗𝑘 (⃗𝑟) = 𝑢𝑛⃗𝑘 (⃗𝑟 + 𝑅
(︁
)︁
⃗𝑡
𝜓𝑛⃗𝑘 (⃗𝑟) = 𝜓𝑛⃗𝑘 (⃗𝑟) exp 𝑖⃗𝑘 · 𝑅

(5.116)

(5.117)

The Born-von Karman boundary conditions apply to the wave function such that:

⃗ 𝑡 ) = 𝜓 ⃗ (⃗𝑟) where𝑅
⃗𝑡 =
𝜓𝑛⃗𝑘 (⃗𝑟 + 𝑅
𝑛𝑘

∑︁
𝑖

𝑁𝑖 𝑎⃗𝑖 and𝑁𝑖 ∈ Z

(5.118)

With these boundary conditions and use of plane waves, Bloch theorem replaces an enormous number of electrons
with an infinite number electrons in a periodic lattice where only those in the unit cell need to be considered.

Figure 5.22: FCC Wigner Seitz Cell and BZ [140]
Figure 5.21: BCC Wigner Seitz Cell and BZ [140]

The (first) Brillouin Zone is a volume in (3D) reciprocal space and it is analogous to the Wigner-Seitz cell in
real space. It is the primitive lattice cell in reciprocal space. The reciprocal of a BCC lattice is a FCC lattice
(fig. 5.21) and vice versa (fig. 5.22). In real space a point anywhere in the lattice is a integer multiple of the
lattice vector away from the same point in the origin Wigner-Seitz cell. There are an infinite number of wave
vectors ⃗𝑘 in reciprocal space, but by virtue of the periodicity of the lattice, they are also all found within the
Brillouin Zone. If the crystal has symmetries, the BZ may be reduced further to the irreducible Brillouin zone.
99

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Within the BZ there are energy surfaces. Picking a straight line through reciprocal space allows one to plot the
energy bands along that one dimensional space. A particularly important energy surface is the Fermi surface
and, in the one electron model, this marks the boundary between the occupied and unoccupied states at 0K
[141]. The Fermi energy is the energy of the highest occupied state at 0K.

5.7.7

Hohenberg-Kohn Theorem

In the 1960s, Hohenberg and Kohn[142] simplified the problem of solving the many electron TISE in an exact
way by proving:
• in an external potential 𝑣(⃗𝑟), the potential is uniquely determined by the density of the ground state 𝑛0 (⃗𝑟)
assuming that the particles are non-degenerate
• a uniquely defined functional 𝐸[𝜌(⃗𝑟)] exists and the ground state energy, 𝑚𝑖𝑛(𝐸[𝜌(⃗𝑟)]), is found by varying
the density
The proof starts by picturing a box of electrons that interact with each other through coulomb repulsion
within an external potential ⃗𝑣 (𝑟), for example the potential of “fixed” nuclei following the Born Oppenheimer
approximation.

ˆ = 𝑇ˆ + 𝑉ˆ = 1 ∇2 + 𝑉 (⃗𝑟)
𝐻
2
[︂
]︂
1 2
− ∇ Ψ(⃗𝑟)0 = 𝐸0 Ψ(⃗𝑟)
2

(5.119)

ˆ = 𝑇ˆ + 𝑉ˆ + 𝑈
ˆ
𝐻

(5.120)

where

𝑇 =

1
2

𝑉 =

𝑈=

∫︁

∫︁

∇𝜓 * (⃗𝑟)∇𝜓(⃗𝑟)𝑑⃗𝑟

𝑣(⃗𝑟)𝜓 * (⃗𝑟)𝜓(⃗𝑟)𝑑⃗𝑟

1
𝜓 * (⃗𝑟)𝜓 * (𝑟⃗′ )𝜓(⃗𝑟)𝜓(⃗𝑟′ )𝑑⃗𝑟𝑑𝑟⃗′
|⃗𝑟 − ⃗𝑟′ |

(5.121)

(5.122)

(5.123)

ˆ is a sum of the kinetic energy 𝑇ˆ, the mutual
In the eqs. 5.120 5.121 5.120 5.123 the hamiltonian operator 𝐻
ˆ and the operator due to an external potential (due to the nuclei) 𝑉ˆ . The non degenerate
coulomb repulsion 𝑈
ground state electron density is 𝑛(⃗𝑟) = ⟨Φ|𝜑* (⃗𝑟)𝜑(⃗𝑟)|Φ⟩.
The HK theorem shows that the external potential 𝑣(⃗𝑟) is a unique functional of the electron density 𝑛(⃗𝑟). The
proof is that by contradiction where by two different states are assumed to have the same ground state charge
density.
100

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

State A

State B

Ψ𝐴 with potential 𝑉𝐴 (⃗𝑟)
ˆ = 𝑇ˆ + 𝑉ˆ𝐴 + 𝑈
ˆ
Hamiltonian 𝐻

Ψ𝐵 with potential 𝑉𝐵 (⃗𝑟)
ˆ = 𝑇ˆ + 𝑉ˆ𝐵 + 𝑈
ˆ
Hamiltonian 𝐻

TISE 𝐻ˆ𝐴 Ψ𝐴 = 𝐸𝐴 Ψ𝐴

TISE 𝐻ˆ𝐵 Ψ𝐵 = 𝐸𝐵 Ψ𝐵

Assumption - this state has the charge density 𝑛(⃗𝑟)

Assumption - this state has the charge density 𝑛(⃗𝑟)

The minimal property of the ground state gives the following[142][143]:

𝐸𝐴 = ⟨Φ𝐴 |𝐻ˆ𝐴 |Φ𝐴 ⟩

𝐸𝐴 = ⟨Φ𝐴 |𝐻ˆ𝐵 + 𝑉ˆ𝐴 − 𝑉ˆ𝐵 |Φ𝐴 ⟩
∫︁
ˆ
𝐸𝐴 = ⟨Φ𝐴 |𝐻𝐵 |Φ𝐴 ⟩ + 𝑑3⃗𝑟𝑛(⃗𝑟)(𝑣𝐴 (⃗𝑟) − 𝑣𝐵 (⃗𝑟))

𝐸𝐴 > 𝐸𝐵 +

∫︁

𝑑3⃗𝑟𝑛(⃗𝑟)(𝑣𝐴 (⃗𝑟) − 𝑣𝐵 (⃗𝑟))

(5.124)

(5.125)

The indices A and B are interchanged to give a second equation:

𝐸𝐵 > 𝐸𝐴 +
𝐸𝐵 > 𝐸𝐴 −

∫︁
∫︁

𝑑3⃗𝑟𝑛(⃗𝑟)(𝑣𝐵 (⃗𝑟) − 𝑣𝐴 (⃗𝑟))

(5.126)

3

𝑑 ⃗𝑟𝑛(⃗𝑟)(𝑣𝐴 (⃗𝑟) + 𝑣𝐵 (⃗𝑟))

By adding eq. 5.125 and eq. 5.126 together the integrals will cancel out.

𝐸𝐴 + 𝐸𝐵 > 𝐸𝐴 + 𝐸𝐵

(5.127)

This (eq. 5.127) is a contradiction and proves the first part of the HK theorem: 𝑣(⃗𝑟) is uniquely determined by
𝑛(⃗𝑟). If the charge density (fig. 5.23 and 5.23) is known, a single external potential exists for it.
The next part of the theorem is to show that the energy functional 𝐸[𝑛(⃗𝑟)] exists and the minimum can be
ˆ define a functional
found by varying the charge density function. The kinetic and interaction functional 𝑇ˆ and 𝑈
𝐹 [𝑛(⃗𝑟)].

ˆ |Φ⟩
𝐹 [𝑛(⃗𝑟)] ≡ ⟨Φ|𝑇ˆ + 𝑈

(5.128)

This is a universal functional[142] and it makes up a part of the energy functional. The energy functional is
comprised of the HK functional 𝐹 [𝑛(⃗𝑟)] and the external potential as shown in eq. 5.129.

𝐸[𝑛(⃗𝑟)] ≡

∫︁

𝑣(⃗𝑟)𝑛(⃗𝑟)𝑑⃗𝑟 + 𝐹 [𝑛]

(5.129)

For the ground state electron density 𝑛(⃗𝑟) the energy will be equal to the ground state energy 𝐸0 = 𝐸𝑣 [𝑛].
Where N is the number of particles in the system, the integral of the density over all space will sum to N (eq.
5.130).
101

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

8

0.09213

7

0.08189

6
0.07165

5

0.06142

0.05118

4

0.04094
3

0.03071

2

0.02047

1
0.01024

0

0.00000

0

1

2

3

4

5

6

7

8

Figure 5.23: Charge density FCC aluminium xy plane at 𝑧 = 0.0𝑎0

8

0.09213

7

0.08189

6
0.07165

5

0.06142

0.05118

4

0.04094
3

0.03071

2

0.02047

1
0.01024

0

0.00000

0

1

2

3

4

5

6

7

8

Figure 5.24: Charge density FCC aluminium xy plane at 𝑧 = 0.5𝑎0

𝑁 [𝑛] =

∫︁

𝑛(⃗𝑟)𝑑⃗𝑟

(5.130)

If the system has N particles the energy level for a none ground state energy, k, is given in eq. 5.131.

ˆ |Φ𝑘 ⟩
𝜖𝑣,𝑘 [Ψ𝑘 ] ≡ ⟨Φ𝑘 |𝑉ˆ |Φ𝑘 ⟩ − ⟨Φ𝑘 |𝑇ˆ − 𝑈

102

(5.131)

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

This has a minimum where Ψ𝑘 = Ψ0 , the ground state.

𝜖𝑣,𝑘 [Ψ𝑘 ] =
𝜖𝑣,0 [Ψ𝑘 ] =

5.7.8

∫︁

∫︁

𝑣(⃗𝑟)𝑛𝑘 (⃗𝑟)𝑑⃗𝑟 + 𝐹 [𝑛𝑘 ]
𝑣(⃗𝑟)𝑛0 (⃗𝑟)𝑑⃗𝑟 + 𝐹 [𝑛0 ]

(5.132)

𝜖𝑣,𝑘 > 𝜖𝑣,0

Kohn-Sham Equations

The year following the Hohenberg-Kohn theorem, a set of self-consistent equations were derived by Kohn and
Sham. The ground state energy of interacting jellium in the potential of fixed nuclei, an external potential, can
be written as follows[144]:

𝐸 = 𝑇𝑠 + 𝑈 + 𝑉𝑛−𝑒 + 𝐸𝑥𝑐

𝐸 = 𝑇𝑠 [𝜌(⃗𝑟)] +

∫︁

𝑑⃗𝑟𝑣(⃗𝑟)𝜌(⃗𝑟) +

1
2

∫︁ ∫︁

𝜌(⃗𝑟)𝜌(𝑟⃗′ )
𝑑⃗𝑟𝑑𝑟⃗′
+ 𝐸𝑥𝑐 [𝜌(⃗𝑟)]
|⃗𝑟 − 𝑟⃗′ |

(5.133)

(5.134)

The kinetic energy, 𝑇𝑠 , is that of a system of non interacting particles and 𝐸𝑥𝑐 is the exchange and correlation
of an interacting system. The exchange and correlation energy functional exists, but is unknown.
The Kohn-Sham equations are used to calculate the energy of a many body Schrödinger equation by solving
for a single electron.
ˆ 𝐾𝑆 𝜓𝑖 = 𝐸𝑖 𝜓𝑖
𝐻
(︂

(5.135)

)︂
1
− ∇2 + 𝑣ˆ𝐾𝑆 [𝑛](⃗𝑟) 𝜓𝑖 (⃗𝑟) = 𝐸𝑖 𝜓𝑖 (⃗𝑟)
2

(5.136)

∫︁

(5.137)

𝑣ˆ𝐾𝑆 (𝑟⃗𝑒 , 𝑟⃗𝑛 ) = 𝑣𝑛−𝑒 (𝑟⃗𝑒 , 𝑟⃗𝑛 ) +

𝑛(⃗𝑟) =

𝑑3 𝑟⃗′

𝜌(𝑟⃗𝑒′ )
+ 𝑣𝑥𝑐 [𝜌](𝑟⃗𝑒 )
|𝑟⃗𝑒 − 𝑟⃗𝑒′ |

𝑁
∑︁
|𝜓𝑖 (⃗𝑟)|2

(5.138)

𝑖

It is important to note that even though this is a one electron equation it is an exact solution.

5.7.9

Self-Consistent Solution

The Kohn-Sham equations cannot be solved in the usual way. They require a value for the density, but the
density is obtained by solving the equations, so there is a dilemma. It can however be solved self consistently:
an initial density is guessed, and this is repeatedly updated until the density in and out values are the same (or
within a set convergence threshold). The basic algorithm used by PWscf from the Quantum Espresso suite is
shown in fig. 5.25[145].

103

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Solve 𝐻ˆ𝑘𝑠 𝜓𝑖 = 𝑒𝑖 𝜓𝑖

Construct 𝑉𝑘𝑠 = 𝑉𝑛𝑒 + 𝑉𝑒𝑒 [𝜌] + 𝑉𝑥𝑐 [𝜌]

Guess 𝜌𝑖𝑛

Compute 𝑉𝑘𝑠

Diagonalize 𝐻𝑘𝑠

Compute 𝑟ℎ𝑜𝑜𝑢𝑡

Mix

No

𝜌𝑖𝑛 == 𝜌𝑜𝑢𝑡

Yes

End
Compute energy, forces etc
Figure 5.25: SCF algorithm for Quantum Espresso

In practice the input and output densities may never be exactly the same so rather than wait indefinitely for
convergence, a threshold is set. The smaller the threshold the more iterations and time would be expected to
pass, but the calculation will be closer to the solution.
With each iteration the density of the last iteration is mixed into a new density. If simple linear mixing is used
a mixing beta determines the ration of new to old density as given in eq. 5.139[146].

𝜌𝑛+1 = (1 − 𝛽)𝜌𝑛𝐾𝑆 + 𝛽𝜌𝑛𝑜𝑢𝑡

(5.139)

More advanced mixing methods include Newton-Raphson or Broyden mixing. The PWscf program within
Quantum Espresso uses Broyden for charge density mixing by default. Charge sloshing is an issue where
convergence is slow or never happens. This is a particular problem for metals[147] and is more significant
the larger the system[148]. The Thomas-Fermi screening used is based on the work by Johnson[149] and this
works well for highly homogenous systems. Further work by Raczkowski, Canning and Wang[148] developed a
Pulay-Thomas-Fermi method that is implemented in PWscf with the local-TF mixing mode, and this is better
suited to highly inhomogeneous systems.

104

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7.10

5.7. DENSITY FUNCTIONAL THEORY

Exchange-Correlation Energy

The Kohn-Sham equations have an exchange-correlation energy and this functional is used to collect together
the electron energy not captured in the non-interacting energy functionals.
The Pauli exclusion principle states that two fermions, half integer spin particles, cannot occupy the same
quantum state. This is why electrons occupy a unique orbital within an atom defined by the quantum numbers
n, l, 𝑚𝑙 and 𝑚𝑠 . Consider two particles at points 𝑟⃗𝑎 and 𝑟⃗𝑏 ; the probability amplitude of the wavefunction of
these particles equals 1.

|Ψ(𝑟⃗𝑎 , 𝑟⃗𝑏 )|2 = 1

(5.140)

Exchanging the particles must also give the same result; they still must exists somewhere with probability 1.

|Ψ(⃗
𝑟𝑏 , 𝑟⃗𝑎 )|2 = 1

(5.141)

Bosons, integer spin particles, are symmetric when exchanged:

Ψ(𝑟⃗𝑎 , 𝑟⃗𝑏 ) = Ψ(⃗
𝑟𝑏 , 𝑟⃗𝑎 )

(5.142)

Fermions, on the other hand, are antisymmetric:

Ψ(𝑟⃗𝑎 , 𝑟⃗𝑏 ) = −Ψ(⃗
𝑟𝑏 , 𝑟⃗𝑎 )

(5.143)

By setting up a wavefunction for two Fermions, and exchanging them, it can be seen why they cannot exist in
the same state.

Ψ𝑎𝑏 = 𝜓1 (𝑟⃗𝑎 , 𝑟⃗𝑏 ) − 𝜓2 (⃗
𝑟𝑏 , 𝑟⃗𝑎 )

(5.144)

Ψ𝑎𝑏 = 𝜓1 (𝑟⃗𝑎 , 𝑟⃗𝑏 ) − 𝜓2 (𝑟⃗𝑎 , 𝑟⃗𝑏 ) = 0

(5.145)

The XC term combines the difference between the real system and the fictitious non-interacting system set out
in the Kohn-Sham equations. It also includes the difference between the quantum mechanical electron-electron
repulsion and classical electron-electron repulsion. Unfortunately, whilst we know a functional exists, we do not
know the exact form of it[150].

5.7.11

Pseudopotentials

Plane wave basis sets are used to help solve the TISE. The DFT code used in this work is Quantum Espresso,
and the binary that carries out the calculations is named PWscf: plane wave self consistent field.
105

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

⃗ is the reciprocal lattice vector, a summation of plane waves may be used to construct each electronic
Where 𝐺
wave function (eq. 5.146)[151].

Ψ⃗𝑘,𝑛 =

⃗ 𝐺𝑚𝑎𝑥
⃗
|𝐺|<

∑︁
⃗
𝐺

(︁
)︁
⃗ ⃗˙
𝑐⃗𝑘+𝐺,𝑛
⃗ exp 𝑖(𝑘 + 𝐺)⃗𝑟

(5.146)

Unfortunately, the plane-wave basis sets required are too large to be used in practice, as the would need to
represent the tight, rapidly oscillating inner orbitals as well as the valence electrons.
Bonding and material properties are primarily determined by valence electrons, not core electrons. Iron, for
example, has two valence electrons in the 4s shell; however, it is a transition metal and the partially empty 3d
shell is also important to consider. The core electrons do not contribute as much to the bond and the model
may be simplified using pseudopotentials.

Figure 5.26: Replacing the complex potentials with a pseudopotential[152]

The eigen-energies of core electrons are also much larger than properties we see in materials, such as the cohesive
energies and this also raises a concern that including the core electrons may introduce errors that are on a similar
scale to the energies we are calculating.
The rapidly oscillating function in the core is replaced by a smoother pseudopotential. The same material
properties are calculated as the valence electron functions are preferenced, but a much small basis set is required
to do so. There are a wide range of pseudopotentials available to use in DFT calculations, and one major
distinguishing feature is how they treat the XC potential 𝑣𝑥𝑐 ([𝑛]; ⃗𝑟).
(︂

)︂
1
+ 𝑉𝑒𝑥𝑡 (⃗𝑟) + 𝑉𝐻 (⃗𝑟) + 𝑉𝑥𝑐 (⃗𝑟) 𝜓𝑘,𝜎 (⃗𝑟) = 𝜖𝑘,𝜎 𝜓𝑘,𝜎 (⃗𝑟)
2

(5.147)

The KS equation consists of several potentials including the exchange-correlation energy. This term represents
the many-electron effects.
LDA
The local density approximation replaces the electron density with jellium, a homogeneous electron gas. Kohn
and Sham, in their original 1965 work, introduced jellium as the density model and, despite its simplicity in
comparison to the real electron density distribution, it has worked well for simple metals.

𝐿𝐷𝐴
𝐸𝑥𝑐
[𝜌] =

∫︁

𝑑3⃗𝑟𝜌(⃗𝑟)[𝑒𝑥 (𝜌(⃗𝑟)) + 𝑒𝑐 (𝜌(⃗𝑟))

106

(5.148)

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

Several different LDA functionals have been developed over the years, including that of Perdew and Zunger.
This functional takes the form given in eq. 5.149[153].

𝜖𝐶 [𝑛(⃗𝑟)] =

{︃

−0.14231
(
1+1.9529𝑟𝑠 0.5)+0.334𝑟𝑠

𝑟𝑠 >= 1

−0.0480 + 0.0311𝑙𝑟(𝑟𝑠 ) − 0.0116𝑟𝑠 + 0.0020𝑟𝑠 𝑙𝑛(𝑟𝑠 )

𝑟𝑠 < 1

(5.149)

LSDA
Electrons are fermions and have half integer spin. When trapped in a potential, such as an atom or a crystal
lattice, electrons must take difference quantum states and one of the parameters is the spin of the electron. The
LDA does not treat spin at all, but the LSDA splits the density into up and down spin (eq. 5.150[150]).

𝜌↑ (⃗𝑟) =

𝑜𝑐𝑐
∑︁
|𝜑𝑘,↑ (⃗𝑟)|2
𝑘

𝑜𝑐𝑐
∑︁
𝜌↓ (⃗𝑟) =
|𝜑𝑘,↓ (⃗𝑟)|2

(5.150)

𝑘

𝜌(⃗𝑟) = 𝜌↑ (⃗𝑟) + 𝜌↓ (⃗𝑟)

The XC energy is now dependent on the spin up and spin down density as well as the position (eq. 5.151[150]).

𝐿𝑆𝐷𝐴
𝐸𝑥𝑐
[𝜌↑ , 𝜌↓ ] =

∫︁

𝑑3⃗𝑟𝜌(⃗𝑟)[𝑒𝑥 (𝜌(⃗𝑟))𝑓 (𝜁(⃗𝑟)) + 𝑒𝑐 (𝜌(⃗𝑟), 𝜁(⃗𝑟))
𝜌↑ − 𝜌↓
𝜌↑ + 𝜌↓
)︁
1 (︁
𝑓 (𝜁) =
(1 + 𝜁)4/3 + (1 − 𝜁)4/3
2
𝜁=

(5.151)

The energy of the system now being solved is also dependent upon the charge density and spin polarization (eq.
5.152).

1
𝐸 = 𝑇 [𝜌, 𝜁] + 𝐸𝑒𝑥𝑡 [𝜌] + 𝐸𝑒𝑒 [𝜌] + 𝐸𝑥𝑐 [𝜌, 𝜁]
2

(5.152)

GGA
In the LDA and LSDA approximations, the electron density is that of an homogeneous electron gas that does
not represent the real electron density. The density of this gas may change in space, but locally it is a constant
density with no gradient.

𝐺𝐺𝐴
𝐸𝑥𝑐
[𝜌↑ , 𝜌↓]

=

∫︁

𝑑3 𝑟𝑓 (𝜌↑ , 𝜌↓, ∇𝜌↑ , ∇𝜌↓)

(5.153)

The GGA functional (eq. 5.153 [150]) takes the spin up spin down electron densities as well as their gradients.

107

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Failures

Successes of GGA

• exchange-correlation holes can be unrealistic under some circumstances

• atomization energy of molecules better
• binding energy curves more realistic

• works better for exchange correlation together than either alone

• Fe is bcc ferromagnet with GGA (fcc nonmagnet with LSDA)

• interaction of electrons in different shells
poorly described

• Gives the anti invar effect in gamma-Fe
and fc Fe-Mn
• Improvement on 4% accuracy for LSDA
of alkali metal lattice constants
• Better lattice constants and bulk moduli
of transition metals
• Isostructural transformation from open
to close packed improved
• Successful calculation of a monovacancy
in silicon
• Oxidation of the Si(001) surface using
spin polarized GGA

Figure 5.27: Successes and failures of the GGA functional[150]

The PBE functional was developed to address some of the short falls of the Perdew-Wang PW91 LSDA functional. These include an over complication in the formulation of PW91 and that it was designed to satisfy many
exact conditions. The PBE development focused more on energetically significant conditions[154].

𝐸𝑐𝑃 𝐵𝐸 [𝜌↑ , 𝜌↓] =

∫︁

𝑑3 𝑟𝜌[𝑒𝑐 (𝑟𝑠 , 𝜁) + 𝐻(𝑟𝑠 , 𝜁, 𝑡)]

𝐸𝑥𝑃 𝐵𝐸 [𝜌] =

∫︁

𝑑3 𝑟𝜌𝑒𝑥 (𝜌)𝐹𝑥 (𝑠)

(5.154)

(5.155)

The functional is split into a correlation energy (eq. 5.154) and exchange energy (eq. 5.155). 𝜁 is the relative
spin polarization 𝜁 = (𝜌↑ − 𝜌↓ )/(𝜌↑ + 𝜌↓ ) and 𝑟𝑠 is the local Seitz radius where 𝜌 = 3/4𝜋𝑟𝑠3 . The functions 𝑒𝑥 (𝜌)

and 𝑒𝑐 (𝜌) are the exchange and correlation energy per electron of unpolarised uniform electron gas[150]. A full
description of the functional is in the appendix J.
LSDA vs GGA Potentials
Typically, GGA is an improvement over LSDA, with improvements in the total energies and structural energy
differences[154]. Another short coming of LSDA is that it predicts FCC to be the optimal structure for pure iron
at 0K, which is incorrect[155]. A list of success stories and failures were discussed shortly after the publication
of the PBE functional and these are summarised in figure 5.27[150].
In the case of the compound Titanium Disilicide, 𝑇 𝑖𝑆𝑖2 , GGA is in better agreement, overall, with experiment
than LDA, although several values are better predicted by the latter. As shown in table 5.5, the data shows
that LDA is within 1.26% of the experimental lattice parameters, 6.16% of the experimental bulk modulus and
18.3% the value of the experimental elastic constants; several of these were particularly poor, with an almost

108

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

Parameter

Experimental

LDA

GGA

a/angs
b/angs
c/angs
𝐵0 (Reuss)/GPa
𝐵0 (Voigt)/GPa
𝐶11 /GPa
𝐶22 /GPa
𝐶33 /GPa
𝐶44 /GPa
𝐶55 /GPa
𝐶66 /GPa
𝐶12 /GPa
𝐶13 /GPa
𝐶23 /GPa

8.27
4.80
8.55
146.8
150.9
317.5
320.4
413.2
112.5
75.8
117.5
29.3
38.4
86.0

8.08
4.74
8.53
156.9
159.1
377.2
341.1
425.3
136.5
93.7
154.6
27.8
21.3
95.1

8.21
4.81
8.64
141.9
145.0
326.0
298.4
371.9
123.5
85.3
135.9
22.4
26.5
105.5

Table 5.5: Experimental vs LSDA vs GGA for 𝑇 𝑖𝑆𝑖2 [109]

45% disagreement. On the other hand, GGA is within 0.66% of the experimental lattice parameters, 3.62% of
the experimental bulk modulus and 14.97% the value of the experimental elastic constants[109].
Lanthanum aluminate (𝐿𝑎𝐴𝑙𝑂3 ) has also been studied using DFT, but this material is better modelled (to
reproduce lattice parameters and bulk modulus) with either LDA or a specific form of GGA, the Perdew-BurkeErnzerhof functional revised for solids (PBESOL) potential. The PBESOL is a revised PBE functional designed
to better reproduce lattice parameters for solids, as shown in table 5.6.
Parameter

Experimental

LDA

GGA

GGA (PBESOL)

a/angs
𝐵0 /GPa

3.78
215

3.74
224.00

3.82
190.35

3.77
206.41

Table 5.6: Experimental vs LSDA vs GGA vs GGA PBESOL for 𝐿𝑎𝐴𝑙𝑂3 [156]

A complete library of pseudo-potentials is available through the Quantum Espresso website. Several of these
have been tested with the PWscf code to calculate the lattice parameter and bulk modulus of simple metals
including Aluminium and Sodium.
As can be seen from table 5.7, the PBE and PBESOL GGA type potentials are in general better at reproducing
the lattice parameters. However, for Aluminium, the PZ LSDA type potential is in better agreement when
calculating the bulk modulus. Overall, the GGA type potentials with the total self-consistent potential pseudized
(these are the pseudopotential files that contain -n- in the name, rather than -nl-) perform best for these simple
metals.
Whilst DFT is an exact method for solving the TISE, there are a number of approximations that still need to
be made in addition to there being gaps in our knowledge (i.e. a lack of an exact functional for the XC).

5.7.12

Ecut, K-Point Integration and Smearing

As discussed in section 5.7.6 the wavefunction can be expressed as a periodic function with the same period as
the crystal lattice (eq. 5.156). The periodic function may then be written as a sum of plane waves (eq. 5.157).

109

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Pseudo-potential

Element

a/angs

𝐵0 /GPa

Experimental
Na.pz-spn-kjpaw psl.1.0.0
Na.pbe-spn-kjpaw psl.1.0.0
Na.pbesol-spn-kjpaw psl.1.0.0
Experimental
Al.pz-nl-kjpaw psl.1.0.0
Al.pz-n-kjpaw psl.1.0.0
Al.pbe-nl-kjpaw psl.1.0.0
Al.pbe-n-kjpaw psl.1.0.0
Al.pbesol-nl-kjpaw psl.1.0.0
Al.pbesol-n-kjpaw psl.1.0.0

Na
Na
Na
Na
Al
Al
Al
Al
Al
Al
Al

4.29[157]
4.06
4.20
4.17
4.05[158]
3.98
3.98
4.04
4.04
4.01
4.01

6.3[157]
8.72
7.67
7.50
76[158]
78.6
78.6
91.3
75.0
87.7
79.0

Table 5.7: Experimental vs LSDA vs GGA - the DFT values were computed with a PWscf[159] using a 2x2x2 cell, 7x7x7
kpoints and ecutwfc=50

(︁
)︁
𝜓𝑛⃗𝑘 (⃗𝑟) = 𝑢𝑛⃗𝑘 (⃗𝑟) exp 𝑖⃗𝑘 · ⃗𝑟

(5.156)

(︁
)︁
⃗ 𝑟
𝑉𝐺
⃗ exp 𝑖𝐺 · ⃗

(5.157)

𝑢𝑛⃗𝑘 (⃗𝑟) =

∑︁
⃗
𝐺

Solving the Kohn-Sham equations requires the matrix diagonalization of a size NxN where N is the number of
planewaves for each k-point in the Brillouin Zone[160]. The number of planewaves can be reduced to satisfy eq.
5.158. In practice this will mean reducing 𝐸𝑐𝑢𝑡 whilst ensuring the desired accuracy is still met.

~2 𝐺2
<= 𝐸𝑐𝑢𝑡
2𝑚

(5.158)

In order to compute the energy using HK, the charge density in the BZ is calculated. It is impossible to
diagonalise the matrix at an infinite number of k-points. The integral is replaced with a summation over
selected points which in turn are weighted (eq. 5.159)[161].
∫︁
∫︁
∑︁
1 ∑︁
1
*
⃗
⃗
𝜌(⃗𝑟) =
𝑓 (𝑘, 𝑖)𝜓𝑖,⃗𝑘 (⃗𝑟)𝜓𝑖,⃗𝑘 (⃗𝑟)𝑑𝑘
𝑑⃗𝑘 →
𝜔⃗𝑘
Ω𝑏𝑧 𝑖
Ω𝑏𝑧 𝐵𝑍

(5.159)

⃗
𝑘

Due to Bloch theorem and the Born-Von-Karman boundary conditions, only the first BZ needs to be sampled.
As discussed earlier, if there are further symmetries in the unit cell, only the IBZ need to be sampled.
The integral over k-space is replaced by a set of points in k-space that are sampled. The higher the number of
points, the higher resolution the space is sampled in, but the longer the calculation will take. The Gamma point
Γ is a high symmetry point in reciprocal space and is located at (0,0,0). It may be used as the only sampling
point in some DFT calculations.
The Monkhorst-Pack grid is a special set of k-points. They are distributed evenly in reciprocal space and may
be aligned such that either one point coincides with Γ or such that 8 points closest points surround Γ at an
110

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

Figure 5.28: Energy gap between valence and conduction bands[163]

Figure 5.29: Probability F(E) of finding a fermion with energy E at several
temperatures[164]

equal distance. By offsetting the grid from Γ and the coordinate axis of reciprocal space, the sampling better
avoids points of high symmetry.
Where the system is spin degenerate, each state is occupied by 2 electrons for the lower 𝑁2𝑒 states (𝑓 (⃗𝑘, 𝑖) = 2),
and zero otherwise (𝑓 (⃗𝑘, 𝑖) = 0)[162]. This drop, from states occupied by two electrons to empty states occurs
at the Fermi surface and it results in a discontinuity in the functions being integrated over in eq. 5.159. This is
the case for an electron gas at absolute zero, but if the gas is heated then there is sufficient energy for electrons
to occupy states above the Fermi energy. This is a problem that affects metals due to the overlap in conduction
and valence bands (figure ??).
Fermi-Dirac statistics determine the probability of a Fermion having an energy E (eq. 5.160). As the temperature
increases the probability of finding a fermion above the Fermi energy increases (figure 5.29). This also smooths
the discontinuity at the Fermi surface between the occupied and unoccupied states (at 0K).

𝐹 (𝐸) =

1
)︀
(︀
𝐹
exp 𝐸−𝐸
+1
𝑘𝑇

(5.160)

To avoid having to integrate the BZ with a very fine mesh, a smearing function is introduced to remove the
discontinuity at the Fermi surface, making the integral over the BZ differentiable at every point. The relationship
between the delta and Heaviside step is used to replace the step function when integrated (eq. 5.161).

∫︁

∞

𝛿(𝑘)𝑑𝑘 = Θ(𝑥)

(5.161)

−∞

𝐼=

∫︁

∞

−∞

𝑆(𝜖 − 𝐸𝐹 )

∫︁

𝐵𝑍

111

𝑓 (⃗𝑘)𝛿(𝜖 − 𝐸(⃗𝑘))𝑑⃗𝑘𝑑𝜖

(5.162)

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Figure 5.30: Delta function replaced by successive Hermite polynomials[165]

The step function at the Fermi surface (eq. 5.162), that causes the discontinuity, may be replaced with a
smearing function[165]. Four of these functions are available to use in the PWscf DFT code.
The Fermi-Dirac function, as mentioned above, is used to heat the system. It removes the discontinuity but the
SCF will converge to the wrong energy (eq. 5.163).

𝑆𝐹 𝐷 (𝜖) =

exp

1
(︀ 𝜖−𝐸 )︀
𝐹

𝑘𝑇

+1

(5.163)

A Gaussian smear is also used to replace the step function although, unlike the Fermi-Dirac function, it has no
physical meaning (eq. 5.164).

𝑆𝐺 (𝜖) =

[︂
(︂
)︂]︂
1
𝜖−𝜇
1 − erf
2
𝜎

(5.164)

The Methfessel-Paxton method attempts to correct the errors introduced by the previous smearing functions
where the delta function is replaced with Hermite polynomials (fig. 5.30 and eq. 5.166). A drawback of this
method is that is allows for negative occupancy of electron states[162].

𝑥 = 𝜖 − 𝐸𝐹 𝑆𝑀 𝑃,𝑁 (𝑥) =

𝑁
∑︁
(︀
)︀
(−1)𝑛
1
√
[1 − 𝑒𝑟𝑓 (𝑥)] +
𝐴𝑛 𝐻2𝑛+1 (𝑥) exp −𝑥2 𝐴𝑛 =
2
𝑛!4𝑛 𝜋
𝑛=1

(5.165)

The Mazari-Vanderbilt function was developed to address the short falling of the Methfessel-Paxton function.
The occupancy where this function is used is always positive (fig. 5.31).

112

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

Figure 5.31: The occupancy for the Marzari-Vanderbilt smearing function is
always positive, unlike the Methfessl-Paxton function[166]

)︂
(︂
√
𝜇−𝜖
1
1 2
𝑥=
𝛿(𝑥) = √ exp −(𝑥 − ( √ )) (2 − 2𝑥)
𝜎
𝜋
2

(5.166)

The recommended smearing function for Quantum Espresso is the Mazari-Vanderbilt type. Dr Mazari who
co-developed the smearing type also contributed to the development of Quantum Espresso. Dr Vanderbilt has
researched condensed-matter physics for 30 years and is also responsible for an entire category of pseudopotentials.

5.7.13

Brief History of Magnetism

Magnetism as a phenomenon has been known to our civilisation for thousands of years. The magnetic mineral
Lodestone contains the iron oxide Magnetite 𝐹 𝑒3 𝑂4 and it was used by the ancient Greeks over two thousand
years ago. The magnetic compass had been used since the 12th century, but is wasn’t until the 17th Century
that the Earth was discovered as a magnet itself by William Gilbert.

⃗ =
𝜕·𝐸

𝜌
𝜖0

⃗ =0
∇·𝐵

⃗
⃗ = − 1 𝜕𝐵
∇×𝐸
𝑐 𝜕𝑡)︃
(︃
⃗
⃗ = 1 4𝜋 𝐽⃗ + 𝜕 𝐸
∇×𝐵
𝑐
𝜕𝑡

(5.167)

In the early 1800s, Hans Christian Oersted discovered that an electric current could move a compass needle,
and this lead to much research into the connection between electricity and magnetism. Experimental work by
Michael Faraday lead to the discovery that a changing magnetic field produces an electric field. By the mid1800s the mathematical physicist, James Clerk Maxwell, derived his set of equations describing the connection
between magnetism and electricity (eq. 5.167).
113

5.7. DENSITY FUNCTIONAL THEORY

5.7.14

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

Magnetism: Moving Charges and Spin

General Relativity and Quantum Mechanics were invented as theories to solve anomalies in science during the
first part of the 20th Century, and they describe the very large and very small realms we do not notice in every
day life. In describing how magnetism comes to be, it may be useful to use classical analogies, but that’s all
they are. Quantum Mechanics is required and this replaces intuition with a mathematical description.

⃗ = 𝜇0 𝑞 ⃗𝑣 × ⃗𝑟𝑖𝑗
𝐵
3
4𝜋𝑟𝑖𝑗

(5.168)

When a charged particle moves, it creates a magnetic field. The field at some point j created by a charge moving
at ⃗𝑣 at point i is calculated (eq. 7.2). Electrons do not orbit around a nucleus in the classical sense, but they
do have an orbital angular momentum. The overall magnetic field created by an atom is made up of:
• orbital angular momentum of the electron
• spin of electrons
• spin of nucleons
The contribution of the nucleus to the magnetic field is small, and the orbital component and spin component
of electrons are mostly responsible.
Spin is a property of quantum mechanics and it doesn’t have an equivalent in classical mechanics, although it
may be thought of similar to a spinning top or a rotating planet. Electrons are point like particles, and do not
actually rotate, but they do have an intrinsic angular moment (spin). Where a spinning top might have a range
of angular velocities, electrons have a quantized value and, as fermions, they have half integer spin.

5.7.15

Ferromagnetism, Antiferromagnetism and Hund’s Rule

Electrons fill the shells of a ground state atom such that the energy is minimised. Four quantum numbers are
used to describe electrons bound to an atom: n, l, 𝑚𝑙 and 𝑚𝑠 . The Pauli exclusion principle states that the
electrons, which are fermions, cannot have the same quantum numbers as another electron bound to that atom.
Electrons may be spin up or spin down thus two electrons can have the same n, l, 𝑚𝑙 with two values for 𝑚𝑠
available. The energy is minimised by not pairing up and down electrons until all the free slots due to the
coulomb interaction between the electrons. Once each slot contains one electron, they begin to pair.
The electronic configuration of Fe highlights this (eq 5.169).

Electronic configuration of Iron
1𝑠2 ↑↓

2𝑠2 ↑↓

2𝑝6 ↑↓ ↑↓ ↑↓

(5.169)

3𝑠2 ↑↓

3𝑝6 ↑↓ ↑↓ ↑↓
4𝑠2 ↑↓

3𝑑6 ↑↓ ↑
114

↑

↑

↑

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

5.7. DENSITY FUNCTIONAL THEORY

Rather than fill the 3d shell from left to right, the first five slots take electrons with spin in the same direction,
and the remaining electron fills the first slot with spin opposite to the first five electrons.
Being fermions the wavefunction for the two electrons must be antisymmetric, with spins opposite to one another.
Electrons with the same spin will repel one another and this causes an increase in the screening between the
electrons and the nucleus. The screening lowers the attraction between the electrons and the nucleus that then
results in the total energy of the atom decreasing[167].

Electronic configuration of Chromium (outer shells)
4𝑠1 ↑
3𝑑

5

↑

(5.170)
↑

↑

↑

↑

Electronic configuration of Iron (outer shells)
4𝑠2 ↑↓
3𝑑

6

↑↓ ↑

(5.171)
↑

↑

↑

Electronic configuration of Cobalt (outer shells)
4𝑠2 ↑↓

3𝑑7 ↑↓ ↑↓ ↑

(5.172)
↑

↑

Electronic configuration of Nickel (outer shells)
4𝑠2 ↑↓

3𝑑8 ↑↓ ↑↓ ↑↓ ↑

(5.173)
↑

In pure Fe (eq. 5.171), under normal conditions, it is energetically favourable for the atoms to align in the same
direction, and as such Fe is ferromagnetic. Co (eq. 5.172) has a face centered tetragonal structure at room
temperature. It has a similar electronic structure to iron, but has three unpaired electrons in the 3d shell rather
than four. It is a ferromagnetic whilst it remains in it’s CPH form. Ni (eq. 5.173) is also ferromagnetic, but it
is ferromagnetic in its FCC phase.
In its gamma phase, as it is in austenitic stainless steel, Fe atoms align opposite to one another in an antiferromagnetic arrangement. This is also the same for BCC Cr (eq. 5.170) which is antiferromagnetic in its pure
form under normal conditions.

5.7.16

Collinear and Non-Collinear DFT Calculations

Although briefly discussed by Kohn and Sham in their 1965 paper[144], DFT does not differentiate between the
spins of electrons. However, where the material is in a magnetic field, or where there are unpaired electrons,
spin-DFT may be used. This is a good way to model magnetic materials, such as iron, where Hund’s rule leads
to unpaired electrons as discussed in section 5.7.15.
In collinear calculations the spin of electrons is restricted to two directions, up and down (in the z-axis, in the
case of Quantum Espresso), whereas noncollinear calculations give the freedom to orient in any direction.

115

5.7. DENSITY FUNCTIONAL THEORY

CHAPTER 5. INTERATOMIC POTENTIAL FITTING

(︃

1
− ∇2 + 𝑣𝑛−𝑒 (𝑟⃗𝑒 , 𝑟⃗𝑛 ) +
2

∫︁

)︃
𝜌(𝑟⃗𝑒′ )
+ 𝑣𝑥𝑐 [𝜌](𝑟⃗𝑒 ) 𝜓𝑖 = 𝐸𝑖 𝜓𝑖
𝑑 𝑟
|𝑟⃗𝑒 − 𝑟⃗𝑒′ |
3 ⃗′

(5.174)

The Kohn-Sham equation is modified to include the magnetic field 𝐵(⃗𝑟) and magnetization density 𝑚(⃗𝑟)[168][169].
Starting with the traditional Kohn-Sham equation, eq. 5.174, the potential and densities are replaced with 2x2
matrices and the equation as a whole is split into spin up and spin down.
(︃(︃

1
− ∇2 +
2

∫︁

𝜌(𝑟⃗𝑒′ )
𝑑3 𝑟⃗′
|𝑟⃗𝑒 − 𝑟⃗𝑒′ |

)︃ [︃
1
0

[︃ ]︃
)︃ [︃ ]︃
𝜓𝑖↑
𝜓𝑖↑
+ ⃗𝑣𝑛−𝑒 (𝑟⃗𝑒 , 𝑟⃗𝑛 ) + 𝑣𝑥𝑐 [⃗
𝜌](𝑟⃗𝑒 )
↓ = 𝐸𝑖
𝜓𝑖↓
𝜓𝑖
1
]︃
0

(5.175)

The equation is modified as shown in eq. 5.175 and, using the Pauli vector, the potential functions (eq. 5.176
and eq. 5.177)[170] and density functions are rewritten (eq. 5.178)[170].
[︃
]︃
𝑚𝑥 (⃗𝑟) − 𝑖𝑚𝑦 (⃗𝑟)
1 𝜌(⃗𝑟) + 𝑚𝑧 (⃗𝑟)
𝜌
⃗(⃗𝑟) =
2 𝑚𝑥 (⃗𝑟) + 𝑖𝑚𝑦 (⃗𝑟)
𝜌(⃗𝑟) − 𝑚𝑧 (⃗𝑟)

⃗𝑣 (⃗𝑟) =

𝑣⃗𝑥𝑐 (⃗𝑟) =

[︃

[︃

𝑣(⃗𝑟) + 𝜇𝐵 𝐵𝑧 (⃗𝑟)

𝜇𝐵 (𝐵𝑥 (⃗𝑟) + 𝑖𝐵𝑦 (⃗𝑟))

𝑣𝑥𝑐 (⃗𝑟) + 𝜇𝐵 𝐵𝑥𝑐,𝑧 (⃗𝑟)

𝜇𝐵 (𝐵𝑥𝑐,𝑥 (⃗𝑟) + 𝑖𝐵𝑥𝑐,𝑦 (⃗𝑟))

𝜇𝐵 (𝐵𝑥 (⃗𝑟) − 𝑖𝐵𝑦 (⃗𝑟))
𝑣(⃗𝑟) − 𝜇𝐵 𝐵𝑧 (⃗𝑟)

(5.176)

]︃

𝜇𝐵 (𝐵𝑥𝑐,𝑥 (⃗𝑟) − 𝑖𝐵𝑥𝑐,𝑦 (⃗𝑟))
𝑣𝑥𝑐 (⃗𝑟) − 𝜇𝐵 𝐵𝑥𝑐,𝑧 (⃗𝑟)

(5.177)

]︃

(5.178)

This work is only concerned with collinear calculations, where the spins are aligned up or down with respect
to the z-axis. The equation derived by Von Barth and Hedin may be simplified to give the pair of Kohn-Sham
equations in eq. 5.179.
(︃

)︃
∫︁
⃗′
1 2
3 ⃗′ 𝜌(𝑟𝑒 )
↑
+ 𝑣𝑥𝑐 [⃗
𝜌](𝑟⃗𝑒 ) + 𝐵𝑧 (⃗𝑟) 𝜓𝑖↑ (⃗𝑟) = 𝐸𝑖↑ 𝜓𝑖↑ (⃗𝑟)
− ∇ + 𝑑 𝑟
′
⃗
2
|𝑟⃗𝑒 − 𝑟𝑒 |
(︃
)︃
∫︁
⃗′
1 2
3 ⃗′ 𝜌(𝑟𝑒 )
↓
− ∇ + 𝑑 𝑟
+ 𝑣𝑥𝑐 [⃗
𝜌](𝑟⃗𝑒 ) − 𝐵𝑧 (⃗𝑟) 𝜓𝑖↓ (⃗𝑟) = 𝐸𝑖↓ 𝜓𝑖↓ (⃗𝑟)
2
|𝑟⃗𝑒 − 𝑟⃗𝑒′ |

(5.179)

This model requires self consistently solving for both the charge density 𝜌(⃗𝑟) and magnetisation density 𝑚𝑧 (⃗𝑟).
It will be adequate for modelling the ferromagnetism of pure iron and antiferromagnetic structure of iron as it
exists in austenitic stainless steel. A full non-collinear treatment would no doubt be better, when considering
surfaces and the presence of doped PGMs atoms in the structure, but would require more resources plus reliable
and tested pseudopotentials suitable for these calculations.

116

Chapter 6

Predicting Activation in Proton
Irradiated Samples
A computer program, Activity, was developed to calculate the radioactivity of an ion irradiated
target. The code has been released in two versions, with the first being written in Fortran and the
second in Python. SRIM, an ion transport code, was used to calculate proton trajectories used by
the Activity codes.
Decay equations were derived to calculate the activity of isotopes within the target at time t during
and after irradiation. These were created in a similar manner to the Bateman equations for radioactive decay, but include source terms and branching factors for radioactive isotopes in a decay
chain. These were implemented in a module and class for each version of the code.
The University of Birmingham cyclotron was used to activate Iron samples (this work) and Molybdenum (a colleague’s work). The radioactivity of these samples were compared to the predicted
activity and gamma lines of the Activity code.
Finally, the latest version of the Activity code was used to predict the activity of a Steel specified
by another colleague and a set of Iron samples irradiated to 100DPA at varying proton energies.
The results of these simulations are presented in this chapter.

6.1

Introduction

High flux neutron reactors are expensive to use, whereas proton accelerators capable of producing beams of
adequate fluence and energy are more readily available, cheaper to buy and cheaper to run. Ion beams, due
to the Coulomb interaction, are more controllable in terms of energy, direction and fluence. They may be
concentrated on a desired target at a set fluence and energy.
Depending on the energy of the ion beam, the target material will become radioactive. The stable nuclei are
transmuted and when the resulting isotope is unstable it will decay. An equation was derived to predict the
activity of isotopes for any decay chain with source terms and branching factors included. Two versions of a
computer code were developed to compute the reaction rates and activity of the irradiated targets.

117

6.2. ACTIVATION BY ION IRRADIATION

6.2

CHAPTER 6. PREDICTING ACTIVATION

Activation by Ion Irradiation

The Bateman equation was derived using Laplace transforms, and this same method has been used to develop a
modified equation that incorporates branching factors and production rates for each isotope in the decay chain,
as illustrated by figure 6.1.
Parent Isotope

Parent Source

Branching

External Source

Daughter 1 (Branch A)

Daughter 1 (Branch B)

External Source

Daughter 2 (Branch B)

External Source

Branching

External Source

Daughter 2 (Branch A)

Figure 6.1: An example of several decay chains including branching factors and possible external source terms
for each isotope on each chain.

6.2.1

Laplace Transform

Laplace Transforms (eq. 6.1) are a useful mathematical tool, and allow ordinary differential equations to be
solved by simple algebraic manipulation in the s domain (appendix A). Bateman took advantage of Laplace
Transforms in deriving his equation, and this is the method that has been taken here as well.

𝐹 (𝑠) =

∫︁∞

𝑓 (𝑡) exp(−𝑠𝑡)𝑑𝑡

(6.1)

0

6.2.2

Constructing the Differential Equations

The first step is to set up differential equations for the parent isotope, unstable daughter isotopes and stable
daughter isotope. The parent isotope has a source term, due to production, and a loss term, due to decay. The
unstable daughter isotopes have two source terms, from the production by irradiation induced transmutation
and the decay of preceding isotopes in the decay chain, and a loss term, due to decay. Finally, the stable
daughter that finalizes the decay chain has two source terms (the same as the unstable daughters) but no loss
term.
The variables (and vectors) used in these equations are defined as follows:
• ⃗𝜆 vector containing isotope decay constants 𝜆𝑖

118

CHAPTER 6. PREDICTING ACTIVATION

6.2. ACTIVATION BY ION IRRADIATION

• ⃗𝑏 vector containing isotope to isotope branching factors 𝑏𝑖
• 𝑤
⃗ vector containing isotope production rates 𝑤𝑖
• 𝑡 time at which activity/amount of isotope is measured
• 𝑁𝑖 (0) starting amount of the ith isotope
• 𝑁𝑖 (𝑡) amount of the ith isotope at time t
• 𝑁𝑖′ (𝑡) change in amount of the ith isotope, with respect to time, at time t
The differential equations for the parent isotope (first isotope), unstable daughter isotopes (ith isotopes) and
stable, final, daughter isotope (zth isotope) in the time domain are as follows:
𝑁1′ (𝑡) = 𝜔1 − 𝜆1 𝑁1 (𝑡)

(6.2)

𝑁𝑖′ (𝑡) = 𝜔𝑖 + 𝑏𝑖−1 𝜆𝑖−1 𝑁𝑖−1 (𝑡) − 𝜆𝑖 𝑁𝑖 (𝑡)

(6.3)

𝑁𝑧′ (𝑡) = 𝜔𝑧 + 𝑏𝑧−1 𝜆𝑧−1 𝑁𝑧−1 (𝑡)

(6.4)

Applying the Laplace Transform to these three differential equations allows them to be manipulated and solved
algebraically in the s-domain.
1
1
𝜔1
𝑁1 (0) +
𝑠 + 𝜆1
𝑠(𝑠 + 𝜆1 )

(6.5)

1
1
1
(𝜔𝑖 ) +
(𝑏𝑖−1 𝜆𝑖−1 𝑁𝑖−1 (𝑠)) +
𝑁𝑖 (0)
𝑠(𝑠 + 𝜆𝑖 )
𝑠 + 𝜆𝑖
𝑠 + 𝜆𝑖

(6.6)

1
1
1
𝜔𝑧 + 𝑏𝑧−1 𝜆𝑧−1 𝑁𝑧−1 (𝑠) + 𝑁𝑧 (0)
2
𝑠
𝑠
𝑠

(6.7)

𝑁1 (𝑠) =

𝑁𝑖 (𝑠) =

𝑁𝑧 (𝑠) =

6.2.3

Numerical Inversion of the Laplace Transform

The Gaver-Stehfest[171] algorithm was developed in the 1960s and 1970s and is a method of calculating the
inverse of a Laplace Transform in the real number domain. It is an easy to implement and reasonably accurate
method, although it is an approximation to the real value. A comparison between an analytic and numeric
inversion for the unstable isotope Po-218 is discussed at the end of this section (figure 6.2).
2𝑛

𝑓 (𝑡) ≈ 𝑓𝑛 (𝑡) =

ln(2) ∑︁
𝑎𝑘 (𝑛)𝐹 (𝑠) where 𝑛 ≥ 1, 𝑡 > 0
𝑡
𝑠=

(−1)(𝑛+𝑘)
𝑎𝑘 (𝑛) =
𝑛!

(6.8)

𝑘=1

𝑘 ln(2)
𝑡

∑︁

𝑗

𝑗=𝐹 𝑙𝑜𝑜𝑟( 𝑘+1
2 )

119

𝑛+1

(6.9)
(︃ )︃ (︃ )︃ (︃
)︃
𝑛
2𝑗
𝑗
𝑗

𝑗

𝑘−𝑗

(6.10)

6.2. ACTIVATION BY ION IRRADIATION

CHAPTER 6. PREDICTING ACTIVATION

The equation for the ith isotope may be calculated by recursively calculating the equations by numeric inversion,
starting from the first (parent isotope) and inserting the result into each subsequent recursion until the ith
isotope is reached (changing the equations appropriately for the parent, unstable daughter and stable daughter
isotopes).

6.2.4

Analytic Solution by Partial Fraction Expansion

The equation for the ith isotope in the s domain can be written in full by substituting the preceding equation
until the parent isotope is reached, and this full equation may be rearranged with the production amount of
each isotope and starting amount of each isotope in individual terms. Each of these terms is multiplied by a
fraction that can be expanded, using partial fractions, and inverted analytically.
This is illustrated with an example unstable isotope, fourth in the decay chain (including the parent isotope)
(eq. 6.11).

𝑁4 (𝑠) =

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝑁1 (0)
(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝑏3 𝑏4 𝜆2 𝜆3 𝑁2 (0)
(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
𝑏4 𝜆3 𝑁3 (0)
+
(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
𝑁4 (0)
+
(𝑠 + 𝜆4 )
1
+
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝜔1
𝑠(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝑏3 𝑏4 𝜆2 𝜆3 𝜔2
𝑠(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
𝑏4 𝜆3 𝜔3
+
𝑠(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
𝜔4
+
𝑠(𝑠 + 𝜆4 )

(6.11)

An example stable isotope, fourth (last) in the decay chain (including the parent isotope) (eq. 6.12).

𝑁4 (𝑠) =

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝑁1 (0)
𝑠(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+
𝑏3 𝑏4 𝜆2 𝜆3 𝑁2 (0)
𝑠(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+
𝑏4 𝜆3 𝑁3 (0)
𝑠(𝑠 + 𝜆3 )
+𝑁4 (0)
+

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝜔1
2
𝑠 (𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+ 2
𝑏3 𝑏4 𝜆2 𝜆3 𝜔2
𝑠 (𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
𝑏4 𝜆3 𝜔3
+ 2
𝑠 (𝑠 + 𝜆3 )
1
+ 2 𝜔4
𝑠

(6.12)

By using partial fraction expansion and standard Laplace Transforms, the set of equations (eqs. 6.13, 6.14,

120

CHAPTER 6. PREDICTING ACTIVATION

6.2. ACTIVATION BY ION IRRADIATION

6.15, 6.16) is used to calculate the amount of the mth isotope in the decay chain, providing the mth isotope is
unstable.

∑︁

⃗0 ) =
𝑁𝑚 (𝑡; ⃗𝜆, ⃗𝑏, 𝑤,
⃗ 𝑁

𝑘=1,𝑚

[︁
]︁
𝑟(𝑘, 𝑚, ⃗𝜆, ⃗𝑏) 𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆)𝑁0,𝑘 + 𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆)𝑤𝑘

𝑟(𝑘, 𝑚, ⃗𝜆, ⃗𝑏) =

⎧
⎨∏︀

𝑖=𝑘,𝑚−1

⎩1,

∑︁

𝑖=𝑘,𝑚

𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

[︃

exp(−𝜆𝑖 𝑡)
∏︀
𝑗=𝑘,𝑚;𝑗̸=𝑖 (𝜆𝑖 − 𝜆𝑗 )
∑︁

𝑚−𝑘+1

𝑖=𝑘,𝑚

+ (−1)

𝜆𝑖

if 𝑘 < 𝑚

(6.14)

if 𝑘 = 𝑚

𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆) = (−1)𝑚−𝑘

1

(𝑏𝑖+1 𝜆𝑖 ) ,

(6.13)

𝑖=𝑘,𝑚

[︃

]︃

(6.15)

exp(−𝜆𝑖 𝑡)
∏︀
𝜆𝑖 𝑗=𝑘,𝑚;𝑗̸=𝑖 (𝜆𝑖 − 𝜆𝑗 )

]︃

(6.16)

The set of equations (eqs. 6.17, 6.18, 6.19, 6.20) is used to calculate the amount of the mth isotope in the decay
chain, where the mth isotope is stable.

∑︁

⃗0 ) = 𝑁𝑚 + 𝑤𝑚 𝑡 +
𝑁𝑚 (𝑡; ⃗𝜆, ⃗𝑏, 𝑤,
⃗ 𝑁

𝑘=1,𝑚−1

𝑟(𝑘, 𝑚, ⃗𝜆, ⃗𝑏) =

1

𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

𝑖=𝑘,𝑚−1

𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

1

𝑖=𝑘,𝑚−1

6.2.5

𝜆𝑖

𝑡−

∑︀

𝑖=𝑘,𝑚−1

𝜆𝑖

∏︀

[︁
]︁
𝑟(𝑘, 𝑚, ⃗𝜆, ⃗𝑏) 𝑓 (𝑡; 𝑘, 𝑚 − 1, ⃗𝜆)𝑁0,𝑘 + 𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆)𝑤𝑘

⎧
⎨∏︀

𝑖=𝑘,𝑚−1

+ (−1)

[︁∏︀

(𝑏𝑖+1 𝜆𝑖 ) , if 𝑘 < 𝑚

⎩1,

(6.18)

if 𝑘 = 𝑚

∑︁

𝑚−𝑘+1

𝑖=𝑘,𝑚−1

𝑗=𝑘,𝑚−1;𝑗̸=𝑖

𝑖=𝑘,𝑚−1

(6.17)

𝜆𝑗

𝜆2𝑖

]︁

[︃

exp(−𝜆𝑖 𝑡)
∏︀
𝜆𝑖 𝑗=𝑘,𝑚−1;𝑗̸=𝑖 (𝜆𝑖 − 𝜆𝑗 )

+ (−1)

𝑚−𝑘+1

∑︁

𝑖=𝑘,𝑚−1

[︃

]︃

(6.19)

exp(−𝜆𝑖 𝑡)
∏︀
2
𝜆𝑖 𝑗=𝑘,𝑚−1;𝑗̸=𝑖 (𝜆𝑖 − 𝜆𝑗 )

]︃

(6.20)

Preference: Analytic over Numeric

The numeric solution only requires the equation to be solved in the s-domain; the Gaver-Stehfest algorithm
performs the inversion. It is worth the extra effort to derive and implement an analytic solution, as the numeric
is only an approximation. Examples of the pitfalls of the numeric solution are that it can give negative amounts
of an isotope and the difference between the numeric and analytic calculated amounts can become quite large

121

6.3. ACTIVITY CODE

CHAPTER 6. PREDICTING ACTIVATION

Po-218 (Analytic)
Po-218 (Gaver-Stehfest)

1e+08

1e+06

Po-218 (mircograms)

10000

100

1

0.01

0.0001

1e-06
0

1000

2000

3000

4000

5000

6000

7000

8000

9000

10000

Time (seconds)

Figure 6.2: Decay of Po-218: Analytic and Gaver-Stehfest Calculations [23]

when the isotope decays away to a very small value. Figure 6.2 shows the predicted decay of a sample of Po-218
irradiated for 1,000s, and sampled until 10,000s. In the region between 4,000s and 9,000s the amount from
the numeric calculation drops below zero, whereas the analytic calculation remains above zero, as would be
expected.

6.3
6.3.1

Activity Code
Computer Code Development

The first version of the Activity code was written in Fortran. A paper that describes this code is contained in
section C.1.1 of the appendix along with the manual describing how to use it (section C.1.1). This version used
the TENDL-2013 cross section database and was replaced by a version of the code written in Python.
Activity V2 uses a custom cross section database generated using the TALYS nuclear reaction code along with
the JEFF3.1.1 datafile for decay data. All the data has been processed and is packaged with the source code.
The source code and instructions on how to use the program are available to download from GitHub:
https://github.com/BenPalmer1983/activity v2
The user provides an ion trajectory file and an input file that specifies beam parameters and target composition.
The code may be used for both protons and deuterons, providing the correct trajectory file has been generated.
It does also contain neutron reaction cross sections and may be used for very thin foils with a flat distribution
of neutron energies.

6.3.2

Extended Bateman Equations

The Bateman equations were derived from scratch to include a source term for each isotope and branching factors
from parent isotope to daughter isotope(s). This process along with the numerical and analytic solutions are
outlined in section 6.2.4.

122

CHAPTER 6. PREDICTING ACTIVATION

6.3. ACTIVITY CODE

The decay equations were programmed as a class in python (appendix B) that used decay data accessible
through a second class, isotopes, populated with data from the JEFF 3.1.1 data file. The static function for
computing activity in this class was tested against numerically computed values.

Figure 6.3: Decay path of Polonium-216

Due to the large range in magnitude of the half life for various isotopes, a decay chain was selected where the
time step for the numeric calculation would be applicable to the half life of the isotopes in the decay chain,
whilst keeping the number of steps low enough to compute the activities in a reasonable amount of time with
a simple algorithm. The decay path of

216
84 𝑃 𝑜

(figure 6.3) contains 6 isotopes and includes one branch at

Isotope
Po-216
Pb-212
Bi-212
Po-212
Tl-212
Pb-208

212
83 𝐵𝑖.

Half Life (s)
1.45 × 10−1
3.83 × 104
3.63 × 103
2.99 × 10−7
3.1 × 101
Stable

Table 6.1: Half life of isotopes in the Po-216 decay chain

The range of half life times (table 6.1) in the Polonium decay chain was from 3.83 × 104 s for
−7

2.99 × 10

s for

212
83 𝑃 𝑜

212
82 𝑃 𝑏
10

down to

and the maximum number of steps used in the numeric calculation is 10 . This number

of steps was near the limit at which increasing by another order of magnitude would take a significant amount
of time to run the calculation.
Isotope
Po-216
Pb-212
Bi-212
Po-212
Tl-212
Pb-208

Source Rate
2.0 × 10−1
0.0 × 100
7.0 × 10−2
5.0 × 10−3
0.0 × 100
1.0 × 10−2

Starting amount 𝑁0
1.0 × 102
5.0 × 100
1.5 × 101
0.0 × 100
0.0 × 100
3.0 × 102

Table 6.2: Parameters used for the decay equation vs numeric calculation comparison

The numeric code used to perform these calculations is detailed in the appendix (section B.3.1). The calculation
was set up with a range of source rates and isotope starting amounts including no source for
starting amount for both

212
81 𝑇 𝑙

and

212
83 𝑃 𝑜.

212
81 𝑇 𝑙

and a zero

The full details are given in table 6.2 and these were used in both

the numeric and analytic codes.
123

6.3. ACTIVITY CODE

CHAPTER 6. PREDICTING ACTIVATION

Figure 6.4: Decay path of Polonium-216

As seen in figure 6.4, for all but the shortest half life isotope Po-212, the numeric calculations are in good
agreement with the decay equations. As the number of steps increases, and hence the time step decreases, the
numerically computed activity for Po-212 also converges to that calculated with the decay equations.
The modified Bateman equation was also tested with several other decay chains against a numeric solution for
each chain. These were the decay of

49
66
125
213
216
24 𝐶𝑟, 28 𝑁 𝑖, 55 𝐶𝑠, 83 𝐵𝑖, 84 𝑃 𝑜

and

218
86 𝑅𝑛.

Apart from a break down in

the numeric code, where the half life was comparable to or smaller than the time step, the results from both
the equations and the numeric solver were in good agreement. The full results to this testing are included in
appendix B.3.1.

6.3.3

Talys Generated Proton Cross Section Database

Due to a variation in range of energies in the existing cross section data files, the cross section data was computed
from scratch using the TALYS code and the BlueBEAR HPC.
A set of proton reaction cross section data files already exist and are updated every few years. The type and
range of data changes between versions of the file. For example, the TENDL-2014 version contains only elastic
and (z,anything) files for (p,Fe56). The TENDL-2009 file contains a wider ranger of reactions and under 50
data points span the energy range from 0MeV to 200MeV. The 2019 version contains even more reactions but
spans a much shorter energy range, 0MeV to 28MeV, with cross sections given at just under 60 energy points.
The cyclotron used in the experimental work has an energy range up to 40MeV for protons and 53MeV for
4

𝐻𝑒2+ ions. To cover this entire range, the TALYS code was used to compute cross section reaction data from

0.01MeV to 62.0MeV in increments of 10keV, breaking the energy range up into 6,200 data points for each
reaction.
Limitations of the TALYS code caused the calculations to be processed in batches of either 400 or 600 points. The
data was collated and processed resulting in a datafile of particle production reactions and residual production
reactions. This is accessible through a stand-alone python class that is also a part of the Activity V2 code.
The residual reactions are grouped by target isotope and then by residual isotope, whereas the particle cross
sections are grouped by target isotope then particle type. The computed values are plotted for all available
reactions and all residuals for 56
26 𝐹 𝑒 reactions with protons (figures 6.8 and 6.9) and these show a good agreement,
although there is a more detailed set of residual isotopes for the generated cross sections.

124

CHAPTER 6. PREDICTING ACTIVATION

6.3. ACTIVITY CODE

(a) TENDL-2009 cross sections

(b) TENDL-2019 cross sections

Figure 6.5: Data from pre-existing TENDL files for (56
26 𝐹 𝑒, 𝑝) reactions

125

6.3. ACTIVITY CODE

CHAPTER 6. PREDICTING ACTIVATION

Target-Residual Cross Section
56Fe - 53Fe(meta 2)
56Fe - 54Co(meta 1)
56Fe - 48Ti
56Fe - 53Fe
56Fe - 48Ti(meta 2)
56Fe - 54Co
56Fe - 52Mn(meta 1)
56Fe - 52Mn
56Fe - 52Fe
56Fe - 44Sc
56Fe - 44Sc(meta 1)
56Fe - 50Mn(meta 1)

0.7

0.6

56Fe - 52Fe(meta 2)
56Fe - 50Mn
56Fe - 53Mn
56Fe - 56Co
56Fe - 57Co
56Fe - 56Fe
56Fe - 54Mn
56Fe - 48V
56Fe - 54Cr
56Fe - 51V
56Fe - 50V

56Fe - 54Fe
56Fe - 55Mn
56Fe - 51Mn
56Fe - 51Cr
56Fe - 55Co
56Fe - 55Fe
56Fe - 52Cr
56Fe - 53Cr
56Fe - 50Cr
56Fe - 49V
56Fe - 47V

56Fe - 50Ti
56Fe - 45Sc
56Fe - 49Cr
56Fe - 47Sc
56Fe - 49Ti
56Fe - 53Co
56Fe - 53V
56Fe - 47Ti
56Fe - 52V
56Fe - 46Ti
56Fe - 48Cr

Cross-section (Barns)

0.5

0.4

0.3

0.2

0.1

0.0
0

10

20

30
Energy (MeV)

40

50

60

(a) TALYS generated residual cross sections

Target-Particle Cross Section
56Fe - helium-3
56Fe - deuteron
56Fe - triton
56Fe - alpha
56Fe - gamma
56Fe - proton
56Fe - neutron

1.4

1.2

Cross-section (Barns)

1.0

0.8

0.6

0.4

0.2

0.0
0

10

20

30
Energy (MeV)

40

50

(b) TALYS generated particle cross sections

Figure 6.6: Data from TALYS generated files for (56
26 𝐹 𝑒, 𝑝) reactions

126

60

CHAPTER 6. PREDICTING ACTIVATION

6.3. ACTIVITY CODE

Listing 6.1: Status report from TALYS database code
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

##############################################
TALYS Cross Section Python Dictionary
##############################################
DB STATUS
Talys dir:
../../data/talys
Isotopes file: ../../data/isotopes.pz
Database load time: 24.489s
Projectiles:

n d p

Total data points: 18777965
End time: 24.674s

The complete set of data files, and Python class used to read them, are available to download at:
https://github.com/BenPalmer1983/talys xs db
The cross section data output by TALYS was grouped into four main files: elastic xs.pz, nonelastic xs.pz,
particle xs.pz and residual xs.pz. All data files that make up this database currently total over 400MB and
contain over 18 million data points (listing 6.1), although this could increase if more projectiles and a wide
range of energies are added.

6.3.4

Ion Trajectory Data

The SRIM code is used to generate ion trajectory data. This uses a quantum mechanical treatment of ion-atom
collisions and statistical algorithms to speed up the process[172]. The trajectory data files used by both versions
of the Activity code will be created using SRIM for the required beam energy and target combinations.

Figure 6.7: 36MeV Ion Track

In the example where the target is set as pure Iron, due to the way SRIM functions, the structure type is
inconsequential. At just 0.5mm in thickness, the 36MeV ions pass through the targets and exit with an energy
above 30MeV (figure 6.7). The coe creates a data file, exyz.txt, and this covers the ion trajectory over this
range of ion energies.

127

6.4. SIMULATING WITH SRIM - IRON

6.3.5

CHAPTER 6. PREDICTING ACTIVATION

Activity Code Assumptions

A number of assumptions have been made to simplify the model. These may be addressed in future versions
if development of the code continues. The flux of the beam is assumed to be constant at any depth into the
material. Charged particle irradiation is ignored completely from the decay of radioactive isotopes in the target,
and the amount of beta radiation may determine how the target is safely handled.
Gammas are assumed to be emitted isotropically and degrade only due to the increase in surface area as the
distance from the source increases. No consideration is given to the dispersion of radioactive isotopes through
the target material, how much material the gammas must pass through or how much air they must go through in
order to reach the person (or measuring device). These assumptions and possible improvements are considered
in chapter 9.

6.3.6

Foil Activation by Neutron Irradiation

An additional feature was added to the Activity V2 code to estimate neutron activity based on the existing
code developed to calculated ion activation. It is a simple non-transport neutron activation code, used to
estimate the activity and subsequent cooling of materials irradiated by neutrons. A single energy neutron flux
or Maxwell-Boltzmann distribution may be selected by the user and the TALYS generated database is used to
provide cross sections for calculating reaction rates. Finally, the previously derived extended Bateman equations
are used to calculate isotopes at time t after irradiation begins.

6.4

Simulating Proton Irradiated Iron with SRIM

The trajectory data used by the activity code, and also to estimate the

55
27 𝐶𝑜

activity, was provided by SRIM.

An input configuration was set with Iron as the target material and protons as the projectile ion. The sample
depth was set to at least the target thickness, 0.5mm. The activity code truncates the data to fit the target
thickness, so a much larger depth, say 1m, could be set in SRIM to ensure all the ions stop within the simulated
target, and this data file may be reused for targets of varying thicknesses.
The ions travelling through the thin 0.5mm target lose between 4MeV and 5MeV (figure 6.8b) as they pass,
and they do so quite smoothly (figure 6.8c). The majority of the energy is lost smoothly through electronic
stopping.
The ion trajectory plot shows the deflection of ions in both the y and z axis. A large percentage of the ions here
deviate very little from a straight pass through, but several are deflected by quite a large angle. Within the
activity computer codes, these ions deflected ions will travel a greater distance through the target. The only
cutoffs applied to the ion trajectory data are either the ion reaching 0MeV or travelling more than the depth
in the x-axis. Any ions travelling a large distance in the y or z axis are still determined to be within the target.
As the thickness of the iron is increased, all the energy is lost to the iron target, and this loss of energy occurs
within a shorter range in the remaining quarter of a millimetre depth of the iron target (figure 6.9a).

6.5
6.5.1

Cyclotron Irradiated Iron
Cyclotron Beam Line

The Scanditronix MC40 cyclotron at the University of Birmingham has several beamlines and is capable of
accelerating protons, deuterons, Helium 3 and Helium 4 with fluxes and energy ranges detailed in table 6.3.

128

CHAPTER 6. PREDICTING ACTIVATION

6.5. CYCLOTRON IRRADIATED IRON

Ion Trajectory

Beam Energy Lost in Sample
0.0020

200000

z/ang

0

Fraction of Ions

100000

−100000
−200000

1

0.0005

g

0

0.0010

x (de 2 3
pth)/
Ang

4

y/a
n

1e6

150000
100000
50000
0
−50000
−100000
−150000
−200000
−250000

0.0015

5

0.0000

4000

4200

4400

4600

Energy Lost/KeV

4800

5000

(b) Histogram of energy lost passing through target

(a) Proton trajectory

Ion Energy In Target
36000

Energy/KeV

35000

34000

33000

32000

31000
0

1

2

3

x (depth)/Ang

4

5

1e6

(c) Energy vs target depth

Figure 6.8: Protons through a 0.5mm thick iron target - 100 proton histories

After running a simulation with SRIM, the 36MeV protons were expected to create an average of 15.8 vacancies
each.
Particle
p
d
4
𝐻𝑒2+
3
𝐻𝑒2+

Energy (MeV)
8-40
8-40
8-53
4-20

Max Current (micro A)
60
30
30
60

Flux (ions per second)
3.75 × 1014
1.87 × 1014
9.36 × 1013
1.87 × 1014

Table 6.3: Beam Characteristics of the Scanditronix MC-40

The cyclotron is located in one room, and several beam lines run from the cyclotron to other rooms in the
cyclotron building. The operation room is separate from the cyclotron and beam line rooms (figure 6.10).
The iron sample was held perpendicular to the beam line, with the ions passing through the 0.5mm thickness of
the sheet. The beam area was approximately 6.4×10−5 𝑚2 , irradiating a volume of approximately 3.2×10−8 𝑚3 .
The target was irradiated for 300 seconds at 0.5 micro amps and it was expected to cause over 1.4 × 1016

displacements within the volume of iron targetted by the beam. With a number density of approximately
8 × 1028 atoms per cubic meter, giving a relatively low damage dose, when compared to that expected over the
lifetime of a component within the reactor, of 5.0 × 10−6 DPA.

During irradiation, the amount of gamma radiation released was enough to trip the alarm for the room (figure

129

6.5. CYCLOTRON IRRADIATED IRON

CHAPTER 6. PREDICTING ACTIVATION

Ion Trajectory

Beam Energy Los in Sample

1e6

10

8

1.0

x (de
pth)/ 1.5 2.0
Ang

−1
−2
−3
−4

2

1e
6

1

4

3
2

g

0.5

0

6

y/a
n

0.0
1e7

z/ang

2
1
0
−1
−2

Frac ion of Ions

3

2.5

0

−0.4

−0.2

0.0

Energy Los /KeV

0.2

0.4

+3.6e4

(b) Histogram of energy lost passing through target

(a) Proton trajectory

Ion Energy In Target
35000
30000

Energy/KeV

25000
20000
15000
10000
5000
0
0.0

0.5

1.0

1.5

x (depth)/Ang

2.0

2.5
1e7

(c) Energy vs target depth

Figure 6.9: Protons through target thick enough to stop all ions - 100 proton histories

6.11). The proton fluence was less than 1% of the maximum fluence capable of being produced by the cyclotron,
so this was definitely a concern. To increase the damage dose, and keep to a shorter period of time, the current
would most probably be increased to a much higher percentage, also increasing the rate of Gammas produced
during irradiation.
Preliminary investigations with SRIM into the stopping distance of protons in a range of materials shows 36MeV
ions stop within 3mm in Iron and Steel(figure 6.12).

130

CHAPTER 6. PREDICTING ACTIVATION

6.5. CYCLOTRON IRRADIATED IRON

Figure 6.10: Cyclotron layout - main hall and beam lines

Figure 6.11: Gamma warning alarm during 0.5 microamp
36MeV proton irradiation of iron

Proton Depth vs Energy
Iron
316SS
Carbon
Molybdenum
Palladium
Platinum
Ruthenium

6

5

Depth (mm)

4

3

2

1

0
0

5

10

15

20

Energy (MeV)

25

30

35

Figure 6.12: Proton stopping distances in various materials

It is clear that 3mm thick samples of Iron or Steel will completely stop 36MeV protons and 1mm of the same
is enough to stop any with an energy of 20MeV or less. The target irradiated here, with a thickness of just
0.5mm, will allow most ions to pass through and retain a large proportion of their energy (figure 6.8b).

6.5.2
55
27 𝐶𝑜

Creation of Cobalt-55

is a relatively short lived isotope with a half life of 17.5 hours and this is a concern to health during and

shortly after irradiation. Isotopes with a long half life are not as active in small quantities, and those with very
short half life decay away quickly.
the stable isotope

55
25 𝑀 𝑛

55
27 𝐶𝑜

decays into another radioactive isotope,

55
26 𝐹 𝑒,

which then decays into

(figure 6.13). The second step in the decay chain is 2.73 years, so the first step with

a much shorter half life will be responsible for the majority of the radiation shortly after being irradiated by
protons.

131

6.5. CYCLOTRON IRRADIATED IRON

CHAPTER 6. PREDICTING ACTIVATION

Figure 6.13: Decay path of Cobalt-55

The decay of

55
27 𝐶𝑜

will produce a range of gammas (figure 6.14), but one in particular to focus on when

measuring the radioactivity is the 931keV gamma with an intensity of 75%.

Figure 6.14: Cobalt-55 Gamma Intensity Plot

The stable isotope 54
26 𝐹 𝑒 makes up almost 6% of natural iron, and one reaction possibility with a proton results
55
55
in 27 𝐶𝑜 and a gamma, 54
26 𝐹 𝑒(𝑝, 𝛾)27 𝐶𝑜. The most abundant isotope in natural Iron also has a route to transmute
to

55
27 𝐶𝑜

through the capture of a proton and the loss of two neutrons,

56
55
26 𝐹 𝑒(𝑝, 2𝑛)27 𝐶𝑜.

Due to the short half-

life of this isotope of Co and the intensity of the 931keV gamma, this peak was expected and measured after
irradiating the iron target. It was also estimated manually using the TENDL-2009 and TENDL-2019 cross
section databases.

6.5.3

Measurement of Sample Activity

The sample was too radioactive to safely handle immediately after irradiation, so it was left to cool for several
days before taking measurements. After it had cooled, a high purity germanium detector (figure 6.15) was
used to measure the activity of the irradiated sample. The detector was calibrated and was expected to detect
approximately 4 out of every 100 gammas emitted.
The detector and preamplifier are both cooled by liquid nitrogen to 77K, as the band-gap of germanium is 0.7eV
and the thermal motion of electrons and nuclei at higher temperatures would induce currents causing noise and
interference in the detector. As a gamma ray enters the detector it creates an electron-hole pair in the medium
of the detector. The holes and electrons are attracted to the center and to the outer cylinder of the detector,
or vice versa.
1
2
3
4

RANGE: 617 = 911.51keV to 649 = 958.79keV
AREA : Gross = 2127168 Net = 1342565 +/- 2207
CENTROID: 631.74 = 933.29keV
SHAPE: FWHM = 6.82 FW(1/5)M = 10.06

132

CHAPTER 6. PREDICTING ACTIVATION

6.5. CYCLOTRON IRRADIATED IRON

Figure 6.15: High Purity Germanium Detector

ID: Bi-214 at 934.05keV
Corrected Rate = 35349.26 +/- 58.11 cA

Listing 6.2: Maestro 931keV Peak Measurement

The gamma counts were recorded over a range of 0MeV to 3MeV (figure 6.16). Correcting the measured count
for the 931keV peak, to account for the geometry and detector, the count rate for 931keV gamma rays from
55
27 𝐶𝑜

was measured at 4.43 × 104 ± 1.05 × 103 counts per second.
HPGe Detector Count Results for Iron Sample

200000

Counts over 300 seconds

5
6

150000

100000

50000

0
0

500

1000

1500
Gamma Energy/KeV

2000

2500

3000

Figure 6.16: Gamma counts from the irradiated iron target over 300 seconds

There are several decay modes that contribute to the radioactivity of the sample, and the largest contributors
to gamma emission also undergo either electron capture or 𝛽+ emission. The decay paths are:
•

𝜖/𝛽+ 55
𝜖/𝛽+ 55
55
27 𝐶𝑜 −−−→ 26 𝐹 𝑒 −−−→ 25 𝑀 𝑛

•

𝜖/𝛽+ 56
56
27 𝐶𝑜 −−−→ 26 𝐹 𝑒

133

6.5. CYCLOTRON IRRADIATED IRON

•

𝜖/𝛽+ 54
54
25 𝑀 𝑛 −−−→ 24 𝐶𝑟

•

𝜖/𝛽+ 52
52
25 𝑀 𝑛 −−−→ 24 𝐶𝑟

•

52
* 𝜖/𝛽+ 52
25 𝑀 𝑛 −−−→ 24 𝐶𝑟

CHAPTER 6. PREDICTING ACTIVATION

Where positrons are emitted, they will annihilate with an electron. This event will release two photons in
opposite directions, each of which will have a 511keV energy. This is responsible for the 511keV peak measured
in figure 6.16. However, at the time of writing, the computer code will not compute this peak and it will be
omitted from the computational results.

6.5.4

Prediction of Activity

Following the measurement of the thin target, in the first instance the predicted activity will be estimated using
55
the average ion energy, the cross section of this energy and the two reactions that result in Co-55 (54
26 𝐹 𝑒(𝑝, 𝛾)27 𝐶𝑜

and

56
55
26 𝐹 𝑒(𝑝, 2𝑛)27 𝐶𝑜).

The activity code (version 1 and version 2) are then used to predict the activity of the

sample as well as the expected gamma spectra.

6.5.5

Estimation of Cobalt-55 Radioactivity

There are over ten TENDL libraries available, and the available data and the range of data points is inconsistent
across these different versions. The earlier library, that was used in the first version of the Activity code, covers
a range up to 200MeV for Iron-proton reaction cross sections. Many of the more recent data files contain total
reaction cross sections only, and in the most recent data files, 2017 and 2019, the energy range only covers
proton reactions from 0MeV to 28MeV, abruptly dropping to 0 barns at 30MeV as seen in fig 6.17.

Fe56(p,2n)Co55 Cross Sections
Talys data file
Exfor
TENDL-2009
TENDL-2017
TENDL-2019

0.08

Cross section (barns)

0.06

0.04

0.02

0.00
25

50

75

100

125

Energy (MeV)

150

175

200

Figure 6.17: 𝐹 𝑒56(𝑝, 2𝑛)𝐶𝑜55 cross section data from several sources [173][174][175][176][177]

The activity of the sample, in particular due to the radioactivity of 55
27 𝐶𝑜, was estimated using a number of data
sources. As a consequence of the short beam duration when compared to the half-life of Cobalt-55, any loss
during irradiation is ignored in each case.

134

CHAPTER 6. PREDICTING ACTIVATION

6.5. CYCLOTRON IRRADIATED IRON

The estimations use one set of experimental data, from the EXFOR data file, as well as evaluated and calculated
data points. As may be seen in 6.17, all data sets follow a similar path although the peak is slightly lower for
the experimental data. The two most recent TENDL data plots terminate abruptly, but the TENDL-2009
and TALYS calculated data points continue in agreement with one another up to 62MeV, where the calculated
points end.
The parameters in relation to the beam current, duration, target material and the gamma intensity were
consistent between the estimations. They are the same parameters as used in the experimental work and are
given in table 6.4.
Parameter
ND/atoms 56
26 𝐹 𝑒
ND/atoms 54
26 𝐹 𝑒
J/amps
Q/C
d/m
irradiation time/s
Co55 t-half/s
Co55 𝜆
931keV Gamma Intensity

Value
7.4 × 1028
4.6 × 1027
0.5 × 10−7
1.60 × 10−19
5.0 × 10−4
3.0 × 102
6.3 × 104
1.1 × 10−5
0.75

Table 6.4: Parameters used to estimate Co55 931keV gamma activity
55
56
55
The 2019 data file ranges up to 30MeV for the 54
26 𝐹 𝑒(𝑝, 𝛾)27 𝐶𝑜 and 26 𝐹 𝑒(𝑝, 2𝑛)27 𝐶𝑜 reactions. As the data cuts
off at 30MeV, the cross section data for a 28-30MeV proton is used in the estimation. This results in an over

estimate in activity.
A 36MeV proton is expected to lose up to 4-5MeV travelling through a 0.5mm thick Iron target, as seen in
figure 6.8c. However, in this estimation the ions are assumed to be only 36MeV (or 28MeV, where 36MeV data
are unavailable).
TENDL 2009
P energy (MeV)
XS 𝜎 (barns)
Reaction Rate
Activity (Bq)
Gamma (Bq)

36
1.29 × 10−4
9.32 × 104
1.78 × 101
1.34 × 101

P energy (MeV)
XS 𝜎 (barns)
Reaction Rate
Activity (Bq)
Gamma (Bq)

36
2.13 × 10−2
2.44 × 108
4.67 × 104
3.50 × 104

TENDL 2017 TENDL 2019
54
55
26 𝐹 𝑒(𝑝, 𝛾)27 𝐶𝑜
28
28
1.94 × 10−4
1.94 × 10−4
1.40 × 105
1.40 × 105
1
2.69 × 10
2.69 × 101
1
2.02 × 10
2.02 × 101
56
55
26 𝐹 𝑒(𝑝, 2𝑛)27 𝐶𝑜
28
28
5.08 × 10−2
5.08 × 10−2
5.81 × 108
5.81 × 108
5
1.11 × 10
1.11 × 105
4
8.33 × 10
8.33 × 104

Exfor

TALYS file

TALYS DB

36
-

36
1.33 × 10−4
9.64 × 104
1.84 × 101
1.38 × 101

36
1.75 × 10−4
1.27 × 105
2.43 × 101
1.82 × 101

36
2.30 × 10−2
2.64 × 108
5.04 × 104
3.78 × 104

36
2.00 × 10−2
2.29 × 108
4.38 × 104
3.29 × 104

36
2.00 × 10−2
2.29 × 108
4.38 × 104
3.29 × 104

Table 6.5: Estimation of the Cobalt-55 931keV gamma activity based on the TENDL-2009[173], TENDL-2017[174],
TENDL-2019[175] data files, EXFOR experimental data [176] and TALYS generated data files[177].

The largest contribution to the 931keV gamma is due to the

56
55
26 𝐹 𝑒(𝑝, 2𝑛)27 𝐶𝑜

reaction, with the

54
55
26 𝐹 𝑒(𝑝, 𝛾)27 𝐶𝑜

reaction being responsible for less than 0.1% of the gammas.
Out of the estimates calculated, the outliers are those that used data files with a 28 MeV maximum limit, and
this is as to be expected. The final three results are much closer to one another, ranging from 43,800Bq to
50,400Bq for the overall activity and 32,900Bq to 37,800Bq for the rate of emission of Gammas. The full details
including cross sections and reaction rates used are given in table 6.5.

135

6.5. CYCLOTRON IRRADIATED IRON

6.5.6

CHAPTER 6. PREDICTING ACTIVATION

Simulating Proton Irradiated Iron with Actvity V1

The first version of the Activity code with modified Bateman equations was used to calculate the predicted
radioactivity (figure 6.18) and predicted gamma lines (figure 6.19). A full output file and details of all isotopes
and their activities are given in appendix D.

Figure 6.18: Isotopes with the top 5 radioactivity plotted
over approximately 3 days

Figure 6.19: Predicted gamma lines approximately 3 days
after irradiation

The code predicts a final 931keV gamma activity of over 59,000 Bq and highlights several other isotopes of
interest, including

52
51
55
25 𝑀 𝑛, 24 𝐶𝑟, 26 𝐹 𝑒

and

54
25 𝑀 𝑛,

all of which have an activity of approximately 10,000 Bq or

above. After 3 days of cooling, the target is predicted to dose an 80KG human, 1 meter away from the target,
with 4.0 × 10−11 Gy/s (absorbed dose) which is less than the limit for a member of the public (6.34 × 10−10
Si/s, effective dose).

6.5.7

Simulating Proton Irradiated Iron with Actvity V2

The iron irradiation experiment was modelled using the second version of the Activity code. In this version the
entire cross section database was created using the TALYS computer code (6.3.3). The same decay equations
used in version 1 were also used here.
As the iron sample is irradiated a large number of particles (neutrons, protons, deuterons, tritons, helium-3,
alphas and gammas) are created. Whilst the beam is on, these are produced at a rate of more than 109 per
second (figure 6.20).
As irradiation commences, the isotope of iron responsible for most of the non-particle radiation is

54
26 𝐹 𝑒,

despite

having a natural abundance of only 5.8%. Two residuals in particular resulting from proton reactions with 54
26 𝐹 𝑒
are responsible for the activity and these are
With a short half life of 0.19 seconds,

54
25 𝐶𝑜

54
25 𝐶𝑜

and

53
26 𝐹 𝑒.

is responsible for the majority of decays per second within a few

seconds of irradiation starting. However, at this same time the majority of the gamma energy from residual
isotopes originates from the decays of

53
26 𝐹 𝑒

(meta 1) and

52
25 𝑀 𝑛

(meta 1). The average gamma energy per

decay of these isotopes is 3.03MeV and 1.42MeV respectively, and this is the reason for such a high contribution
towards the gamma energy output (6.21a).
By the time the beam is turned off, at 300s, the primary isotope contributing almost 50% of the decays per
53
26 𝐹 𝑒. It’s contribution to the over all gamma output is still quite low with the main contributor
52
being 25 𝑀 𝑛 (meta 1) as was the case at the start of irradiation (6.21b). This difference between the decays
and gamma energy is due to 53
26 𝐹 𝑒 having an average gamma energy of only 0.18MeV per decay, whereas the
52
metastable 25 𝑀 𝑛 has a much higher average gamma energy per decay of 1.4MeV.

second is

Once the beam is turned off, those isotopes with a very short half life decay away quickly. After 1 day of cooling,
the isotopes responsible for activity in the sample are very different. With a half life of less than 10 minutes,
136

CHAPTER 6. PREDICTING ACTIVATION

6.5. CYCLOTRON IRRADIATED IRON

Particle Production
109

107

Production Rate

105

103

101

helium-3
deuteron
triton
alpha
gamma
proton
neutron

10−1

10−3

0

50

100

150
Time (s)

200

250

300

Figure 6.20: Particle production rate in beam
Residual gamma power at time t=3.0
Total gamma power: 0.00024354619226584488 mW

Residual gamma power at time t=300.0
Total gamma power: 0.015656781568754878 mW

52Fe 0.0%

0.2%
21.6%

0.1%
0.0%
2.1%
0.0%
0.8%
0.2%
0.0%

1.2%
8.1%

43.1%

52Mn(meta 1) 30.0%
52Mn 0.2%
54Co(meta 1) 21.6%
52Fe(meta 1) 1.2%
53Fe 8.1%
53Fe(meta 1) 35.5%
54Co 0.0%
50Mn 0.2%
55Co 0.8%
49Cr 0.0%
53Co 2.1%
51Mn 0.0%
56Co 0.0%
54Mn 0.0%
56Mn 0.1%
57Mn 0.1%

30.0%

35.5%

52Fe 0.0%

52Mn(meta 1) 43.1%
52Mn 0.4%
54Co(meta 1) 13.1%
52Fe(meta 1) 0.4%
53Fe 10.8%
53Fe(meta 1) 30.6%
55Co 1.2%
49Cr 0.0%
53Co 0.0%
51Mn 0.0%
56Co 0.0%
54Mn 0.0%
56Mn 0.2%
57Mn 0.0%

0.4%
0.2%
0.0%
1.2%

13.1%
0.4%
10.8%

(a) Beam on, t=3.0s

30.6%

(b) Beam on, t=300.0s

Figure 6.21: Gamma output of residual isotopes, by isotope, at the start and end of irradiation

the

53
26 𝐹 𝑒

will have decayed to nothing as would have the

53
26 𝐹 𝑒

(meta 1) and

isotope with the highest contribution to decays per second will be

55
27 𝐶𝑜,

52
25 𝑀 𝑛

(meta 1). At this time, the

but with a half-life of 17.53 hours it

does not remain the largest contributor. It is also responsible for more than half of the gamma power output
at this time as well (6.22a).
At the end of the experiment, the time at which the experimental gamma readings were taken (2.6 × 105 s),

the largest contributor to both decays per second and gamma energy output per second is the

52
25 𝑀 𝑛

isotope

(6.22b).
The computer code also calculates the predicted gamma lines as time goes by. The gamma lines become more
prominent whilst the ion beam is irradiating the target to a maximum activity at 300 seconds. The three most
active gammas at this point are computed to be 1.43MeV, 378keV and 701keV. The 1.43MeV gamma is released
7
by the decay of the metastable isotope 52
25 𝑀 𝑛 (meta 1) and is emitted at a rate of 2.9 × 10 Bq. The 377keV and

791keV gammas are emitted by
9.7 × 106 Bq.

53
26 𝐹 𝑒

and

53
26 𝐹 𝑒

(meta 1) respectively having emission rates of 2.4 × 107 Bq and

137

6.5. CYCLOTRON IRRADIATED IRON

CHAPTER 6. PREDICTING ACTIVATION

Residual gamma power at time t=86001.0
Total gamma power: 0.00013470195336474222 mW

Residual gamma power at time t=260000.0
Total gamma power: 5.703563656739926e-05 mW

37.5%

69.1%
52Fe 0.2%

52Fe 0.0%

52Mn(meta 1) 2.0%
52Mn 37.5%
55Co 55.2%
51Cr 0.1%
56Co 3.9%
54Mn 1.0%
56Mn 0.0%

2.0%
0.2%
0.0%
1.0%
3.9%
0.1%

0.1%
0.0%
2.3%
9.1%
0.2%

55.2%

52Mn(meta 1) 0.1%
52Mn 69.1%
55Co 19.3%
51Cr 0.2%
56Co 9.1%
54Mn 2.3%
58Co 0.0%

19.3%

(a) Beam off, t=86001.0s

(b) Beam off, t=260000.0s

Figure 6.22: Residual isotope power output, by residual, once beam is off.

Following a day of cooling the 931keV gamma from

55
27 𝐶𝑜

will have an activity of approximately 2.9 × 105 Bq

and this is accompanied by another gamma of similar energy. This is the 935keV gamma from the decay of
52
25 𝑀 𝑛.

At this point in time the activity of the 935keV gamma is less than that of the 931keV gamma with an

activity of 9.49 × 104 Bq. In addition, the

52
25 𝑀 𝑛

will also emit a 1.43 MeV gamma at a similar rate calculated

52
to be 1.0 × 105 Bq. With half lives of 17.5 hours for 55
27 𝐶𝑜 and 134 hours for 25 𝑀 𝑛 it is clear that, at some point,

the activity of the 931keV gamma will drop below that of the 935keV gamma.

Gamma Lines at time 260000s

80000
70000
60000

Activity (Bq)

50000
40000
30000
20000
10000
0
0

1000

2000
3000
Energy (keV)

4000

5000

Figure 6.23: Expected gamma lines by the end of the experiment (3 days)

At the end time of the simulated experiment, 2.6 × 105 s, the activity of the 931keV Gamma is predicted to have
dropped to just over 42,000Bq. It’s neighbour, the 935keV Gamma, will have an activity almost double, with
74,000 decays per second (figure 6.23). The full results calculated by this code are included in appendix E.
The prediction of such a large neighbouring Gamma does raise a question where the experimental value is
concerned. It may be that, due to the resolution of the Gamma detector, the measured peak is the sum of both
the 931keV and 935keV Gamma. Ideally the detector would be calibrated for a smaller range about that peak
and the experiment would be repeated to determine the value of both the 931keV and 935keV peak.

138

CHAPTER 6. PREDICTING ACTIVATION

6.5.8

6.6. 100DPA PREDICTED ACTIVITY

Comparing Experimental Results with Calculated Values

The estimation is cruder and does not take into account the details of the loss of energy of the projectile as it
passes through the target. It also does not take into account the creation of

55
27 𝐶𝑜

through other reactions. It

gives a lower value of activity that the computer codes and the experimentally measured value (table 6.6).
Value source
Experimental
TENDL-2009
Activity V1
Activity V2

Co-55 Gammas/second at approximately 3 days
4.4 × 104 ± 1.05 × 103
3.5 × 104
5.9 × 104
4.2 × 104

Table 6.6: Comparison of proton irradiated iron Co55 931keV gamma rates

Although the predictions are in good agreement with the experimental value, there are still a number of questions
that remain unanswered. The most important of these is whether or not the 935keV peak has been included
with the 931keV peak when the measurement was taken.

6.6

Predicted Activity for 100DPA Irradiated Iron

Generation IV reactors are required to withstand 100-150DPA over the lifetime of the plant, which may span
30 years or more. The Scanditronix cyclotron is capable of creating a 60 microamp beam and, due to the small
area (and volume of material) this may be concentrated on, it is able to create high damage rates over a shorter
period of time.
The Activity V2 code was used to calculate how radioactive a 100DPA iron sample would be after irradiation at
the maximum current setting of 60 microamps. The simulated target is 0.5mm thick, pure iron and the beam is
protons and has an area of 64𝑚𝑚2 . The projectile fluence is 3.75 × 1014 protons per second, and the number of

atoms within the volume of iron are approximately 2.56 × 1021 . Five different energy settings were used (5MeV,

10MeV, 15MeV, 20MeV, 25MeV) and the vacancies per ion as well as the ion trajectories were generated by
SRIM.

VPI
DPA/year
Days for 100 DPA
Damage Depth (mm)
Activity1 (Bq)
Gamma Output1 (mW)
Activity2 (Bq)
Gamma Output2 (mW)

5MeV
38.5
178
205
<0.1
2.27 × 106
9.44 × 10−5
2.14 × 106
8.85 × 10−5

10MeV
58.8
272
134
0.25
7.32 × 108
3.87 × 10−1
6.86 × 108
3.64 × 10−1

15MeV
51.0
236
155
0.5+
2.55 × 109
1.32 × 100
2.35 × 109
1.24 × 100

20MeV
23.7
109
333
0.5+
3.66 × 109
1.29 × 100
3.08 × 109
1.16 × 100

25MeV
20.2
93
391
0.5+
4.10 × 109
6.05 × 10−1
2.82 × 109
3.63 × 10−1

30MeV
12.8
59
617
0.5+
4.88 × 109
5.74 × 10−1
3.52 × 109
2.94 × 10−1

Table 6.7: Comparison of proton irradiated iron up to 100DPA at a range of proton energies. The first set of
measurements1 are calculated values at the point the proton beam is turned off. The second set2 are calculated after 1 week of cooling.

In each case the sample was irradiated close to saturation. Doubling the irradiation time would not be expected
to significantly increase the activity, as sufficient time (in each case) is given for the radioactive isotopes being
created to balance those decaying away.
It is clear to see from the predicted activities in table 6.7 that the higher energy beams would take longer to
reach 100DPA, as they pass through the target leaving at a high energy, whilst also irradiating the target several
orders of magnitude more than 5MeV and 10MeV.
139

6.7. PROTON IRRADIATED MOLYBDENUM

CHAPTER 6. PREDICTING ACTIVATION

The Coulomb potential between a proton and an Fe nucleus, at the combined nuclear radius of both, is approximately 6.5MeV (eq. 4.2 and eq. 4.3). Unlike neutron radiation, protons need to overcome the Coulomb
repulsion and this explains the relatively low radioactive activation by the 5MeV beam.

Gamma Power Output 100DPA Fe Cooling for 1 Week
1.2

Gamma Power (mW)

1.0

5MeV Protons
10MeV Protons
15MeV Protons
20MeV Protons
25MeV Protons
30MeV Protons

0.8

0.6

0.4

0.2

0.0
0

100000

200000

300000

Time (s)

400000

500000

600000

Figure 6.24: Change in isotope gamma output over time with proton beam off.

The predominant isotope responsible for radiation in the 5MeV sample is expected to be 58
27 𝐶𝑜, and with a half
life of 77 days this will remain radioactive for a substantial amount of time (relative to testing by irradiating,
cooling then testing the material).
For the 10-20MeV irradiated samples the primary isotope responsible for the radiation is

56
27 𝐶𝑜,

and its contri-

bution to the total gamma output in terms of power ranges from 95% to 99%. This isotope has a similarly long
half life, relative to the testing cycle, of 71 days. Depending upon the volume of material being irradiated, this
could lead to problems whereby the sample may need to cool for months to reach a safe activity to handle.
As higher energy protons are used to damage the sample a wider range of reaction possibilities become more
likely including that leading to both

52
25 𝑀 𝑛

and

52
25 𝑀 𝑛(𝑚𝑒𝑡𝑎1).

By the end of irradiation a large percentage of

radioactivity is due to these isotopes (28.6% for 25MeV protons and 42.8% for 30MeV protons). The half life
of

52
25 𝑀 𝑛

56
27 𝐶𝑜

and

52
25 𝑀 𝑛(𝑚𝑒𝑡𝑎1)

are short, being 5.6 days and 21 minutes respectively, and will decay away leaving

as the main contributor to radiation once again.

Detailed plots resulting from this Activity V2 simulation are in appendix E.1.

6.7

Proton Irradiated Molybdenum

A colleague at the University of Birmingham, John Hewett, irradiated several samples of Molybdenum for
materials testing and throughout this the activity of the Molybdenum was measured by the department’s HPGe
detector[178]. Similar to the Iron sample, thin sheets of Molybdenum were irradiated using a beam line from
the cyclotron.

140

CHAPTER 6. PREDICTING ACTIVATION

6.7.1

6.7. PROTON IRRADIATED MOLYBDENUM

Molybdenum Experimental Irradiation Results

A thin 49 micrometer sheet of pure Molybdenum was irradiated with a 13MeV proton beam for 19 seconds at
a current of 0.5 microamps. The beam area on the target was 50𝑚𝑚2 . A thick 506 micrometer sheet of the
same was also irradiated, but this time a higher beam current of 5 microamps and a duration of 1,500s.
The detector was calibrated to detect energies in the range covering 0MeV to 1.2MeV and several measurements
were taken for each sample. For the thick target the total gamma activity was measured as 16MBq at 3 days
(14MBq for gammas above 200keV) and 7.1MBq at 7 days (6.6MBq for gammas greater than 200keV).

Figure 6.25: Proton irradiated Molybdenum gamma activity measured by colleague John Hewett

A full gamma spectra was also recorded for the thick sample by gamma peak at three days. The isotopes
responsible for the five most prominent peaks at this point were

95
43 𝑇 𝑐

(half life of 20 hours[23]) and

96
43 𝑇 𝑐

(half

life of 4.28 days[23]). The results measured and interpolated by my colleague are given in figure 6.26 and table
6.8.
Peak
1
2
3
4
5

Energy (keV)
766
778
813
850
1127

Isotope
95
43 𝑇 𝑐
96
43 𝑇 𝑐
96
43 𝑇 𝑐
96
43 𝑇 𝑐
96
43 𝑇 𝑐

Gamma Intensity
93.82%
99.76%
82.00%
97.57%
15.16%

Activity (Bq)
5.118 × 105
1.355 × 106
1.155 × 106
1.386 × 106
2.103 × 105

Measured Energy (keV)
763
776
810
847
1123

Table 6.8: Gamma emissions measured from a 0.5mm thick sample of Molybdenum irradiated with 13MeV protons at 5
microamps for 1,500 seconds

6.7.2

Estimating the Activity of Proton Irradiated Molybdenum

The gamma activity of the 0.5mm thick molybdenum target will be estimated. The generated data are compared
to a number of experimental data sources through EXFOR.
Naturally occurring Molybdenum is made up of four stable isotopes, two observationally stable isotopes,
and

98
42 𝑀 𝑜

and one unstable isotope,

100
42 𝑀 𝑜,

92
42 𝑀 𝑜

with an extremely long half life of 9.9 × 1019 years (figure 6.26).

There are five reactions of particular interest that are predicted to create radioactive isotopes at the highest
rate. Two of the residual isotopes were identified in the experimental work and the reactions responsible are
the first two of the five listed below.
•

95
95
42 𝑀 𝑜(𝑝, 𝑛)43 𝑇 𝑐

141

6.7. PROTON IRRADIATED MOLYBDENUM

CHAPTER 6. PREDICTING ACTIVATION

Molybdenum Natural Abundance of Stable Isotopes
16.7%

24.1%

Mo98 24.1%
Mo96 16.7%
Mo95 15.9%
Mo92 14.8%
Mo100 9.6%
Mo97 9.6%
Mo94 9.3%

15.9%
9.3%
14.8%

9.6%

9.6%

Figure 6.26: Isotopes in naturally occurring Molybdenum

•

96
96
42 𝑀 𝑜(𝑝, 𝑛)43 𝑇 𝑐

•

96
96
42 𝑀 𝑜(𝑝, 𝑛)43 𝑇 𝑐

•

97
97
42 𝑀 𝑜(𝑝, 𝑛)43 𝑇 𝑐

•

94
94
42 𝑀 𝑜(𝑝, 𝑛)43 𝑇 𝑐

The isotope

95
43 𝑇 𝑐

(meta 1)

produced four measurable gamma activities, and these gamma decay rates will be estimated

using cross section data available from TENDL and EXFOR. The cross sections have been measured experimentally, with their results published, by four groups since the 1970s. Whilst there are discrepancies, the
total cross section predicted by the TALYS code fits well with the TENDL-2019 database and measurements
by Lamere[179] and Flynn[180]. The lower energy cross sections of Hogan[181] do not match as well but the
higher energy reactions(30MeV+) are a closer match. Finally cross section measurements by Levkovski[182] are
slightly larger near to the peak values, but on the whole match well with the TALYS computed values.

Mo96(p,n)Tc96 Cross Sections

1.0

Talys data file (ground state)
Talys data file (meta 1)
Talys data file
TENDL-2019
Flynn 1979
Hogan 1972
Lamere 2019
Levkoski 1990

Cross section (barns)

0.8

0.6

0.4

0.2

0.0
0

10

20

30

40

Energy (MeV)

Figure 6.27: Reaction cross sections for

50

60

96
96
42 𝑀 𝑜(𝑝, 𝑛)43 𝑇 𝑐

70

80

from various sources

The cross sections computed by the TALYS code are split into both the reaction to the Technetium-96 ground
state and metastable 1 state. The separate data are plotted in figure 6.27 along with their combined cross
section.
142

CHAPTER 6. PREDICTING ACTIVATION

6.7. PROTON IRRADIATED MOLYBDENUM

This estimate will calculate the contribution from the ground state only. The metastable state of
2% chance to decay directly to

96
42 𝑀 𝑜

96
43 𝑇 𝑐

has a

and a 98% chance to decay to the ground state. The half life for the

metastable state is 51.5 minutes[23] and, coupled with a lower reaction cross section than the ground state, it
will contribute a relatively small amount of

96
43 𝑇 𝑐

when compared to those created by the ion beam and will

delay the production of the ground state past the point at which the beam is removed.
The 13MeV protons will lose all their energy within the first 375 micrometers of the material as computed by
SRIM (figure 6.12). As the ions lose energy the probability of a reaction occurring changes. The cross section
ranges from a maximum of 475mb at 11MeV and this drops to zero once the ion energy falls to 3.8MeV. The
average cross section over the entire energy range based on SRIM stopping distance calculations and TALYS
data is 0.269 barns.
Given the data used is in good agreement with EXFOR experimental data, the 13MeV is expected to transmute
2.93 × 109

96
42 𝑀 𝑜

atoms into

96
43 𝑇 𝑐

every second. By the end of the beam almost 4.4 × 1012 atoms will have been

transmuted via this reaction and, as the half life of

96
43 𝑇 𝑐

is 247 times greater than the 1,500s beam duration,

atoms lost to decay during irradiation will be ignored in this estimate. The intensity of each gamma varies, and
these are listed in 6.8.
Peak
2
3
4
5

Energy (keV)
778
813
850
1127

Measured Activity (Bq)
1.355 × 106
1.155 × 106
1.386 × 106
2.103 × 105

Estimated Activity (Bq)
4.74 × 106
4.15 × 106
4.93 × 106
7.66 × 105

Factor of Over Estimate
3.5
3.6
3.6
3.6

Table 6.9: A comparison between measured and estimated peaks from a 0.5mm thick sample of Mo irradiated with
13MeV protons at 5 microamps for 1,500 seconds

There is a discrepancy between the measured amount and that predicted by past work, and it is consistent
across the four gamma peaks. There are several simplifications with this estimate including the omission of the
metastable state, but the inclusion of this would increase the estimated activity rather than decrease it.
My colleague investigated the affect of self attenuation of gammas passing through the Mo sample. They made
the assumption that the radioactive isotopes were concentrated half way through the thickness of the sample and
that the gammas would need to pass through 250 micrometers of matter. It was expected that gammas above
200keV would retain 94% of their intensity with those above 1MeV having 98.5% of their original intensity[178].
The distribution of radioactive isotopes would in fact be closer to the surface of the material than the midway
point. This is illustrated in figure 6.28 and it shows the majority of the

96
43 𝑇 𝑐

is created in the top 150 microns.

This plot is based on the SRIM stopping range for protons in Mo and the cross section data used in the estimate.
It is plausible that the orientation of the sample would affect the gamma count. If it were placed such that
the beam irradiated side faced the detector there would be less material between the radiation source and the
detector. The opposite way round and more material would block the path of the gammas to the detector, thus
decreasing their intensity.
When plotting the gamma attenuation through Mo over a range of gamma energies it is clear that those with an
energy of 500keV or more are drop to an intensity of as low as 0.9 in targets up to 1mm thick (figure 6.29)[30].
This is double the target depth of the thick target and so it does not explain the discrepancy between the
experimental and estimated values.

6.7.3

Simulated Proton Irradiated Molybdenum

Both the thin and thick samples irradiated experimentally are simulated. However, detailed data are available
for the thick sample only. A qualitative comparison of the thin sample will be made with the experimental
143

6.7. PROTON IRRADIATED MOLYBDENUM

CHAPTER 6. PREDICTING ACTIVATION

1e6 Tc96 Activity and Ion Energy vs Depth Into Target
1.0

Tc96 Activity

0.8

Proton Energy (MeV)

12
10

0.6
8

0.4

6

0.2

4

0.0
0

50

100
150
200
Depth (micrometers)

250

300

Figure 6.28: Tc activity and beam energy as a function of depth into the target, showing a non-uniform distribution of
radioactive atoms in the sample

Gamma Attenuation in Mol bdenum
1.0

50 micron
100 micron
250 micron
500 micron
1mm
1.5mm
2.0mm
2.5mm
5.0mm
1.0cm

Intensit

0.8
0.6
0.4
0.2

10−1

100

101

Gamma Energ (MeV)

Figure 6.29: The attenuation of Gammas through Mo for a range of energies and thicknesses[30]

results available.
Only stable isotopes are included in the cross section data file currently and, as 3 out of the 7 “stable” isotopes
are either observationally stable, or have an incredibly long half life, their reactions are not included. The
addition of these isotopes could highlight additional reactions but the data would need to be created first, if
possible, using TALYS.
Out of the four stable isotopes of Mo,

96
42 𝑀 𝑜

is responsible for most of the radioactivity both at the time the

beam is turned off (1,500s) (figure E.27) and after 3 days of cooling (figure E.28). As discussed earlier this
is due to the creation of both the ground state and metastable 1 state for

96
43 𝑇 𝑐.

Whilst the beam is on over

60% of the activity is due to the metastable-1 isotope. The gamma energy emitted by the isomeric transition
is comparatively low with an energy of just 32.28keV, and as a result it’s contribution to the power output is
also low. In contrast the transition to the ground state for

96
43 𝑇 𝑐

(meta 1) releases many energetic gammas.

The majority of the energy released towards the end of the ion irradiation is due to both the ground state and
metastable 1 of

94
43 𝑇 𝑐

(figure E.31).

After three days of cooling almost 67% of the decays are due to the ground state

144

96
43 𝑇 𝑐

isotopes in the sample

CHAPTER 6. PREDICTING ACTIVATION

6.8. PROTON IRRADIATED MOLYBDENUM DOPED STEEL

with another 31% from 95
43 𝑇 𝑐 (figure E.30). The gamma energy output is also primarily due to these two isotopes,
although with an 87% and 12% split (figure E.32).

Gamma Line Comparison

1e7

Calculated
Estimate
Experimental

1.0

Activity (Bq)

0.8
0.6
0.4
0.2
0.0
0

200

400

600
Energy (keV)

800

1000

Figure 6.30: Comparison of Gamma peaks from experiment, a simple estimate and the Activity code.

It is clear that there is a disagreement in the values of the experimental, estimated and computed activities and
gamma lines. The fact that the estimated activities are lower than the calculated values was expected as the
estimate only considered one reaction. The difference between the experimental work with both the estimated
and calculated values is harder to explain but will be discussed in section 8.2.4. The full results from the activity
code are included in appendix E.2.
Peak
1
2
3
4
5

Energy (keV)
766
778
813
850
1127

Measured Activity (Bq)
5.118 × 105
1.355 × 106
1.155 × 106
1.386 × 106
2.103 × 105

Computed Activity (Bq)
4.574 × 106
1.053 × 107
8.658 × 106
1.030 × 107
1.601 × 106

Factor of Over Estimate
8.9
7.8
7.5
7.4
7.6

Table 6.10: A comparison between measured and calculated peaks from a 0.5mm thick sample of Mo irradiated with
13MeV protons at 5 microamps for 1,500 seconds

6.8

Proton Irradiated Molybdenum Doped Steel

Another colleague in the Metallurgy and Materials department at the University of Birmingham, Alex DickinsonLomas, requested a copy of the Activity code and a simulation of a steel with a specific composition (Fe: 96.375,
C: 0.772, Cu: 0.024, Mn: 1.36, Ni: 0.698, Si: 0.381, Cr: 0.092, V: 0.008, P: 0.009, S: 0.003, Mo: 0.278) that
would be irradiated with 5MeV protons.
In comparison to the previous cases, 36MeV protons in Fe and 13MeV protons in Mo, the activity is much lower.
The simulated beam current was 0.5 microamps and the duration 5 minutes, but in contrast to the 100MBq
maximum activity of the Iron sample, this is expected to reach a maximum of just over 10KBq with a gamma
output of just 1.0 × 10−8 mW.

145

6.9. MEDIA ACCESSIBLE VIA GITHUB

CHAPTER 6. PREDICTING ACTIVATION

During irradiation, the isotope responsible for the majority of the residual radioactivity is
created through the

13
13
6 𝐶(𝑝, 𝑛)7 𝑁

13
7 𝑁

and this is

reaction. This is despite the stable isotope carbon-13 having a percentage by

mass in the sample of 0.008322%.
The reaction probability for

13
13
6 𝐶(𝑝, 𝑛)7 𝑁

is also high in the 4-5MeV range with a cross section between 0.1

and 0.15 barns. In contrast the first reaction of note for Carbon-12 results in Boron-9 and this begins at proton
energies near to and above 10MeV.
After a day of cooling the activity due to Nitrogen-13 will have decayed through 144 half lives to nothing. The
reaction responsible for almost 40% the radioactivity at this point is predicted to be
Other residual isotopes of note are 57
27 𝐶𝑜,

58
55
27 𝐶𝑜, 26 𝐹 𝑒

58
58
26 𝐹 𝑒(𝑝, 𝑛)27 𝐶𝑜(𝑚𝑒𝑡𝑎1).

and 55
27 𝐶𝑜. A full breakdown is included in appendix (E.3).

Whilst there are no experimental activity data to compare to, the Activity code is a useful tool. It takes a
complex material and highlights likely reaction interactions, highly radioactive residual isotopes and gamma
peaks. It also predicts the total activity expected and the calculation may be run multiple times with a range
of target thicknesses and beam energies.

6.9

Media Accessible via GitHub

The activity code outputs several videos to show how the activity and gamma output of a target changes over
time, during and after irradiation. Several of these are available through the wiki page for the code at the URL
given below.
https://github.com/BenPalmer1983/activitypy/wiki

146

Chapter 7

Potentials for Iron, Palladium and
Ruthenium
The aim of this part of my work is to derived an interatomic potential for Fe-Pd and Fe-Ru that
are suitable for modelling both radiation damage and a change in concentration of PGMs at the
grain boundary.
Experimental data exists for the bulk properties of BCC Fe, FCC Pd and HCP Ru, but the FCC
structure of austenitic steels necessitates the computation of bulk properties, energies and forces of
pure iron with this structure. DFT is the method used to perform these calculations.
The parameters required for Quantum Espresso, the selected DFT code, are converged for each
element and those that give a reasonable degree of accuracy, balanced against execution time, are
used throughout the remainder of this work. A computer code was developed to automate the convergence process (QECONVERGE) and for the calculation of bulk properties (QEEOS).
The computed properties, as well as a range of atomic configurations, for a reference database
that is used to fit the potentials to. A computer code, EAMPA, was developed to carry out the
fitting to this database and this resulted in two binary allow potentials: Fe-Pd and Fe-Pd, trained
on bulk property data and energy force data for FCC structures.

7.1

Introduction

While computer technology has advanced almost in accordance with Moore’s law, the calculations involved
to approximately simulate simple structures with Quantum Mechanics are barely accessible. Ideally, crystal
structures with several hundred atoms, containing Fe, Cr, and Ni with Ru or Pd would have been used in this
work to derive a potential describing all combinations of elements.
The computer used did not have the resources required for such calculations, and so the model was simplified
to either Fe-Pd or Fe-Ru and pure elements only. The ferromagentism and antiferromagnetism of Fe and Cr
were explored using collinear spin DFT calculations. Due to the improvement in modelling given by including
magnetism, all calculations for the reference database were collinear spin.
A number of computer codes were developed to automate processes. QECONVERGE creates input files and
calls PWscf to converge parameters used in this work (section 7.2.5). QEEOS also creates input files for PWscf

147

7.1. INTRODUCTION

CHAPTER 7. POTENTIALS FOR FE, RU, PD

but computes bulk properties such as the equation of state, bulk modulus and elastic constants, see appendix
M.

7.1.1

Interatomic Potential Fitting

The potentials in this work are fitted to both experimental data and DFT data. As the purpose of these
potentials is to provide a way to model Palladium and Ruthenium, and determine whether or not they migrate
to the surface, appropriate atomic configurations are included in the fitting process.
The work may be broken into three main parts. The first is devoted to using DFT to generate the required
data, the second is the development of a computer program for fitting the potential, and the third is finally
fitting the potential. An overview of this process is given in figure 7.1.
The process follows aspects of previous work. The force matching method of Ercolessi and Adams[125] and
its application within Brommer’s PotFit code[135] (and it’s subsequent extension by Sheng[136]) impacted this
work greatly. The exact fitting methods used by Bonny and spline type functions used throughout work on Iron
alloys by Ackland, Mendelev, Hepburn and more helped to fix on a specific form of the functions and functional
used here.

7.1.2

Existing Experimental & DFT Bulk Property Data

The bulk properties for Fe (BCC) and Pd are available on several websites and in published work. The lattice
parameter, bulk modulus and elastic constants are available for Fe BCC and Pd FCC, but as pure Fe FCC is
theoretical under normal conditions, this is computed here using DFT.
A large amount of computing power is required to run the DFT calculations. If the input parameters are not
accurate enough to begin with, it will either take a long time for the DFT calculation to run, or it will fail to
converge completely. The lattice parameter for each element, using the density of that pure element in its state
under normal conditions, is predicted for that element either for both the FCC and BCC structures (table 7.1).
Element
Al [183]
Cr [184]
Fe [184]
Ni [185]
Ru [186]
Pd [187]

Atomic Mass
26.98
52.00
55.84
58.69
101.07
106.42

Density kg/m3
2700
7140
7874
8908
12270
12023

Atoms/m3
6.02 × 1028
8.27 × 1028
8.47 × 1028
9.09 × 1028
7.42 × 1028
6.83 × 1028

FCC (Bohr/Angstrom)
7.66/4.05
6.89/3.64
6.83/3.61
6.67/3.53
7.14/3.78
7.34/3.88

BCC (Bohr/Angstrom)
6.08/3.22
5.47/2.89
5.42/2.87
5.30/2.80
5.67/3.00
5.83/3.08

Table 7.1: Predicted lattice parameters based on the density, atomic number and type of structure

Aluminium appears here because it has a simpler electronic structure and no magnetic properties to complicate
the DFT calculations. These calculations for Aluminium complete much faster than for the other elements
listed, so it was used throughout to develop and test the computer codes created.

148

no

yes

149

Figure 7.1: Work flow used to fit potentials

Continue
with these
settings?

Test the
settings

More
config
sizes?

yes

no

All
elements
complete?
yes

no

All pairs
complete?

Surface
configs

Randomly
perturbed
configs

Randomly
perturbed
configs

Surface
configs

Bulk

Relax

Binary
Alloy calculations

Compute
Elastic
Constants

Compute
BM EoS

Converge
ecutwfc
and
ecutrho

Converge
k-points
and choose
smearing

Relax pure
element
crystal

Choose or
generate
PPs

Collate experimental
properties

yes

Test
Potential

Introduce
EFS
configs

Fit to bulk
properties

Choose
starting
parameters

Choose
EAM
function
form

Pure
element
fitting

no

Test alloy
potential

Save as
LAMMPS
&
DLPOLY

Fit alloy
cross pair
potentials

Effective
gauge
transformations

yes

All
alements
done?

Improve fit

CHAPTER 7. POTENTIALS FOR FE, RU, PD
7.1. INTRODUCTION

7.2. DFT SETTINGS

7.2
7.2.1

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Selected DFT Code, Pseudopotentials and Parameters
Quantum Espresso

There are a choice of several different DFT programs to choose from, including VASP, Siesta and Quantum
Espresso. The open source Quantum Espresso includes the PWscf binary that solves electronic structure
calculations with plane wave pseudopotentials. It calculates the total energy of a system as well as the forces
between atoms and the stress on the simulation box.
As the calculations contain Iron, it is important to take into account the magnetism caused by the unpaired
filling of the d-shell. PWscf gives three modes: non-magnetic, collinear spin and non-collinear spin.

7.2.2

Pseudopotential Selection

The pseudopotentials were downloaded from the Quantum Espresso PSLibrary with URL:
http://www.quantum-espresso.org/pseudopotentials/pslibrary
There are several categories of pseudopotential available. The pseudopotentials may be fully relativistic or not.
The DFT calculations in this work will be non-spin or collinear spin and the element with the largest number
of electrons will be Palladium, with electrons in the s, p, d shells. There will be no elements used in this work
with f shell electrons, so a non-relativistic pseudopotential will be used for each element.
There are a number of choices of exchange-correlation functional, depending on the element:
• pz: Perdew-Zunger (LDA)
• vwn: Vosko-Wilk-Nusair (LDA)
• pbe: Perdew-Burke-Ernzerhof (GGA)
• blyp: Becke-Lee-Yang-Parr (BLYP)
• pw91: Perdew-Wang 91 gradient-corrected
In the literature, LDA and BLYP are used for organic DFT calculations. LDA and GGA type pseudopotentials
have been used to model solids and, in particular, the GGA type have been used to study metals as they are
more reliable at calculating parameters such as 𝑎0 (see section 5.7.11). Several elements were tested to compare
the results of LDA and GGA pseudopotentials to the experimental values for the lattice parameter of each.
The settings used were:
• ecutwfc: 71
• ecutrho: 430
• k-points: 9 9 9 Monhurst-Pack grid offset
• smearing: 0.04 Ry Mazari-Vanderbilt cold smearing
• calculation type: non-polarised calculation
• pseudopotentials: PZ for LDA, PBE for GGA
The results were computed as follows:
The simpler LDA pseudopotentials consistently underestimate the lattice parameter 𝑎0 for the four metals
tested, and on average they underestimate by 3%. The GGA calculations are within 1.5% of the experimental
value.
150

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Element
Al
Fe
Pd
Cu

Crystal
FCC
BCC
FCC
FCC

7.2. DFT SETTINGS

𝑎0 exp. (ang)
4.05
2.87
3.89
3.61

𝑎0 LDA (ang)
3.98
2.69
3.84
3.49

𝑎0 GGA (ang)
4.04
2.75
3.93
3.59

Table 7.2: Predicted lattice parameters based on the density, atomic number and type of structure

7.2.3

Smearing Type

The material being studied here is a metal/metal alloy, and this has important consquences when setting up
the calculation. The conduction and valence bands overlap in a metal, and the fermi energy passes through
this overlap. When the occupied states are summed, integrating over all k-points k[188], those bands that cross
the Fermi energy will drop to zero. There are two solutions used here to reduce this abrupt drop off: increase
the number of k-points, or add a smearing to smooth the occupation function. Previous work has given the
following suggested smearing types and values as a start point.
• Degauss values 0.01Ry Methessel-Paxton [189]
• Fermi-Dirac 0.01eV (0.00074Ry) [190]
• Marzari-Vanderbilt 0.01Ry [191]
• Degauss 0.03 + 0.05 [192]
• Marzari-Vanderbilt 0.05Ry [193]
This suggests that a range between 0.01Ry to 0.05Ry should be investigated as a sensible range of smearing
energies. There are a choice of four smearing functions in QuantumEspresso.
• Gaussian
• Fermi-Dirac
• Methfessel-Paxton
• Marzari-Vanderbilt
Functions such as the Gaussian and Fermi-Dirac are not cold smearing, and will converge to the wrong energy
whereas the Mazari-Vanderbilt and Methfessel-Paxton are designed to reduce and heating whilst smearing the
electron wavefunction. An author of QuantumEspresso, N. Marzari, co-developed the cold smearing MarzariVanderbilt function, and this was selected as it had appeared a number of times in the literature and throughout
the QuantumEspresso tutorials.

7.2.4

Parameter Convergence

The energy cutoff, charge density, k-point and smearing values must be selected carefully for any similar DFT
calculation. There is a balancing act between the accuracy of the result of a particular calculation and computational time. This will also vary with the pseudopotential, complexity of the electron configuration of the
atoms, whether or not the calculation is with or without spin, and so on.
The pseudopotentials and smearing type have already been selected, and the first set of calculations will not
include magnetism. The parameters must work well with high symmetry geometries, such as a BCC or FCC
crystal with the atoms in their exact position, but also where the atoms have been slightly perturbed from their
exact position in the lattice.
151

7.2. DFT SETTINGS

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Ecutwfc and Ecutrho
A primitive FCC or BCC is created and the atoms are slightly perturbed, breaking symmetry but also putting
forces on each atom within the cell. A reasonably high number of k-points are used and the smearing value
should be low, but the k-point values in particular will depend upon the computing resources available.
Select a low ecutwfc and set the ecutrho equal to four times the value of the ecutwfc. Depending on the
pseudopotential, the calculation may fail because the values are too small. If this is the case, continue increasing
the value in 5Ry increments until the calculation runs successfully.
Continue to increase the ecutwfc value whilst increasing the value of ecutrho such that 𝑒𝑐𝑢𝑡𝑟ℎ𝑜 = 4 × 𝑒𝑐𝑢𝑡𝑤𝑓 𝑐

in steady increments (5Ry). Once the calculated force and energy per 1Ry increment fall below a threshold set
by the user, the values have converged. In this work, the convergence values were:
• Energy convergence per 1Ry: 1.0 × 10−6 Ry (1.36 × 10−5 eV)
• Force convergence per 1Ry: 1.0 × 10−5 Ry/Bohr (2.57 × 10−4 eV/Ang)
At this point, it may be possible to reduce the ecutrho value further while remaining within this convergence
threshold, so the ecutwfc value is held fixed while the ecutrho value is reduced in steps of 5Ry.
An attempt is made to reduce the value of ecutwfc further in 1Ry steps while holding the ecutrho value steady
for as long as the convergence value remains within the set threshold.
K-Points and Smearing Value
A configuration with a similar size and number of atoms as those in the calculations should be created. In
this work, the reference database and bulk properties will be calculated using 32 atom configurations in an
approximately sized 7 × 7 × 7 angstrom box. The Iron FCC k-points and smearing are calculated using a 32

atom FCC box with sides length 7.2 angstrom and the Palladium with a 32 atom FCC box with sides length
7.8 angstrom.
As with the ecutwfc and ecutrho convergence calculations, the atoms are slightly perturbed from their exact crystal positions, putting a force on the atoms and breaking the symmetry (as will be the case for the
configurations used for fitting).
The convergence process is more complex for k-points and smearing. There might be a convergence that, at
face value, looks better (a smaller convergence value and a decrease in the computation time and memory
requirements) for combinations with a higher smearing value, but it is preferred to have a smaller smearing
value with a higher number of k-points, while maintaining a reasonable computing time, as the greater the
smearing the further the calculated value is from the actual calculated value (with no smearing and a very high
number of k-points).
A 2D plot of energy and force values as a function of number of k-points and smearing may then be used to
choose reasonable settings that balance the requirements.

7.2.5

QECONVERGE Python Code

The convergence process requires the creation of many input files, and manually editing these files is time
consuming and vulnerable to human error. Over 100 input files may be required to converge the ecutwfc and
ecutrho values, with a further 50-100 required to generate the 2D k-point and smearing plots. A python code,
QECONVERGE, was developed to automate this process and plot the results automatically for the user (section
K).
152

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.2. DFT SETTINGS

The program reads an input file into memory, and this contains the settings for the convergence run. A template
PWscf input file is also loaded, and this will detail any required PWscf settings, such as the pseudopotentials,
atom species and so on.
Once these files have been loaded, the first stage of the program runs to determine the ecutwfc and ecutrho
values that are within the force and energy convergence thresholds provided by the user. The program creates
a crystal based on the settings, for example an FCC, BCC or SC crystal supercell. The exact atomic positions
are likely to be the optimal, relaxed, positions and so the overall forces on each atom will be zero. The program
randomly varies the atomic positions, and this results in a configuration with forces between the atoms.
The wfc value starts with the user defined ecutwfc starting value, and this is increased until the change in energy
and force both converge to within the specified thresholds. The ecutrho value is increased simultaneously, and
is four times the ecutwfc value. In the second stage, the ecutrho value is decreased and the ecutwfc value is
fixed while the energy and force remain within their respective convergence thresholds. Finally, the program
attempts to decrease the ecutwfc value further.
Following the energy and charge density cutoff, the program then runs a number of calculations in order to
produce a collection of colour density plots of energy cutoff vs density cutoff, plotting the convergence of total
energy and total force. This allows the user to visualise the convergence surface and select cutoff values manually,
if desired.
The final part of the program is to help the user decide upon degauss and k-point values. The converged ecutwfc
and ecutrho values from the first part of the code are used, and the k-point start, end and increment amounts
are set by the user, as is a list of smearing degauss values. 2D colour plots of force and energy convergence as
smearing changes and k-point value changes are prepared and saved so the user may study these to determine
the best combination for their application.
The randomised atom positions use a seed that may be set in the input file. This means that, although they are
pseudo-rng generated, they are repeatable given the same random seed. Every successful PWscf calculation is
logged and saved. If the program runs multiple times, the cached output files are used rather than recalculating
every input file.
The source code and instructions on how to use the program are available to download from GitHub.
https://github.com/BenPalmer1983/qeconverge

7.2.6

Convergence of Key DFT Settings and Testing

Prior to generating a database of atom configurations, calculated forces, stresses and energies, key DFT settings
needed to be selected and tested. The Python code QECONVERGE was written then used to converge the
ecutwfc, ecutrho, k-points and degauss smearing values for each of the pseudopotentials required.
As discussed in previously (section 5.7.11) the GGA type pseudo-potential more reliably calculated the bulk
properties of a material when compared to LDA/LSDA, and a copy of the earlier table is given in table 7.3.

153

7.2. DFT SETTINGS

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Pseudo-potential

Element

a/angs

𝐵0 /GPa

Experimental
Na.pz-spn-kjpaw psl.1.0.0
Na.pbe-spn-kjpaw psl.1.0.0
Na.pbesol-spn-kjpaw psl.1.0.0
Experimental
Al.pz-nl-kjpaw psl.1.0.0
Al.pz-n-kjpaw psl.1.0.0
Al.pbe-nl-kjpaw psl.1.0.0
Al.pbe-n-kjpaw psl.1.0.0
Al.pbesol-nl-kjpaw psl.1.0.0
Al.pbesol-n-kjpaw psl.1.0.0

Na
Na
Na
Na
Al
Al
Al
Al
Al
Al
Al

4.29[157]
4.06
4.20
4.17
4.05[158]
3.98
3.98
4.04
4.04
4.01
4.01

6.3[157]
8.72
7.67
7.50
76[158]
78.6
78.6
91.3
75.0
87.7
79.0

Table 7.3: Experimental vs LSDA vs GGA - the DFT values were computed with a PWscf[159] using a 2x2x2 cell, 7x7x7
kpoints and ecutwfc=50

The following pseudopotential files were used for each element:
• Aluminium: a plane wave GGA potential Pd.pbe-spn-kjpaw psl.1.0.0.UPF
• Chromium: a plane wave GGA potential Cr.pbe-spn-kjpaw psl.1.0.0.UPF
• Iron: a plane wave GGA potential Fe.pbe-spn-kjpaw psl.1.0.0.UPF
• Palladium: a plane wave GGA potential Pd.pbe-spn-kjpaw psl.1.0.0.UPF
• Ruthenium: a plane wave GGA potential Ru.pbe-spn-kjpaw psl.1.0.0.UPF
For each pseudopotential, the ecutwfc, ecutrho and kpoint and degauss settings were converged. Ideally, the
k-points settings would have been increased, but doing so would have been prohibitive due to the amount of
time taken to perform each calculation.
By the time calculations were being executed for a 32 atom supercell, one node of 20 processor cores would
run for several days up to a week or more, requiring the calculation to be submitted to the job queue multiple
times. Al is also considered in the results section, as it is a simpler atom to run trial calculations with, and to
compare to experimental results.
The relaxed crystal lattice parameters were calculated for Fe, Cr, Pd and Ru. Cr will not be used in either the
Fe-Pd or Fe-Ru fitting calculations. However, there is a large increase in computation time between non-spin
and collinear spin calculations and the ferromagnetic structure of BCC Fe as well as the antiferromagnetic
structure of FCC Fe and BCC Cr were investigated.

154

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.2. DFT SETTINGS

Equation of State
)2.482e2

Cr BCC No Mag

)0.0180

Cr BCC AFM
Cr BCC FM

)0.0185

Energ( (R(/atom)

)0.0190

)0.0195

)0.0200

)0.0205

)0.0210

)0.0215

74

76

78

Volume (Bohr^3/atom)

80

82

Figure 7.2: Equation of state fit through data points for Chromium BCC with no magnetism, ferromagnetic and antiferromagnetic configurations

Description

𝐴0 (ang)

𝑉0 (bohr3)

𝐵0 (GPA)

𝐸0 (Ry) (DFT Only)

Exp.
AFM
FM
No Mag

2.91
2.86
2.85
2.85

83.23
78.77
78.10
78.102

160
217
267
267

-248.2216
-248.2214
-248.2214

Table 7.4: Chromium properties with and without collinear spin

The equation of state was calculated for Chromium BCC in three ways: (1) with magnetism switched off, (2)
atoms set in a ferromagnetic configuration (collinear, all in the same direction), (3) atoms set in an antiferromagnetic configuration (collinear, atoms in the same cell with spin in opposing directions).
The DFT calculated values for the bulk modulus were larger than expected, but the antiferromagnetic calculation
was much closer to the experimental value (table 7.4). The 𝐸0 values do not reflect the actual energies, but
show the relative calculated values. The antiferromagnetic configuration gives the lowest, optimum, energy (fig.
7.2).

155

7.2. DFT SETTINGS

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Equation of State
−3.292e2

BCC W th Mag (ferromagnet c)
BCC No Mag
−0.030

FCC No Mag
FCC W th Mag (ant -ferromagnetic)

−0.035

Energ) (R)/atom)

−0.040

−0.045

−0.050

−0.055

−0.060

64

66

68

70

72

Volume (Bohr^3/atom)

74

76

78

Figure 7.3: Equation of state fit through data points for Iron BCC (no magnetism, ferromagnetic) and Iron FCC (no
magnetism and antiferromagnetic)

Description

A0 (ang)

V0 (𝑏𝑜ℎ𝑟3 )

B0 (GPA)

E0 per atom (Ry) (DFT Only)

BCC Exp.
BCC No Mag
BCC FM
BCC AFM
FCC Exp.
FCC No Mag
FCC FM
FCC AFM

2.86
2.77
2.82
(failed)
(none)
3.43
(failed)
3.42

79.01
71.53
75.9
(failed)
(none)
69.59
(failed)
73.11

170
286
239
(failed)
(none)
286
(failed)
226

-329.23
-329.26
(failed)
(none)
-329.25
(failed)
-329.26

Table 7.5: BCC and FCC Iron properties with and without collinear spin

In the case of Iron, both BCC and FCC configurations were used. The antiferromagnetic calculation for BCC
Fe and ferromagnetic calculation for FCC Fe failed in that either the SCF calculations failed to converge or
there were other issues. As expected, the optimal configuration was BCC with ferromagnetism, and second to
this was FCC with antiferromagnetism.
Despite the increase in computational time, and other demands on resources such as scratch space and RAM per
node, it was clear that collinear spin calculations were required for iron. The lattice parameter value was within
2% of the experimental value with the BCC structure set in a ferromagnetic state. Whilst the bulk modulus is
only within 41% of the experimental value, this is an improvement over the non magnetic calculation that was
almost 70% away from the experimental bulk modulus (table 7.5, figure 7.3).
The QECONVERGE program was used to suggest the parameters to use, given the convergence threshold of
1.0−5 𝑅𝑌 /𝐵𝑜ℎ𝑟 for forces and 1.0−6 𝑅𝑌 for energy.

156

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.3. DFT RESULTS

Element

Pseudopotential

Ecutwfc

Ecutrho

K-points

Degauss

Atoms

Al
Fe/Pd/Ru
Fe/Pd/Ru

Al PBE KJPAW
PBE KJPAW
PBE KJPAW

50
71
71

200
431
431

11
9
Gamma

0.04
0.04
0.04

32
32
128-256

Table 7.6: DFT Settings - pseudopotentials, ecutwfc, ecutrho, k-points, smearing

These settings in table 7.6 were used throughout the remainder of the work. The maximum values were selected
from Fe, Ru and Pd as they were to be used for calculations of the pure elements and for binary allows of Fe-Ru
and Fe-Pd.
The other settings used in PWscf throughout are listed in table 7.7. Several of these values were arrived at by
trial and error. It was recommended by the authors of Quantum Espresso to adjust parameters such as the
mixing beta if a calculation fails to converge. The mixing mode was also changed from time to time, but overall
the plain mode seemed to work best in most cases.
Parameter

Value

etot conv thr
forc conv thr
conv thr
diagonalization
mixing beta
mixing mode

0.0001
0.001
−8
1.0 × 10 to 1.0 × 10−6
david
0.1 to 0.3
plain (local-TF for defects or randomised configurations)

Table 7.7: DFT Settings - other settings

The choices of parameters are supported by the convergence plots produced by the QECONVERGE code in
figures L.1 and L.2 (appendix L).

7.3

DFT Reference Database and Bulk Properties

The potentials in this work were designed for austenitic stainless steel and the properties of the individual
elements in the FCC structure were computed using DFT. This is due to the bulk properties only being
available experimentally for FCC Pd. A database of atom configurations along with atom positions, energy,
forces and stresses was also compiled using DFT calculations.

7.3.1

QEEOS Python Program

A Python code, QEEOS, has been developed to calculate bulk properties of a structure using the DFT code
Quantum Espresso. It is able to fit the equation of state for a cubic structure, and elastic constants for
orthorhombic structures (which includes the subset of cubic structures).
A code was developed to automate the process of calculating the equation of state and elastic constants of a
material using Quantum Espresso. It requires an input file and a starting PWscf input file.
• the input configuration is relaxed using the vc-relax option in PWscf
• configuration files are created to compute the equation of state, and PWscf is used to calculate the energies
of these configurations
157

7.3. DFT RESULTS

CHAPTER 7. POTENTIALS FOR FE, RU, PD

• to compute the elastic constants, nine distortions are applied to the relaxed configuration with the required
number of steps for each strain applied to each distortion, and these are processed with PWscf
• once all DFT work has completed, the Birch-Murnaghan equation of state is fit to the first set of energies,
and the nine orthorhombic elastic constants are fit to the results of the second set of energies
The source code and instructions on how to use the program are available to download from GitHub.
https://github.com/BenPalmer1983/qeeos
The readme file along with a number of the functions used in the code are included in appendix M.

7.3.2

DFT Calculations of Bulk Properties

Although experimental data does exist for several of the structures, it was decided to calculate all the properties
using DFT. This was partly to confirm that both the QEEOS and PWscf, with the converged settings, were
giving reasonable values and also to give data points that would better align with the energy, force and stress
configuration calculations.
Experimental data is not available for FCC Fe and FCC Ru and so it was essential to compute these. Although
spin collinear equations were used throughout, it was particularly important for these settings to be used for
Fe. The relaxation step allowed for a relaxation of the atom positions, the basis vector and lattice parameter.
This gave cubic structures for Ru and Pd but a tetragonal structure for Fe.
The bulk property calculations were automated with the QEEOS code and this applied the preprogrammed
nine strains, as discussed in section 5.2.6, and the results are discussed here.

7.3.3

Relaxed Crystal Calculations

The cohesive energy is an important value in relation to the interatomic potential. The energies calculated by
DFT code depend on many factors including the energy under which plane-wave are cut-off, the degauss value,
k-point settings and the SCF convergence parameters. What is more important in the DFT calculations is the
difference in energy between calculations. As the experimental cohesive energy is known for certain elements,
a DFT calculation may be performed for each species of atom to determine the relaxed energy. This value
may then be used to calibrate other DFT calculations, so they are given relative to the energy of each atom
spaced infinitely far from one another, with a binding energy of 0eV. The relaxed energies, the settings used to
calculate them and the adjustment to convert them to the “real” energies are given in table 7.8.

158

159

Aluminium
FCC
50
200
11 11 11
0.04
0
None
32
-1264.08749654
-39.502734267
-537.462275214
-3.36
534.102275214
15.265
None
1.000
1.000
1.000
0.000

Element
Structure
Ecutwfc (Ry)
Ecutrho
K-points
Smearing (Ry)
NSpin
Starting Magnetism
No. Atoms
Energy (Ry)
Energy/Atom (Ry)
Energy/Atom (eV)
Known Cohesive Energy (eV)
Adjustment/atom (eV)
Relaxed 𝑎0 (Bohr)
Relaxed 𝑐 (Bohr)
𝑈𝑥𝑥
𝑈𝑦𝑦
𝑈𝑧𝑧
𝑈𝑦𝑥

Iron
BCC
71
430
999
0.04
2
FM
16
-5268.18846365
-329.261778978
-4479.836349416
-4.316
4475.520349416
10.594
None
1.000
1.000
1.000
0.000

Fe BCC
Iron
FCC
71
430
999
0.04
2
AFM
32
-10536.25040753
-329.257825235
-4479.782555982
-4.26 (Calculated)
4475.520349416
12.937
None
1.000
1.054
1.000
0.000

Fe FCC
Palladium
FCC
71
430
999
0.04
0
None
32
-16384.95803030
-512.029938447
-6966.524743211
-3.91
6962.614743211
14.845
None
1.000
1.000
1.000
0.000

Pd FCC

Table 7.8: Relaxed energies calculated in Quantum Espresso

Al FCC

Measurement

None
1.000
1.000
1.000
0.000

-6.62 (Calculated)
5866.47338

-6.74
5866.47338
1.5773
1.000
0.8660
1.5773
-0.5

Ruthenium
FCC
71
430
999
0.04
0
None
32
-13813.30088106
-431.665652533

Ruthenium
HCP
71
430
999
0.04
0
None
16
-6906.78722345
-431.674201466

Ru HCP

CHAPTER 7. POTENTIALS FOR FE, RU, PD
7.3. DFT RESULTS

7.3. DFT RESULTS

CHAPTER 7. POTENTIALS FOR FE, RU, PD

The configuration for Fe has been referred to throughout this work as FCC, but the relaxed collinear spinpolarized DFT calculation predicts that the structure is slightly face centered tetragonal (FCT). The optimal
magnetic setting is antiferromagnetic and, with the spin aligned in the z-direction, the y-axis of the unit cell is
approximately 5% larger than the x and z axis.

Figure 7.4: Magnetic alignment along the z-axis, antiferromagnetic Fe fcc

The atoms in the (0,1,0) plane are majority spin-up electrons, along the z-axis, and those in the (0,2,0) plane
are spin-down, along the z-axis (fig. 7.4). Following the relaxation calculation, all the atoms were in their
standard FCC positions, and the magnetic moment for each atom was 1.4901 Bohr magneton and -1.4901 Bohr
magneton for the spin up and down respectively.

7.3.4

Calculation of Elastic Constants

The planewave cutoff and k-points were converged to within the required parameters for energy and force but
it is known that, in general, LDA and GGA pseudopotentials under and over estimate the lattice parameters.
The bulk modulus and elastic constants were calculated for FCC Aluminium and BCC Iron in order to compare
to experimental values.
A summary of the main data points is given here for FCC Al, BCC Fe, FCC Pd and FCC Fe, and the first
three listed are compared to experimental data. A full details of the calculated properties including plots are
included in appendix N.
FCC Aluminium
The parameters used for the Al calculations were arrived at earlier using the convergence code. The remainder
of the parameters are either default settings, or were selected following trial and error (for example, reducing
the mixing beta to help achieve convergence). These settings are given in table N.1.

160

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.3. DFT RESULTS

The results in table N.2 show a good agreement between the experimental values for Al and the calculated
values. The lattice parameter is a particularly good fit, being within 1% of the experimental value. The shear
modulus does not match as well, but is within 20% of the experimental value. The RSS measurement of fit
between the values was 2.54 × 102 .
BCC Iron
The equation of state and elastic constants were calculated for BCC Fe, with no-spin and collinear spin. The
settings used for the calculations are given in table N.3.
The non-magnetic Iron calculation was particularly poor. Although the lattice parameter was within 5% of the
experimental value, the structure was unstable and had negative values for both the Young’s modulus and shear
modulus (table N.4). The RSS measurement of fit between the values for the was 2.01 × 105 .
With collinear spin enabled, the structure is stable. The lattice parameter is still slightly under the experimental,
but is now within almost 2% of the value. The bulk modulus predicted by fitting the Birch-Murnaghan equation
of state is more than 40% the experimental value, but the Reuss and Voigt values derived from the calculated
elastic constants are just 20% difference to the experimental value. The latter two values are calculated using
the elastic constants, rather than the equation of state. This highlights the importance of using collinear spin
calculations, despite the cost in computing time. The RSS measurement of fit between the values was 1.09 × 104
giving an improvement of at least one magnitude.
FCC Iron
The gamma phase of pure iron does not exist for experimental measurements to be made, and the results here
will be used to fit the FCC iron potential in section 7.6. The settings used for the calculations are given in table
N.5.
The structure is stable under the orthorhombic stability conditions given in section 5.2.7. Whilst there are
no experimental measurements to check against, the values are sane when compared to the other calculations
performed here (table N.6). The 𝐶44 , 𝐶55 and 𝐶66 values are slightly large when compared with those for BCC,
but further DFT calculations would need to be performed to investigate this.
The results computed here are summarised in table 7.9 and these are used by the EAMPA code in section 7.6
to fit the potential for pure Fe.

161

7.3. DFT RESULTS

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Property

Value used in potential fitting

Element
Structure
𝑎0
Nearest Neighbour

Fe
Face Centered Cubic
3.59 Angstrom
1.85 Angstrom
⎤
⎡
0.96 0.0 0.0
⎥
⎢
⎣ 0.0 1.00 0.0 ⎦
0.0 0.0 0.96
-4.32 eV
226.1
356.8
144.8
0.23
⎤
⎡
364.6 141.6 233.8
0
0
0
⎥
⎢
0
0
0 ⎥
⎢141.6 298.7 130.4
⎥
⎢
⎢233.8 130.4 364.6
0
0
0 ⎥
⎥
⎢
⎢ 0
0
0
186.3
0
0 ⎥
⎥
⎢
⎢
⎥
⎣ 0
0
0
0
266.8
0 ⎦
0
0
0
0
0
186.3

Basis vectors
𝐸𝑐𝑜ℎ
𝐵0 (GPA)
𝐸 (GPA)
𝐺 (GPA)
Poisson Ratio 𝜂

Elastic Constants

Table 7.9: DFT computed FCC Fe parameters for fitting the potentials in this work

FCC Palladium
The equation of state and elastic constants were calculated for FCC Pd with no-spin. The settings used for the
calculations are given in table N.7.
There is a good agreement between the computed and experimental values for Pd, without the need to move
from non-spin to collinear spin calculations (table N.8). However, in the alloy calculations the presence of Fe
will dictate the necessity for collinear spin. The RSS measurement of fit between the values was 4.12 × 103 .
The results computed here are summarised in table 7.10 and these are used by the EAMPA code in section 7.6
to fit the potential for pure Pd.

162

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.3. DFT RESULTS

Property

Value used in potential fitting

Element
Structure
𝑎0
Nearest Neighbour

PD
Face Centered Cubic
3.925 Angstrom [187]
Angstrom [187]
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
3.91 eV [119]
184.4 GPA [119]
⎤
⎡
218.5 151.4 151.4
0
0
0
⎥
⎢
0
0
0 ⎥
⎢151.4 218.5 151.4
⎥
⎢
⎢151.4 151.4 218.5
0
0
0 ⎥
⎥
⎢
⎢ 0
0
0
80.3
0
0 ⎥
⎥
⎢
⎥
⎢
⎣ 0
0
0
0
80.3
0 ⎦
0
0
0
0
0
80.3

Basis vectors
𝐸𝑐𝑜ℎ
𝐵0

Elastic Constants

Table 7.10: DFT computed FCC Pd parameters for fitting the potentials in this work

FCC Ruthenium
Ruthenium at standard conditions exists as hexagonal close packed, but as this work is focused on FCC steel
doped with PGMs, the properties are computed for FCC Ruthenium. The settings used for the calculations are
given in table N.9.
The results computed here are summarised in table 7.11 and these are used by the EAMPA code in section 7.6
to fit the potential for pure Ru.
Property

Value used in potential fitting

Element
Structure
𝑎0
Nearest Neighbour

RU
Face Centered Cubic
3.809 Angstrom [187]
Angstrom [187]
⎡
⎤
1.0 0.0 0.0
⎢
⎥
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
6.624 eV [119]
307.8 GPA [119]
⎡
⎤
471.5 219.1 219.1
0
0
0
⎢
⎥
0
0
0 ⎥
⎢219.1 471.5 219.1
⎢
⎥
⎢219.1 219.1 471.5
0
0
0 ⎥
⎢
⎥
⎢ 0
0
0
245.0
0
0 ⎥
⎢
⎥
⎢
⎥
⎣ 0
0
0
0
245.0
0 ⎦
0
0
0
0
0
245.0

Basis vectors
𝐸𝑐𝑜ℎ
𝐵0

Elastic Constants

Table 7.11: DFT computed FCC Ru parameters for fitting the potentials in this work

163

7.3. DFT RESULTS

7.3.5

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Calibrating the Cohesive Energies

Density Functional Theory solves the Kohn-Sham equations for an infinite repeating lattice, and at first it
doesn’t seem applicable to single atoms or molecules that are not part of much larger lattice. There are settings
that may be used to compute the energy of an isolated atom and these are discussed on the Quantum Espresso
forum[194] and Materials Square[195].
The settings of note used in these calculations were a configuration of just 1 isolated atom in a large cubic cell
(20+ Bohr). The computations were all nspin = 2 to ensure the electrons are computed spin up and down. The
assume isolated setting is given the makov-payne setting, as the system is a cube.
It was important to reduce the number of processor cores as too many would cause matrix decomposition errors
for a low number of atoms, causing Quantum Espresso to crash. An option to leverage more cores was to
split the calculation into pools using the -npool input flag for PWscf, but this was not necessary for this set of
calculations.
The isolated and relaxed energy values were computed and from these values the cohesive energies were calculated (figure 7.5 and table 7.12). In doing so, it became apparent that there were errors of up to 12% between
the known values and those computed with DFT.

Isolated Atom Ene gies

0.000

Ene gy (eV)

−0.005
−0.010
−0.015
−0.020

Pd
Ru
Fe

−0.025
−0.030
4000

6000

8000

10000

12000

14000

16000

Cell Volume (Boh Cubed)

18000

Figure 7.5: Isolated atom energies as cell size increase

An offset was needed to convert from the DFT energies to “real” energies that could be used to derive a
potential.
Element
Fe
Fe
Pd
Ru
Ru

Structure
BCC
FCC
FCC
HCP
FCC

Isolated Energy (Ry)
-4474.99115
-4474.99115
-6962.47261
-5866.39894
-5866.39894

Relaxed Energy (Ry)
-4479.83524
-4479.78095
-6966.52234
-5873.22666
-5873.11029

Cohesive Energy (eV)
4.84 (exp. 4.32)
4.79
4.05 (exp. 3.91)
6.83 (exp. 6.74)
6.71

Table 7.12: DFT calculated energies per atom

Two offsets were computed and these depend upon the settings used in the calculation (table 7.13). Specifically,
they depend on whether 9x9x9 k-points are used, in the case of the 32 atom calculations, or the gamma point
is used (128, 129 and 256 atoms).
There were significant differences between the calculated cohesive energy, taking the difference between the
isolated and bulk energies, and the experimentally known energies. Rather than use these all the DFT energies
164

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Element
Fe
Pd
Ru

Reference Structure
BCC
FCC
HCP

7.3. DFT RESULTS

Energy (Ry) (9x9x9)
-329.2618197
-512.0299524
-431.6742014

Energy (Ry) (Gamma)
-84290.00709480
-131079.09207327
-110507.45936537

Cohesive (eV)
-4.316
-3.91
-6.74

Table 7.13: Relaxed energies for 32 atoms, using 9x9x9 k-points, and 256 atoms, using the gamma point. These were
used with the known cohesive energy to compute the offset energy.

in the remainder of this work were recalculated using the relaxed DFT energy and the known cohesive energy.
This was to ensure the potentials were trained towards the known cohesive energies.

7.3.6

Compiling a DFT Reference Database

A database of configurations generated by DFT was compiled for Iron, Palladium, Ruthenium with alloys of
Iron-Palladium and Iron-Ruthenium. The potentials are derived for FCC Iron and so more weighting was given
to configurations that were also of this structure.
The QEEOS code was used to compute the bulk properties and in doing so it created PWscf input files and
processed the output files. These output files are saved but the program and are as valid to use in the reference
database as any. In total the database has over 600 configurations for Fe-Pd and almost 600 for Fe-Ru.
The distribution of atom separations was measured across the database and these are plotted in figure 7.6. The
full set is available to download from https://github.com/BenPalmer1983/fepd feru potential.
All the configurations in this work are FCC structure crystals. The QEEOS program (section 7.3.1 and ??)
was used to compute the relaxed lattice parameter and primitive cell basis vector.
This program also automated the computation of equation of state, bulk modulus and elastic constants. A
32 atom supercell was used for each pure element where the bulk properties were computed. Ideally a large
supercell or a larger number of k-points would have been used but throughout this work the number of processor
cores per node ranged from 20-72 and this along with time constraints limits complexity of the calculations.
The data output from the QEEOS code forms a part of the reference database that is discussed in chapter ??.
A number of configurations used to make up this database are given in appendix S.

7.3.7

Pure Element Defects

The potentials are created to apply to FCC Iron, Palladium, Ruthenium and alloys of Fe-Pd and Fe-Ru. The
configuration database will include several defects:
• octahedral interstitial
• tetrahedral interstitial
• 100, 110 and 111 interstitials
• crowdion
• a vacancy
The configurations for these defects were estimated using the perfect crystal positions of 2x2x2 supercells
containing 32 atoms. The defect or vacancy was applied, in some cases changing the total number of atoms,
and the defect position was estimated.

165

7.3. DFT RESULTS

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Fe DFT DB Neighbour Distances

Pd DFT DB Neighbour Distances

6

4.0
5

3.5
3.0

4

2.5

3

2.0
1.5

2

1.0

1

0.5
0.0

2

3

4

5

0

6

2

3

(a) Fe database

5

6

(b) Pd database

Ru DFT DB Neighbour Distances

8

4

5

7
4

6
5

3

4
2

3
2

1

1
0

2

3

4

5

0

6

(c) Ru database

3

4

5

6

(d) Fe-Pd database

4.0

3.5

3.0

2.5

2.0

1.5

1.0

0.5

0.0
2

3

4

5

6

(e) Fe-Ru database

Figure 7.6: Neighbouring atom separations and their frequency over 5 subsections of the DFT reference database

166

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.3. DFT RESULTS

A number of calculations, and the chance of a successful convergence in both the electronic state SCF calculation
and relaxation calculation, were very sensitive on the input parameters. Aluminium was not as sensitive and
was used to relax the starting configuration. This was then used as the starting point for either Fe, Pd or Ru.
Due to the periodic nature of these calculations, having only 32 atoms was not ideal as each defect cell would
be very close to another. Unfortunately, as stated a number of times, it was a constraint that was needed to be
able to complete the work in a reasonable amount of time.

7.3.8

Alloy Atom Positions for Pd and Ru

The stainless steel being studied is to be doped with 1% or less of a platinum group metal. Ideally a super
cell with at least 256 atoms (4x4x4 primitive FCC cells) would be used for all calculations, but due to the
complexity of the calculations the majority were 2x2x2 super cells containing just 32 atoms.

(a) Single atom, 256 atoms in total

(b) Multiple atoms, 256 atoms in total

Figure 7.7: Binary alloy configurations with less than 2% PGMs

Most of the configurations were prepared using the relaxed FCT structure computed for Fe. One or more iron
atoms were then replaced with either Pd or Ru. The majority of calculations were carried out using the 32
atom configurations. The larger 256 atom calculations were better suited to represent the low percentage of
PGM but were only computed using the gamma k-point (figure 7.7). This was another compromise in order to
complete the calculations in time.

7.3.9

Configurations with Randomised Positions

Many of the atom configurations generated up to this point are symmetric and, whilst they have a variety of
energies and stresses to use for fitting, the forces on the atoms are almost balanced and are small or none. A
large set of configurations with positions perturbed slightly from the exact lattice position are created.
Rather than use a linear random distribution a Gaussian distribution is used. The majority of the atoms are
closer to the exact crystal position but a minority are further and further away, as would be expected with this
type of distribution. The maximum amount of perturbation was selected randomly between a minimum and
maximum value. The effect on the calculation by making these perturbations was to increase the energy of the
system as the maximum perturbation amount was increased, as can be seen in figure 7.8.
As the amount at which the atoms are perturbed increases, the total force between the atoms also increases. If
the disturbance increased too much, it will likely be useless for our needs as it would be beyond the temperatures
relevant to this work, and it may also cause the SCF calculations to fail. When these calculations were processed
the maximum perturbation being too large was the primary factor that caused PWscf to fail.

167

7.3. DFT RESULTS

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Increase in energy
1,000K
2,000K
3,000K
Increase in force

Gaussian Heating
0.7

0.004

0.6
0.5

Total force (eV/angs)

Energy (eV)

0.003
0.4

0.002

0.3
0.2

0.001
0.1
0.0

0.000
0.00

0.01

0.02
0.03
0.04
Maximum perturbation (angs)

0.05

0.06

Figure 7.8: Effect of randomly perturbing atom locations

In the case of the alloy configurations, the randomised positions were loaded into the files. In all cases convergence failed. As perturbed atom positions had already been computed for a new set of input files were created
holding the Fe atoms in their perfect locations. The added and atoms were then perturbed slightly from their
perfect position within the lattice in order to compute forces and energies at slightly different positions. Perhaps
with more time and refined settings alloys with non-perfect atom positions could be calculated, but this would
need to be investigated.

7.3.10

Surface Energy Calculations

One key aspect of this work is to determine whether or not either Pd or Ru are depleted from the surface at grain
boundaries under irradiation. With this in mind, the surface energies for the pure elements were calculated by
creating a slab of atoms with an open surface on each side.

(c) Single atom on the surface, 129 atoms
(a) Single atom in the surface layer, 128
(b) Single atom in bulk of slab, single atom in total
atoms in total
in surface layer, 128 atoms in total

Figure 7.9: A sample of configurations used for binary alloy DFT calculations for Fe-Pd and Fe-Ru.

A set of 32 atom configurations were used where the separation between the two facing surfaces is varied.
Several more 128 atom configurations were also prepared for the three pure elements. To investigate the effect

168

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.4. ISSUES TO OVERCOME

of a small addition of either Ru or Pd in the alloy a slab of Fe was prepared with Ru or Pd either within the
slab, at the surface or on the surface (figure 7.9). These examples were then added into the reference database
used to fit the binary potentials.

7.3.11

Defects in Fe-Pd and Fe-Ru Alloys

Attempts were made to compute simple defects in the alloy but the majority failed to converge, either in the
electronic structure SCF iteration or a failure to relax geometrically that then lead to a SCF failure. Rather
than focus too much on this, more time was spent investigating Ru and Pd in a slab of Fe where the calculations
were more successful.

7.4

DFT Errors, Convergence Failures and Repeat Calculations

A number of issues were encountered throughout this work when putting DFT into practice. These are explored
in this section in order to explain why certain calculations weren’t performed. They are also listed to serve as a
reminder of what to try and avoid in future if the potentials are developed further and more DFT calculations
are required.

7.4.1

Insufficient Memory

The DFT calculations are performed on a supercomputer with many processors and many cores per processor.
The program uses two implementations of parallelization.
• OpenMP - many threads have access to the same shared memory
• OpenMPI/MPICH - many processes, each with it’s own memory
Whilst some favourable results have been shown using a hybrid of OpenMP and OpenMPI, it was more straightforward to use in OpenMPI mode only in this work. Unfortunately, the amount of memory per process overwhelmed the computing nodes for certain calculations as each process requires an a copy of the data held in
memory. The job script was modified to reserve entire nodes and all the memory on each node, but to only
use the cores on one of the two processors to halve the processes per node, but double the memory per process.
It was quicker to do this than wait in the high memory queue on BlueBEAR, where the memory per process
would be perhaps double than that required.

7.4.2

Scratch Restrictions

When the calculations first started, the scratch space was located on a large shared space on the BlueBEAR
computer. Over time the drive space quota was restricted and the scratch was relocated to individual nodes.
There were few issues with less complex calculations as the SCF temporary data was several GB in size with
the scratch space on each node being approximately 120GB. Once a batch of collinear iron calculations had
been submitted to the job queue, they would quickly fill the scratch drive and the job would terminate after
just a few calculations, as the node had run out of scratch drive space.
Listing 7.1: Sbatch file
1
2
3
4

#!/bin/bash
#
#SBATCH --job-name=feforfit
#SBATCH --output=jobout.txt

169

7.4. ISSUES TO OVERCOME

5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34

CHAPTER 7. POTENTIALS FOR FE, RU, PD

#SBATCH --account=readmsd02
#
#SBATCH --ntasks 40
#SBATCH --nodes 1
#SBATCH --time 1800:00
#SBATCH --mem 180GB
#
#SBATCH --get-user-env
#SBATCH --export=NONE
#
unset SLURM_EXPORT_ENV
module
module
module
module
module

purge; module load bluebear
load bear-apps/2018a
load iomkl/2018a
load Python/3.6.3-iomkl-2018a
load matplotlib/2.1.1-iomkl-2018a-Python-3.6.3

# Change to $PBS_O_WORKDIR
cd "$PBS_O_WORKDIR"
# Set the number of threads to 1
export OMP_NUM_THREADS=1
export PROC_COUNT=40
export PWSCF_SCRATCH=/scratch/bxp912
export PWSCF_PP=/rds/homes/b/bxp912/pp
export PWSCF_CACHE=/rds/homes/b/bxp912/pwscf_cache
export PWSCF_BIN=/rds/homes/b/bxp912/apps/qe-6.3/bin/pw.x
export PWSCF_SCRIPT=/rds/homes/b/bxp912/apps/qe-6.3/bin/pw.sh
python /rds/homes/b/bxp912/apps/python/qeforfit.py input.in > results.txt

Listing 7.2: Wrapper file
1
2
3

#!/bin/bash
rm -R $PWSCF_SCRATCH/*
mpirun -n $1 $PWSCF_BIN -in $2 > $3

As the convergence and equation of state/elastic constant python programs automatically created and submitted
the PWscf jobs, they would need to be continually restarted after clearing out the scratch. To work around this
a batch script (listing 7.1) and wrapper script (listing 7.2) for pw.sh were written. The batch script sets the
environment variables required for the sbatch job scheduling program and the wrapper script, and the wrapper
script then clears the scratch directory before running PWscf.

7.4.3

Caching Repeat Calculations

Several of the programs required many hundreds of DFT calculations. At first, if an error was encountered and
the program had to start from scratch, computation time would be wasted. To solve this, a directory was set to
cache input and output files for PWscf. A hash would be generated from the input file and this would be used
as the cache file name. If a calculation was successful, it would save the input and output file. In future, if the
same calculation was submitted again, the cached file would be returned. The cache could be copied between
BlueBEAR and other computers to save on repeat submission to the BlueBEAR job scheduler.

7.4.4

Adjustment of DFT Parameters

Throughout the DFT segment of this work, there were a number of issues that either resulted in the calculations
failing or completing and not converging. There were a number of causes for this and several solutions were

170

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.4. ISSUES TO OVERCOME

used throughout the process to converge the SCF calculation.
Where the ecutwfc and ecutrho parameters are not converged there is a danger that values too low therefore
containing too few plane waves in the basis set. This might cause problems with the SCF causing it not to
converge. The same can be said about a failure to pick appropriate k-points and smearing.
There are a selection of mixing modes available in PWscf, giving a choice of Thomas-Fermi screening for
homogeneous systems, local density dependent Thomas Fermi (local-TF) screening for inhomogeneous screening
and Broyden mixing as the default.
Total Energy

Total Energy
10570

Estimated accuracy (Ry)

10590
Total Energy (Ry)

Estimated accuracy (Ry)

100

10600

10−2

10610
10−4

10620
10630

10−6

10580

101

10580

10590
10−1

Total Energy (Ry)

102

10600

10−3

10610
10620

10−5

10630

10−7

10640
0

20

40

Iteration

60

80

10640

100

0

(a) Plain mixing failing to converge

5

10

15

20
25
Iteration

30

35

40

(b) Converging using local-TF mixing

Figure 7.10: Fe-Ru calculations failed to converge in 100 iterations when plain mixing was used, but achieved convergence
in under 40 iterations with local-TF convergence

For calculations with defects the local-TF setting was used and for equation of state and elastic constant
calculations, where the distribution of atoms is more homogeneous, plain Broyden mixing was used. In most
circumstances the mixing factor (mixing beta) was reduced to 0.1. This wasn’t always the case, and for certain
defect calculations the default value of 0.3 proved to be the more efficient choice.
One other important parameter, that primarily affects geometry and position relaxation calculations (VCRELAX), was the convergence threshold for the SCF calculations (conv thr). The default value is 1.0 × 10−6 Ry
and this was sufficient for SCF calculations and most VC-RELAX calculations. Several relaxation calculations
failed to converge and, at the suggestion of authors of Quantum Espresso, the threshold was reduced to 1.0×10−7
Ry. This would lead to a longer time to compute the first geometry optimisation step. The result from the
first SCF cycle affects the convergence of subsequent steps and with the better starting point the time taken to
complete the geometry relaxation was reduced and the chance of success was increased.

7.4.5

Not Straying Too Far From Reality

It is important to provide the calculation with reasonable and realistic configurations and settings. Where
a pure element such as Aluminium, Iron or Platinum was being investigated, the known experimental lattice
parameters were used as a starting point (table 7.1 and table 7.2). If the parameters were too far from these
values, for example inputting a lattice parameter of either 2 or 8 angs for Aluminium rather than 4, as a
starting approximation, the DFT calculation might struggle to relax the structure, or to even successfully run
or converge a calculation.
The FCC Iron structure lattice parameter was estimated from the density of FCC steel, and the lattice parameter
for alloys could similarly be estimated within a reasonable margin to use as a start point for the calculation.

171

7.4. ISSUES TO OVERCOME

7.4.6

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Trial Parameters for Iron with and Octahedral Defect

Calculations where there is a high level of symmetry finished relatively quickly and without much trouble.
Where the position of each atom was perturbed slightly or where there was a defect the SCF calculations would
take more iterations to converge and would often fail completely. Where the geometry and atom position was
also being optimised through repeated sets of SCF iterations the calculation would begin to converge but would
ultimately fail through SCF non convergence.
Nbnd
317
320
317
340
320
317
317
317
320
320
320
320

Ntype
5
3
3
3
3
3
5
3
3
3
3
3

K
9x9x9
9x9x9
9x9x9
9x9x9
9x9x9
9x9x9
9x9x9
9x9x9
9x9x9
11x11x11
13x13x13
9x9x9

Degauss
0.04
0.04
0.04
0.04
0.04
0.04
0.04
0.04
0.04
0.04
0.04
0.07

Scfconv
1.0 × 10−6
1.0 × 10−6
1.0 × 10−7
1.0 × 10−6
1.0 × 10−6
1.0 × 10−6
1.0 × 10−6
1.0 × 10−6
1.0 × 10−6
1.0 × 10−6
1.0 × 10−6
1.0 × 10−6

Beta
0.1
0.05
0.1
0.8
0.1
0.8
0.3
0.3
0.3
0.3
0.3
0.3

Ndim
10
10
10
8
10
8
8
8
10
10
10
10

Mode
Plain
Local-TF
Local-TF
Local-TF
Local-TF
Local-TF
Local-TF
Local-TF
Local-TF
Local-TF
Local-TF
Local-TF

Iterations
75
46
42
38
36
33
32
32
29
29
29
25

Table 7.14: Improving convergence SCF calculations of defects in Iron

Iron with an octahedral defect was used to help fine tune parameters. Initially a set of SCF calculations were
performed with different parameters, and finally these were used to relax the cell geometry and atom positions
for this defect.
Changing the number of k-points did not have an impact on the number of iterations required to converge, but
changing the smearing value did. An increase in smearing would be detrimental to the accuracy of convergence
to the correct value and by doing this it would cause a difference in energy between past calculations with a
smearing of 0.04Ry and and those with 0.07Ry.
The adjustment that had the largest impact on reducing the number of iterations was the change from plain
mixing to Local-TF. Following this, using a mixing beta of 0.3 where more weight is given to the previous state,
also helped to reduce the number of iterations.
The attempts to optimise the values was not exhaustive as there were constrictions on time. However, despite
making these improvements and reducing the convergence threshold to 1.0×10−8 , the cell geometry and position
relaxation of the starting configuration for an octahedral defect (by adding an atom at the octahedral location)
also fails to relax by SCF non-convergence within an iteration of the relaxation algorithm.
The optimization of the geometry and atom positions was likely due to it being a complex system to model with
the initial configuration too far from the relaxed one. To work around this the octahedral defect for a more
simple metal, Aluminium, was relaxed to give a better starting point for the Iron calculation. The increase in
cell size was also applied. With a better initial configuration and the adjusted parameters, the Iron octahedral
calculation successfully completed.
This process was repeated for tetrahedral, 100, 110, 111 and crowdion defects.

172

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.5

7.5. EAMPA

EAMPA: Potential Analysis and Fitting Code

7.5.1

Introduction

A python-fortran based computer code was developed to analyse interatomic potentials and fit their parameters
to bulk properties and DFT calculated forces and energies. It was designed to take advantage of both Fortran
and Python. Fortran is used to compute the neighbour lists, energies, stresses and forces, and Python is used to
read and write data, produce plots and control the potential fitting. This allowed the use of custom optimization
subroutines as well as the use of those included in the SciPy module. Highlights from the code are discussed in
this section and the appendix of this work (appendix Q).
The latest version of the code has the following features:
• calculate energy, forces and stress of an ensemble of atoms
• calculate bulk properties of a potential for pure BCC of FCC structures
• relaxation of the lattice parameter
• relaxation of the cell geometry along with the lattice parameter
• fitting on analytic potential parameters using simulated annealing, genetic algorithm, Nealder-Meade,
Levenberg-Marquardt, BFGS
• effective gauge transforms of pure element potentials
• creation of potential files in other formats (tabulated, LAMMPS etc)
The source code and instructions on how to use the program are available to download from GitHub.
https://github.com/BenPalmer1983/eampa

7.5.2

Potentials

The code has been designed specifically for many body potentials. These include Finnis-Sinclair, embedded-atom
method, two band embedded-atom method but not the modified embedded-atom method. It may be reduced
to pair potentials only by setting the density function and embedding functional to “zero” (see appendix R for
function details).
The function types available for pair, density and embedding are listed in the appendix (R). More function
types may be easily added by editing the module in the Fortran code that defines each function. Most of the
functions are basic mathematical functions that use built in operators and functions. Several are more complex,
such as the cubic spline, quintic spline and knot-to-knot splines.
Cubic and Quintic Splines
These splines have been discussed in section 5.3.4. Several papers have previously used summed polynomial
splines that employ the Heaviside-step function to cut off these functions at the desired points. The cubic term,
(𝑟 − 𝑟𝑖 )3 , ensures the function and it’s first and second derivatives equal zero and are continuous at the cutoff

points.

173

7.5. EAMPA

CHAPTER 7. POTENTIALS FOR FE, RU, PD

𝑉 (𝑟) =

𝑁
∑︁
𝑖

𝑎𝑖 (𝑟 − 𝑟𝑖 )3 𝐻(𝑟𝑖 − 𝑟)

𝐻(𝑥) =

{︃

where
0

𝑥<0

1

𝑥 >= 0

(7.1)

This was implemented in Fortran so that an efficient vectorised version could be used by Python. The Fortran
code for the spline function is in the appendix ??.
Knot to Knot Splines
A Fortran module was created for the knot-to-knot spline function. It takes a set of knots and splines between
the knots pair at a time using the x, y, y’ values to construct a set of linear equations to solve.

𝑐0 + 𝑐1 𝑥𝐴 + 𝑐2 𝑥𝐴 2 + 𝑐3 𝑥𝐴 3 = 𝑓 (𝑥𝐴 )
0 + 𝑐1 + 2𝑐2 𝑥𝐴 + 3𝑐3 𝑥𝐴 2 = 𝑓 ′ (𝑥𝐴 )
𝑐0 + 𝑐1 𝑥𝐵 + 𝑐2 𝑥𝐵 2 + 𝑐3 𝑥𝐵 3 = 𝑓 (𝑥𝐵 )

(7.2)

0 + 𝑐1 + 2𝑐2 𝑥𝐵 + 3𝑐3 𝑥𝐵 2 = 𝑓 ′ (𝑥𝐵 )

⎡
1
⎢
⎢0
⎢
⎢1
⎣
0

𝑥𝐴

𝑥𝐴 2

1

2𝑥𝐴

𝑥𝐵

𝑥𝐵 2

1

2𝑥𝐵

⎤⎡ ⎤ ⎡
⎤
𝑐0
𝑓 (𝑥𝐴 )
⎥⎢ ⎥ ⎢ ′
⎥
⎢ ⎥ ⎢
⎥
3𝑥𝐴 2 ⎥
⎥ ⎢𝑐1 ⎥ = ⎢𝑓 (𝑥𝐴 )⎥
⎢
3 ⎥⎢ ⎥
𝑥𝐵 ⎦ ⎣𝑐2 ⎦ ⎣ 𝑓 (𝑥𝐵 ) ⎥
⎦
3𝑥𝐵 2
𝑐3
𝑓 ′ (𝑥𝐵 )
𝑥𝐴 3

(7.3)

A subroutine was created to calculate the coefficients for the 3rd order or 5th order polynomial to spline the
two knots. This subroutine and the remainder of the module are available to view and download on the GitHub
repository for this project. The Fortran code for a cubic and cubic with ZBL inner core knot-to-knot spline are
included in the appendix (section ?? and section ??).

7.5.3

Calculations

The calculations involved in this code centre around the calculation of energy of configurations as well as the
forces and stresses when necessary. All configurations are held within the Python program, but the neighbour
list and energy (as well as stress and force) calculations are carried out in an imported Fortran module.
Energy, Force and Stress Calculations
A potential and configuration of atoms may be loaded into the program in a number of ways. Python passes
this data to the atom Fortran module and then computes the neighbour list before it is passed back to the
Python program where it is stored for later use.
There are a number of functions that allow the potential as well as atom configurations (and neighbour lists)
to be updated. These are handled in Python, but the calculations are carried out in the Fortran atom module,

174

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.5. EAMPA

that then passes the results back to Python. One example of such a function is where the position of the atoms
is changed and the neighbour list is updated without a full recalculation.
The energy, forces and stresses may be computed for a range of configurations or a single configuration. This
process starts in Python, but the calculations are once again completed using the Fortran module. The method
used is discussed in section 5.5.3 and the subroutine used is included in the appendix (section Q.1).
Geometry and Coordinate Optimisation
Once a configuration is loaded into the program, it can be relaxed using a variety of techniques. The lattice
parameter may be relaxed using the built in BFGS or CG minimizers and the same functions may be used
to relax the simulation cell. Where the coordinates of the atoms are relaxed, a damped molecular dynamics
subroutine is called from the Fortran module that computes the forces on the atoms and moves them accordingly.
This has been more successful than using built in minimizers, where no gradient data is passed, but a more
promising approach might be to include the VA08 subroutine from the Harwell archives[196]. This is the same
subroutine used in the Bonny potential fitting code[118].
Bulk Property Calculations
The bulk property calculations rely on the calculation of the energy of a number of configurations where specific
strains have been applied to the perfect relaxed crystal. The methods used are discussed in chapter 5 and
the subroutine that creates the configurations, with which the module calculates the energies used to plot the
equation of state and other distortions, is included in appendix Q.
The Python code creates the configurations with the strains applied and the Fortran subroutines are called
to compute the energies. Once the values are collected, the bulk properties are calculated in Python and any
required plots are created.
As part of the calculation process the optimum (relaxed) lattice parameter is first calculated for the potential.
Either a BFGS or CG minimizer is used. The basis vectors are fixed by the user, although there could be the
option in the future to allow the basis vectors to also be adjusted. In this work the basis vectors of FCC Fe
were fixed as the tetragonal determined by DFT in the input file for EAMPA.
During the fitting process, each time the potential is varied, the lattice parameter and bulk properties need to be
recalculated. To save time the neighbour list is only calculated once, and the atom separations are recalculated
based on the initial list, the recalculated lattice parameter and basis vectors.
RSS - How Well The Potential Fits Experimental & DFT Data
The fitting process measures how well a potential fits the data when the initial parameters are given and every
time a new set of parameters are proposed. The user assigns weights to configurations and the parameters the
potential is being fit to. The Python code calculates the residual squared sum (RSS) of the differences between
calculated energies, forces, stress, lattice parameter, cohesive energy, bulk modulus and elastic constants and
the known values. The sum of these values measures how well the potential fits.
Overview of the Potential Fitting Process
The input files are read in by Python that then iterates over the fitting process while changing the potential.
The Fortran modules calculate the energy, force and stress of the loaded configurations as well as the bulk
property calculations for pure crystals of the atomic species and structures specified by the user. To save on

175

7.5. EAMPA

CHAPTER 7. POTENTIALS FOR FE, RU, PD

processing time, the neighbour lists for all configurations, including those used to calculate the equation of state
and elastic constants, are only calculated once.
The step by step flow of the program while fitting parameters of a potential is as follows:
1. Read input files
2. Load Fortran Modules
3. Load potentials into Python
4. Load configurations into Python
5. Create neighbour list configurations in Fortran and save to Python
6. Begin fitting loop in Python
7. Loop starts - loop through potential function parameters
(a) Update potential in Python
(b) Create tabulated version of functions
(c) Run calculations in Fortran
(d) Loop starts - loop through configurations
i. Calculate energy, force, stress using pre-calculated neighbour lists
(e) End loop
(f) Save energies, forces and stresses back to Python
(g) Compute bulk properties from the energies in Python
(h) Calculate the RSS between the potential computed and know values
(i) Save parameters if best
(j) Make next set of parameters
8. End loop
9. Output results
Once the fitting process has completed, the best set of parameters are stored for the user along with a plot of
the potential functions, equation of state and elastic constant energy-strain distortion plots (where these are
used in the fitting process).
Simulated Annealing
The simulated annealing algorithm is implemented in the code and is an option available to the user for fitting.
The algorithm looks for better solutions and replaces the current value with better values. It also accepts worse
solutions with a probability that decreases with “temperature”. Similar to the way atoms find optimal positions
by annealing and cooling, the algorithm starts with a high temperature and it reduces this temperature over
time. It is used to search for the global optimum.
The algorithm is discussed in greater detail in appendix P.1.5. The implementation used in the EAMPA code
is included in appendix Q.5.

176

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.5. EAMPA

Genetic Algorithm
The global optimum may be searched for using a genetic algorithm. The user chooses the parameters for the
algorithm and it attempts to search for the optimum parameters to fit the potential functions to the data.
The user settings include the following:
• population size
• “fresh” (new randomly generated) parameters
• number of generations
• how often the best results are enhanced with a chosen local optimization algorithm
The function that breeds the parameters randomly combines the parameters from two parent solutions to create
two children parameter sets. The parents are either both from the existing pool of solutions, or a parent from
the existing pool with a parent from a fresh set, and the fresh set of parameters changes with each generation
(fig. 7.11).

Figure 7.11: Parameter Breed Event

There is a chance that the child solutions will mutate slightly from the two parent combination, and this chance
is set by the user.
During the breed event, the program will check whether or not the two children already exist within the solution
pool. If they are allowed to also enter the pool, the solutions may quickly be filled with clones during the breeding
process. The breed event automatically forces any clones to be varied so they become a different and distinct
solution.
Every now and then an extinction event will occur that kills off any poor solutions and replaces them with
variations of the better solutions. The user controls the frequency of the extinction event and the probability
that a solution will be removed.
Top solutions are enhanced, at a frequency picked by the user, using a local optimisation algorithm: line-search
and gradient descent. It does require many calculations and adds a substantial amount of time to the procedure,
but it uses the gradient of solutions to find more optimal solutions more efficiently that randomly generated or
bred solutions. The algorithm used is given in appendix Q.5 and is also discussed in appendix P.1.5.
Newton Gauss Optimisation
The Newton Gauss optimisation estimates the second order derivatives matrix, the Hessian, by multiplying the
Jacobian and its transpose. It is not yet implemented in the code, but may be in the future. The algorithm is
used to find a local optimum, but it can be unstable or return errors.
177

7.5. EAMPA

CHAPTER 7. POTENTIALS FOR FE, RU, PD

𝐽⃗𝑇 𝐽⃗𝑝⃗ = 𝐽⃗𝑇 ⃗𝑟

(7.4)

⃗𝑟 = ⃗𝑦 − 𝑓 (⃗𝑥, 𝑝⃗)
Levenberg-Marquardt Optimisation

The Levenberg-Marquardt algorithm is similar to the Newton-Gauss method, but the estimate for the Hessian
does not need to be calculated for each loop of the algorithm. The parameter, 𝜆, is changed and the Hessian is
updated periodically. This is not yet implemented in the code, but may be added in the future.
(︁

(︁
)︁)︁
(︁
)︁
⃗ 𝐽⃗ + 𝜆𝑑𝑖𝑎𝑔 𝐽⃗𝑇 𝑊
⃗ 𝐽⃗ 𝑝⃗ = 𝐽⃗𝑇 𝑊
⃗ ⃗𝑟
𝐽⃗𝑇 𝑊

(7.5)

⃗𝑟 = ⃗𝑦 − 𝑓 (⃗𝑥, 𝑝⃗)

Python SciPy Optimization Functions
Additional optimisation functions have been used by importing the SciPy module into the program, and these
may be used in conjunction with those listed above. Several have been used including the bin-hopping, NealderMeade and BFGS. The bin-hopping was unreliable and crashed on a number of occasions, and preference in this
work was given to simulated annealing and genetic algorithms for global parameter searches. The Nealder-Meade
and BFGS were both used following the run of global optimisation and increased the efficiency of improving
the parameters.
Minimising Runtime
When fitting a potential, for each trial set of functions, the program must calculate the energy, forces and stress
for each of the configurations and tens or hundreds of energy only calculations for the equation of state and
elastic constant calculations. Python is a well used programming language in many areas of Science and it has
the benefits of many modern languages. For certain specific tasks, it is slow in comparison to Fortran.
The energy, stress and force calculations were programmed in Fortran and use OpenMP to improve the calculation speed. This could be improved further by processing batches of configurations in parallel, but this isn’t
currently implemented. For now, a seed is picked so multiple instances can be run in parallel to give multiple
optimised potentials to choose from.
The code optimises analytic potentials, but a number of the functions available are complicated and require the
evaluation of many functions in order to give an output. To speed up the calculation, the user has the option
to convert the analytic potentials to tabulated versions and these are interpolated using Lagrange polynomials
(eq. 7.6 7.8).

𝐷 = {(𝑥0 , 𝑦0 ) (𝑥1 , 𝑦1 ) (𝑥2 , 𝑦2 ) · · · (𝑥𝑛 , 𝑦𝑛 )}

𝑝𝑛 (𝑥) =

𝑛
∑︁

𝑦𝑖 𝐿(𝑖, 𝑥)where 𝑙(𝑖, 𝑥) =

𝑖=0

𝑛
∏︁

𝑗=0,𝑗!=𝑖

178

(𝑥 − 𝑥𝑗 )

(7.6)

(7.7)

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.6. APPLICATION OF THE EAMPA CODE

There are typically hundreds or thousands of data points, so to interpolate, the closest few points are used. The
gradient of the potential functions are also computed using Lagrange polynomials (eq. 7.8).

𝑞𝑛 (𝑥) =
⎛

where 𝑔 (𝑖, 𝑥) = ⎝

𝑗=𝑛
∏︁

𝑗=0,𝑗̸=𝑖

⎞

⎛

1 ⎠ ⎝
×
𝑥𝑖 − 𝑥𝑗

𝑖=𝑛
∑︁

𝑦𝑖 𝑔 (𝑖, 𝑥)

𝑖=0

𝑘=𝑛
∑︁

𝑗=𝑛
∏︁

𝑘=0,𝑘̸=𝑖 𝑗=0,𝑗̸=𝑘,𝑗̸=𝑖

⎞

(7.8)

(𝑥 − 𝑥𝑗 )⎠

A pseudocode for both interpolation of the function points and derivatives are available in the appendix (section
Q.7 and Q.8).
Effective Gauge Transforms
In order to create a potential for an alloy an effective gauge transform, as described in section 5.4.4, was applied
to each pure potential. A mode added to the EAMPA program reads in the analytic potential and creates a
numeric potential that has had the transform applied. This allows the pure potentials to be used together,
although a cross pair potential is still needed.
LAMMPS Format
LAMMPS is a popular molecular dynamics code and the EAMPA code outputs potentials in its own format
as well as the LAMMPS format. The structure of the file depends on the number of elements and there are a
number of caveats to note including the pair potentials being stored in the file as the value multiplied by the
distance, in angstrom[197].

7.5.4

Verifying Energy and Force Calculations with LAMMPS

Many of the calculations depend on the energies computed as well as accurate computation of the forces.
LAMMPS is a widely used molecular dynamics code and many potentials already exists in the format required for
LAMMPS. The energies and forces computed by the EAMPA code were compared for a number of configurations
and potentials against the energies and forces computed by LAMMPS to validate the code developed here. The
results between the two codes agreed.

7.6
7.6.1

Application of the EAMPA Code
Investigating the Transferability of Existing Potentials

There are currently a number of EAM Iron potentials, as well as a MEAM potential for Fe-Pd. Several pure
element potentials also exist for Ruthenium and Palladium. Whilst it would be convenient to have a one size
fits all potential, this is not the case. Taking the Ruthenium potential as an example, in work that required the
reproduction of stacking fault and surface energy of the element, the existing potentials were inadequate and a
new potential was developed[198].
Several potentials were selected to test transferability. First, the FCC Sheng potential for Aluminium was
applied to both FCC and BCC structures in the EAMPA code. The properties of FCC Aluminium are known,
and those for BCC Aluminium were calculated using DFT. This investigation shows that some properties, such

179

7.6. APPLICATION OF THE EAMPA CODE

CHAPTER 7. POTENTIALS FOR FE, RU, PD

as the lattice constant, does transfer quite well to the new structure, but the bulk modulus and 𝐶11 elastic
constant are both poorly reproduced (table 7.15).
Property
a0
e0
b0
𝐶11
𝐶12
𝐶44

Al FCC Exp.
4.05
-3.36
76
114
62
32

Al FCC Sheng
4.02
-3.36
86
124 (125)
67 (66)
29 (32)

Al BCC DFT
3.23
-3.26
69
47 (47)
81 (24)
40 (12)

Al BCC Sheng
3.18
-3.27
50
11 (5)
70 (63)
29 (42)

Table 7.15: Applying the Sheng Al potential, developed for FCC crystals, to the BCC structure. Elastic constants are
calculated using the method by Mehl et al with values from the method by Ravindran et al in brackets.

The Mendelev 2003 potential was developed to fit the properties of BCC Iron, but also to reproduce the
transition from BCC to FCC at high temperatures. However, when using this potential for low temperature
FCC Iron, it does not reproduce the properties predicted by DFT. All 9 orthorhombic elastic constants have
been omitted in table 7.16, but there is a significant difference for the three elastic constants given as well as
the bulk modulus.
Property
a0
e0
b0
𝐶11
𝐶12
𝐶44

Fe BCC Exp.
2.86
-4.32
170
243
145
116

Fe BCC Mendelev
2.86
-4.13
176
255 (260)
137 (143)
114 (111)

Fe FCC DFT
3.42
-4.26
226
364
142
186

Fe FCC Mendelev
3.59
-4.01
98
6 (79)
145 (69)
86 (48)

Table 7.16: Applying the Mendelev 2003 potential, developed for BCC crystals, to the FCC structure. Elastic constants
are calculated using the method by Mehl et al with values from the method by Ravindran et al in brackets.

Finally the Ackland 1997 potential for Iron was tested. This older potential gives a better value for the cohesive
energy when transferred to the FCC structure, but other properties such as the relaxed lattice constant are
quite different (table 7.17).
Property
a0
e0
b0
𝐶11
𝐶12
𝐶44

Fe BCC Exp.
2.86
-4.32
170
243
145
116

Fe BCC Mendelev
2.87
-4.32
200
265 (248)
168 (151)
125 (128)

Fe FCC DFT
3.42
-4.26
226
364
142
186

Fe FCC Mendelev
3.62
-4.26
141
117 (140)
153 (117)
164 (94)

Table 7.17: Applying the Ackland 1997 potential, developed for BCC crystals, to the FCC structure. Elastic constants
are calculated using the method by Mehl et al with values from the method by Ravindran et al in brackets.

This investigation into existing potentials shows that whilst some of the properties are replicated, many do not
match the DFT computed values. This supports the derivation of new potentials to be fit that replicate the
DFT values and take into account the characteristics of a number of provided configurations. Additional plots
are included in the appendix that show the expected equations of state compared to those generated using the
above potentials (section O).

180

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.6.2

7.6. APPLICATION OF THE EAMPA CODE

Fitting Potentials with EAMPA

The fitting process was computationally intensive and utilised nodes on the University of Birmingham BlueBEAR computer. At the time of writing, the code was able to fit energy, forces and bulk properties. Whether
the method with which the stress is calculated in PWscf was the same as that used in the EAMPA code was
unclear. As a result it is suggested to set the weighting of stress to zero.
Choice of Function and Functional
A number of functions and functionals have been used previously and these are discussed in detail in chapter
5. Several were used to attempt to fit the potentials, but eventually the cubic splines and tight binding type
functional, as used by Mendelev, Ackland, Bonny et al, were selected.
Initially, the computer program DIRAC was used to generate the density function, as it computes the radial
electron density distribution, as seen in figure 7.12 and figure 7.12. Unfortunately, as may be expected, there
were a number of issues in using the density distribution of a single atom. The atomic separation for both
Fe and Pd, for a relaxed crystal, begins at approximately 2-2.5 angstrom, but most of the electrons, from all
shells, are distributed much closer. The plot does not take into consideration the valence electrons shared in
the crystal, bonding the metal atoms together.
From the point of view of the potential, the pair potential will dominate at small separations due to the ZBL
function. The density function will be important at separations of 2 angstrom up to the cutoff radius (5-6
angstrom). For this reason, in addition to moving away from attempting to represent the underlying physics,
the idea to use the DIRAC computed densities was abandoned in favour of a cubic spline.
Iron - Radial Electron Density

Palladium - Radial Electron Density

35
70
30
60

50

20

Density

Density

25

15

40

30

10

20

5

10

0

0
0

1

2

3

Radius/Angs

4

5

6

0

1

2

3

Radius/Angs

4

5

6

Figure 7.12: DIRAC calculated radial electron density Figure 7.13: DIRAC calculated radial electron density
for Iron
for Palladium
One interesting feature that Bonny used in his code was to add a hard core spline to the pair potential with a
positive coefficient. This was to ensure that at small separations, say below 1.5-1.8 angstrom, the atoms would
repel. The cubic spline used in this work for the density also has a parameter as a positive coefficient in order
to stop negative densities for small separations. This is dependent on the number of cubic splines used, and is
a feature that can be turned off in the EAMPA code.
A cubic spline was also used for the pair potential, and as with Bonny’s code, this had a hard core potential but
in addition to this a ZBL core was added to the entire potential to ensure the exponential increase in energy
as modelled with the ZBL function. This was to ensure the potential would both model the material when out
of a radiation field, where the atoms are several angstrom apart, but also able to capture a damage cascade
where the separation drops and the ZBL becomes the dominant feature, over both the pair cubic spline and the
embedding functional.

181

7.6. APPLICATION OF THE EAMPA CODE

CHAPTER 7. POTENTIALS FOR FE, RU, PD

There was a choice of several embedding functionals but one based on the Finnis-Sinclair and EAM was used.
It consisted of the square root term but also a zeroth power and square term for greater flexibility. The addition
of a fourth power term had been trailed, but occasionally when fitting the parameters the coefficient of the
fourth power would become negative leading to a negative energy at high electron densities.
Searching Parameter Space
Improving the potential was an iterative process that required multiple runs of EAMPA feeding the last potential
as a starting point for the next potential. In the first instance, the exact bulk property fitting code of Bonny
was used, but it did not always find the parameters that reproduced the data points it was given. This was
perhaps due to a lack of data and knowledge on how to use the code effectively, but it did give a starting point
with a modest number of cubic splines for the density and pair functions.
These initial set of parameters were then used with EAMPA. The first task with this code was to find parameters
that replicated the energies, forces and bulk properties for each of the pure elements.
The type of search could be adjusted for each fitting job, but the typical process was as follows. A short random
search through parameter space followed by a small simulated annealing search with a wide search area. This
was then followed by a genetic algorithm search with quite a wide search area. Next a second genetic algorithm
search over a smaller range of parameters but with more iterations and a larger population, and this step used
most of the computation time. Finally a short simulated annealing and local BFGS minimizer were used before
outputting optimised parameters. A sample input is given in listing 7.3, but the user is free to add fewer or
more steps and search types.
Listing 7.3: Parameter search settings when fitting in EAMPA
1
2
3
4
5
6

#FIT
#FIT
#FIT
#FIT
#FIT
#FIT

type=RAND niter=1000
type=SA niter=1000 titer=10 tstart=100.0 tend=0.001 pfact=0.5 pvar=10.0 vartype=add gaussian=True
type=GA niter=200 popsize=500 fresh=0.2 search=w
type=GA niter=5000 popsize=2000 fresh=0.2 search=n
type=SA niter=1000 titer=15 tstart=1.0 tend=0.001 pfact=0.5 pvar=0.01 vartype=add gaussian=True
type=BFGS

The code has an option to set the random seed such that every job with that seed and settings will return the
same output. This allowed ten or more jobs to be run in parallel, with 4 cores per job, and a different seed for
each job. Typical run times were 3-5 days per iteration and several iterations required.
At the start of the fitting process all available configurations were used, but it turned out to be difficult for the
code to satisfy all the constraints given the simplicity of the EAM potentials. Towards the end of the process
many of the configurations were removed with bulk and surface/slab configurations being left. This was in order
to train the potential specifically to these configurations in favour of the entire set.
Once the pure potentials for Fe, Pd and Ru were determined, they each underwent an effective gauge transform,
with the transform being that used by Bonny et al[118][126]. Due to this transform, they were converted from
analytic potentials to numeric.
The fixed numeric functions were then used in the binary alloy fitting where the only parameters adjusted are
those for the cross pair potential. The searching method was similar to that used for the pure elements, but the
configurations were changed to those containing both species of atom. The pure element configurations were
removed as these potential functions were now fixed. The bulk property fitting was also turned off as this fitting
was only applicable to the pure elements and had no affect on the cross species potential.

182

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.6.3

7.6. APPLICATION OF THE EAMPA CODE

Iron-Palladium and Iron-Ruthenium Potentials

Reference Database
The database of reference configurations was used to derive this potential. It was designed for FCC Fe rather
than BCC Fe, and this is one point that distinguishes this potential from those that already exist. As discussed
in section 7.6.1 a potential developed for one application isn’t necessarily transferable to another.
There were a number of options available when choosing certain parameters, such as using DFT to compute
cohesive energies based on relaxed and isolated configurations, or to extrapolate based on known energies. The
choices made are listed below and these apply to both the Fe-Pd and Fe-Ru potential.
• all cohesive energies were computed based on known experimental values and the DFT computed relaxed
energy of those structures
• all bulk property values are those computed using DFT
During the fitting process, there was a desire to have a reasonably good fit to bulk property values as well as the
defect configurations, perturbed atom configurations and so on. Weights were applied to the bulk properties as
a whole and individually to the property, such as lattice parameter, cohesive energy and so on. They were also
applied to the reference configurations as a whole and to individual configurations.
The potentials for Pd and Ru were fit only to their FCC structures and more weight was given to the lattice
parameter and cohesive energy. As the DFT computations had already been carried out for BCC Fe, these were
also used to fit the potential for Fe, but a much lower weighting was given to these than the FCC structure.
Again, more weight was given to the lattice parameter and cohesive energy than for other properties.
There were many configurations available, but given the reason for the potential is to model PGMs on or near
the surface of a grain of steel, more weight was given to the bulk and slab/surface configurations than defects
and other distorted configurations.
Potentials
The full potentials are available from https://github.com/BenPalmer1983/fepd feru potential and they are
ready to use with LAMMPS. The functions for pure Fe are the same for both potentials and give the same bulk
properties, but the binary potentials and of course those for pure Ru and Pd differ from one another.
A summary of the properties is given in table 7.18. This data and more are available in appendix S.
Both the Birch-Murnaghan and Rose-Vinet equation of states were used to fit the potentials, and these are
useful for fitting the bulk modulus (Birch-Murnaghan) and behaviour of the potential over a wider range of
values for the lattice parameter (Rose-Vinet). The Rose-Vinet fit for Fe is given in figure 7.14 for both the FCC
and BCC structures.
The Rose-Vinet fit for both Pd and Ru is given in figure 7.15 for just FCC structures. The potentials were then
used to calculate the energies predicted by DFT and how well these fit, for both potentials, are given in figure
7.16.
There has been very limited testing of the potentials with LAMMPS in order to verify that the output files are
readable by the molecular dynamics code. The code successfully reads in both potentials and was able to run
a rudimentary simulation of Fe-Pd and Fe-Ru. An single frame from a trial simulation of a 32,000 atom cube,
made of 99% Fe and 1% Pd, is given in figure 7.18.
There is certainly room for improvement and this will be discussed in more detail in chapter 8. More data
relating to the potentials is given in appendix T and U and these detail the bulk properties of the potentials
and compare how well they fit to the DFT computed values to which they are fit.
183

7.6. APPLICATION OF THE EAMPA CODE

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Property

Fe FCC
DFT Potential

Fe BCC
DFT Potential

Pd FCC
DFT Potential

Ru FCC
DFT Potential

𝑎0
𝑥
𝑦
𝑧
𝑒0
𝐵0 (a)
𝐵0 (b)
𝐶11
𝐶12
𝐶13
𝐶22
𝐶23
𝐶33
𝐶44
𝐶55
𝐶66

3.42
1.0
1.054
1.0
-4.26
226.1
222.0
364.6
141.6
233.8
298.7
130.4
364.6
186.3
266.8
186.3

2.80
1.0
1.0
1.0
-4.32
239.2
205.3
250.1
182.8
139.4
-

3.93
1.0
1.0
1.0
-3.91
184.4
173.7
218.5
151.4
80.3
-

3.81
1.0
1.0
1.0
-6.62
307.8
303.3
471.5
219.1
245.0
-

3.42
1.0
1.05
1.0
-4.27
246.6
235.2
312.6
182.3
222.8
321.6
182.3
312.6
171.9
223.1
171.9

2.76
1.0
1.0
1.0
-4.16
229.0
207.6
190.1
248.5
168.7
-

3.89
1.0
1.0
1.0
-3.78
165.0
156.0
191.1
152.0
58.8
-

3.79
1.0
1.0
1.0
-6.61
331.1
320.4
375.0
309.2
97.5
-

Table 7.18: A summary of bulk properties from these potentials. The bulk modulus is computed from the BirchMurnaghan equation of state (a) and an average of the Reuss and Voight bulk modulus (b).
Rose Equation of State
This potential
Rose predicted energy-volume

50

This potential
Rose predicted energy-volume

20
15

40

Energy (ev/atom)

Energy (ev/atom)

Rose Equation of State

30
20
10

10
5
0

0
2

3

4
5
Lattice Constant (ang)

6

−5

7

3

4
5
6
Lattice Constant (ang)

(a) BCC Iron

7

(b) FCC Iron

Figure 7.14: Rose-Vinet plots for Iron
Rose Equation of State

Rose Equation of State

This p tential
R se predicted energ(-volume

12.5
10.0

15

7.5

Energy (ev/atom)

Energ( (ev/at m)

This otential
Rose redicted energy-volume

20

5.0
2.5

10
5

0.0

0

)2.5

(5
3

4

5
6
Lattice C nstant (ang)

7

8

3

(a) FCC Palladium

4

5
6
Lattice Constant (ang)

(b) FCC Ruthenium

Figure 7.15: Rose-Vinet plots for Palladium and Ruthenium

184

7

8

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.6. APPLICATION OF THE EAMPA CODE

Known vs Po en ial Energy

Kno n vs Potential Energy

Known vs po en ial
Known vs known

12.5

10.0

Calculated Energy per Atom (eV)

10.0

Calcula ed Energy per A om (eV)

Kno n vs potential
Kno n vs kno n

12.5

7.5

5.0

2.5

0.0

−2.5

7.5

5.0

2.5

0.0

−2.5

−5.0

−7.5

−5.0
−4

−2

0

2

4

6

8

Potential Energy per A om (eV)

10

12

−7.5

−5.0

−2.5

0.0

2.5

5.0

Potential Energy per Atom (eV)

(a) Fe-Pd

7.5

10.0

12.5

(b) Fe-Ru

Figure 7.16: Plotting how well the potentials reproduce DFT energy values

Surface energy fr m bulk t slab

(3.7

Kn wn energy
P tential energy

(3.8

Calculated Energy per At m (eV)

(3.8

Calculated Energy per At m (eV)

Surface energy fr m bulk t slab

(3.7

Kn wn energy
P tential energy

(3.9

(4.0

(4.1

(4.2

(3.9

(4.0

(4.1

(4.2

0

1

2

3

Surface separati n a0 (angstr m)

4

5

0

1

2

3

(a) Fe

Surface energy from bulk to slab

Kn wn energy
P tential energy

Known energy
Potential energy

−6.0

(3.8

−6.1

Calculated Energy er Atom (eV)

Calculated Energy per At m (eV)

5

(b) Pd

Surface energy fr m bulk t slab

(3.7

4

Surface separati n a0 (angstr m)

(3.9

(4.0

(4.1

−6.2

−6.3

−6.4

−6.5

−6.6
(4.2
−6.7
0

1

2

3

Surface separati n a0 (angstr m)

4

5

0

(c) Fe

1

2

3

4

Surface se aration a0 (angstrom)

5

6

(d) Ru

Figure 7.17: Energy plotted as both a slab and two surfaces begin to form. The plots give the energies predicted by
DFT and computed using the potentials from this work.

185

7.6. APPLICATION OF THE EAMPA CODE

CHAPTER 7. POTENTIALS FOR FE, RU, PD

Figure 7.18: LAMMPS modelled cube like Fe-Pd particle

186

CHAPTER 7. POTENTIALS FOR FE, RU, PD

7.7

7.7. DL POLY CONTRIBUTION

DL POLY Contribution

DL POLY is a Molecular Dynamics code developed by W. Smith, T.R. Forester and I.T. Todorov at Daresbury
Laboratory in Warrington. It is written in Fortran and, before the modifications, included a number of potential
types for metals and several of these are listed below.
• Finnis Sinclair
• EAM
• EEAM
The Finnis Sinclair is a particular form of the EAM potential, and EEAM is a modification where, is the metal
is an alloy, the density and embedding functional for each atom type are treated separately.
A meeting was held with Dr. Todorov at Daresbury Laboratory, where a brief overview of the relevant code
was given. After this point, and corresponding by email, the two band EAM type was added (2BEAM). The
code was altered with the addition of an array used to store the d-band density function and d-band embedding
functional, with the s-band function/functional using the original density function and embedding functional
arrays. The calculation of energy and forces on atoms was also altered to make use of these arrays where a two
band embedded-atom method potential is used.
Listing 7.4: DL POLY 4.05 mailshot extract
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

DL_POLY_4.05: New Release & Events - MAILSHOT 013
NEW FEATURES \& IMPROVEMENTS
--------------------------1. New two band (2B) EAM and EEAM potentials for metals (TEST45 and TEST46).
Acknowledgements
---------------Ben Palmer \@ University of Birmingham (UK) for contributing to the
development and testing of the 2BEAM for metals;
Regards,
Ilian Todorov
July 2013

Extracts of the modified DL POLY code are included in appendix V. Dr Todorov’s assistance in correcting the
modifications and integrating them into the release version of the code was greatly appreciated.

187

Chapter 8

Conclusions
It is known that Cr provides protection to stainless steel through a passive protective layer, but
this becomes ineffective to protect the steel under irradiation as Cr is depleted from the grain
boundary. Platinum group metals also provide a mechanism to protect steel from corrosion, and
experimentation or simulations may be used to investigate whether they can maintain high enough
concentrations at the surface to continue to protect the steel against corrosion under irradiation.
If either of the two chosen PGMs, Pd or Ru, are depleted at the grain boundary under irradiation
along with the depletion of Cr, the steel will become susceptible to corrosion.
Experimental testing is cheaper, more controllable and more rapid at causing damage in a targeted volume if an ion beam is used rather than a neutron source. Either source will cause the
target material to become radioactive. It is important to be able to calculate how radioactive, and
how long after irradiation (to the desired damage, in DPA) it will be until the material is safe to be
handled. This work allows the prediction of the activation of irradiated targets through the Activity
code and modified Bateman equations.
Computer simulations to model radiation damage will be much too large and complex for firstprinciples calculations. Damage cascades require thousands to millions of atoms and typical damage rates take years to reach in practice. Simulations will need to use either classical molecular
dynamics or atomic kinetic Monte Carlo (akMC) to encapsulate the much larger volumes of atoms,
to contain the atoms effected by the damage cascade, and to represent the grain boundary. This
requires the derivation of an appropriate interatomic potential using experimental data and firstprinciples data where it is not available, or where it is either impossible or impractical to measure.
Binary potentials for Fe-Ru and Fe-Pd have been developed in this work as a step towards this goal.

8.1

Inter Granular Stress Corrosion Cracking

Austenitic stainless steel is particularly susceptible to inter granular stress corrosion cracking. It has good
properties, including a good resistance to corrosion due to its high Cr and Ni content. Under irradiation, the Cr
at grain boundaries is depleted with the formation of Cr carbides. There is also segregation due to the inverse
Kirkendall effect, driven by the radiation, that preferentially depletes Cr leaving Fe and Ni. Three requirements
for inter granular stress corrosion cracking to occur are:
• a susceptible material (austenitic stainless steel)

188

CHAPTER 8. CONCLUSIONS

8.2. PREDICTING ION INDUCED RADIOACTIVITY

• stress, welds, swelling, pressure, any applied stress (high pressure in reactor environment, swelling due to
irradiation)
• a corrosive environment (radiolysis of water)
The passive Cr layer, under normal conditions, protects the steel from corrosion. The steel is made up from
small grains, and the surface of these grains of crystalline metal are where the protective layer covers. As the
percentage of Cr drops below the threshold required for formation of the passive protective layer the surface
becomes prone to corrosion.
Small quantities of PGMs may be added to a steel to also increase its corrosion resistance. PGMs are rare and
much more costly that Fe, Ni, Cr. Where irradiation is not present, it has been shown experimentally that
the benefit due to Pd is lost due to the formation of Pd-Mn nanoparticles, where Mn is present in the steel,
although no such particles are present when Pd was replaced by Ru. Pd does provide corrosion protection via
cathodic modification when Mn is reduced to very small amounts as it no longer forms Pd-Mn precipitates during
sensitisation. The outstanding question is whether or not Pd or Ru are depleted, enriched or are unaffected at
the grain boundary when under irradiation.

8.2

Predicting Ion Induced Radioactivity

Testing a material inside a nuclear reactor is an expensive experiment. There are many more ion sources around
the world than high flux neutron sources, and ion beams are easier to direct due to the charge of the ion versus
the neutral charge of the neutron. The ion energies required to create similar sized damage cascades in the
material are high enough to also have a chance of transmuting the target nuclei. These transmuted nuclei are
highly likely to be left in an excited state and will either be metastable or radioactive. To reach damage dose
levels comparable to a component in a Gen IV reactor by the end of its life (up to 200 DPA), the target material
will become dangerously radioactive.
Bateman’s equation may be used to calculate the amount of an isotope in a decay chain of several isotopes, and
thus how radioactive an isotope would be after a certain time. Major modifications were required to be made
to the equation to also include branching factors and source rates for isotopes generated by an ion beam.

8.2.1

Modified Equation

Whilst the equation was first tackled by solving the differential equations head on, it became obvious that using
Laplace transforms would be the logical choice; this was also the route Bateman followed when deriving the
original equations. Once transformed, a numerical algorithm (Gaver-Stehfest) was programmed and used to
solve, with some success.
The numeric method is not an exact solution, and the errors incurred often resulted in negative amounts of an
isotope, and this was unacceptable. More progress was made towards solving the problem analytically, and this
was achieved by using partial fractions, obviating the need for a numerical method.
The analytic solution was tested against a simple numeric solver and the results were in good agreement between
the modified equation and numeric solutions (appendix B.3.1).

8.2.2

Activity Code

The Activity code was created to automate the process of calculating the activity of an ion irradiated target.
The program:

189

8.2. PREDICTING ION INDUCED RADIOACTIVITY

CHAPTER 8. CONCLUSIONS

• reads in simulation settings (target composition, thickness, duration etc)
• reads in ion cross section data from the Talys database
• processes SRIM exyz data points
• calculates the amount of each isotope by the end of the simulation
• calculates the activity of each isotope and the dose that an average human would be exposed to
A number of simplifications are made to the model but it predicted the radioactivity of certain peaks reasonably
well with a sample of proton irradiated pure Fe. Given more time a range of alloys would also be irradiated
by a proton beam and, once their activity is measured at several time intervals after irradiation, they would
compared to the activity predicted by the Activity code.
The first version of the Activity code was replaced by a second version that used Python rather than Fortran.
The first version was more cumbersome for new users and it crashed for certain isotope, and these problems
were fixed in the new version.

8.2.3

Iron Irradiation

During the experimental stage of this work it was determined that the isotope to focus on would be

55
27 𝐶𝑜

and the associated 931keV peak it generates would be the peak to measure. The equipment was calibrated
specifically for the purpose of measuring this gamma. If this is the case then the value predicted by the Activity
V2 computer code is in good agreement (table 6.6).
The Activity code collates and displays data generated from the cross section database and JEFF 3.3 decay
data file. It is clear that there should also be a nearby 935KeV gamma from the decay of

52
25 𝑀 𝑛.

The sum of

these nearby gammas is predicted to be almost 120kBq and, if both peaks were tallied in the experimental work
due to the energy resolution of the detector, the predicted value is three times that of the measured value of
44kBq.
It is quite possible that the code is giving a value three times larger than expected and reasons for this will be
discussed below.

8.2.4

Molybdenum Irradiation

Similar to the results discussed for Fe, the activity results computed for Mo have positive and negative attributes.
There are gaps in the available cross section data, but the most prominent gammas are predicted by the computer
code. The radioactivity computed is too high, but for each of the five peaks measured by experiment, the values
are out by a similar factor of approximately 7-9, depending on the peak.

8.2.5

Beam Flux Reduction and Gamma Attenuation

The Talys derived cross section data used by the Activity code has been checked for a number of cases against
EXFOR data and is in good agreement with this. Certain data for reactions is missing in particular those of
observationally stable and isotopes with extremely long lived isotopes, but this would have a minimal impact
due to how low the radioactivity would be.
Thin foils are ideal to compare experimental results to the data files and activity code as ions will not lose a
great deal of energy travelling though such a shallow target. However, the much thicker targets used here for
Fe and Mo reduce ion energies significantly, if not completely.

190

CHAPTER 8. CONCLUSIONS

8.2. PREDICTING ION INDUCED RADIOACTIVITY

It could be argued that as ions pass through the target the energy and intensity of the beam decreases, and this
is not currently modelled with the activity code. By imagining the target as thin laminae perpendicular to the
beam it is easy to consider that the ions will enter the first layer and lose those that react with target atoms.
As the beam enters the next lamina it will have a lower energy, either due to electronic stopping or deflection
by nuclear collisions, and a lower intensity as a proportion of the protons will be absorbed.
The change in energy is accounted for in the code through the SRIM exyz ion trajectory file but how the beam
intensity decreases is not. It is important to approximate how many ions are captured through nuclear reactions
and whether it is a significant percentage of the total number of ions. Particles and residuals were calculated
to be produced at a rate of approximately 6 × 1010 per second for the Fe target and 7 × 1010 per second for the

thick Mo target. The beam rates were 3 × 1012 and 3 × 1013 protons per second respectively and so, even if the
estimate that a proton was removed for each reaction the beams would only lose 2% and 0.3% of their intensity
due to transmutation reactions.
Another possibility for the over estimate in prediction is the attenuation of gammas travelling through the
target material to the detector. This was discussed in the work of my colleague[178] and the inhomogeneous
distribution of radioactive material in the Mo target was discussed in this work (section 6.7.2). Calculations
using the NIST attenuation coefficient for Mo show that 500keV gammas have their intensity reduced to 91%
through a 1.0cm target. The intensity of 1MeV gammas is reduced to just 94% through the same target.
The reduction through loss of ions due to reactions and attenuation of gammas does not explain the increase
in predicted activity. There may be another reason behind this, or there may be issues with the experimental
work.

8.2.6

More Experimental Data Required

I have not had a great deal of experience practically measuring gammas, and I would expect there to be errors
introduced due to my own inexperience. The range of beam energies, elements and beam duration are also very
restricted.
In past experimental work discussed in section 4.4.3, thin foils were used to measure reaction probabilities,
and this data influences models such as TALYS. In some two out of the three examples reviewed, the data
beam energy was degraded using a stack of foils perpendicular to the beam, with those closest to the aperture
receiving the highest energy protons. It is hard to imagine whether foils stacked in this way would be much
different to a solid target of the same thickness, but this should be tested experimentally.
Ideally a range of target materials of varying thicknesses would be irradiated with protons of energies ranging
up to the limit of the cyclotron, perhaps 60MeV, and the Gamma spectra of each measured at set times after
irradiation. This data would be compared to the gamma lines predicted by the Activity code to help give a
better understanding of the accuracy of the code.

8.2.7

100DPA Activity Predictions

Using dose rates calculated with SRIM, the Activity code was used to predict how radioactive Fe would become
at a dose rate of 100DPA. It assumes the beam source is the Scanditronix MC40 using protons at maximum
current for an uninterrupted duration of 134-391 days. In the worst case scenario, 25MeV protons result in over
20 Gys per hour if irradiated to the required damage dose, and this level of dose would be extremely dangerous
and probably fatal if exposed to for half an hour. However, by reducing the beam energy to 15MeV radioactivity
of the target is reduced by a factor of 1,000. It may be reduced further by lowering the energy to 5MeV or
10MeV, but for a 0.5mm piece of steel at these energies the ions would not have enough energy to pass through
and the damage would be disproportionately concentrated in the top 100-250 microns of the target.

191

8.3. DERIVED POTENTIALS

8.2.8

CHAPTER 8. CONCLUSIONS

Original Contribution

The modified Bateman equation as derived is an original contribution to knowledge. The Activity code is also
an original contribution, and its use shows how adjusting beam parameters will reduce the amount of radioactive
material created and the risk to those handling irradiated samples. It is also a useful tool to highlight problematic
isotopes and reactions of interest within a complicated material.

8.3
8.3.1

Derived Potentials
Restricting Potentials to Binary Alloys

It would be too complex a task to develop an interatomic potential that includes Fe, Pd, Ru, Cr, Ni and any
other elements that make up a typical sample of austenitic stainless steel. The binary alloy potentials for Fe-Pd
and Fe-Ru are a starting point to with the possibility of adding more elements to the potential in the future.
Austenitic steels have a FCC structure and this is why the potentials were trained with a higher weighting
to FCC configurations. As only Pd exists under normal conditions in this state, the properties for all three
elements were computed using DFT.

8.3.2

Collinear Spin DFT

With most models, there will be a trade off between simplicity, accuracy and the computational cost of the
model. The parameters that had the largest impact on how long a DFT calculation will take to compute are the
planewave energy cutoff and number of k-points used to integrate the Brillouin zone. These should be reduced
as much as possible, while keeping the energy and force results within a tolerance determined by the user.
A choice in the complexity of the calculation also had to be decided upon, and this was whether to use a
non-spin, collinear spin or non-collinear spin calculation. Examples of room temperature ferromagnetic and
antiferromagnetic materials, Fe and Cr respectively, were investigated with DFT using both non-spin and
collinear spin. These calculations showed that when magnetism is ignored the optimum structure for Fe is FCC,
but when the spin of unpaired electrons is accounted for DFT then correctly predicts the optimum structure as
ferromagnetic BCC. Similarly when spin polarized DFT calculations are performed for Cr the optimum state
is shown to be antiferromagnetic BCC, as expected. It was therefore deemed necessary to use these more
computationally intensive calculations.
Non-collinear spin was not considered as it would increase the resources required further and would possibly
require the testing of suitable pseudopotentials. The collinear calculations were adequate for modelling bulk Fe,
but there could be merit in using non-collinear spin calculations in the future due to the local effects individual
doped PGM atoms may have plus investigating the effect of a surface on the alignment of atoms nearby.

8.3.3

Automated Convergence Calculations

A Python code (QECONVERGE) was developed to automatically converge the aforementioned parameters.
Whilst automation worked well for the planewave cutoff parameters the choice of smearing type, the amount of
smearing and number k-points was more difficult to automate. It was more useful to select a range of k-point
values and smearing values and produce 2D force and energy plots so the user could make a decision based on
these and choose the parameters that best suit their requirements.
During testing, a much larger number of k-points were needed for the predicted properties of Aluminium to
replicate the known properties reasonably well. Unfortunately, the number of k-points used for Fe and Pd was
192

CHAPTER 8. CONCLUSIONS

8.3. DERIVED POTENTIALS

constrained by the amount of time and the RAM available on the compute nodes. Ideally, more k-points would
have been used, but this was not possible.

8.3.4

Bulk Property Calculations

As discussed in the previous section, spin polarised DFT were used for all first principles calculations in this
work. Although a smaller number of k-points were used than would have been desired, the calculations required
to compute these properties continued for more than a month.
Rather that calculate the input files manually, a program was created to automate this process (QEEOS). It
was designed to cache input and output files for the DFT program, PWscf, such that it would load an output
file from the cache if it had already successfully run, to reduce the calculation time.
In the case of Fe, the relaxed (energy minimised) shape of the antiferromagnetic FCC Fe was not cubic, but
orthorhombic. The equation of state calculation is specifically for a cubic crystal, but the elastic constants were
calculated for the orthorhombic crystal. From the 9 calculated elastic constants the melting point, bulk modulus,
shear modulus and Young’s modulus were calculated (section 7.3.4 and appendix N.5). The resulting structure
was stable and were well within a magnitude of the known values for BCC Fe. These data are an original
contribution to science. The properties were also computed for Pd and Ru and were used in the derivation of
interatomic potentials.

8.3.5

Iron-Palladium and Iron-Ruthenium Configurations as Fitting Data

To be able to fit the Fe-Pd and Fe-Ru potentials, the bulk properties were computed and a range of other
configurations were generated. A number had atoms randomly perturbed from their perfect positions, others
represented slabs, defects and so on.
The energy and force data were entirely from first-principles calculations, and ideally there would have been
more configurations and computed with a higher number of k-points as well as a reduction in the smearing
value, if possible. In addition, a wider range of vacancies, interstitials and mixing concentrations would have
been desirable. Unfortunately many of the configurations failed to converge, and this was particularly prevalent
where the atom configurations were far from the perfect crystal, and even more so when multiple elements were
used in a calculation.
The atomic percentage on Pd or Ru doped is half a percent which would be better represented with a one PGM
atom in a 4x4x4 FCC 256 atom supercell rather than the 32 atom cells used, but again this was a constraint
imposed by computational resources and this lead to the majority of the calculations being performed on 32
atom supercells, with relatively few 256 atom supercells.

8.3.6

Iron-Palladium and Iron-Ruthenium Potentials

Both potentials have had minimal testing using the molecular dynamics package LAMMPS. In each case
LAMMPS was able to read in the potential and run a simulation with a Nose-Hoover thermostat. When
given a relaxed start point, the simulations were well behaved either as a nano cube particle surrounded by a
vacuum or as the bulk material represented by a cube subject to PBCs.
As the relaxed structure from DFT calculations for Fe was FCT, the structure is not symmetric and a directional
potential would better represent the increased lattice parameter in the y axis (figure 7.4). One possibility would
be to replace the EAM potential with a MEAM, but this is discussed further in section 9.2.4.
The individual potentials reproduce the bulk properties, as calculated by DFT, reasonably well with the lattice
parameters and cohesive energies being within a few percent of the experimental values. The poorest properties
193

8.4. TWO-BAND EAM CONTRIBUTION TO DL-POLY

CHAPTER 8. CONCLUSIONS

in the fitting process were the elastic constants, in particular the 𝐶44 value for Ru. These could be improved
by running the code for a longer time period.
The Rose-Vinet equation of state for each pure element fits well and takes on a shape that would be expected,
with an increase in energy where the lattice parameter is reduced, a minimum where the relaxed lattice parameter
is and a reduction in energy to zero as the atoms are pulled further and further apart. Where the creation of
a slab with two surfaces is modelled, the predicted energies for each pure element match well with the DFT
energies. Out of the three elements, Ru fits least well as far as the formation of a slab is concerned with a
consistent energy difference of at lease 0.05eV.
Overall, both of the potentials reproduce the energies calculated using DFT well across a range of configurations.
There is definitely room to improve and build upon these potentials given more time.

8.3.7

Original Contribution

The fitting code is an original contribution as it allows the fitting of metal potentials in the form of the embeddedatom method and two band embedded-atom method to DFT data and bulk properties. Other similar codes
do exist, such as FitPot and PotFit, but at the time of developing the EAMPA code, PotFit did not have the
ability to fit analytic potentials (although, this feature is now available) and does not have, in its available form,
the ability to fit the potential to the bulk properties of the material (although the Sheng version did have this
ability). The code developed here may be modified in the future to add more features and properties to fit
potentials to.

8.4

Two-Band EAM Contribution to DL-Poly

During the early stages of this work it was clear that the Embedded Atom Method was a good candidate for the
type of potential to be derived as it was well suited to modelling metals and had been used previously (along
with the similar FS potential) to model radiation damage[26]. Work by Prof. Ackland at the University of
Edinburgh considered using a separate density function and embedding functional to represent the S-Band and
D-Band of transition elements such as Caesium. Work by P. Olsson and J. Wallenius also used this two band
version to model Fe-Cr with a later Fe-Cr potential being developed by Bonny et al to replicate the mixing
enthalpy as a function of Cr content.
After meeting with Prof. Todorov at Daresbury Laboratory, the source code for DL-Poly was modified to
include new keywords, additional arrays to store the two-band density and embedding data for the second band
and modifications to the energy and force subroutines. This was then released with version 4.05 of DL POLY
in July 2013.
Ultimately, only EAM potentials were fit in this work. In the future, as more elements are added to the potential,
in particular Cr, the 2BEAM may be required for the reasons discussed in section 5.3.3. The molecular dynamics
code and fitting code both have the capability to use this type of potential.

194

Chapter 9

Future Work
During the development of the Activity code, a number of simplifications were made. In future,
some of these could be examined more closely to determine how much impact the simplifications
have on the end result. Other simplifications could also be applied, again once their significance
has been determined, in order to make the calculation less computationally expensive.
Two potentials were developed in this work, but they have not been used for the purpose they
were created for. There is room to improve these potentials by providing better fitting data and by
continuing the fitting process for longer. They need to be tested in terms of their ability to model
damage cascades and then put into practice using either MD or akMC.

9.1
9.1.1

Activity Code
Experimental Activity Readings for Ion Irradiated Targets

The Activity code was developed using data generated by the Talys nuclear reaction code. To test the validity
of the Activity code, an Fe sample was irradiated and its activity was measured several days after irradiation.
To validate the code further, a range of pure targets and alloys would be irradiated by a cyclotron, with targets
of varying thickness and beams of varying fluences and energies. This would generate data to be used to compare
to the results predicted by the code. This would require significant resources in terms of beam line time on the
cyclotron as well as an experienced experimental physicist.

9.1.2

Code Improvements

A number of improvements could be made to the code. While Python is a popular language, and a feature
rich one, there are still benefits in using a language such as Fortran. This is especially true when coupled with
OpenMP. There certainly are parts of the code that could be improved by using F2PY to decrease runtime.
All versions of the code have relied on data from SRIM. It might be useful to integrate or build an ion transport
class so a calculation may be run once, rather than having to first generate the transport data on one platform
and run the Activity code on another.
It should also be investigated whether or not a history of many particles is even needed at all as there already
exist average energy stopping tables. If there is little difference in calculated activity when using the histories of
a thousand ions and energy stopping tables, then the stopping tables should be used instead. It would remove

195

9.2. POTENTIAL FITTING AND MD SIMULATIONS

CHAPTER 9. FUTURE WORK

the need to generate the ion history, which in itself is a long process, and it would speed up the computation of
target activity.
The energy range of cross section values and particle types could be extended to higher energies and a wider
range of particles including deuterons, tritons and helium ions. This would require more time but would be
useful in the case of the University of Birmingham cyclotron as it is capable of accelerating these particles as
well as protons.
Currently the code does not take into account 511KeV gammas created by the annihilation of positrons from
𝛽 + decay or pair production from higher energy photons. This will affect the calculations during irradiation and
during the cooling period. Where the transmuted nuclei is left in an excited state due to the energy difference,
the gammas that will be released are not yet accounted for. This is more important during irradiation and may
not need to be considered providing there is adequate shielding whilst the target is in the ion beam.
As the target becomes thicker, the orientation of the irradiated target to the end user expected to handle the
sample will become more important. Incorporating this into the end calculation to display the gamma fluence
radially in 2 dimensions from the target would help the user position themselves relative to the irradiated face
of the target to minimise the dose received.
Whilst the target is being irradiated, there will be a high number of gammas as well as other radiation such as
neutrons, protons, electrons and other light ions. It has always been assumed that this process will be carried
out behind adequate shielding as it is only a danger when the proton beam is on. When out of the beam the
primary concern to a person nearby the target are the gammas released by radioactive decay. There may also
be reasons to consider the amount of beta and alpha radiation emitted by the target, although this might only
be a concern if the target is to be machined, releasing ingestible radioactive dust, or handled without protection
where the beta particles will be in a position to travel through skin. Ideally, both these circumstances would
be avoided, but the utility could be added to the code.
More features could be added including a choice of dose units and whether or not the dose is calculated for a
given volume of space or for a given person with certain parameters.

9.2
9.2.1

Potential Fitting and MD Simulations
Larger Supercells

In many examples in the literature, the supercell sizes were at least 4x4x4 containing 256 atoms for FCC
crystals. These require much more memory and processing power, especially considering the lack of symmetry
and inclusion of magnetism in the calculations.
If these potentials were to be improved in the future, all the calculations would contain approximately 128 atoms
for BCC and HCP configurations and 256 atoms for FCC as all the configurations would be based on 4x4x4
supercells. Ideally the smearing would be reduced further from the value used here, of 0.04, and the number of
k-points increased within reason if the Gamma point only is determined to be insufficient.
This higher number of atoms per calculation would have the benefit of increasing the number of data points
used to fit the potentials, as a consequence of increasing the number of force values. It would also allow the 1%
doped value to be better represented by using 1, 2 or 3 atoms per 256 (0.4%, 0.8%, 1.2%) rather than 1 per 32
atoms (3%).

9.2.2

Alloy Bulk Properties

The original potentials used the bulk properties of the pure elements Fe, Pd and Ru. The calculations may
then be performed using the QEEOS code to compute the bulk properties of Fe-Pd and Fe-Ru alloys. As the
196

CHAPTER 9. FUTURE WORK

9.2. POTENTIAL FITTING AND MD SIMULATIONS

arrangement of atoms would not be unique it would not be as useful to use the figures output by QEEOS, but
it would be more useful to use the files output by Quantum Espresso as additional configurations to add to the
reference database.

9.2.3

Defects

In the derivation of the potentials in this work, more weighting was given to bulk and slab/surface configurations.
There were also issues in SCF convergence for a number of the defect configurations. More effort could be put
towards investigating how to ensure PWscf achieves convergence.

9.2.4

MEAM for FCC Iron

With a collinear spin-polarized DFT calculation, the relaxed structure was slightly longer in the y direction.
Investigating the use of an angularly dependent potential might be worthwhile and the MEAM type potential
with an angularly dependent electron density would be a starting point (section 5.3.3).

9.2.5

Improved Potential: Fe-Ni-Cr-Pd

Given more time and a larger computer, more complicated DFT calculations could be performed that better
represent the material, austenitic stainless steel. As already mentioned, there are drawbacks (in terms of memory
and computational time) and benefits in using a supercell with more atoms. For example a 1% PGM doped
steel could be represented as a 4x4x4 supercell containing 256 atoms. For 304SS approximately 50 Cr, 25 Ni,
178 Fe and 3 Pd or 3 Ru atoms would be needed (and small variations on these figures).

9.2.6

PKA Cascade Trials in LAMMPS or DL POLY

The first set of trials using the potential should be PKAs within a suitably sized simulation box, perhaps tens of
thousands to hundreds of thousands of atoms. Individual cascades may be simulated, examined and compared
to previous simulations as discussed earlier in this work. These would be the first steps towards testing how
well the potential represents the material as well as the damage cascades by virtue of the ZBL function that
forms a part of the pair functions.

9.2.7

Radiation Induced Segregation Trials

The ultimate goal for this part of the work is to determine whether or not PGMs are depleted at the grain
boundary removing the protection to corrosion that they provide. There is a possibility of using the potentials
with molecular dynamics, but the time period to cover the number of displacements required may be too large
for classical molecular dynamics. An alternative use for the potential would be to explore atomic kinetic Monte
Carlo (akMC) and this could allow simulation over a much longer period of time in order to reach damage doses
up to 100 DPA.

197

Acronyms
2BEAM two band embedded-atom method. 76, 92, 176, 190, 197, 507
ABWR Advanced Boiling Water Reactor. 5, 7
AGR Advanced Gas Reactor. 4, 5, 9, 40
akMC atomic kinetic Monte Carlo. 191, 198, 200
ASME American Society of Engineers. 30
AVF Azimuthally Varying Field. 52
BCC body centered cubic. 15, 29–31, 37, 66, 67, 76, 77, 83, 102, 118, 150, 151, 159, 163, 164, 176, 186, 195,
196, 199, 497, 505, 506
BFGS Broyden Fletcher Goldfarb Shanno. 60, 178, 181, 185, 432, 435, 436
BLYP Becke-Lee-Yang-Parr. 153
BWR Boiling Water Reactor. 4, 12, 32, 39
BZ Brillouin zone. 102, 113, 114
CANDU Canada Deuterium Uranium. 4
CCGT Combined Cycle Gas Turbine. 6, 10, 11
CERN Conseil Européen pour la Recherche Nucléaire. 45
CG Conjugate Gradient. 178, 435
CPH face centered tetragonal. 118
CPU central processing unit. 96
DFT Density Functional Theory. i, 17, 61, 67, 69, 86, 88, 94, 96, 97, 108, 111–114, 118, 150, 151, 153, 154,
156–161, 163, 164, 167–169, 171, 172, 178, 186, 188, 195–197, 200, 381, 402, 432, 491, 500
DNA Deoxyribonucleic Acid. 18
DPA displacements per atom. i, 15, 32, 34–36, 132, 143, 192, 200, 355
EAM embedded-atom method. 16, 17, 60, 75–78, 83, 85, 92, 176, 182, 185, 196, 197
EBR Experimental Breeder Reactor. 34
ECIS Equations Couplées Itérations Séquentielle. 53
198

Acronyms

Acronyms

ECP electrochemical corrosion potential. 39, 41
ELSY European Lead Fast Reactor. 10
ENDF Evaluated Nuclear Data File. 44, 55, 57
EPR European Pressurised Reactor. 7, 8
EXFOR EXchange FORmat. 52, 137, 138, 145, 146
FCC face centered cubic. i, 29–31, 37, 60, 66, 67, 70, 76, 102, 118, 150, 159–161, 163, 165, 166, 168, 170, 176,
178, 186, 195, 196, 199, 489, 491–498, 500–504, 506
FCT face centered tetragonal. 163, 170, 196
FS Finnis-Sinclair. 17, 60, 176, 197
Gen II Generation II. 4, 32, 35
Gen II+ Generation II+. 4, 5
Gen III Generation III. 5
Gen III+ Generation III+. i, 1, 4, 5, 7, 13
Gen IV Generation IV. i, 1, 3, 4, 9, 12, 13, 32, 40, 49, 142, 192
GFR Gas-Cooled Fast Reactor. 11, 40
GGA generalized gradient approximation. 110–113, 153, 156, 157, 163, 381
GPU graphical processing unit. 86
HCP hexagonal close packed. 150, 166, 199
HFIR High Flux Isotope Reactor. 25, 44, 46, 49
HK Hohenberg-Kohn. 103–105, 113
HPR Hualong Pressurised Water Reactor. 5
HRB Hardness Rockwell B. 31
IAEA International Atomic Energy Agency. 52
IASCC irradiation assisted stress corrosion cracking. 37
IBZ irreducible Brillouin zone. 102, 113
IGSCC inter granular stress corrosion cracking. 1, 29, 31, 36–40
IKE inverse Kirkendall effect. 35
INS Institute for Nuclear Study. 52
ITER International Thermonuclear Experimental Reactor. 13
JEFF Joint Evaluated Fission and Fusion File. 56, 57
KE Kirkendall effect. 35

199

Acronyms

Acronyms

KS Kohn-Sham. 109
LAMMPS Large-scale Atomic/Molecular Massively Parallel Simulator. 80, 86, 87, 90, 91, 94, 182, 186, 196,
489, 498
LDA local density approximation. 109–111, 153, 156, 163, 381
LFR Lead-Cooled Fast Reactor. 10, 11
LHC Large Hadron Collider. 45
LINAC linear accelerator. 44, 47
LM-BFGS Limited-memory Broyden Fletcher Goldfarb Shanno. 435
LMA Levenberg-Marquardt Algorithm. 95, 432, 436
LSDA local spin density approximation. 110–113, 156, 157, 381
LWR Light Water Reactor. 39
MCNP Monte Carlo N-Particle. 19
MD molecular dynamics. i, 61, 72, 74, 83, 86, 90, 94, 198
MEAM modified embedded-atom method. 79, 176, 182, 196, 200
MOX mixed oxide. 87
MPI Message Parsing Interface. 86
MSKP Mehl, Singh, Klein, Papaconstantopoulos. 395, 493, 495, 497, 502, 504, 506
MSR Molten Salt Reactor. 12
NAA neutron activation analysis. 60
NBS National Bureau of Standards. 46
NBSR National Bureau of Standards Reactor. 47
NDS Nuclear Data Services. 51
NEA Nuclear Energy Agency. 56
NG Newton-Gauss. 435, 436
NIST National Institute of Standards and Technology. 194
OMP optical model potential. 44
OpenMP Open Multi-Processing. 86
ORNL Oak Ridge National Laboratory. 46, 47
PBC periodic boundary conditions. 196
PBE Perdew-Burke-Ernzerhof. 110–112, 381–383
PBESOL Perdew-Burke-Ernzerhof functional revised for solids. 111, 112

200

Acronyms

Acronyms

PBR Pebble-Bed Reactor. 11
PGM platinum group metal. i, 1, 41–43, 61, 119, 150, 166, 170, 186, 191, 192, 195, 196, 200
PKA primary knock-on atom. 13–16, 27, 28, 31–33, 83, 86–88, 200
PWR Pressurised Water Reactor. 4, 5, 7, 12, 32, 39, 40
PZ Perdew-Zunger. 112
QP Quadratric Programming. 435
RBMK Reaktor Bolshoy Moshchnosti Kanalnyy. 4
RFKJ Ravindran, Fast, Korzhavyi, Johansson. 397
RIS radiation induced segregation. 35, 36, 40
RSS residual squared sum. 164, 165, 178, 219–224
SA Simulated Annealing. 435
SCC stress corrosion cracking. 34, 40, 41
SCF self consistent field. 107, 114, 161, 170, 172, 174, 175, 200
SCWR Supercritical-Water-Cooled Reactor. 10–12
SEM scanning electron microscope. 60
SFR Sodium-Cooled Fast Reactor. 10–12, 40, 41
SIMS secondary-ion mass spectrometry. 60
SLAC Stanford Linear Accelerator Center. 44
SNS Spallation Neutron Source. 44, 47, 49
SRIM Stopping Range In Matter. 44, 51, 57, 59, 74, 120, 130, 132, 143, 193, 194, 198
TEM transmission electron microscope. 41, 42, 60
TENDL TALYS-based Evaluated Nuclear Data Library. 55, 57, 127, 135, 137, 138, 145
TGSCC trans granular stress corrosion cracking. 39
TISE Time Independent Schrödinger Equation. 97–100, 103, 108, 112
TRIM TRansport In Matter. 44, 57–59
TRISO Tristructural Isotropic. 13
TRIUMF TRI-University Meson Facility. 45
UK United Kingdom. 3
URL Uniform Resource Locator. 149, 153
USSR United Socialist Soviet Republic. 4
UTS Ultimate Tensile Strength. 31
201

Acronyms

Acronyms

VHTR Very-High-Temperature Reactor. 10, 11
VPI vacancies per ion. 143
VVER Vodo-Vodyanoi Energetichesky Reaktor. 4
XC exchange-correlation. 108–110, 112
ZBL Ziegler-Biersack-Littmark. 16, 74, 75, 82, 83, 177, 184, 200

202

Glossary
304SS Austenitic stainless steel: 18-20%Cr, 8-11%Ni. 31, 34, 37, 40, 41, 200
316SS Austenitic stainless steel: 16.5-18.5%Cr, 10-13%Ni, 2.0-2.5%Mo. 31, 37, 40
Al Aluminium 𝑍 = 13, 𝐴𝑟 = 26.98. 85, 157
allotrope an element that exists in multiple forms/structures - the common example of allotropes are graphite
(hexagonal sheets) and diamond (regular tetrahedral structure) for carbon. 30
antiferromagnetic neighbouring electrons orientate in opposite directions, cancelling out overall magnetism.
79
barn Unit for cross sectional area (1.0 × 1028 𝑚2 ). 22
Becquerel Becquerel (Bq) - decays per second. 23
Bloch theorem electron wave functions may be written as a sum of plane waves 𝜓⃗𝑘,𝑛⃗𝑟 =
˙ 102
⃗ ⃗𝑟).
𝐺)

∑︀

⃗
𝑐⃗𝑘+𝐺,𝑛
⃗ 𝑒𝑥𝑝(𝑖(𝑘 +

Bohr magneton natural unit for magnetic moment 5.788 × 105 𝑒𝑉 𝑇 −1 . 163
Brillouin Zone the Wigner-Seitz cell in reciprocal space. 102
C Carbon 𝑍 = 6, 𝐴𝑟 = 12.00. 29
Cauchy pressure 𝐶12 − 𝐶44 . 79
Co Cobalt 𝑍 = 27, 𝐴𝑟 = 58.93. 2, 118, 135
Cr Chromium 𝑍 = 24, 𝐴𝑟 = 52.00. 1, 2, 29, 78, 79, 118, 157, 191
Cs Caesium 𝑍 = 55, 𝐴𝑟 = 132.91. 76–78
Cu Copper 𝑍 = 29, 𝐴𝑟 = 63.55. 35
Curie Curie (Ci) - activity of 1 gram of Radium-226 - 1Ci = 3.7 × 1010 decays per second. 23
enthalpy sum of internal energy plus pressure times volume 𝐻 = 𝐸𝑖𝑛𝑡𝑒𝑟𝑛𝑎𝑙 + 𝑃 𝑉 . 78
eutectic A eutectic contains two or more elements, and has a lower melting point than any of it’s constituent
elements.. 10
Fe Iron 𝑍 = 26, 𝐴𝑟 = 55.85. 2, 29, 60, 78, 117, 118, 143, 149, 157, 159, 164, 171, 178, 184, 186, 191, 195, 198
Fermi energy the energy of the highest occupied state. 102
fermion half-integer spin particle - includes electrons, protons, neutrons. 107
203

Glossary

Glossary

fissile Fissile materials can undergo a nuclear chain reaction with slow (thermal) neutrons. 2
fissionable A material that can fission with high energy neutrons. 3
Gray Gray (Gy) how much energy is deposited into matter and 1Gy is equal to 1 Joule per kg. 23
ˆ = 𝑇ˆ + 𝑉ˆ = 𝐻
ˆ = − ~2 ∇ 2 +
Hamiltonian the total energy of a system - an operator in quantum mechanics, 𝐻
2𝑚
𝑉 (⃗𝑟, 𝑡) . 97

homogeneous electron gas quantum mechanical model of electrons distributed uniformly through space (jellium). 109
invar effect invar is an Fe Ni (64/36) alloy that has a low thermal expansion coefficient for a range of temperatures below its curie temperature, and this low expansion is the invar effect. 111
Ir Iridium 𝑍 = 77, 𝐴𝑟 = 192.22. 41
isostructural transformation a change from one structure to another. 77
jellium quantum mechanical model of electrons distributed uniformly through space (homogeneous electron
gas). 106, 109
Kohn-Sham equations 𝑣ˆ𝐾𝑆 (𝑟⃗𝑒 , 𝑟⃗𝑛 ) = 𝑣𝑛−𝑒 (𝑟⃗𝑒 , 𝑟⃗𝑛 ) +
LD50 Lethal dose in 50 percent of cases. 26

∫︀

𝜌(𝑟⃗′ )

𝑑3 𝑟⃗′ |𝑟⃗ −𝑒𝑟⃗′ + 𝑣𝑥𝑐 [𝜌](𝑟⃗𝑒 ). 106, 107
𝑒

𝑒

matrix diagonalization Take matrix 𝐴 and find a diagonal matrix 𝐷 such that 𝑆 − 1𝐴𝑆 = 𝐷. 113
mean free path average (mean) distance a projectile travels before reacting with the target. 22
Mn Maganese 𝑍 = 25, 𝐴𝑟 = 54.94. 3
Mo Molybdenum 𝑍 = 42, 𝐴𝑟 = 95.95. 2, 29, 35, 146–149, 193
Neel temperature temperature at which an antiferromagnetic becomes a paramagnet. 79
Ni Nickel 𝑍 = 28, 𝐴𝑟 = 58.69. 29, 60, 85, 118, 191
O Oxygen 𝑍 = 8, 𝐴𝑟 = 16.00. 36
observationally stable theoretically unstable but yet to be measured as unstable by experiment. 145
orthorhombic 𝑎, 𝑏, 𝑐, 𝛼 = 𝛽 = 𝛾 = 90∘ . 62
P Phosphorus 𝑍 = 15, 𝐴𝑟 = 30.97. 34
Pauli exclusion principle half-integer spin particles cannot have the same quantum numbers. 107
[︃
]︃ [︃
]︃ [︃
]︃
0 1
0 −𝑖
1 0
Pauli vector sum of the three Pauli matrices ⃗𝜎 =
+
+
. 119
1 0
𝑖 0
0 −1
Pd Palladium 𝑍 = 46, 𝐴𝑟 = 106.42. 2, 41, 60, 157, 160, 165, 171, 184, 186
plane wave a wave of parallel planes of constant frequency that are normal to the direction of propagation.
102
proof strength stress at which a material undergoes a permanent extension. 31
204

Glossary

Glossary

Pt Platinum 𝑍 = 78, 𝐴𝑟 = 195.08. 41
Pu Plutonium 𝑍 = 94, 𝐴𝑟 = 244. 3
Rad Rad (Rad) this is another measure for absorbed dose and 1 rad is equal to 100 ergs per gram (1 rad =
1.0cGy = 0.01Gy). 23
Rontgen Equivalent Man Rontgen Equivalent Man (REM) - equivalent/effective dose - 1 REM equivalent
is equal to 1𝑅𝑎𝑑 × 𝑊𝑟 (1cGy 1𝑅𝑎𝑑 × 𝑊𝑟 ) and 1 REM effective is equal to 1𝑅𝑎𝑑 × 𝑊𝑟 × 𝑊𝑡 (1cGy

1𝑅𝑎𝑑 × 𝑊𝑟 × 𝑊𝑡 ). 24

Ru Ruthenium 𝑍 = 44, 𝐴𝑟 = 101.07. 2, 41, 60, 157, 166, 171, 186, 197
Rutherford Rutherford (Rd) - 1.0 × 106 decays per second. 23
sensitization The precipitation of chromium rich carbides at the grain boundaries of stainless steel. 36, 37
Sievert Sievert (Sv) - equivalent/effective dose - this is the absorbed dose with radiation weighting (equivalent)
and tissue weighting (effective) factors applied 1𝑆𝑣(equivalent) = 1𝐽/𝑘𝑔×𝑊𝑟 and 1𝑆𝑣(effective) = 1𝐽/𝑘𝑔×
𝑊𝑟 × 𝑊𝑡 . 23
supercritical Above 374∘ 𝐶 (647K) and 22.1MPa water is no longer a distinct liquid or gas and it becomes
supercritical. 12
Tc Technetium 𝑍 = 42, 𝐴𝑟 = 96.91. 147
Th Thorium 𝑍 = 90, 𝐴𝑟 = 232.04. 12
U Uranium 𝑍 = 92, 𝐴𝑟 = 238.03. 2
ultimate tensile strength maximum stress the material can withstand. 31
valence electron outer shell electron that can form bonds. 109
W Tungsten 𝑍 = 74, 𝐴𝑟 = 183.84. 15
2

wave function contains all there is to know about a system and it’s meaning is given by a probability |Ψ| = 1.
97

Wigner-Seitz cell given a lattice point, the set of all points in space which are closer to that lattice point

that any other lattice point constitute the Wigner-Seitz cell[solidstatebasicswcs]
Young’s modulus measure of resistance to elastic deformation 𝛿 =
Zn Zinc 𝑍 = 30, 𝐴𝑟 = 65.38. 35
Zr Zirconium 𝑍 = 40, 𝐴𝑟 = 91.22. 8

205

stress
strain .

31, 70

. 102

Bibliography
[1]

D. W. Saxey et al. “Understanding Stress Corrosion Resistant Stainless Steels at the Atomic Scale”. In:
(2010).

[2]

World Nuclear. Advanced Nuclear Power Reactors. 2020. url: https://world-nuclear.org/informationlibrary/nuclear- fuel- cycle/nuclear- power- reactors/advanced- nuclear- power- reactors.
aspx.

[3]

Thomas W. Kerlin and Belle R. Upadhyaya. Dynamics and Control of Nuclear Reactors. Vol. 2. 2019.

[4]

H. Khartabil. Gen-4 Reactors. 2013. url: http : / / www . gen - 4 . org / GIF / About / documents / 25 Session2-3-Khartabil.pdf.

[5]

Financial Times. Cost of new Sizewell C Nuclear Plant. 2020. url: https://www.ft.com/content/
77c209f7-6d18-4609-ac3c-77d1b5b82b34.

[6]

Energy for Generations. ESB opens 820m Euro Carrington Power Station in Manchester. 2020. url:
https://www.esb.ie/tns/press-centre/2017/2017/03/13/esb-opens-820m-carrington-powerstation-in-manchester.

[7]

Our World In Data. Safest and Cleanest Sources of Energy. 2020. url: https://ourworldindata.org/
uploads/2020/10/What-is-the-safest-form-of-energy-2048x1129.png.

[8]

MIT Open Courseware. Engineering of Nuclear Systems - Lecture 6A. 2013. url: http://ocw.mit.edu/
courses/nuclear-engineering/22-06-engineering-of-nuclear-systems-fall-2010/lecturesand-readings/MIT22\%5F06F10\%5Flec06a.pdf.

[9]

Yuchen Dou, Hong Luo, and Jing Zhang. “Elastic Properties of FeCr20Ni8Xn (X = Mo, Nb, Ta, Ti, V,
W and Zr) Austenitic Stainless Steels: A First Principles Study”. In: Metals 9 (145 2019).

[10]

Philippe F Weck et al. Mechanical properties of zirconium alloys and zirconium hydrides predicted from
density functional perturbation theory. 2020. url: https://www.osti.gov/pages/servlets/purl/
1259850.

[11]

GenIV International Forum. Introduction to Generation IV Nuclear Energy Systems and the International
Forum. 2013. url: https://www.iea.org/topics/world-energy-outlook.

[12]
[13]

Wikipedia. Carnots theorem (thermodynamics). 2020. url: https://en.wikipedia.org/wiki/Carnot.
S. E. Jensen and E. Nonbol. Description of the Magnox Type of Gas Cooled Reactor (MAGNOX). 1998.
url: https://inis.iaea.org/collection/NCLCollectionStore/\%5FPublic/30/052/30052480.
pdf.

[14]

Wikipedia. Combined cycle power plant. 2020. url: https : / / en . wikipedia . org / wiki / Combined \
%5Fcycle\%5Fpower\%5Fplant.

[15]

World Nuclear. Uranium Enrichment. 2020. url: https://www.world- nuclear.org/informationlibrary/nuclear-fuel-cycle/conversion-enrichment-and-fabrication/uranium-enrichment.
aspx.

206

BIBLIOGRAPHY

[16]

BIBLIOGRAPHY

Los Alamos National Laboratory. Los Alamos National Laboratory Tour. 2013. url: http://t2.lanl.
gov/nis/tour/sch007.html.

[17]

GenIV International Forum. Very-High-Temperature Reactor (VHTR). 2020. url: https://www.gen4.org/gif/jcms/c\%5F9362/vhtr.

[18]

Sangeeta Deokattey et al. “Hydrogen production using high temperature reactors: an overview”. In:
Advances in Energy Research 1 (1 2013), pp. 013–033.

[19]

James A. Mahaffey. Atomic Accidents.

[20]

S Heidenreich, M Müller, and P. U. Foscolo. Advanced Biomass Gasification - New Concepts for Efficiency
Increase and Product Flexibility. 2016.

[21]

MIT Open Courseware. Engineering of Nuclear Systems - Lecture 6B. 2013. url: http://ocw.mit.edu/
courses/nuclear-engineering/22-06-engineering-of-nuclear-systems-fall-2010/lecturesand-readings/MIT22\%5F06F10\%5Flec06b.pdf.

[22]

V. Ignatiev and A. Surenkov. Corrosion phenomena induced by molten salts in Generation IV nuclear
reactors. 2017, p. 166.

[23]

A. Santamarina et al. The JEFF-3.1.1 Nuclear Data Library. 2009.

[24]

M. R. Gilbert, J. Marian, and J-Ch. Sublet. “Energy spectra of primary knock-on atoms under neutron
irradiation”. In: Journal of Nuclear Materials 467 (2015), pp. 121–134.

[25]

J. Fikar and R. Schaublin Ecole. “Molecular dynamics simulation of radiation damage in bcc tungsten”.
In: Journal of Nuclear Materials (101 2009), pp. 97–101.

[26]

Andrew F. Calder et al. “Computer simulation of cascade damage in a-iron with carbon in solution”. In:
Journal of Nuclear Materials (382 2008), pp. 91–95.

[27]

N J Carron. An Introduction to the Passage of Energetic Particles through Matter. 2007.

[28]

James Byrne. Neutrons, Nuclei & Matter. 2011, p. 161.

[29]

G. F. Knoll. Radiation Detection and Measurement Third Edition. 1999, pp. 53–54.

[30]

NIST. X-Ray Mass Attenuation Coefficients. 2022. url: https://physics.nist.gov/PhysRefData/
XrayMassCoef/tab3.html.

[31]

J R Greening. Fundamentals of Radiation Dosimetry. 1985.

[32]

UK Health Security Agency. Comparison of doses from sources of exposure. 2020. url: https : / /
www . gov . uk / government / publications / ionising - radiation - dose - comparisons / ionising radiation-dose-comparisons.

[33]

Centers for Disease Control and Prevention. Acute Radiation Syndrome: A Fact Sheet for Clinicians.
2020. url: https://www.cdc.gov/nceh/radiation/emergencies/arsphysicianfactsheet.htm.

[34]

UK Statutory Instrument. The Ionising Radiations Regulations 2017. 2017. url: https://www.legislation.
gov.uk/uksi/2017/1075/schedule/3.

[35]

J. Rodenas and G. Verdu. “Analysis of nuclear reactions to determine the radionuclides generated and
its activity in various devices”. In: Radiation Physics and Chemistry 167 (2020), pp. 1–6.

[36]

H. Sheng. EAM Potentials. 2012. url: https://sites.google.com/site/eampotentials.

[37]

G. S. Was. Fundamentals of Radiation Materials Science. 2007.

[38]

R. E. Stoller. “Primary Damage Formation in Irradiated Materials”. In: Journal of Metals 48 (12 1996),
pp. 23–27.

[39]

Jian wei Su and Dong ping Huang. “Phase equilibria of the Fe–Cr–Ni ternary systems and interfacialreactions in Fe–Cr alloys with Ni substrate”. In: Journal of Alloys and Compounds 457 (2008), pp. 270–
278.
207

BIBLIOGRAPHY

[40]

BIBLIOGRAPHY

S. Choudhury a et al. “Ab-initio based modelling of diffusion in dilute bcc Fe–Ni and Fe–Cr alloys and
implications for radiation induced segregation”. In: Journal of Materials 411 (2011), pp. 1–14.

[41]

G. S. Was. Fundamentals of Radiation Materials Science. 2007, p. 140.

[42]

J. L. Seran and M. Le Flem. Irradiation-resistant Austenitic Steels as Core Materials for Generation IV
Nuclear Reactors. 2017, pp. 285–328.

[43]

T.R. Allen and J.T. Busby. “Radiation damage concerns for extended light water Reactor service”. In:
Journal of Materials 61 (2009), pp. 29–34.

[44]

Gary S. Was and Shigeharu Ukai. Austenitic Stainless Steels. 2019.

[45]

T.R. Allen et al. “Swelling and radiation-induced segregation in austentic alloys”. In: Journal of Nuclear
Materials 342 (2005), pp. 90–100.

[46]

T. R. Allen, J. I. Cole, and E. A. Kenik. Radiation-Induced Segregation and Void Swelling in 304 Stainless
Steel. 2000. url: https://www.osti.gov/servlets/purl/757550.

[47]

M. Krcmar et al. “Diffusion rates of 3d transition metal solutes in nickel by first-principles calculations”.
In: Acta Materialia 53 (2005), pp. 2369–2376.

[48]

IAEA Geir Meyer and Egil Stokke. Description of Sizewell B Nuclear Power Plant. 2019. url: https:
//inis.iaea.org/collection/NCLCollectionStore/\%5FPublic/29/010/29010110.pdf.

[49]
[50]

G. S. Was. Fundamentals of Radiation Materials Science. 2007, p. 183.
B. Kombaiah et al. “Mechanisms of radiation-induced segregation around He bubbles in a Fe-Cr-Ni
crystal”. In: Journal of Nuclear Materials 11 (2018).

[51]

W G Johnston, W G Morris, and A M Turkalo. “Proc. Int. Con. on Radiation Effects in Breeder Reacror
Structural Materials”. In: Metall. Soc. AIME (1977), p. 421.

[52]

A D Marwick. “Segregation in irradiated alloys: The Inverse Kirkendall Effect and the effect of constitution on void swelling”. In: J. Phys. F: Met. Phys 8 (1978), pp. 1849–1862.

[53]

P. R. Okamoto and L. E. Rehn. “RADIATION-INDUCED SEGREGATION IN BINARY AND TERNARY
ALLOYS”. In: Journal of Nuclear Materials 83 (1979), pp. 2–23.

[54]

Jeremy L. Gilber. Metals - Basic Principles.

[55]

R. Kirchheim et al. “Compositional Changes of Passive Films Due To Different Transport Rates and
Preferential Dissolution”. In: Corrosion Science 31 (1990), pp. 573–578.

[56]

R. Kirchheim et al. “The Passivity of Iron-Chromium Alloys”. In: Corrosion Science 29 (7 1989), pp. 899–
917.

[57]

P. J. Maziasz and M. Le Flem. Properties of Austenitic Steels for Nuclear Reactor Applications. Vol. 2.
2012, pp. 303–318.

[58]

Rolled Alloys. What is alloy sensitization? 2020. url: https://www.rolledalloys.com/dotAsset/
50dc766c-08f5-43d9-bbda-5d9a9a2fa6d5.jpg.

[59]

Speciality Steel Industry of North America. Intergranular Corrosion. 2020. url: https://www.ssina.
com/education/corrosion/intergranular-corrosion/.

[60]

S. Lyon. Corrosion of Molybdenum and its Alloys. 2010. url: https : / / www . researchgate . net /
publication/287308921\%5FCorrosion\%5Fof\%5FMolybdenum\%5Fand\%5Fits\%5FAlloys.

[61]

V. Maurice et al. “Effects of molybdenum on the composition and nanoscale morphology of passivated
austenitic stainless steel surfaces”. In: Faraday Discussions 180 (2015), pp. 151–170.

[62]

G. S. Was. Fundamentals of Radiation Materials Science. 2007, p. 765.

[63]

Edward Kenik, R H Jones, and G E C Bell. “Irradiation-assisted stress corrosion cracking”. In: Journal
of Nuclear Materials (212-215 1994), pp. 52–59.
208

BIBLIOGRAPHY

[64]

BIBLIOGRAPHY

Sophie Le Caër. Water Radiolysis: Influence of Oxide Surfaces on H2 Production under Ionizing Radiation. 2011. url: https://www.mdpi.com/2073-4441/3/1/235.

[65]

R.W. Staehle. Historical views on stress corrosion cracking of nickel-based alloys: the Coriou effect. 2016.

[66]

United States Nuclear Regulatory Commission. AP1000 Design Control Document. 2020. url: https:
//www.nrc.gov/docs/ML1117/ML11171A447.pdf.

[67]

P. N. Standring. The Long Term Storage of Advanced Gas-Cooled Reactor Fuel. url: https://inis.
iaea.org/collection/NCLCollectionStore/\%5FPublic/30/040/30040095.pdf.

[68]

Guy O.H. Whillock et al. “Investigation of thermally sensitised stainless steels as analogues for spent
AGR fuel cladding to test a corrosion inhibitor for intergranular stress corrosion cracking”. In: Journal
of Nuclear Materials journal (498 2018), pp. 187–198.

[69]

IAEA. Status report 81 - Advanced Passive PWR (AP 1000). 2020. url: https://aris.iaea.org/PDF/
AP1000.pdf.

[70]

Framatome ANP and Inc. EPR Design Description. 2020. url: https://www.nrc.gov/docs/ML0522/
ML052280170.pdf.

[71]

F. Dalle et al. Conventional austenitic steels as out-of-core materials for Generation IV nuclear reactors.

[72]

Pascal V. Grundler and Stefan Ritter. “Nobel Metal Chemical Addition for Mitigation of Stress Corrosion
Cracking: Theoretical Insights and Applications”. In: PPChem (2014), pp. 76–93.

[73]

J. H. Potgieter and A. Van Benekom. “The effect of varying ruthenium content on the corrosion behavior
of two cathodically modified superferritic stainless steels”. In: Canadian Metallurgical Quarterly 34 (2
1994), pp. 143–146.

[74]

IAEA Department of Nuclear Sciences and Applications. Directory of Cyclotrons used for Radionuclide
Production in Member States. 2006. url: http://www- naweb.iaea.org/napc/iachem/cyclotrons/
PDF/DCRP.pdf.

[75]

Diamond. About Synchrotrons. 2020. url: https://www.diamond.ac.uk/Home/About/FAQs/AboutSynchrotrons.html.

[76]

World Nuclear. World Nuclear Research Reactors. 2018. url: http : / / www . world - nuclear . org /
information- library/non- power- nuclear- applications/radioisotopes- research/researchreactors.aspx.

[77]

IAEA. Nepture Reactor. 2018. url: https://nucleus.iaea.org/RRDB/RR/ReactorSearch.aspx.

[78]

ORNL. High Flux Isotope Reactor User Guide. 2018. url: https : / / neutrons . ornl . gov / sites /
default/files/HighFluxIsotopeReactorUserGuide2.0.pdf.

[79]

ORNL. High Flux Isotope Reactor Parameters. 2018. url: https : / / neutrons . ornl . gov / hfir /
parameters.

[80]

ORNL. High Flux Isotope Reactor (HFIR) USER GUIDE. 2015. url: https://neutrons.ornl.gov/
sites/default/files/High\%20Flux\%20Isotope\%20Reactor\%20User\%20Guide\%202.0.pdf.

[81]

John J. Rush and Ronald L. Cappelletti. The NIST Center for Neutron Research: Over 40 Years Serving NIST/NBS and the Nation. 2015. url: https://www.ncnr.nist.gov/NCNRHistory\%5FRush\
%5FCappelletti.pdf.

[82]

ISIS. How ISIS works - In Depth. 2020. url: https://www.isis.stfc.ac.uk/Pages/How- ISISworks--in-depth.aspx.

[83]

ORNL E. B. Iverson. Neutron Moderation. 2016. url: https : / / conference . sns . gov / event / 56 /
attachments/64/99/Lecture\%5F2a\%5F-\%5FNeutron\%5FModeration\%5F-\%5FErik\%5FIverson.
pdf.

209

BIBLIOGRAPHY

[84]

BIBLIOGRAPHY

M. N. H. Comsan. Spallation Neutron Sources for Science and Technology. 2011. url: https://inis.
iaea.org/collection/NCLCollectionStore/\%5FPublic/43/099/43099436.pdf.

[85]

R. B. Leachman. Peaceful Uses of Atomic Energy. Vol. 2. 1956, p. 193.

[86]

Hyperphysics. Calculation of Coulomb Barrier. 2022. url: http://hyperphysics.phy-astr.gsu.edu/
hbase/NucEne/coubar.html.

[87]

Hyperphysics. Nuclear Size and Density. 2022. url: http://http://hyperphysics.phy- astr.gsu.
edu/hbase/Nuclear/nucuni.html\#c4.

[88]

V.V. Zerkin and B. Pritychenko. “The experimental nuclear reaction data (EXFOR): Extended computer
database and Web retrieval system”. In: Nuclear Inst. and Methods in Physics Research, A 888 (2018),
pp. 31–43.

[89]

Shigeo Tanaka and Michiaki Furukawa. “Excitation Functions for (p,n) Reactions with Titanium, Vanadium, Chromium, Iron and Nickel up to Ep”. In: Journal of the Physical Society of Japan 14 (10 1959),
pp. 1269–1275.

[90]

M. S. Livingston and H. A. Bethe. “Nuclear Physics C. Nuclear Dynamics, Experimental”. In: Physical
Review 9 (3 1937), pp. 245–398.

[91]

J. Wing and J. R. Huizenga. “(p,n) Cross Sections of V51, Cr52, Cu63, Cu65, Ag107, Ag109, Cd111,
Cd112 and La139 from 5 to 10.5MeV”. In: Physical Review 128 (1 1962), pp. 280–290.

[92]

E. Gadioli et al. “Excitation Functions of V51, Fe56, 65Cu (p,n) Reactions Between 10 and 45 MeV”.
In: Il Nuovo Cimento 22 (4 1974), pp. 547–558.

[93]

P E Hodgson. “The Nuclear Optical Model”. In: Rep. Prog. Phys. 34 (1971), pp. 765–819.

[94]

A Koning, S Hilaire, and S Goriely. TALYS 1.95 A Nuclear Reaction Program. 2019.

[95]

NEA. Janis Book. 2020. url: https://tendl.web.psi.ch/tendl\%5F2019/other/book-protons.pdf.

[96]

NEA. Exfor reaction cross section website. 2020. url: https://www-nds.iaea.org/exfor/.

[97]

J. F. Ziegler, J. P. Biersack, and M. D. Ziegler. The Stopping and Range of Ions in Matter. 2015.

[98]

James F. Ziegler, M. D. Ziegler, and J. P. Biersack. “SRIM - The stopping and range of ions in matter”.
In: Nuclear Instruments and Methods in Physics Research Section B 268 (2010), pp. 1818–1823.

[99]

Roger Rousseau, Vassiliki-Alexandra Glezakou, and Annabella Selloni. “Theoretical insights into the
surface physics and chemistry of redox-active oxides”. In: Nature Reviews Materials (5 2020), pp. 460–
475. url: https://www.nature.com/articles/s41578-020-0198-9?proof.

[100]

F. D. Murnaghan. “The Compressibility of Media Under Extreme Pressures”. In: (1944).

[101]

A. Mahmoud ad A. Erba. Crystal: Equation of State. 2019. url: http://tutorials.crystalsolutions.
eu/tutorial.html?td.

[102]

F. Birch. “Finite elastic strain of cubic crystals”. In: Physical Review 71 (11 1947), pp. 809–824.

[103]

gilgamesh. Fitting Birch-Murnaghan. 2013. url: http://gilgamesh.cheme.cmu.edu/doc/software/
jacapo/appendices/appendix-eos.html.

[104]

M. J. Mehl, D. J. Singh, and D. A. Papaconstantopoulos. “Properties of ordered intermetallic alloys:
first-principles and approximate methods”. In: Materials Science and Engineering (1993), pp. 49–57.

[105]

Pascal Vinet et al. “Universal features of the equation of state of solids”. In: Journal of Physics Condensed
Matter 1 (1989), pp. 1941–1963.

[106]

B Jelinek et al. “Modified embedded atom method potential for Al, Si, Mg, Cu, and Fe alloys”. In:
Physical Review B 84 (24 2012), pp. 1–18.

[107]

G. Bonny, R. C. Pasianot, and L. Malerba. “Interatomic potentials for alloys: Fitting concentration
dependent properties”. In: Philosophical Magazine 89 (8 2009), pp. 711–725.
210

BIBLIOGRAPHY

[108]

BIBLIOGRAPHY

Michael J. Mehl. “Pressure depenence of the elastic moduli in aluminium-rich Al-Li compounds”. In:
Physical Review B 47 (5 1993), pp. 2493–2500.

[109]

P. Ravindran et al. “Density functional theory for calculation of elastic properties of orthorhombic crystals
applications to TiSi2”. In: Journal of Applied Physics 84 (9 1998), pp. 4891–4904.

[110]

M. J. Mehl, B. M. Klein, and D. A. Papaconstantopoulos. First Principles Calculations of Elastic Properties of Metals. 1994.

[111]

B B Karki, G J Ackland, and J Crain. Elastic instabilities in crystals from ab initio stress–strain relations.
2013. url: http://www.homepages.ed.ac.uk/gja/karki1.pdf.

[112]

G. Ghosh. “A first-principles study of cementite (Fe3C) and its alloyed counterparts: Elastic constants,
elastic anisotropies, and isotropic elastic moduli”. In: AIP Advances 5 (2015).

[113]

M. E. Fine, L. D. Brown, and H. L. Marcus. “Elastic Constants Versus Melting Temperature in Metals”.
In: Scripta Metallurgica 18 (1984), pp. 951–956.

[114]

M. W. Finnis and J. E. Sinclair. “A simple empirical N-body potential for transition metals”. In: Philosophical Magazine A 50 (1984).

[115]

Murray S. Daw and M. I. Baskes. “Embedded-atom method: Derivation and application to impurities,
surfaces and other defects in metals”. In: Physical Review B 29 (12 1983).

[116]

Graeme J. Ackland. “Two-band second moment model for transition metals and alloys”. In: Condensed
Materials (2005).

[117]

P. Olsson et al. “Two-band modelling of alpha prime phase formation in Fe-Cr”. In: Physical Review B
72 (2005).

[118]

G. Bonny et al. “Iron chromium potential to model high-chromium ferritic alloys”. In: Philosophical
Magazine 91 (April 2011), pp. 1724–1746.

[119]

Byeong-Joo Lee, Jae-Hyeok Shim, and M. I. Baskes. “Semiempirical atomic potentials for the fcc metals
Cu, Ag, Au, Ni, Pd, Pt, Al, and Pb based on first and second nearest-neighbor modified embedded atom
method”. In: Physical Review B 68 (2003).

[120]

J. Fikar and R. Schäublin. “Molecular dynamics simulation of radiation damage in bcc tungsten”. In:
Journal of Nuclear Materials 386-388 (C 2009), pp. 97–101.

[121]

Y. Mishin. “Atomistic modeling of the gamma and gamma prime phases of the Ni-Al system”. In: Acta
Materialia 52 (2004), pp. 1451–1467.

[122]

M. I. Mendelev et al. “Development of new interatomic potentials appropriate for crystalline and liquid
iron”. In: Philosophical Magazine 83 (2003), pp. 3977–3994.

[123]

G. Bonny, A. Bakaev, and D. Terentyev. “Interatomic potential to study plastic deformation in tungstenrhenium alloys”. In: Journal of Applied Physics 121 (165107 2017), pp. 1–13.

[124]

Jorge Nocedal and Stephen J. Wright. Numerical Optimization. 2006, p. 449.

[125]

F. Ercolessi and J. B. Adams. “Interatomic Potentials from First-Principles Calculations: the ForceMatching Method”. In: Europhys. Lett. 26 (8 1994), pp. 583–588.

[126]

G. Bonny and L. Malerba. “Overview of Interatomic Potentials”. In: SCK CEB Open Report (2005).

[127]

Hector Balboa et al. “Damage characterization of (U,Pu)O2 under irradiation by molecular dynamics
simulations”. In: Journal of Nuclear Materials 512 (2018), pp. 440–449.

[128]

K. A. Nekrasov and. “Sputtering of material from the surface of PuO2 crystals by collision cascades
impact. A molecular dynamics study”. In: Journal of Nuclear Materials 512 (2018), pp. 440–449.

[129]

“Defect production due to displacement cascades in metals as revealed by computer simulation”. In:
Journal of Nuclear Materials 251 (1997), pp. 1–12.

211

BIBLIOGRAPHY

[130]

BIBLIOGRAPHY

K. Trachenko et al. “Modeling high-energy radiation damage in nuclear and fusion applications”. In:
Nuclear Instruments and Methods in Physics Research B 277 (2012), pp. 6–13.

[131]

I.T.Todorov and W. Smith. The DL POLY 4 User Manual. 2016.

[132] LAMMPS - Partitioning. url: https://docs.lammps.org/Developer_par_part.html.
[133]

Wikipedia. Virial Stress. 2016. url: https://en.wikipedia.org/wiki/Virial\%5Fstress.

[134]

Derek J Hepburn and Graeme J Ackland. “Metallic-covalent interatomic potential for carbon in iron”.
In: Physical Review B 78 (165115 2008), pp. 1–6.

[135]

P. Brommer and F. Gähler. “Potfit: effective potentials from ab initio data”. In: Modelling Simul. Mater.
Sci. Eng. 15 (2007), pp. 295–304.

[136]

H. W. Sheng et al. “Highly Optimized Embedded-Atom-Method Potentials for Fourteen FCC Metals”.
In: Europhys. Lett. 26 (8 1994), pp. 583–588.

[137]

D. Connetable and O. Thomas. “First-principles study of the structural, electronic, vibrational and
elastic properties of orthorhombic NiSi”. In: Physical Review B 79 (2009).

[138]

Materials. Microstructure and Mechanical Properties of. 2019. url: https : / / www . mdpi . com / 1996 1944/12/2/290/pdf\#:~:text.

[139]

Steven H. Simon. Solid State Basics. 2013.

[140]

MIT. Physics for Solid State Applications. 2004. url: http : / / web . mit . edu / 6 . 730 / www / ST04 /
Lectures/Lecture7.pdf.

[141]

Harry Jones. The Theory of Brillouin Zones and Electronic States in Crystals. 1960, p. 48.

[142]

P. Hohenberg and W. Kohn. “Inhomogeneous Electron Gas”. In: Physical Review 136 (1964).

[143]

Robert van Leeuwen. Introduction to density-functional theory. 2020. url: http : / / users . jyu . fi /
~roleeuwe/DFTLectureNotes.pdf.

[144]

W. Kohn and L. J. Sham. “Self-Consistent Equations Including Exchange and Correlation Effects”. In:
Physical Review 140 (1965).

[145]
[146]

SISSA. ABC of DFT. 2020. url: https://people.sissa.it/~degironc/ES/lectures/ABCofDFT.pdf.
J. F. Annett. “Efficiency of algorithms for Kohn-Sham density functional theory”. In: Computational
Materials Science 4 (1995), pp. 23–42.

[147]

G. Kresse and J. Furthmüller. “Efficient iterative schemes for ab initio total-energy calculations using a
plane-wave basis set”. In: Physical Review B 54 (16 1996).

[148]

D. Raczkowski, A. Canning, and L. W. Wang. “Thomas Fermi charge mixing for obtaining self consistency
in DF calculations”. In: Physical Review B 64 (2001).

[149]

D. D. Johnson. “Modified Broydens method for accelerating convergence in self-consistent calculations”.
In: Physical Review B 38 (18 1988).

[150]

P. Ziesche, S. Jurth, and J. P. Perdew. “Density functionals from LDA to GGA”. In: Computational
Materials Science 11 11 (1998), pp. 122–127.

[151]

M. C. Payne et al. “Iterative minimization techniques for ab initio total-energy calculations: molecular
dynamics and conjugate gradients”. In: REVIEWS OF MODERN PHYSICS 64 (1992).

[152]

Annabella Selloni. The plane wave-pseudopotential method (basic aspects). 2009. url: https://th.fhiberlin . mpg . de / th / Meetings / DFT - workshop - Berlin2009 / Talks / OnlinePublication / 0624 - 2 \
%5F20090623-1\%5FSelloni\%5FFINAL\%5F2perA4\%5F-\%5FSelloni-Berlin2.pdf.

[153]

V.P. Gupta. PRINCIPLES AND APPLICATIONS OF QUANTUM CHEMISTRY - Density Functional
Theory (DFT) and Time Dependent DFT (TDDFT). 2016, p. 169.

212

BIBLIOGRAPHY

[154]

BIBLIOGRAPHY

John P Perdew, Kieron Burke, and Matthias Ernzerhof. “Generalized Gradient Approximation Made
Simple”. In: Physical Review Letters 77 (18 1996), pp. 3865–3868.

[155]

John P Perdew. “Generalized Gradient Approximations for exchange and correlation: A look backward
and forward”. In: Physica B 172 (1991), pp. 1–6.

[156]

M R Benam, N Abdoshahi, and M Majidiyan Sarmazdeh. “Ab initio study of the effect of pressure on
the structural and electronic properties of cubic LaAl03 byt density function theory using GGA, LDA
and PBESOL exchange correlation potentials”. In: Physica B 446 (2014), pp. 32–38.

[157]

periodictable.com. Sodium: periodictable.com. 2020. url: https://periodictable.com/Elements/011/
data.html.

[158]

periodictable.com. Aluminium: periodictable.com. 2020. url: https://periodictable.com/Elements/
013/data.html.

[159]

P Giannozzi et al. “Quantum Espresso”. In: J Phys Condens Matter 29 (2017).

[160]

University of Illinois. Density functional theory calculation of elastic constants. 2020. url: https://
courses.physics.illinois.edu/mse404ela/sp2018/Project2-DFT.html.

[161]

Alessandro Genova and Michele Pavanello. “Exploiting the Locality of Periodic Subsystem DensityFunctional Theory: Efficient Sampling of the Brillouin Zone”. In: J. Phys.: Condens. Matter 27 (2015),
pp. 495–501. url: https://iopscience.iop.org/article/10.1088/0953- 8984/27/49/495501/
ampdf.

[162]

N. Marzari. Ab-initio Molecular Dynamics for Metallic Systems. 1996, p. 77.

[163]

Hyperphysics. Electron band gap diagram for insulators, semiconductors and conductors. 2020. url:
http://hyperphysics.phy-astr.gsu.edu/hbase/Solids/band.html.

[164]

University of Cambridge. Dissemination of IT for the Promotion of Materials Science. 2020. url: https:
//www.doitpoms.ac.uk/tlplib/semiconductors/fermi.php.

[165]

M. Methfessel and A. T. Paxton. “High-precision sampling for Brillouin-zone integration in metals”. In:
Physical Review B 40 (6 1989), pp. 3616–3621.

[166]

N. Marzari. Ab-initio Molecular Dynamics for Metallic Systems. 1996, p. 136.

[167]

Steven H. Simon. Solid State Basics. 2013, p. 213.

[168]

U Von Barth and L Hedin. “A local exchange-correlation potential for the spin polarized case”. In:
Journal of Physics C Solid State Physics 5 (1972).

[169]

Edward A. Pluhar III and Carsten A. Ullrich. “Exchange-correlation magnetic fields in spin-densityfunctional theory”. In: Physical Review B 100 (12-15 September 2019 2019).

[170]

Gustav Bihlmayer. Magnetism in Density Functional Theory. 2020. url: http://citeseerx.ist.psu.
edu/viewdoc/download?doi=10.1.1.563.8752&rep=rep1&type=pdf.

[171]

H. Stehfest. “Algorithm 368 Numerical Inversion of Laplace Transform”. In: Communications of the
ACM 13 (1970), pp. 47–49.

[172]

J. Ziegler. The Stopping and Range of Ions in Matter. 2019. url: http : / / www . srim . org / SRIM /
SRIMINTRO.htm.

[173]

A.J. Koning and D. Rochman. “TENDL: Comprehensive Nuclear Data Library with Covariances”. In:
(2010).

[174]

A.J. Koning, D. Rochman, and J. Sublet. “TENDL: Comprehensive Nuclear Data Library with Covariances”. In: (2017).

[175]

A.J. Koning et al. “TENDL: Complete Nuclear Data Library for Innovative Nuclear Science and Technology”. In: Nuclear Data Sheets 155 (2019).

213

BIBLIOGRAPHY

[176]

BIBLIOGRAPHY

M.C.Lagunas-Solar and J.A.Jungerman. “Cyclotron production of carrier-free cobalt-55.a new positronemitting label for bleomycin”. In: Applied Radiation and Isotopes 30 (1979), p. 25.

[177]

D. Rochman and A. J. Koning. “Modern Nuclear Data Evaluation With The TALYS Code System”. In:
Nuclear Data Sheets 113 (2012).

[178]

J. Hewett. Use of the University of Birmingham’s Scanditronix MC40 Cyclotron for Materials Irradiation
Damage Studies. 2011.

[179]

E. Lamere et al. “Proton-induced reactions on molybdenum”. In: Physical Review, Part C, Nuclear
Physics 100 (2019), p. 034614.

[180]

D.S.Flynn, R.L.Hershberger, and F.Gabbard. “Sub-Coulomb proton absorption for isotopes of zirconium
and molybdenum”. In: Physical Review, Part C, Nuclear Physics 20 (5 1979), p. 1700.

[181]

J.J.Hogan. “Mo-96(P,XN)Reaction from 10 to 80 MeV”. In: Physical Review, Part C, Nuclear Physics
6 (1972), p. 810.

[182]

V.N.Levkovski. “Mo-96(P,XN)Reaction from 10 to 80 MeV”. In: Soviet Atomic Energy 69 (1990), p. 773.

[183]

webelements.com. Webelements: Aluminium. 2020. url: https://www.webelements.com/aluminium.

[184]

webelements.com. Webelements: Iron. 2020. url: https://www.webelements.com/iron.

[185]

webelements.com. Webelements: Nickel. 2020. url: https://www.webelements.com/nickel.

[186]

webelements.com. Webelements: Ruthenium. 2020. url: https://www.webelements.com/ruthenium.

[187]

webelements.com. Webelements: Palladium. 2020. url: https://www.webelements.com/palladium.

[188]

N. Marzari et al. “Thermal Contraction and Disordering of the Al(110) Surface Nicola”. In: Condensed
Matter (110 2008), pp. 4–7.

[189]

A. L. Okana-Lomanga et al. “Adsorption of Br2 molecule on the Fe W(110) substrate - Energetics,
electronic and magnetic properties”. In: Computational Condensed Matter 23 (2020).

[190]

A. E. Rezaee and M. Almasi-Kashi. “The influence of point defects on Na diffusion in black phosphorene
- first principles study”. In: Journal Pre-proof ().

[191]

N. Acharya and S. P. Sanyal. “Structural phase transition, electronic and superconducting properties of
ScBi and YBi”. In: Solid State Communications 266 (2017), pp. 39–45.

[192]

A. Choudhary, L. Malakkal, and R. K. Siripurapu. “First principles calculations of hydrogen storage on
Cu and Pd-decorated graphene”. In: International Journal of Hydrogen Energy 41 (2016), pp. 17652–
17656.

[193]

O. E. Osafile, P. O. Adebambo, and G. A. Adebayo. “Elastic constants and observed ferromagnetism in
inverse Heusler alloy Ti2CoAs using kjpaw pseudopotentials - A first-principles approach”. In: Journal
of Alloys and Compounds 722 (2017), pp. 207–211.

[194]

Quantum Espresso. QE Forum. 2022. url: https://lists.quantum-espresso.org/.

[195] Materials Square Single Atom Calculations.
[196] Harwell VA08 Minimizer. url: https://www.hsl.rl.ac.uk/archive/specs/va08.pdf.
[197]

Christopher O’Brien. Formatting EAM Potentials. 2021. url: https://sites.google.com/a/ncsu.
edu/cjobrien/tutorials-and-guides/eam.

[198]

Andrea Fortini, Mikhail I Mendelev, and Sergey Buldyrev et al. “Asperity contacts at the nanoscale:
Comparison of Ru and Au”. In: J. Appl. Phys. 104 (074320 2008), pp. 1–9.

[199]

MIT. Constitutive Equations. 2020. url: http://web.mit.edu/16.20/homepage/3_Constitutive/
Constitutive_files/module_3_with_solutions.pdf.

[200]

S. Kirkpatrick, C. D. Gelatt Jr, and M. P. Vecchi. “Optimization by Simulated Annealing”. In: Science
220 (4598 1983), pp. 671–680.
214

BIBLIOGRAPHY

[201]

BIBLIOGRAPHY

David J. Wales and Jonathan P. K. Doye. “Global Optimization by Basin-Hopping and the Lowest
Energy Structures of Lennard-Jones Clusters Containing up to 110 Atoms”. In: J. Phys. Chem. A 1997
101 (1997), pp. 5111–5116.

[202] SciPy Basin Hopping Algorithm.
[203]

Jonathan Richard Shewchuk. An Introduction to the Conjugate Gradient Method Without the Agonizing
Pain Edition 1.25. 1994. url: https :/ / www . cs. cmu . edu/ ~quake - papers/ painless - conjugategradient.pdf.

215

Chapter 10

Acknowledgements
Thank you to Brian, Mark and Alessandro for your supervision and support, to my wife Rachel, son Zakk,
parents and my family for encouragement. The various forums in the scientific community, in particular useful
discussions with Dr. Todorov of Daresbury and members of the Quantum Espresso forum, have been helpful
throughout. I should also thank two teachers from my school days, Mr. George and Mr. Rockett, for their
encouragement in the sciences (especially Physics).
The computations described in this work were performed using the University of Birmingham’s BlueBEAR
HPC service, which provides a High Performance Computing service to the University’s research community.
See http://www.birmingham.ac.uk/bear for more details.

216

Appendices

217

Appendix A

Useful Laplace Transforms
A.1

Table of Transforms
𝑓 (𝑡) = ℒ−1 {𝐹 (𝑠)}
𝑓 (𝑡)
𝑓 ′ (𝑡)
𝑎
exp(−𝑎𝑡)
𝑎 exp(−𝑏𝑡)
1
[1
− exp(−𝑎𝑡)]
𝑎
𝑎
𝑏 [1 − exp(−𝑏𝑡)]

𝐹 (𝑠) = ℒ {𝑓 (𝑡)}
𝐹 (𝑠)
𝑠𝐹 (𝑠) − 𝑓 (0)
𝑎
𝑠
1
𝑠+𝑎
𝑎
𝑠+𝑏
𝑎
𝑠(𝑠+𝑎)
𝑎
𝑠(𝑠+𝑏)

Table A.1: Useful Laplace transforms

A.2

Decay with a Source Term

Set up the equation:

𝑑𝑁 (𝑡)
= 𝜔 − 𝜆𝑁 (𝑡)
𝑑𝑡

(A.1)

Transform:

ℒ

{︂

𝑑𝑁 (𝑡)
𝑑𝑡

}︂

= 𝑠𝐹 (𝑠) − 𝑁0

ℒ {𝜔 − 𝜆𝑁 (𝑡)} =
Rearrange to make 𝑁 (𝑠) the subject:

218

𝜔
− 𝜆𝑁 (𝑠)
𝑠

(A.2)

APPENDIX A. USEFUL LAPLACE TRANSFORMS

A.2. DECAY WITH A SOURCE TERM

𝜔
− 𝜆𝑁 (𝑠)
𝑠
𝜔
(𝑠 + 𝜆)𝑁 (𝑠) = + 𝑁0
𝑠
𝜔
𝑁0
𝑁 (𝑠) =
+
𝑠(𝑠 + 𝜆) (𝑠 + 𝜆)
𝑠𝑁 (𝑠) − 𝑁0 =

(A.3)

Inverse transform:

ℒ−1

{︂

}︂

ℒ−1 {𝑁 (𝑠)} = 𝑁 (𝑡)

𝜔
𝜔
= (1 − exp(−𝜆𝑡))
𝑠(𝑠 + 𝜆)
𝜆
{︂
}︂
𝑁0
ℒ−1
= 𝑁0 exp(−𝜆𝑡)
𝑠+𝜆

(A.4)

Simplify:

𝑁 (𝑡) =

𝜔
(1 − exp(−𝜆𝑡)) + 𝑁0 exp(−𝜆𝑡)
𝜆
𝜔 (︁
𝜔 )︁
𝑁 (𝑡) = + 𝑁0 −
exp(−𝜆𝑡)
𝜆
𝜆

219

(A.5)

Appendix B

Activity Equation in Python: decay
class
B.1

Full Source Code

The full source code is available to download from github.
https://github.com/BenPalmer1983/atomic dictionaries
https://github.com/BenPalmer1983/decay

B.2

Highlighted Code

The code below is taken from the decay class and it is specifically responsible for calculating the amount of
isotopes in the decay chain at some time t.
Listing B.1: Decay python3 class for calculating the amount of an isotope in a decay chain at time t
1
2
3
4
5
6
7

import os
import numpy
from pz import pz
from isotopes import isotopes
import matplotlib.pyplot as plt
import copy
import hashlib

8
9

class decay:

10
11
12

path_isotopes = "../data/isotopes.pz"
loaded = False

13
14
15
16
17
18

@staticmethod
def set(path_isotopes):
decay.path_isotopes = path_isotopes
isotopes.set(path_isotopes)
decay.load()

19
20
21
22
23

@staticmethod
def load():
if(decay.loaded == False):
decay.loaded = True

220

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40

@staticmethod
def chain_isotopes(key, out=[]):
if(not isotopes.is_valid(key)):
return out
if(key not in out):
out.append(key)
else:
return out
if(isotopes.is_stable(key)):
return out
else:
dm = isotopes.get_decay_modes(key)
for k in dm.keys():
decay.chain_isotopes(k, out)
return out

41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62

@staticmethod
def make_chain(key, l=0, out=[], bf=0.0):
if(not isotopes.is_valid(key)):
return out
if(l == 0):
decay.chains_store = []
out.append([l, key, bf])
if(isotopes.is_stable(key)):
if(len(out) > 1):
for i in range(len(out)-1,1,-1):
if(out[i-1][0]>=out[i][0]):
out.pop(out[i-1][0])
return decay.chains_store.append(copy.deepcopy(out))
else:
l = l + 1
dms = isotopes.get_decay_modes(key)
for k in dms.keys():
bf = dms[k][’branching_factor’]
decay.make_chain(k, l, out, bf)
return out

63
64
65

@staticmethod
def calculate(parent, time, i_data_in, log=None, custom_chain=None):

66
67
68
69
70

if(log != None):
log_dir = decay.get_file_dir(log)
print(log_dir)
decay.make_dir(log_dir)

71
72
73
74
75
76
77

decay.results = {
’tally’: {},
’unique’: None,
’chains’: None,
}
decay.chains_store = None

78
79
80
81
82
83
84

if(custom_chain == None):
decay.chains_store = []
decay.make_chain(parent, 0, [])
decay.results[’chains’] = []
cn = 0
for chain in decay.chains_store:

221

B.2. HIGHLIGHTED CODE

B.2. HIGHLIGHTED CODE

85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

decay.results[’chains’].append([])
for iso in chain:
k = iso[1]
bf = iso[2]
i_data = isotopes.get(k)
half_life = None
decay_constant = None
n0 = 0.0
w = 0.0
if(not i_data[’stable’]):
half_life = i_data[’half_life’]
decay_constant = i_data[’decay_constant’]
if(k in i_data_in.keys()):
n0 = i_data_in[k][’n0’]
w = i_data_in[k][’w’]
d = {
’isotope_key’: k,
’bf’: bf,
’w’: w,
’n0’: n0,
’nend’: 0,
’half_life’: half_life,
’decay_constant’: decay_constant,
}
decay.results[’chains’][cn].append(d)
cn = cn + 1
else:
decay.results[’chains’] = custom_chain

113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145

# Find unique and make tally
decay.results[’unique’] = []
for chain in decay.results[’chains’]:
for iso in chain:
k = iso[’isotope_key’]
if(k not in decay.results[’tally’].keys()):
decay.results[’unique’].append(k)
# Use provided data
if(iso[’half_life’] == None):
stable = True
half_life = None
decay_constant = 0.0
else:
stable = False
half_life = iso[’half_life’]
decay_constant = numpy.log(2) / iso[’half_life’]
w = iso[’w’]
n0 = iso[’n0’]
# Get proton/neutron etc from isotopes database
i_data = isotopes.get(k)
if(i_data is None):
decay.results[’tally’][k] = {
’printable’: ’Custom’,
’element’: ’ZZ’,
’protons’: 999,
’nucleons’: 999,
’metastable’: 9,
’stable’: stable,
’half_life’: half_life,
’decay_constant’: decay_constant,
’w’: w,

222

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162

B.2. HIGHLIGHTED CODE

’n0’: n0,
’nend’: 0.0,
}
else:
decay.results[’tally’][k] = {
’printable’: decay.pad(isotopes.get_printable_name(k), 12),
’element’: i_data[’element’],
’protons’: i_data[’protons’],
’nucleons’: i_data[’nucleons’],
’metastable’: i_data[’metastable’],
’stable’: stable,
’half_life’: half_life,
’decay_constant’: decay_constant,
’w’: w,
’n0’: n0,
’nend’: 0.0,
}

163
164
165
166
167
168
169
170
171
172
173
174
175
176
177

decay.results[’chains_individual’] = []
for cn in range(len(decay.results[’chains’])):
for n in range(len(decay.results[’chains’][cn])):
nc = []
if(decay.results[’chains’][cn][n][’n0’]>0.0 or decay.results[’chains’][cn][n][’w’]>0.0):
for j in range(n, len(decay.results[’chains’][cn])):
iso = copy.deepcopy(decay.results[’chains’][cn][j])
if(j>n):
iso[’n0’] = 0.0
iso[’w’] = 0.0
nc.append(iso)
if(len(nc)>0):
decay.results[’chains_individual’].append(nc)

178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197

for cn in range(len(decay.results[’chains_individual’])):
chain = decay.results[’chains_individual’][cn]
n0 = numpy.zeros((len(chain),),)
w = numpy.zeros((len(chain),),)
l = numpy.zeros((len(chain),),)
b = numpy.zeros((len(chain)-1,),)
for n in range(len(decay.results[’chains_individual’][cn])):
k = decay.results[’chains_individual’][cn][n][’isotope_key’]
n0[n] = decay.results[’chains_individual’][cn][n][’n0’]
w[n] = decay.results[’chains_individual’][cn][n][’w’]
l[n] = decay.results[’tally’][k][’decay_constant’]
if(n>0):
b[n-1] = decay.results[’chains_individual’][cn][n][’bf’]
# Some observationally stable will still have a decay constant, so set to -1.0
if(isotopes.is_stable(k)):
l[n] = -1.0
nt = decay.calculate_activity(time, l, b, w, n0)
for n in range(len(decay.results[’chains_individual’][cn])):
decay.results[’chains_individual’][cn][n][’nend’] = nt[n]

198
199
200
201
202
203
204

205

set = []
for cn in range(len(decay.results[’chains_individual’])):
ckey = ’’
for n in range(len(decay.results[’chains_individual’][cn])):
k = decay.results[’chains_individual’][cn][n][’isotope_key’]
ckey = ckey + str(decay.results[’chains_individual’][cn][n][’isotope_key’]) + "N0:" + str(decay.results[’
chains_individual’][cn][n][’n0’]) + "W:" + str(decay.results[’chains_individual’][cn][n][’w’])
ckeyh = hashlib.md5(ckey.encode())

223

B.2. HIGHLIGHTED CODE

206
207
208

209

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

ckeyh = ckeyh.hexdigest()
if(ckeyh not in set):
decay.results[’tally’][k][’nend’] = decay.results[’tally’][k][’nend’] + decay.results[’chains_individual
’][cn][n][’nend’]
set.append(ckeyh)

210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228

# Log
if(log != None):
width = 140
fh = open(log, ’w’)
fh.write("Unique Isotopes\n")
fh.write(decay.hr(width) + "\n")
for k in decay.results[’unique’]:
line = decay.results[’tally’][k][’printable’]
fh.write(line + "\n")
fh.write("\n")
fh.write("\n")
fh.write("Decay Chains\n")
fh.write(decay.hr(width) + "\n")
fh.write("\n")
fh.write("\n")
for cn in range(len(decay.results[’chains’])):
chain = decay.results[’chains’][cn]

229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255

256
257
258

fh.write(decay.pad(cn+1,6))
for n in range(len(chain)):
iso = chain[n]
k = iso[’isotope_key’]
if(n>0):
bf = "{0:3e}".format(iso[’bf’])
fh.write(" --[" + str(bf) + "]--> ")
fh.write(decay.pad(decay.results[’tally’][k][’printable’], 12))
fh.write("\n")
fh.write(decay.pad("T1/2",6))
for n in range(len(chain)):
if(n>0):
fh.write(decay.pad("",17))
if(decay.results[’chains’][cn][n][’half_life’] == None):
fh.write(decay.pad("[Stable]",12))
else:
fh.write(decay.pad("[" + str("{0:8e}".format(decay.results[’chains’][cn][n][’half_life’])) + "]",12))
fh.write("\n")
fh.write(decay.pad("L",6))
for n in range(len(chain)):
if(n>0):
fh.write(decay.pad("",17))
if(decay.results[’chains’][cn][n][’decay_constant’] == None):
fh.write(decay.pad("[Stable]",12))
else:
fh.write(decay.pad("[" + str("{0:8e}".format(decay.results[’chains’][cn][n][’decay_constant’])) + "]"
,12))
fh.write("\n")
fh.write("\n")
fh.write("\n")

259
260
261
262
263
264

fh.write("Amounts\n")
fh.write(decay.hr(width) + "\n")
fh.write("\n")

224

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

265
266
267
268
269
270
271
272
273
274
275

B.2. HIGHLIGHTED CODE

fh.write(decay.hr(width) + "\n")
line = decay.pad("Isotope", 12)
line = line + decay.pad("T(1/2)", 18)
line = line + decay.pad("Decay Constant", 18)
line = line + decay.pad("W", 18)
line = line + decay.pad("N(t=0)", 18)
line = line + decay.pad("N(t=" + str(time) + ")", 18)
line = line + decay.pad("A(t=0)", 18)
line = line + decay.pad("A(t=" + str(time) + ")", 18)
fh.write(line + "\n")
fh.write(decay.hr(width) + "\n")

276
277
278
279
280
281
282
283
284
285
286
287
288
289
290

291

292
293
294
295

for k in decay.results[’tally’].keys():
line = decay.pad(decay.results[’tally’][k][’printable’], 12)
if(decay.results[’tally’][k][’half_life’] is None):
line = line + decay.pad("Stable", 18)
line = line + decay.pad("Stable", 18)
else:
line = line + decay.pad(str("{0:16e}".format(decay.results[’tally’][k][’half_life’])).strip(), 18)
line = line + decay.pad(str("{0:16e}".format(decay.results[’tally’][k][’decay_constant’])).strip(), 18)
line = line + decay.pad(str("{0:16e}".format(decay.results[’tally’][k][’w’])).strip(), 18)
line = line + decay.pad(str("{0:16e}".format(decay.results[’tally’][k][’n0’])).strip(), 18)
line = line + decay.pad(str("{0:16e}".format(decay.results[’tally’][k][’nend’])).strip(), 18)
if(decay.results[’tally’][k][’half_life’] is not None):
line = line + decay.pad(str("{0:16e}".format(decay.results[’tally’][k][’decay_constant’] * decay.results
[’tally’][k][’n0’])).strip(), 18)
line = line + decay.pad(str("{0:16e}".format(decay.results[’tally’][k][’decay_constant’] * decay.results
[’tally’][k][’nend’])).strip(), 18)
fh.write(line + "\n")
fh.write(decay.hr(width) + "\n")
fh.write("\n")
fh.write("\n")

296
297

fh.close()

298
299

return decay.results

300
301
302
303

##########################################
# DECAY EQUATIONS
##########################################

304
305
306
307
308
309
310
311
312
313

@staticmethod
def calculate_activity(t, lam, b, w, n0):
nt = numpy.zeros((len(n0),),)
for m in range(0,len(n0)):
if(lam[m] <= 0):
nt[m] = decay.calc_stable(t, m, lam, b, w, n0)
else:
nt[m] = decay.calc_unstable(t, m, lam, b, w, n0)
return nt

314
315
316
317
318
319
320

321
322

@staticmethod
def calc_unstable(t, m, lam, b, w, n0):
y = 0.0
k = 0
while(k<=m):
y = y + decay.r(k, m, lam, b) * (decay.f_unstable(t, k, m, lam) * n0[k] + decay.g_unstable(t, k, m, lam) * w
[k])
k = k + 1
return y

225

B.2. HIGHLIGHTED CODE

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

323
324
325
326
327
328
329
330
331
332
333

@staticmethod
def f_unstable(t, k, m, lam):
s = 0.0
i = k
while(i<=m):
p = decay.lprod(lam, k, m, 3, i)
s = s + numpy.exp(-lam[i] * t) * (1.0 / p)
i = i + 1
s = s * (-1)**(m-k)
return s

334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349

@staticmethod
def g_unstable(t, k, m, lam):
# Term a
p = decay.lprod(lam, k, m, 1)
a = 1.0 / p
# Term b
s = 0.0
i = k
while(i<=m):
p = decay.lprod(lam, k, m, 3, i)
s = s + (1 / lam[i]) * numpy.exp(-lam[i] * t) * (1.0 / p)
i = i + 1
s = s * (-1)**(m-k+1)
return a + s

350
351
352
353
354
355
356
357
358

@staticmethod
def calc_stable(t, m, lam, b, w, n0):
y = n0[m] + w[m] * t
k = 0
while(k<=m-1):
y = y + decay.r(k, m, lam, b) * (decay.f_stable(t, k, m, lam) * n0[k] + decay.g_stable(t, k, m, lam) * w[k])
k = k + 1
return y

359
360
361
362
363
364

@staticmethod
def f_stable(t, k, m, lam):
mm = m - 1
p = decay.lprod(lam, k, mm, 1)
a = 1.0 / p

365
366
367
368
369
370
371
372
373

s = 0.0
i = k
while(i<=mm):
p = decay.lprod(lam, k, mm, 3, i)
s = s + (1 / lam[i]) * numpy.exp(-lam[i] * t) * (1.0 / p)
i = i + 1
s = s * (-1)**(mm-k+1)
return a + s

374
375
376
377

@staticmethod
def g_stable(t, k, m, lam):
mm = m - 1

378
379
380

p = decay.lprod(lam, k, mm, 1)
a = (t/p)

381
382
383

s = 0.0
i = k

226

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

384
385
386
387
388
389

while(i<=mm):
p = decay.lprod(lam, k, mm, 4, i)
s = s + p
i = i + 1
q = decay.lprod(lam, k, mm, 2)
b = (-s / q)

390
391
392
393
394
395
396
397
398

c = 0.0
i = k
while(i<= mm):
p = lam[i]**2 * decay.lprod(lam, k, mm, 3, i)
c = c + numpy.exp(-1.0 * lam[i] * t) / p
i = i + 1
c = c * (-1.0)**(mm - k)
nd = a + b + c

399
400

return nd

401
402
403
404
405
406
407
408
409
410
411
412
413

@staticmethod
def r(k, m, lam, b):
if(k == m):
return 1
else:
p = 1.0
i = k
while(i<=(m-1)):
p = p * b[i] * lam[i]
i = i + 1
return p

414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444

@staticmethod
def lprod(lam, k, m, t=1, i=None):
# PROD k,m lam[j]
if(t == 1):
p = 1.0
j = k
while(j<=m):
p = p * lam[j]
j = j + 1
return p
# PROD k,m lam[j]**2
elif(t == 2):
p = 1.0
j = k
while(j<=m):
p = p * lam[j]**2
j = j + 1
return p
# PROD k,m, i!=j (lam[i]-lam[j])
elif(t == 3):
p = 1.0
j = k
while(j<=m):
if(i != j):
p = p * (lam[i] - lam[j])
j = j + 1
return p
# PROD k,m, i!=j lam[j]
elif(t == 4):
p = 1.0

227

B.2. HIGHLIGHTED CODE

B.2. HIGHLIGHTED CODE

445
446
447
448
449
450

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

j = k
while(j<=m):
if(i != j):
p = p * lam[j]
j = j + 1
return p

451
452
453
454
455
456
457

@staticmethod
def pad(inp, l=16):
inp = str(inp)
while(len(inp)<l):
inp = inp + " "
return inp

458
459
460
461
462
463
464

@staticmethod
def hr(l=16):
inp = ""
while(len(inp)<l):
inp = inp + "="
return inp

465
466
467
468
469
470
471
472
473
474
475
476

@staticmethod
def get_file_dir(file_path):
file_path = file_path.strip()
if(file_path[0] != "/"):
root = os.getcwd()
file_path = root + "/" + file_path
file_path = file_path.split("/")
path = ""
for i in range(1,len(file_path) - 1):
path = path + "/" + file_path[i]
return path

477
478
479
480
481
482
483
484
485
486
487
488
489
490

@staticmethod
def make_dir(dir):
dirs = dir.split("/")
try:
dir = ’’
for i in range(len(dirs)):
dir = dir + dirs[i]
if(not os.path.exists(dir) and dir.strip() != ’’):
os.mkdir(dir)
dir = dir + ’/’
return True
except:
return False

491
492
493
494
495

@staticmethod
def test():
print("Test Decay")

496
497
498

# Load isotopes dictionary
decay.set("../data/isotopes.pz")

499
500
501
502
503
504
505

idata = {}
parent = 84216
time = 10
idata[84216] = {’w’: 0.20, ’n0’: 100.0}
idata[82212] = {’w’: 0.0, ’n0’: 5.0}
idata[83212] = {’w’: 0.07, ’n0’: 15.0}

228

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

506
507
508
509

idata[81208] = {’w’: 0.005, ’n0’: 0.0}
# 84Po212 0 0 (default)
idata[82208] = {’w’: 0.01, ’n0’: 300.0}
decay.calculate(parent, time, idata, "testing/log_84216_new.txt")

510
511
512
513

def main():
decay.test()

514
515
516

if __name__ == "__main__":
main()

229

B.2. HIGHLIGHTED CODE

B.3. ACTIVITY EQUATION TESTING

B.3
B.3.1

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

Activity Equation Testing
Numeric Fortran Code

A simple Fortran code was created for each decay path used to test the activity equation and computer code.
The version of the code used to calculate the amount of each isotope for the Po-216 decay chain is given in fig.
B.3, and this code was modified for each decay chain tested.
Listing B.2: Bash file to compile Fortran test code
1
2
3
4
5
6
7
8
9

#!/bin/bash
mpif90 -g \
-fopenmp \
-fbounds-check \
-mtune=native \
kinds.f90 \
main.f90 \
-o test.x \
&& ./test.x

Listing B.3: Fortran code to numerically estimate the amount of each isotope in the Polonium-216 decay chain
1
2
3
4
5

PROGRAM main_test
! University of Birmingham
! Ben Palmer
Use kinds
Use MPI

6
7

IMPLICIT NONE

8
9

CALL main()

10
11

CONTAINS

12
13

! Subroutines

14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29

SUBROUTINE main()
!###########################################
! PRIVATE VARIABLES
INTEGER(kind=StandardInteger) :: i, j, k
INTEGER(kind=StandardInteger) :: steps, chn
REAL(kind=DoubleReal) :: w(1:20)
REAL(kind=DoubleReal) :: t(1:20)
REAL(kind=DoubleReal) :: l(1:20)
REAL(kind=DoubleReal) :: n0(1:20)
REAL(kind=DoubleReal) :: n(1:20)
REAL(kind=DoubleReal) :: source(1:20)
REAL(kind=DoubleReal) :: loss(1:20)
REAL(kind=DoubleReal) :: t_end, t_step
!###########################################

30
31

print *, "Decay Test - Po216"

32
33
34
35
36
37
38
39

w(:) = 0.0D0
l(:) = 0.0D0
t(:) = 0.0D0
n0(:) = 0.0D0
source(:) = 0.0D0
loss(:) = 0.0D0
chn = 6

230

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

40
41
42
43
44
45

w(:)
w(1)
w(3)
w(4)
w(6)

=
=
=
=
=

0.0D0
0.2D0
0.07D0
0.005D0
0.01D0

l(1)
l(2)
l(3)
l(4)
l(5)

=
=
=
=
=

4.683427D+00 ! 84Po216
1.809595D-05 ! 82Pb212
1.908235D-04 ! 83Bi212
3.777781D-03 ! 81Tl208
2.310491D+06 ! 84Po212
! 82Pb208

46
47
48
49
50
51
52
53
54
55
56
57
58

n0(:)
n0(1)
n0(2)
n0(3)
n0(6)

=
=
=
=
=

0.0D0
1.0D2
5.0D0
1.5D1
3.0D2

59
60

n(:) = n0(:)

61
62
63

t_end = 10.0D0
t_step = t_end / 1.0D10

64
65
66
67
68

Do k=1,10
DO i=1,1000000000
source = 0.0D0
loss = 0.0D0

69
70
71

source(1) = t_step * w(1)
loss(1) = n(1) * (1.0D0 - exp(-l(1) * t_step))

72
73
74

source(2) = t_step * w(2) + loss(1)
loss(2) = n(2) * (1.0D0 - exp(-l(2) * t_step))

75
76
77

source(3) = t_step * w(3) + loss(2)
loss(3) = n(3) * (1.0D0 - exp(-l(3) * t_step))

78
79
80

source(4) = t_step * w(4) + 0.359300D0 * loss(3)
loss(4) = n(4) * (1.0D0 - exp(-l(4) * t_step))

81
82
83

source(5) = t_step * w(5) + 0.640700D0 * loss(3)
loss(5) = n(5) * (1.0D0 - exp(-l(5) * t_step))

84
85

source(6) = t_step * w(6) + loss(4) + loss(5)

86
87

n(1:chn) = n(1:chn) + source(1:chn) - loss(1:chn)

88
89
90

END DO
END DO

91
92
93
94
95
96
97
98

print
print
print
print
print
print

*,
*,
*,
*,
*,
*,

"Po216
"Pb212
"Bi212
"Tl208
"Po212
"Pb208

",
",
",
",
",
",

n(1)
n(2)
n(3)
n(4)
n(5)
n(6)

99
100

231

B.3. ACTIVITY EQUATION TESTING

B.3. ACTIVITY EQUATION TESTING

101

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

END SUBROUTINE main

102
103
104
105

END PROGRAM main_test

232

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

B.3.2

B.3. ACTIVITY EQUATION TESTING

Chromium-49

Chromium-49 has a straightforward decay path, via positron emission (or electron capture) through to Vanadium49 then to the stable isotope Titanium-49. Calculated isotope amounts are given for 5 different trial source
rates and starting amounts; the results are listed in table B.2. The RSS error between the numeric and analytic
code in this decay chain over all five trials was 6.52 × 10−3 and the total percentage error between the two was

2.17 × 10−3 %.

Figure B.1: Decay path for Chromium-49 [23]

49
24 𝐶𝑟

Numeric
Analytic
49
23 𝑉
Numeric
Analytic
49
22 𝑇 𝑖
Numeric
Analytic

𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end

Trial 1
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100

Trial 2
1.0 × 102
0.0 × 100
3.62694 × 105
3.62694 × 105
0.0 × 100
0.0 × 100
8.26897 × 106
8.26897 × 106
0.0 × 100
0.0 × 100
8.33841 × 103
8.33847 × 103

Trial 3
0.0 × 100
1.0 × 102
4.51169 × 10−9
4.51169 × 10−9
0.0 × 100
0.0 × 100
9.97990 × 101
9.97990 × 101
0.0 × 100
0.0 × 100
2.01023 × 10−1
2.01025 × 10−1

Trial 4
2.5 × 100
3.0 × 104
9.06734 × 103
9.06734 × 103
0.0 × 100
0.0 × 100
2.36664 × 105
2.36664 × 105
0.0 × 100
0.0 × 100
2.68767 × 102
2.68769 × 102

Table B.2: Chromium-49 - numeric vs analytic calculated radioactivity

233

Trial 5
2.5 × 100
3.0 × 104
9.06734 × 103
9.06734 × 103
1.07 × 100
1.0 × 103
3.30013 × 105
3.30013 × 105
3.2 × 100
2.0 × 104
2.96848 × 105
2.96848 × 105

B.3. ACTIVITY EQUATION TESTING

B.3.3

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

Nickel-66

Figure B.2: Decay path for Nickel-66 [23]
Nickel-66 beta decays to Copper-66 and then to Zinc-66. The trial data are in table B.4. The RSS error between
the numeric and analytic code in this decay chain over all five trials was 9.40 × 10−2 and the total percentage

error between the two was 1.52 × 10−4 %.

66
28 𝑁 𝑖

Numeric
Analytic
66
29 𝐶𝑢
Numeric
Analytic
49
22 𝑇 𝑖
Numeric
Analytic

𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end

Trial 1
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100

Trial 2
1.0 × 102
0.0 × 100
7.44391 × 106
7.44391 × 106
0.0 × 100
0.0 × 100
1.15802 × 104
1.15802 × 104
0.0 × 100
0.0 × 100
1.18451 × 106
1.18451 × 106

Trial 3
0.0 × 100
1.0 × 102
7.36534 × 101
7.36534 × 101
0.0 × 100
0.0 × 100
1.15264 × 10−1
1.15264 × 10−1
0.0 × 100
0.0 × 100
2.62314 × 101
2.62314 × 101

Trial 4
2.5 × 100
3.0 × 104
2.08194 × 105
2.08194 × 105
0.0 × 100
0.0 × 100
3.24085 × 102
3.24085 × 102
0.0 × 100
0.0 × 100
3.74822 × 104
3.74822 × 104

Table B.4: Nickel-66 - numeric vs analytic calculated radioactivity

234

Trial 5
2.5 × 100
3.0 × 104
2.08194 × 105
2.08194 × 105
1.07 × 100
1.0 × 103
7.96452 × 102
7.96452 × 102
3.2 × 100
2.0 × 104
4.26938 × 105
4.26938 × 105

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

B.3.4

B.3. ACTIVITY EQUATION TESTING

Caesium-125

Figure B.3: Decay path for Caesium-125 [23]
The RSS error between the numeric and analytic code in this decay chain over all five trials was 6.42 × 10−1
and the total percentage error between the two was 1.23 × 10−3 %.

125
55 𝐶𝑠

Numeric
Analytic
125
54 𝑋𝑒
Numeric
Analytic
125
53 𝐼
Numeric
Analytic
125
52 𝑇 𝑒
Numeric
Analytic

𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end

Trial 1
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100

Trial 2
1.0 × 102
0.0 × 100
4.0424 × 105
4.0424 × 105
0.0 × 100
0.0 × 100
5.3391 × 106
5.3391 × 106
0.0 × 100
0.0 × 100
2.8851 × 106
2.8851 × 106
0.0 × 100
0.0 × 100
1.1544 × 104
1.1544 × 104

Trial 3
0.0 × 100
1.0 × 102
5.2204 × 10−8
5.2204 × 10−8
0.0 × 100
0.0 × 100
3.9172 × 101
3.9172 × 101
0.0 × 100
0.0 × 100
6.0438 × 101
6.0438 × 101
0.0 × 100
0.0 × 100
3.8975 × 10−1
3.8975 × 10−1

Trial 4
5.0 × 101
2.0 × 105
2.0212 × 105
2.0212 × 105
0.0 × 100
0.0 × 100
2.7479 × 106
2.7479 × 106
0.0 × 100
0.0 × 100
1.5634 × 106
1.5634 × 106
0.0 × 100
0.0 × 100
6.5513 × 103
6.5513 × 103

Table B.6: Caesium-125 - numeric vs analytic calculated radioactivity

235

Trial 5
2.3 × 101
3.0 × 105
9.2976 × 104
9.2976 × 104
5.4 × 101
2.0 × 102
4.3142 × 106
4.3142 × 106
2.1 × 101
1.7 × 106
6.0191 × 106
6.0191 × 106
4.0 × 100
5.0 × 104
4.3678 × 105
4.3678 × 105

B.3. ACTIVITY EQUATION TESTING

B.3.5

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

Bismuth-213

Figure B.4: Decay path for Bismuth-213 [23]
The previous decay examples have been straight chains with no branches, but Bismuth-213 is the first discussed
in this section to have a branch. There’s approximately an 98% chance that
decay and just over 2% chance that it will decay to
that then undergoes beta decay to
209
83 𝐵𝑖

209
83 𝐵𝑖.

213
84 𝑃 𝑜

213
83 𝐵𝑖

will decay to

213
83 𝑇 𝑙

by alpha

by beta decay. These both go on to decay to

There is another step in the chain (to the stable isotope

209
82 𝑃 𝑏

205
81 𝑇 𝑙),

but

is observationally stable with an extremely long half life and the decay code terminates the chain at this

point.
The RSS error between the numeric and analytic code in this decay chain over all five trials was 2.03 × 1013 .
This is large, but due mostly to the larger amounts used in this example. The total percentage error between

the two was 6.07 × 103 % which is again large, but this is due to the numeric code and the short half life of

Po-213 in comparison to the time step used. Without the contribution of Po-213 the total percentage error
between the two sets of results is just 2.37 × 10−4 %.

213
83 𝐵𝑖

Numeric
Analytic
213
84 𝑃 𝑜
Numeric
Analytic
209
81 𝑇 𝑙
Numeric
Analytic
209
82 𝑃 𝑏
Numeric
Analytic
209
83 𝐵𝑖
Numeric
Analytic
205
81 𝑇 𝑙
Numeric
Analytic

𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end

Trial 1
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100

Trial 2
1.0 × 102
0.0 × 100
3.9463 × 105
3.9463 × 105
0.0 × 100
0.0 × 100
8.4594 × 10−3
5.2264 × 10−4
0.0 × 100
0.0 × 100
3.9096 × 102
3.9096 × 102
0.0 × 100
0.0 × 100
1.6881 × 106
1.6881 × 106
0.0 × 100
0.0 × 100
6.5568 × 106
6.5568 × 106
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100

Trial 3
0.0 × 100
1.0 × 100
3.1024 × 10−8
3.1024 × 10−8
0.0 × 100
0.0 × 100
6.6504 × 10−16
4.1088 × 10−17
0.0 × 100
0.0 × 100
3.2265 × 10−11
3.2265 × 10−11
0.0 × 100
0.0 × 100
8.1281 × 10−1
8.1281 × 10−1
0.0 × 100
0.0 × 100
9.9187 × 101
9.9187 × 101
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100

Trial 4
3.0 × 105
1.0 × 1010
1.1839 × 109
1.1839 × 109
0.0 × 100
0.0 × 100
2.5378 × 101
1.5679 × 100
0.0 × 100
0.0 × 100
1.1729 × 106
1.1729 × 106
0.0 × 100
0.0 × 100
5.1457 × 109
5.1457 × 109
0.0 × 100
0.0 × 100
2.9589 × 1010
2.9589 × 1010
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100

Table B.8: Bismuth-213 - numeric vs analytic calculated radioactivity

236

Trial 5
3.0 × 105
1.0 × 1010
1.1839 × 109
1.1839 × 109
7.0 × 103
2.0 × 107
2.5983 × 101
1.6053 × 100
2.0 × 104
2.0 × 106
4.9141 × 106
4.9141 × 106
1.0 × 100
1.0 × 107
5.6026 × 109
5.6026 × 109
3.5 × 108
1.0 × 106
3.0271 × 1013
3.0271 × 1013
1.0 × 10−10
1.0 × 10−10
0.0 × 100
0.0 × 100

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

B.3.6

B.3. ACTIVITY EQUATION TESTING

Polonium-216

Figure B.5: Decay path for Bismuth-213 [23]
The RSS error between the numeric and analytic code in this decay chain over all five trials was 3.85 × 101

and the total percentage error between the two was 7.94 × 104 %. This large error was due to a short half life

isotope (Po-212) and the comparatively long time step in the numeric solver. Without this result, the agreement
between numeric and analytic is 6.10 × 10−2 %.

216
84 𝑃 𝑜

Numeric
Analytic
212
82 𝑃 𝑏
Numeric
Analytic
212
83 𝐵𝑖
Numeric
Analytic
208
81 𝑇 𝑙
Numeric
Analytic
212
84 𝑃 𝑜
Numeric
Analytic
208
82 𝑃 𝑏
Numeric
Analytic

𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end

Trial 1
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100

Trial 2
1.0 × 102
0.0 × 100
2.13562 × 101
2.13519 × 101
0.0 × 100
0.0 × 100
4.36891 × 106
4.36891 × 106
0.0 × 100
0.0 × 100
4.02810 × 105
4.02810 × 105
0.0 × 100
0.0 × 100
7.30001 × 103
× 10
0.0 × 100
0.0 × 100
4.25501 × 10−3
2.13149 × 10−5
0.0 × 100
0.0 × 100
3.86096 × 106
3.86096 × 106

Trial 3
0.0 × 100
1.0 × 102
0.0 × 100
0.0 × 100
0.0 × 100
0.0 × 100
2.09405 × 101
2.09405 × 101
0.0 × 100
0.0 × 100
2.19385 × 100
2.19385 × 100
0.0 × 100
0.0 × 100
4.00077 × 10−2
× 10
0.0 × 100
0.0 × 100
2.31743 × 10−8
1.16088 × 10−10
0.0 × 100
0.0 × 100
7.68257 × 101
7.68257 × 101

Trial 4
3.5 × 102
5.0 × 104
7.47467 × 101
7.47316 × 101
0.0 × 100
0.0 × 100
1.53016 × 107
1.53017 × 107
0.0 × 100
0.0 × 100
1.41093 × 106
1.41093 × 106
0.0 × 100
0.0 × 100
2.55700 × 104
× 10
0.0 × 100
0.0 × 100
1.49041 × 10−2
7.46601 × 10−5
0.0 × 100
0.0 × 100
1.35518 × 107
1.35518 × 107

Table B.10: Polonium-216 - numeric vs analytic calculated radioactivity

237

Trial 5
2.0 × 10−1
1.0 × 102
4.27124 × 10−2
4.27038 × 10−2
2.0 × 10−1
5.0 × 100
1.31287 × 104
1.31287 × 104
7.0 × 10−2
1.50 × 101
1.57757 × 103
1.57757 × 103
5.0 × 10−3
1.0 × 101
1.83923 × 10−5
× 10
2.0 × 10−2
1.7 × 101
1.83923 × 10−5
9.21338 × 10−8
1.0 × 10−2
3.0 × 102
2.07028 × 104
2.07028 × 104

B.3. ACTIVITY EQUATION TESTING

B.3.7

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

Radon-218

Figure B.6: Decay path for Bismuth-213 [23]
The RSS error between the numeric and analytic code in this decay chain over all five trials was 1.73 × 103 and

the total percentage error between the two was 5.93 × 101 %. However, if the short half life isotope Po-214 is
excluded, the error is just 5.15 × 10−1 %.

238

APPENDIX B. ACTIVITY EQUATION IN PYTHON: DECAY CLASS

218
86 𝑅𝑛

Numeric
Analytic
214
84 𝑃 𝑜
Numeric
Analytic
210
82 𝑃 𝑏
Numeric
Analytic
206
80 𝐻𝑔
Numeric
Analytic
210
83 𝐵𝑖
Numeric
Analytic
206
81 𝑇 𝑙
Numeric
Analytic
210
84 𝑃 𝑜
Numeric
Analytic
206
82 𝑃 𝑏
Numeric
Analytic

𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end
𝜔
𝑛start
𝑛end
𝑛end

Trial 1
0.0 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.00000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.00000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.00000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.00000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.00000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.00000 × 100

Trial 2
1.0000 × 100
0.0000 × 100
5.1980 × 100
5.1937 × 100
0.0000 × 100
0.0000 × 100
2.8000 × 10−2
2.3415 × 10−2
0.0000 × 100
0.0000 × 100
8.6396 × 106
8.6396 × 106
0.0000 × 100
0.0000 × 100
1.1585 × 10−7
1.1584 × 10−7
0.0000 × 100
0.0000 × 100
3.5238 × 102
3.5236 × 102
0.0000 × 100
0.0000 × 100
3.4319 × 10−7
3.4316 × 10−7
0.0000 × 100
0.0000 × 100
1.6413 × 101
1.6411 × 101
0.0000 × 100
0.0000 × 100
2.0729 × 10−2
2.0747 × 10−2

Trial 3
0.0000 × 100
1.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
0.0000 × 100
9.9991 × 101
9.9991 × 101
0.0000 × 100
0.0000 × 100
1.3520 × 10−12
1.3519 × 10−12
0.0000 × 100
0.0000 × 100
7.9731 × 10−3
7.9725 × 10−3
0.0000 × 100
0.0000 × 100
7.1575 × 10−12
7.1570 × 10−12
0.0000 × 100
0.0000 × 100
5.6320 × 10−4
5.6316 × 10−4
0.0000 × 100
0.0000 × 100
9.5248 × 10−7
9.5242 × 10−7

B.3. ACTIVITY EQUATION TESTING

Trial 4
3.5 × 102
5.0000 × 104
1.8193 × 101
1.8178 × 101
0.0000 × 100
0.0000 × 100
9.8000 × 10−2
8.1952 × 10−2
0.0000 × 100
0.0000 × 100
3.0289 × 107
3.0289 × 107
0.0000 × 100
0.0000 × 100
4.0614 × 10−7
4.0611 × 10−7
0.0000 × 100
0.0000 × 100
1.2373 × 103
1.2372 × 103
0.0000 × 100
0.0000 × 100
1.2047 × 10−6
1.2046 × 10−6
0.0000 × 100
0.0000 × 100
5.7726 × 101
5.7722 × 101
0.0000 × 100
0.0000 × 100
7.3026 × 10−2
7.3089 × 10−2

Table B.12: Radon-218 - numeric vs analytic calculated radioactivity

239

Trial 5
3.5000 × 102
5.0000 × 104
1.8193 × 101
1.8178 × 101
7.0000 × 101
1.0000 × 103
1.1760 × 10−1
9.8343 × 10−1
1.0000 × 103
1.2000 × 102
1.2273 × 108
1.2273 × 108
1.7000 × 101
7.0000 × 102
1.2243 × 104
1.2243 × 104
2.3000 × 101
4.1000 × 101
1.8609 × 10−6
1.8609 × 106
8.1000 × 101
5.0000 × 102
3.5646 × 104
3.5646 × 104
5.2000 × 102
1.5000 × 103
4.4948 × 107
4.4948 × 107
1.0000 × 103
1.0000 × 104
9.4943 × 107
9.4943 × 107

Appendix C

Activity Code
C.1
C.1.1

Activity V1
Paper published in Computer Physics Communications

The Activity code was published in the Computer Physics Communications journal and this is included in the
following pages. It was submitted in 2015 and published in 2017.

240

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Computer Physics Communications 216 (2017) 138–144

Contents lists available at ScienceDirect

Computer Physics Communications
journal homepage: www.elsevier.com/locate/cpc

Activity computer program for calculating ion irradiation activation✩
Ben Palmer *, Brian Connolly, Mark Read
University of Birmingham, United Kingdom

article

info

Article history:
Received 1 June 2015
Received in revised form 15 February 2017
Accepted 19 February 2017
Available online 29 March 2017

a b s t r a c t
A computer program, Activity, was developed to predict the activity and gamma lines of materials
irradiated with an ion beam. It uses the TENDL (Koning and Rochman, 2012) [1] proton reaction cross
section database, the Stopping and Range of Ions in Matter (SRIM) (Biersack et al., 2010) code, a Nuclear
Data Services (NDS) radioactive decay database (Sonzogni, 2006) [2] and an ENDF gamma decay database
(Herman and Chadwick, 2006) [3]. An extended version of Bateman’s equation is used to calculate the
activity at time t, and this equation is solved analytically, with the option to also solve by numeric
inverse Laplace Transform as a failsafe. The program outputs the expected activity and gamma lines of
the activated material.
Program summary
Program title: Activity
Catalogue identifier: AFBS_v1_0
Program summary URL: http://cpc.cs.qub.ac.uk/summaries/AFBS_v1_0.html
Program obtainable from: CPC Program Library, Queen’s University, Belfast, N. Ireland
Licensing provisions: GNU GPL v3
No. of lines in distributed program, including test data, etc.: 688828
No. of bytes in distributed program, including test data, etc.: 71056048
Distribution format: tar.gz
Programming language: Fortran.
Computer: PCs or HPCs.
Operating system: Linux (tested on Debian).
Has the code been vectorized or parallelized?: OpenMPI
RAM: 250MB per process + 200MB overhead
Classification: 2.2, 17.8.
Nature of problem: To calculate the predicted activity of an ion irradiated target. The expected range of ion
energies is between 1MeV and 200MeV; this is the range of the available ion cross section data.
Solution method: The program loads cross section data from the TENDL database and trajectory data from
a SRIM [1] simulation exyz data file. It uses this data to calculate the production/loss rate of each isotope in
the simulated target. Radioactive decay equations are used to calculate the amounts and activity of each
radioactive isotope at the set time.
Running time: Typically the Activity program runs each input from seconds to no more than several
minutes.
References:
[1] SRIM — The stopping and range of ions in matter (2010). Ziegler, James F., Ziegler, M.D. and
Biersack, J.P. 2010, Nuclear Instruments and Methods in Physics Research Section B, Vol. 268, pp.
1818–1823.

© 2017 Elsevier B.V. All rights reserved.

✩ This paper and its associated computer program are available via the Computer
Physics Communication homepage on ScienceDirect (http://www.sciencedirect.
com/science/journal/00104655).
Corresponding author.
E-mail address: benpalmer1983@gmail.com (B. Palmer).

*

http://dx.doi.org/10.1016/j.cpc.2017.02.025
0010-4655/© 2017 Elsevier B.V. All rights reserved.

241

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

B. Palmer et al. / Computer Physics Communications 216 (2017) 138–144

139

The spreading of ion depths at lower energies is a result of the
higher momentum transfer during nuclear collisions, as can be
seen in Fig. 1.
1.3. Transmutation of nuclei by ion irradiation

Fig. 1. One hundred simulated 13 MeV proton energy loss curves in Fe simulated
with SRIM [4].

1. Background

Considering a simplified nuclear potential well, energetic protons approaching a nucleus may overcome the Coulomb potential
barrier. They are captured by the nucleus and held within the
potential well by the strong nuclear force. This process may leave
the nucleus in an excited and unstable state, depending on the
input energy of the proton and configuration of nucleons. The
process is probabilistic, and the average chance of a reaction (the
microscopic cross section) may be measured as a function of the
projectile, projectile energy and target, either experimentally or by
optical model potential calculations. The reaction rate is calculated
from the microscopic cross section using the following equation:
R=

1.1. Ion irradiation at the University of Birmingham
The Scanditronix MC-40 Cyclotron is used at the University
of Birmingham to create a beam of protons or other light ions.
The energies of these ions are typically between 10 MeV and 60
MeV with beam currents ranging up to 50 µA (3.1 × 1014 protons
per second). Target materials are irradiated by this cyclotron for a
number of reasons, including purposely creating radioactive isotopes for the nearby Queen Elizabeth Hospital, investigating ion
irradiation damage and emulating neutron irradiation.
The cyclotron is usually used to create radioactive isotopes for
medical use, but an additional beam line has been devoted to
material science investigations into radiation damage. While the
creation of radioactive isotopes is desired in some cases, material
being tested for radiation damage should preferably have low
levels of radioactivity.
It is expensive to arrange the irradiation of target materials by
high energy neutrons sources, whereas it is relatively inexpensive
to irradiate using an ion beam on the MC-40 Cyclotron. The energies can be controlled, and a set dose at a single energy, or a range
of energies, can be precisely deposited into the target material.
The Activity code discussed here was developed to calculate the
activity of a target material irradiated by a proton beam. It has
been developed in Fortran and uses data from the TENDL-2013
proton cross section database, SRIM ion transport code and NDS
radioactive decay database.
1.2. Simulating ion irradiation with SRIM
A package of ion transport codes, SRIM, is freely available to
download and use to investigate the transport of ions through
matter. SRIM uses the binary collision approximation (BCA) to
simulate the passage of ions in a material. It is an approximate
method, and one key restriction is that it does not take into account
the structure of the material, and this approximation is therefore
also imposed on the Activity code.
One file that SRIM creates is of importance to the Activity
code, and that is the trajectory file that contains the energy and
x, y, z co-ordinate data points for simulated ions moving through
matter. Fig. 1 shows the trajectory of one hundred 13 MeV protons
entering and passing through an Iron target, and it is this set of data
points (together with the cross section database) that the Activity
code uses to calculate the reaction rates for the transmutation of
nuclei in the target. At higher energies, the ions slow as they lose
energy due to electronic stopping, but as the ion energy drops the
mechanism of loss through nuclear collisions becomes important.

242

J
e

•
•
•
•
•
•

nt σ · 10−28 δ t

(1)

R Reaction Rate (reactions per second)
J Beam current (A)
nt Number density of target (atoms per cubic meter)
σ Microscopic reaction cross section (barns)
e Elementary charge (1.602177E-19C)
δ T Target thickness (m).

1.4. Radioactive decay
Radioactive decay is the random change in nucleons or energy
state of an unstable nucleus. It is impossible to predict when a
single nucleus will decay, but the decay of a collection of nuclei
is statistical in nature. The radioactivity and number of unstable
nuclei at time t can be predicted using the decay constant, λ, for
the radioactive isotope. This constant is defined as follows:

λ=−

N ′ (t)
N(t)

.

(2)

The number of radioactive nuclei N(t) at time t is given by the
following equation, where N(0) is the starting number of nuclei:
N(t) = N(0) exp(−t λ).

(3)

The activity A(t) of the radioactive nuclei is predicted at time
t by using the following equations, where N ′ (t) is the change in
amount of nuclei with respect to time:
A(t) = −N ′ (t) = λN(t)

(4)

A(t) = λN(0) exp(−t λ).

(5)

1.5. Bateman equation for radioactive decay
The English mathematician Harry Bateman derived an Eq. (6) to
calculate the amount of each isotope in a decay chain, illustrated
in Fig. 2, at time t.
Nn (t) =

i=n
∑

⎛⎛

j=n−1

∏
⎝⎝

i=1

j=i

⎞
λ(ij+1) ⎠

j=n
∑

(

Ni0 exp(−λj t)

∏p=n
j=i

λ − λj )

p=i,p̸ =j ( p

)⎞
⎠.

(6)

When a radioactive isotope decays, there may be more than one
mode of decay, and this leads to branching factors. Pb-214 only
decays via beta decay to Bi-214, giving a branching factor of 1.0,
whereas Bi-214 has a 99.979% chance of decaying to Po-214 by beta
decay and a 0.021% of emitting an alpha particle and decaying to
Tl-210 (branching factors of 0.99979 and 0.00021 respectively) [5].

APPENDIX C. ACTIVITY CODE

140

C.1. ACTIVITY V1

B. Palmer et al. / Computer Physics Communications 216 (2017) 138–144

• Ni (t) amount of the ith isotope at time t
• Ni′ (t) change in amount of the ith isotope, with respect to
time, at time t.
The differential equations for the parent isotope (first isotope),
unstable daughter isotopes (ith isotopes) and stable, final, daughter
isotope (zth isotope) in the time domain are as follows:
N1′ (t) = ω1 − λ1 N1 (t)

(8)

Ni (t) = ωi + bi−1 λi−1 Ni−1 (t) − λi Ni (t)

(9)

′

Nz (t) = ωz + bz −1 λz −1 Nz −1 (t).
′

(10)

Applying the Laplace Transform to these three differential equations allows them to be manipulated and solved algebraically in the
s-domain.
N1 (s) =

Fig. 2. An example decay chain from an unstable parent isotope, through unstable
daughter isotopes ending with a stable daughter isotope.

When a target material is irradiated, there is a source term for
transmuted nuclei due to the irradiation. The daughter isotopes of
these transmuted isotopes will also be affected by the irradiation
and will transmute further, giving a source term for each daughter
isotope as a result of the irradiation. Sources for each isotope in the
decay chain, and branching factors between a parent isotope and
its daughter isotope/s must be accounted for.
The Bateman equation was derived using Laplace transforms,
and this same method has been used to develop a modified equation that incorporates branching factors and production rates for
each isotope in the decay chain, as illustrated by Fig. 3.

1
s + λ1
1

f (t) exp(−st)dt .

F (s) =

1.7. Constructing the differential equations
The first step is to set up differential equations for the parent
isotope, unstable daughter isotopes and stable daughter isotope.
The parent isotope has a source term, due to production, and a
loss term, due to decay. The unstable daughter isotopes have two
source terms, from the production by irradiation induced transmutation and the decay of preceding isotopes in the decay chain, and
a loss term, due to decay. Finally, the stable daughter that finalizes
the decay chain has two source terms (the same as the unstable
daughters) but no loss term.
The variables (and vectors) used in these equations are defined
as follows:

•
•
•
•
•

λ⃗ vector containing isotope decay constants λi
⃗ vector containing isotope to isotope branching factors bi
b
w
⃗ vector containing isotope production rates wi
t time at which activity/amount of isotope is measured
Ni (0) starting amount of the ith isotope

(12)
(13)

The Gaver–Stehfest [6] algorithm was developed in the 1960s
and 1970s and is a method of calculating the inverse of a Laplace
Transform in the real number domain. It is an easy to implement
and reasonably accurate method, although it is an approximation
to the real value. A comparison between an analytic and numeric
inversion for the unstable isotope Po-218 is discussed at the end of
this section (Fig. 4).
f (t) ≈ fn (t) =
s=

2n
ln(2) ∑

t

ak (n)F (s) where n ≥ 1, t > 0

(15)

t

ak (n) =

(14)

k=1

k ln(2)

(7)

0

(11)

1.8. Numerical inversion of the Laplace Transform

∞

∫

ω1

s(s + λ1 )
1
Ni (s) =
(bi−1 λi−1 Ni−1 (s))
(ωi ) +
s(s + λi )
s + λi
1
+
Ni (0)
s + λi
1
1
1
Nz (s) = 2 ωz + bz −1 λz −1 Nz −1 (s) + Nz (0).
s
s
s

1.6. Laplace transform
Laplace Transforms (7) are a useful mathematical tool, and allow ordinary differential equations to be solved by simple algebraic
manipulation in the s domain. Bateman took advantage of Laplace
Transforms in deriving his equation, and this is the method that
has been taken here as well.

1

N1 (0) +

(−1)(n+k)
n!

∑

jn+1

( )( )(
n
j

2j
j

)

j
.
k−j

(16)

1
)
j=Floor( k+
2

The equation for the ith isotope may be calculated by recursively calculating the equations by numeric inversion, starting
from the first (parent isotope) and inserting the result into each
subsequent recursion until the ith isotope is reached (changing
the equations appropriately for the parent, unstable daughter and
stable daughter isotopes).
1.9. Analytic solution by partial fraction expansion
The equation for the ith isotope in the s domain can be written
in full by substituting the preceding equation until the parent
isotope is reached, and this full equation may be rearranged with
the production amount of each isotope and starting amount of each
isotope in individual terms. Each of these terms is multiplied by a
fraction that can be expanded, using partial fractions, and inverted
analytically.
This is illustrated with an example unstable isotope, fourth in
the decay chain (including the parent isotope):
N4 (s) =

243

1
(s + λ1 )(s + λ2 )(s + λ3 )(s + λ4 )

b2 b3 b4 λ1 λ2 λ3 N1 (0)

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

B. Palmer et al. / Computer Physics Communications 216 (2017) 138–144

141

Fig. 3. An example of several decay chains including branching factors and possible external source terms for each isotope on each chain.

+

1
s2 (s + λ3 )

b4 λ3 ω3 +

1
s2

ω4 .

(18)

By using partial fraction expansion and standard Laplace Transforms, the set of equations below is used to calculate the amount
of the mth isotope in the decay chain, providing the mth isotope is
unstable.

⃗ b⃗, w
Nm (t ;∑
λ,
⃗)

⃗ f (t ; k, m, λ⃗ )Nk (0) + g(t ; k, m, λ⃗ )wk
⃗ b)
r(k; λ,

=

[

]

(19)

k=1,m

⃗) =
r(k, m, λ

⎧ ∏
⎨
(bi+1 λi ) ,

if k < m

(20)

i=k,m−1

⎩
Fig. 4. Decay of Po-218: Analytic and Gaver– Stehfest Calculation [5].

1,

if k = m

⃗)
f (t ; k, m, λ

⎡
+
+
+
+
+

1
b3 b4 λ2 λ3 N2 (0)
(s + λ2 )(s + λ3 )(s + λ4 )
1
1
b4 λ3 N3 (0) +
N4 (0)
(s + λ3 )(s + λ4 )
(s + λ4 )
1
b2 b3 b4 λ1 λ2 λ3 ω1
s(s + λ1 )(s + λ2 )(s + λ3 )(s + λ4 )
1
b3 b4 λ2 λ3 ω2
s(s + λ2 )(s + λ3 )(s + λ4 )
1
1
b4 λ3 ω3 +
ω4 .
(17)
s(s + λ3 )(s + λ4 )
s(s + λ4 )

An example stable isotope, fourth (last) in the decay chain
(including the parent isotope):
N4 (s) =

1

∑

= (−1)m−k

⎣exp(−λi t)

i=k,m

1
⃗) = ∏
g(t ; k, m, λ
i=k,m

j=k,m;j̸ =i

λi

×

1

⎣
i=k,m

λi

1

λi − λj

⎤
)
⎦

(21)

+ (−1)m−k+1

⎡
∑

∏ (

exp(−λi t)

∏ (
j=k,m;j̸ =i

1

λi − λj

⎤
)
⎦.

(22)

The set of equations below is used to calculate the amount of the
mth isotope in the decay chain, where the mth isotope is stable.

⃗ b⃗, w
Nm (t ; λ,
⃗ ) = Nm + wm t +

∑

⃗
⃗ b)
r(k; λ,

k=1,m−1

[
]
× f (t ; k, m − 1, λ⃗ )Nk (0) + g(t ; k, m, λ⃗ )wk
⎧ ∏
⎨
if k < m
(bi+1 λi ) ,
⃗ ) = i=k,m−1
r(k, m, λ
⎩
1,
if k = m

b2 b3 b4 λ1 λ2 λ3 N1 (0)

s(s + λ1 )(s + λ2 )(s + λ3 )
1
+
b3 b4 λ2 λ3 N2 (0)
s(s + λ2 )(s + λ3 )
1
+
b4 λ3 N3 (0) + N4 (0)
s(s + λ3 )
1
+ 2
b2 b3 b4 λ1 λ2 λ3 ω1
s (s + λ1 )(s + λ2 )(s + λ3 )
1
+ 2
b3 b4 λ2 λ3 ω2
s (s + λ2 )(s + λ3 )

1
⃗) = ∏
f (t ; k, m, λ
i=k,m

λi

×

⎣
i=k,m

244

1

λi

(24)

+ (−1)m−k+1

⎡
∑

(23)

exp(−λi t)

∏ (
j=k,m;j̸ =i

1

λi − λj

⎤
)
⎦

(25)

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

142

B. Palmer et al. / Computer Physics Communications 216 (2017) 138–144

• gammaLines.dat — tally into discrete bins of predicted
gamma counts.

• ionTraj.dat — the averaged ion trajectory used in the calculation.

• isotopeActivityFileG.dat — a large data file detailing the
activity of every predicted radioactive isotope in the target
at user specified times following irradiation.
The charts include:

• activityTop5.png — activity of the top 5 active isotopes as a
function of time after irradiation starts.

Fig. 5. Flow chart of major processes in the Activity code.

• gammaLines.png — predicted gamma spectrum expected at
the ‘‘experiment end time’’.

[
1

⃗) = ∏
g(t ; k, m, λ

i=k,m

λi

t+

]

∑

∏

i=k,m

j=k,m;j̸ =i

∏
i=k,m

λ2i

⎡
+ (−1)

m−k+1

1

∑
⎣
i=k,m

λ2i

λj

∏ (

exp(−λi t)

j=k,m;j̸ =i

1

λi − λj

)

⎤
⎦.

(26)

1.10. Preference: analytic over numeric
The numeric solution only requires the equation to be solved
in the s-domain; the Gaver–Stehfest algorithm performs the inversion. It is worth the extra effort to derive and implement an analytic
solution, as the numeric is only an approximation. Examples of
the pitfalls of the numeric solution are that it can give negative
amounts of an isotope and the difference between the numeric and
analytic calculated amounts can become quite large when the isotope decays away to a very small value. Fig. 4 shows the predicted
decay of a sample of Po-218 irradiated for 1000 s, and sampled until
10,000 s. In the region between 4000 s and 9000 s the amount from
the numeric calculation drops below zero, whereas the analytic
calculation remains above zero, as would be expected.
2. Computational methods
The Activity program has been developed in Fortran and takes
advantage of MPI (Message Parsing Interface) to speed up calculation times by allowing the use of multiple processes in parallel. It
has a self contained maths library, although this could be improved
in the future by using optimized maths libraries for certain functions (e.g. matrix operations).
The code was developed on a Debian based distribution of
Linux, but it should be supported on other variants of Linux and
Unix, and does not require any specialist hardware.
The user is required to prepare an input file that contains the
instructions required to perform a calculation. In addition to the
input file, the user must provide an EXYZ ion trajectory file output
by SRIM. Activity will read in the user input file, and the SRIM and
data files listed within, before performing the calculation. Fig. 5
shows a flowchart of the major steps the code performs.
There are various settings in the user input file, but the main
ones relating to the simulated experiment are:

•
•
•
•
•

Element composition of target (percentage by mass).
Beam flux (current), energy, duration and area on target.
Activity measurement time (end of the ‘‘experiment’’).
Material density.
Target thickness.

Several data files are generated by Activity and, if the user has
matplotlib [7], charts will be created too. The most relevant to the
user are:

The Activity code uses the equations derived above to calculate
the amount and activity of each isotope in the calculation. One
problem with the original Bateman equation that also exists in the
set of modified Bateman equations is that two different isotopes
with the same decay constant will cause a singularity and a halt
in the calculation. The activity code loops through all the decay
constants in use before it attempts to run the calculation. If any
isotope decay constants match they are varied by a small amount
relative to the decay constant. It repeats this process until all decay
constants are unique before proceeding.
3. Approximations
The accuracy of the Activity code is dependent on the input files
provided by the user and the method used to calculate the reaction
rates and resulting activity. The TENDL proton database consists of
experimental measured cross sections as well as values calculated
using the optical model potential. Using the latest database is
recommended.
SRIM uses the binary collision approximation to simulate ion
transport. It is a well tested code that has been used for many years.
One limitation is that the structure of the material is not taken
into account. This would have an impact on a user of the Activity
program if they were trying to calculate, for example, whether
a FCC (face centered cubic) steel would be irradiated differently
when compared to a BCC (body centered cubic) steel. The Activity
code would determine the activity of the steel as a function of the
ion current, ion type and the density, thickness and composition of
the steel, not its structure.
This version of the Activity code averages the path of all the
SRIM simulated ions, rather than treating each ion differently. This
may or may not have an impact on the results. If a new version
of the code is developed there would be an option to calculate
reaction rates for each individual simulated ion, and a comparison
could then be made to the calculations using the averaged path of
a set of ions.
The final approximation would be to use the numeric solution
to the activity equations, although the analytic solution is forced
within the code unless it returns a failed result.
4. Results
A target of high purity Iron was irradiated with 36 MeV protons
by the University of Birmingham Scanditronix MC-40 Cyclotron.
The target was 0.5 mm thick and was irradiated at a current of
0.5 µA for 300 s, irradiating approximately 0.25 g of Iron. A high
purity Germanium detector was used to measure the gamma peaks
three days after irradiation.
The peak that dominated the readings was the 931 keV Cobalt
55 line. After calibrating the detector and adjusting the readings,
this peak was measured at 44,300 Bq+/-2000 Bq. The activity of
this peak as predicted by the Activity code was 44,565 Bq.

245

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

B. Palmer et al. / Computer Physics Communications 216 (2017) 138–144

143

Table 1
Gamma peaks predicted and measured for a 13 MeV ion irradiated sample of Mo.
Gamma energy (keV)

Predicted activity (Bq)

Experimental activity (Bq)

766
778
812
850
126

4.45E6
6.14E6
5.04E6
6.00E6
9.33E5

5.11E5+/−2.5E4
1.36E6+/−6.8E4
1.15E6+/−5.8E4
1.39E6+/−7.0E4
2.10E5+/−1.1E4

Fig. 8. Sample Activity code output chart for the top five most active isotopes for
Molybdenum irradiated by 13 MeV protons.

Fig. 6. Sample Activity code output chart for the top five most active isotopes for
Iron irradiated by 36 MeV protons.

Fig. 9. Sample Activity code output chart for the expected gamma lines to be
measured for Molybdenum irradiated by 13 MeV protons.

Fig. 7. Sample Activity code output chart for the expected gamma lines to be
measured for Iron irradiated by 36 MeV protons.

A target of high purity Molybdenum was irradiated with
13 MeV protons by the University of Birmingham Scanditronix
MC-40 Cyclotron. The target was 0.5 mm thick and was irradiated
at a current of 5 µA for 1500 s, irradiating approximately 0.3 g
of Molybdenum. A high purity Germanium detector was used to
measure the gamma peaks three days after irradiation.
Five peaks were of interest, and these are listed in Table 1.
There was the possibility of the high purity Geranium detector
introducing errors due to detector dead time, where by a source
that is too active floods the device with gammas. The samples
were safe to handle, and did not appear to flood the detector
in any way, but there was still the possibility of counts being
missed due to dead time. The probabilistic nature of radioactive
decay also introduced inherent errors to the experimental activity
measurements (see Figs. 6–9).

takes advantage of multi-core processors, and typical calculations
take from seconds to minutes.
Using the SRIM code and TENDL database, the code has been
used to predict the activity of Iron and Molybdenum targets that
have been irradiated with a proton beam. The prediction of the 931
(keV) Cobalt 55 gamma activity of irradiated Iron was very close to
the measured value. The five predicted gamma activities for ion
irradiated Molybdenum were up to a factor of 5–10 away from the
measured activities.
There are a number of improvements that would be considered
in a future version of the Activity code. These improvements would
include the following:

• A more readable output with less information printed, as too
much may confuse the user.

• A file containing the top five radioactive isotopes with their
top five gamma lines.

• Individual ion trajectories used to calculate the reaction
rates, rather than the average path.

• Experimental ion activation data for a wider range of elements to test the Activity code against.

• Expand to include deuterons (this would require the TENDL
deuteron cross section database).
Acknowledgments
We would like to thank and acknowledge the input and advice
of the following:

5. Conclusions
The Activity program is an easy to use Fortran compiled executable that can be built and run, for free, on a Linux computer. It

246

• Dr Chris Cooper and John Hewett for irradiation activation
data points.

APPENDIX C. ACTIVITY CODE

144

C.1. ACTIVITY V1

B. Palmer et al. / Computer Physics Communications 216 (2017) 138–144

• The University of Birmingham for providing the funding for
this project.
References
[1] A.J. Koning, D. Rochman, Nucl. Data Sheets 113 (2012).
[2] A.A. Sonzogni, Nuclear Data Services. www-nds.iaea.org. 2006. URL: http://
www-nds.iaea.org/ndspub/download-endf/ENDF-B-VII.0/decay-index.htm
(visited on 08/14/2015).

[3] M. Herman, M.B. Chadwick, Nucl. Data Sheets 107 (2006) 2931.
[4] J.P. Biersack, J.F. Ziegler, M.D. Ziegler, Nuclear Instrum. Methods Phys. Res. B 268
(2010) 1818–1823.
[5] P. Blaise, M. Coste, A. Courcelle, T.D. Huynh, C. Jouanne, P. Leconte, O. Litaize, S.
Mengelle, G. Nogure, J.-M. Ruggiri, O. Srot, J. Tommasi, C. Vaglio, J.-F. Vidal, A.
Santamarina, D. Bernard, The JEFF-3.1.1 Nuclear Data Library. 2009. ISBN: 97892-64-99074-6.
[6] H. Stehfest, Commun. ACM 13 (1970) 47–49.
[7] J.D. Hunter, Comput. Sci. Eng. 9 (2007) 90–95.

247

C.1. ACTIVITY V1

C.1.2

APPENDIX C. ACTIVITY CODE

Accompanying Manual

The accompanying manual for the Activity code is included in the following pages.

248

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Department of Metallurgy & Materials

Activity Manual

249

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

Contents
1 Background
1.1

1.2

1.3

4

Ion Irradiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

1.1.1

Ion Irradiation at the University of Birmingham . . . . . . . . . . . . . . . . . . . . . . .

4

1.1.2

Simulating Ion Irradiation with SRIM . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

1.1.3

Transmutation of Nuclei by Ion Irradiation . . . . . . . . . . . . . . . . . . . . . . . . . .

5

Decay and Activity Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.2.1

Radioactive Decay . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.2.2

Bateman Equation for Radioactive Decay . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.2.3

Laplace Transform . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7

1.2.4

Constructing the Differential Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7

1.2.5

Numerical Inversion of the Laplace Transform . . . . . . . . . . . . . . . . . . . . . . . . .

8

1.2.6

Analytic Solution by Partial Fraction Expansion . . . . . . . . . . . . . . . . . . . . . . .

9

1.2.7

Preference: Analytic over Numeric . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

Computational Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
1.3.1

Activity Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

1.3.2

Approximations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

1.3.3

Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

2 Installation and Using the Activity Code
2.1

Getting Started . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
2.1.1

2.2

17

Prerequisites . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

Installing Activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
2.2.1

Download Source Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

2.2.2

Compile Source Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

2.3

Input File . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

2.4

Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

Appendices

22

2

250

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

A Example Input File

23

A.1 Iron 36MeV Proton Beam . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
B Fortran 90 Code

25

B.1 Fortran 90 Implementation of Analytic Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

3

251

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

List of Figures
1.1

Proton energy loss in Fe simulated with SRIM [2] . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.2

An example decay chain from an unstable parent isotope, through unstable daughter isotopes
ending with a stable daughter isotope. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1.3

5

6

An example of several decay chains including branching factors and possible external source terms
for each isotope on each chain. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7

1.4

Decay of Po-218: Analytice and Gaver-Stehfest Calculations [5] . . . . . . . . . . . . . . . . . . . 11

1.5

Flow chart of major processes in the Activity code . . . . . . . . . . . . . . . . . . . . . . . . . . 12

1.6

Sample Activity code output chart for the top five most active isotopes for Iron irradiated by
36MeV protons. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

1.7

Sample Activity code output chart for the expected gamma lines to be measured for Iron irradiated by 36MeV protons. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

1.8

Sample Activity code output chart for the top five most active isotopes for Molybdenum irradiated
by 13MeV protons. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

1.9

Sample Activity code output chart for the expected gamma lines to be measured for Molybdenum
irradiated by 13MeV protons. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

4

252

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Chapter 1

Background
1.1

Ion Irradiation

A computer program, Activity, was developed to predict the activity and gamma lines of materials irradiated
with an ion beam. It uses the TENDL[1] proton reaction cross section database, the Stopping and Range of
Ions in Matter (SRIM)[2] code, a Nuclear Data Services (NDS) radioactive decay database [3] and an ENDF
gamma decay database [4]. An extended version of Bateman’s equation is used to calculate the activity at time
t, and this equation is solved analytically, with the option to also solve by numeric inverse Laplace transform
as a failsafe. The program outputs the expected activity and gamma lines of the activated material.

1.1.1

Ion Irradiation at the University of Birmingham

The Scanditronix MC-40 Cyclotron is used at the University of Birmingham to create a beam of protons or
other light ions. The energies of these ions are typically between 10 MeV and 60 MeV with beam currents
ranging up to 50 microamps (3.1x1014 protons per second). Target materials are irradiated by this cyclotron for
a number of reasons, including purposely creating radioactive isotopes for the nearby Queen Elizabeth Hospital,
investigating ion irradiation damage and emulating neutron irradiation.
The Cyclotron is usually used to create radioactive isotopes for medical use, but an additional beam line
has been devoted to material science investigations into radiation damage. While the creation of radioactive
isotopes is desired in some cases, material being tested for radiation damage should preferably have low levels
of radioactivity.
It is expensive to arrange the irradiation of target materials by high energy neutrons sources, whereas it is
relatively inexpensive to irradiate using an ion beam on the MC-40 Cyclotron. The energies can be controlled,
and a set dose at a single energy, or a range of energies, can be precisely deposited in the target material.
The Activity code discussed here was developed to calculate the activity of a target material irradiated by
a proton beam. It has been developed in Fortran and uses data from the TENDL-2013 proton cross section
database, SRIM ion transport code and NDS radioactive decay database.

1.1.2

Simulating Ion Irradiation with SRIM

A package of ion transport codes, SRIM, is freely available to download and use to investigate the transport
of ions through matter. SRIM uses the binary collision approximation (BCA) to simulate the passage of ions
in a material. It is an approximate method, and one key restriction is that the does not take into account the
structure of the material, and this approximation is therefore also imposed on the Activity code.
5

253

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

14000

14000

12000

10000

10000

8000

8000

6000

6000

4000

4000

2000

2000

Y-axis Label

12000

0
0

500000

1e+06

1.5e+06

2e+06
2.5e+06
X-axis Label

3e+06

3.5e+06

4e+06

Y-axis Label

Energy per Atom (eV)

0
4.5e+06

Figure 1.1: Proton energy loss in Fe simulated with SRIM [2]

One file that SRIM creates is of importance to the Activity code, and that is the trajectory file that contains
the energy and x,y,z co-ordinate data points for simulated ions moving through matter. Figure 1.1 shows the
trajectory of protons passing through an Iron target, and it is this set of data points (together with the cross
section database) that the Activity code uses to calculte the reaction rates for the transmutation of nuclei in
the target. At higher energies, the ions slow as they lose energy due to electronic stopping, but as the ion
energy drops the mechanism of loss through nuclear collisions becomes important. The spreading of ion depths
at lower energies is a result of the higher momentum transfer during nuclear collisions, as can be seen in Figure
1.1.

1.1.3

Transmutation of Nuclei by Ion Irradiation

Considering a simplified nuclear potential well, energetic protons approaching a nucleus may overcome the
coulomb potential barrier. They are captured by the nucleus and held within the potential well by the strong
nuclear force. This process may leave the nucleus in an excited and unstable state, depending on the input
energy of the proton and configuration of nucleons. The process is probabilistic, and the average chance of a
reaction (the microscopic cross section) may be measured as a function of the projectile, projectile energy and
target, either experimentally or by optical model potential calculations. The reaction rate is calculated from
the microscopic cross section using the following equation:

𝑅=

𝐽
𝑛𝑡 𝜎 · 1028 𝛿𝑡
𝑒

∙ R Reaction Rate (reactions per second)
∙ J Beam current (A)
∙ 𝑛𝑡 Number density of target (atoms per cubic metre)
∙ 𝜎 Microscopic reaction cross section (barns)
∙ e Elementary charge (1.602177E-19C)
∙ 𝛿T Target thickness (m)

6

254

(1.1)

APPENDIX C. ACTIVITY CODE

1.2
1.2.1

C.1. ACTIVITY V1

Decay and Activity Equations
Radioactive Decay

Radioactive decay is the random change in nucleons or energy state of an unstable nucleus. It is impossible to
predict when a nucleus will decay, but the decay of a collection of nuclei is statistical in nature. The radioactivity
and number of unstable nuclei at time t can be predicted using the decay constant λfor the radioactive isotope.
This constant is defined as follows:

𝜆=−

𝑁 ′ (𝑡)
𝑁 (𝑡)

(1.2)

The number of radioactive nuclei N(t) at time t is given by the following equation, where N(0) is the starting
number of nuclei:

𝑁 (𝑡) = 𝑁 (0) exp(−𝑡𝜆)

(1.3)

The activity A(t) of the radioactive nuclei is predicted at time t by using the following equations, where N’(t)
is the change in amount of nuclei with respect to time:

1.2.2

𝐴(𝑡) = −𝑁 ′ (𝑡) = 𝜆𝑁 (𝑡)

(1.4)

𝐴(𝑡) = 𝜆𝑁 (0) exp(−𝑡𝜆)

(1.5)

Bateman Equation for Radioactive Decay

Parent Isotope, N1 (t)

1st Unstable Daughter Isotope, N2 (t)

2nd Unstable Daughter Isotope, N3 (t)

Stable Daughter Isotope, N4 (t)
Figure 1.2: An example decay chain from an unstable parent isotope, through unstable daughter isotopes ending
with a stable daughter isotope.
The English mathematician Harry Bateman derived an equation to calculate the amount of each isotope in a
decay chain, illustrated in Figure 1.2, at time t.

𝑁𝑛 (𝑡) =

𝑖=𝑛
∑︁
𝑖=1

⎛⎛
⎝⎝

𝑗=𝑛−1
∏︁
𝑗=𝑖

⎞

𝜆(𝑖𝑗+1) ⎠
7

255

𝑗=𝑛
∑︁
𝑗=𝑖

(︃

)︃⎞
𝑁𝑖0 exp(−𝜆𝑗 𝑡)
⎠
∏︀𝑝=𝑛
𝑝=𝑖,𝑝̸=𝑗 (𝜆𝑝 − 𝜆𝑗 )

(1.6)

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

When a radioactive isotope decays, there may be more than one mode of decay, and this leads to branching
factors. Pb-214 only decays via beta decay to Bi-214, giving a branching factor of 1.0, whereas Bi-214 has a
99.979% chance of decaying to Po-214 by beta decay and a 0.021% of emitting an alpha particle and decaying
to Tl-210 (branching factors of 0.99979 and 0.00021 respectively) [5].
When a target material is irradiated, there is a source term for transmuted nuclei due to the irradiation. The
daughter isotopes of these transmuted isotopes will also be affected by the irradiation and will transmute further,
giving a source term for each daughter isotope as a result of the irradiation. Sources for each isotope in the
decay chain, and branching factors between a parent isotope and its daughter isotope/s must be accounted for.
The Bateman equation was derived using Laplace transforms, and this same method has been used to develop a
modified equation that incorporates branching factors and production rates for each isotope in the decay chain,
as illustrated by Figure 1.3.
Parent Isotope

Parent Source

Branching

External Source

Daughter 1 (Branch A)

Daughter 1 (Branch B)

External Source

Daughter 2 (Branch B)

External Source

Branching

External Source

Daughter 2 (Branch A)

Figure 1.3: An example of several decay chains including branching factors and possible external source terms
for each isotope on each chain.

1.2.3

Laplace Transform

Laplace Transforms are a useful mathematical tool, and allow ordinary differential equations to be solved by
simple algebraic manipulation in the s domain. Bateman took advantage of Laplace Transforms in deriving his
equation, and this is the method that has been taken here as well.

𝐹 (𝑠) =

∫︁∞

𝑓 (𝑡) exp(−𝑠𝑡)𝑑𝑡

(1.7)

0

1.2.4

Constructing the Differential Equations

The first step is to set up differential equations for the parent isotope, unstable daughter isotopes and stable
daughter isotope. The parent isotope has a source term, due to production, and a loss term, due to decay. The
unstable daughter isotopes have two source terms, from the production by irradiation induced transmutation

8

256

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

and the decay of preceding isotopes in the decay chain, and a loss term, due to decay. Finally, the stable
daughter that finalizes the decay chain has two source terms (the same as the unstable daughters) but no loss
term.
The variables (and vectors) used in these equations are defined as follows:
∙ ⃗𝜆 vector containing isotope decay constants 𝜆𝑖
∙ ⃗𝑏 vector containing isotope to isotope branching factors 𝑏𝑖
∙ 𝑤
⃗ vector containing isotope production rates 𝑤𝑖
∙ 𝑡 time at which activity/amount of isotope is measured
∙ 𝑁𝑖 (0) starting amount of the ith isotope
∙ 𝑁𝑖 (𝑡) amount of the ith isotope at time t
∙ 𝑁𝑖′ (𝑡) change in amount of the ith isotope, with respect to time, at time t
The differential equations for the parent isotope (first isotope), unstable daughter isotopes (ith isotopes) and
stable, final, daughter isotope (zth isotope) in the time domain are as follows:
𝑁1′ (𝑡) = 𝜔1 − 𝜆1 𝑁1 (𝑡)

(1.8)

𝑁𝑖′ (𝑡) = 𝜔𝑖 + 𝑏𝑖−1 𝜆𝑖−1 𝑁𝑖−1 (𝑡) − 𝜆𝑖 𝑁𝑖 (𝑡)

(1.9)

𝑁𝑧′ (𝑡) = 𝜔𝑧 + 𝑏𝑧−1 𝜆𝑧−1 𝑁𝑧−1 (𝑡)

(1.10)

Applying the Laplace Transform to these three differential equations allows them to be manipulated and solved
algebraically in the s-domain.
1
1
𝑁1 (0) +
𝜔1
𝑠 + 𝜆1
𝑠(𝑠 + 𝜆1 )

(1.11)

1
1
1
(𝜔𝑖 ) +
(𝑏𝑖−1 𝜆𝑖−1 𝑁𝑖−1 (𝑠)) +
𝑁𝑖 (0)
𝑠(𝑠 + 𝜆𝑖 )
𝑠 + 𝜆𝑖
𝑠 + 𝜆𝑖

(1.12)

1
1
1
𝜔𝑧 + 𝑏𝑧−1 𝜆𝑧−1 𝑁𝑧−1 (𝑠) + 𝑁𝑧 (0)
𝑠2
𝑠
𝑠

(1.13)

𝑁1 (𝑠) =

𝑁𝑖 (𝑠) =

𝑁𝑧 (𝑠) =

1.2.5

Numerical Inversion of the Laplace Transform

The Gaver-Stehfest[6] algorithm was developed in the 1960s and 1970s and is a method of calculating the inverse
of a Laplace Transform in the real number domain. It is an easy to implement and reasonably accurate method,
although it is an approximation to the real value. A comparison between an analytic and numeric inversion for
the unstable isotope Po-218 is discussed at the end of this section.
2𝑛

𝑓 (𝑡) ≈ 𝑓𝑛 (𝑡) =

ln(2) ∑︁
𝑎𝑘 (𝑛)𝐹 (𝑠) where 𝑛 ≥ 1, 𝑡 > 0
𝑡
𝑘=1

9

257

(1.14)

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

𝑘 ln(2)
𝑡

𝑠=

(−1)(𝑛+𝑘)
𝑎𝑘 (𝑛) =
𝑛!

∑︁

𝑗

𝑗=𝐹 𝑙𝑜𝑜𝑟( 𝑘+1
2 )

𝑛+1

(1.15)
(︃ )︃ (︃ )︃ (︃
)︃
𝑛
2𝑗
𝑗
𝑗

𝑗

𝑘−𝑗

(1.16)

The equation for the ith isotope may be calculated by recursively calculating the equations by numeric inversion,
starting from the first (parent isotope) and inserting the result into each subsequent recursion until the ith
isotope is reached (changing the equations appropriately for the parent, unstable daugher and stable daughter
isotopes).

1.2.6

Analytic Solution by Partial Fraction Expansion

The equation for the ith isotope in the s domain can be written in full by substituting the preceding equation
until the parent isotope is reached, and this full eqaution may be rearranged with the production amount of
each isotope and starting amount of each isotope in individual terms. Each of these terms is multiplied by a
fraction that can be expanded, using partial fractions, and inverted analytically.
This is illustrated with an example unstable isotope, fourth in the decay chain (including the parent isotope):

𝑁4 (𝑠) =

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝑁1 (0)
(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
𝑏3 𝑏4 𝜆2 𝜆3 𝑁2 (0)
+
(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
𝑏4 𝜆3 𝑁3 (0)
+
(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝑁4 (0)
(𝑠 + 𝜆4 )
1
+
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝜔1
𝑠(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝑏3 𝑏4 𝜆2 𝜆3 𝜔2
𝑠(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
𝑏4 𝜆3 𝜔3
+
𝑠(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝜔4
𝑠(𝑠 + 𝜆4 )

An example stable isotope, fourth (last) in the decay chain (including the parent isotope):

10

258

(1.17)

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝑁1 (0)
𝑠(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+
𝑏3 𝑏4 𝜆2 𝜆3 𝑁2 (0)
𝑠(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+
𝑏4 𝜆3 𝑁3 (0)
𝑠(𝑠 + 𝜆3 )

𝑁4 (𝑠) =

+𝑁4 (0)
+

𝑠2 (𝑠

(1.18)

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝜔1
+ 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
𝑏3 𝑏4 𝜆2 𝜆3 𝜔2
+ 2
𝑠 (𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+ 2
𝑏4 𝜆3 𝜔3
𝑠 (𝑠 + 𝜆3 )
1
+ 2 𝜔4
𝑠

By using partial fraction expansion and standard Laplace Transforms, the set of equations below is used to
calculate the amount of the mth isotope in the decay chain, providing the mth isotope is unstable.

𝑁𝑚 (𝑡; ⃗𝜆, ⃗𝑏, 𝑤)
⃗ =

∑︁

𝑘=1,𝑚

[︁
]︁
𝑟(𝑘; ⃗𝜆, ⃗𝑏) 𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆)𝑁𝑘 (0) + 𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆)𝑤𝑘

𝑟(𝑘, 𝑚, ⃗𝜆) =

⎧
⎨∏︀

𝑖=𝑘,𝑚−1

⎩1,

𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆) = (−1)𝑚−𝑘

∑︁

𝑖=𝑘,𝑚

𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

1

𝑖=𝑘,𝑚

𝜆𝑖

(𝑏𝑖+1 𝜆𝑖 ) , if 𝑘 < 𝑚

+ (−1)

(1.19)

(1.20)

if 𝑘 = 𝑚

⎡

⎣exp(−𝜆𝑖 𝑡)

𝑚−𝑘+1

∑︁

𝑖=𝑘,𝑚

⎡

∏︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

⎣ 1 exp(−𝜆𝑖 𝑡)
𝜆𝑖

(︂

⎤
)︂
1
⎦
𝜆𝑖 − 𝜆𝑗
∏︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

(︂

⎤
)︂
1
⎦
𝜆𝑖 − 𝜆𝑗

(1.21)

(1.22)

The set of equations below is used to calculate the amount of the mth isotope in the decay chain, where the
mth isotope is stable.

𝑁𝑚 (𝑡; ⃗𝜆, ⃗𝑏, 𝑤)
⃗ = 𝑁𝑚 + 𝑤𝑚 𝑡 +

∑︁

𝑘=1,𝑚−1

𝑟(𝑘, 𝑚, ⃗𝜆) =

[︁
]︁
𝑟(𝑘; ⃗𝜆, ⃗𝑏) 𝑓 (𝑡; 𝑘, 𝑚 − 1, ⃗𝜆)𝑁𝑘 (0) + 𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆)𝑤𝑘

⎧
⎨∏︀

𝑖=𝑘,𝑚−1

⎩1,

(𝑏𝑖+1 𝜆𝑖 ) , if 𝑘 < 𝑚
if 𝑘 = 𝑚

11

259

(1.23)

(1.24)

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

1e+08

Po-218
Po-218 (GS)

1e+06

10000

Po-218 (mircograms)

100

1

0.01

0.0001

1e-06

1e-08
0

1000

2000

3000

4000

5000
Time (seconds)

6000

7000

8000

9000

10000

Figure 1.4: Decay of Po-218: Analytice and Gaver-Stehfest Calculations [5]

𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

1

𝑖=𝑘,𝑚

𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

1

𝑖=𝑘,𝑚

1.2.7

𝜆𝑖

𝑡+

∑︀

𝑖=𝑘,𝑚

𝜆𝑖

+ (−1)

∑︁

𝑖=𝑘,𝑚

[︁∏︀

∏︀

𝑚−𝑘+1

𝑗=𝑘,𝑚;𝑗̸=𝑖

𝑖=𝑘,𝑚

𝜆2𝑖

𝜆𝑗

]︁

⎡

⎣ 1 exp(−𝜆𝑖 𝑡)
𝜆𝑖

+ (−1)

𝑚−𝑘+1

∑︁

𝑖=𝑘,𝑚

∏︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

⎡

(︂

⎤
)︂
1
⎦
𝜆𝑖 − 𝜆𝑗

⎣ 1 exp(−𝜆𝑖 𝑡)
𝜆2𝑖

∏︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

(1.25)

(︂

⎤
)︂
1
⎦
𝜆𝑖 − 𝜆𝑗

(1.26)

Preference: Analytic over Numeric

The numeric solution only requires the equation to be solved in the s-domain; the Gaver-Stehfest algorithm
performs the inversion. It is worth the extra effort to derive and implement an analytic solution, as the numeric
is only an approximation. Examples of the pitfalls of the numeric solution are that it can give negative amounts
of an isotope and the difference between the numeric and analytic calculated amounts can become quite large
when the isotope decays away to a very small value. Figure 1.4 shows the predicted decay of a sample of Po-218
irradiated for 1,000s, and sampled until 10,000s. In the region between 4,000s and 9,000s the amount from
the numeric calculation drops below zero, whereas the analytic calculation remains above zero, as would be
expected.

12

260

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Figure 1.5: Flow chart of major processes in the Activity code

1.3
1.3.1

Computational Methods
Activity Code

The Activity program has been developed in Fortran and takes advantage of MPI (Message Parsing Interface)
to speed up calculation times by allowing the use of multiple processes in parallel. It has a self contained maths
library, although this could be improved in the future by using optimised maths libraries for certain functions
(e.g. matrix operations).
The code was developed on a Debian version of Linux, but it should be supported on other variants of Linux
and Unix, and does not require any specialist hardware.
The user is required to prepare an input file that contains the instructions required to perform a calculation.
In addition to the input file, the user must provide an EXYZ ion trajectory file output by SRIM. Activity will
read in the user input file, and the SRIM and data files listed within, before performing the calculation. Figure
1.5 shows a flowchart of the major steps the code performs.
There are various settings in the user input file, but the main ones relating to the simulated experiment are:
∙ element composition of target (percentage by mass)
∙ beam flux (current), energy, duration and area on target
∙ activity measurement time (end of the “experiment”)
∙ material density
∙ target thickness
Several data files are generated by Activity and, if the user has matplotlib [7], charts will be created too. The
most relevant to the user are:
∙ gammaLines.dat - tally into discrete bins of predicted gamma counts
13

261

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

∙ ionTraj.dat - the averaged ion trajectory used in the calculation
∙ isotopeActivityFileG.dat - a large data file detailing the activity of every predicted radioactive isotope in
the target at user specified times following irradioation

The charts include:
∙ activityTop5.png - activity of the top 5 active isotopes as a function of time after irradiation starts
∙ gammaLines.png - predicted gamma spectrum expected at the “experiment end time”
The Activity code uses the equations derived above to calculate the amount and activity of each isotope in the
calculation. One problem with the original Bateman equation that also exists in the set of modified Bateman
equations is that two different isotopes with the same decay constant will cause a singularity and a halt in
the calculation. The activity code loops through all the decay constants in use before it attempts to run the
calculation. If any isotope decay constants match they are varied by a small amount relative to the decay
constant. It repeats this process until all decay constants are unique before proceding.

1.3.2

Approximations

The accuracy of the Activity code is dependant on the input files provided by the user and the method used
to calculate the reaction rates and resulting activity. The TENDL proton database consists of experimental
measured cross sections as well as values calculated using the optical model potential. Using the latest database
is recommended.
SRIM uses the binary collision approximation to simulate ion transport. It is a well tested code that has been
used for many years. One limitation is that the structure of the material is not taken into account. This would
have an impact on a user of the Activity program if they were trying to calculate, for example, whether a FCC
(face centered cubic) steel would be irradiated differently when compared to a BCC (body centered cubic) steel.
The Activity code would determine the activity of the steel as a function of the ion current, ion type and the
density, thickness and composition of the steel, not its structure.
This version of the Activity code averages the path of all the SRIM simulated ions, rather than treating each
ion differently. This may or may not have an impact on the results. If a new version of the code is developed
there would be an option to calculate reaction rates for each induvidual simulated ion, and a comparison could
then be made to the calculations using the averaged path of a set of ions.
The final approximation would be to use the numeric solution to the activity equations, although the analytic
solution is forced within the code unless it returns a failed result.

1.3.3

Results

A target of high purity Iron was irradiated with 36 MeV protons by the University of Birmingham Scanditronix
MC-40 Cyclotron. The target was 0.5mm thick and was irradiated at a current of 0.5 micro Amps for 300
seconds, irradiating approximately 0.25g of Iron. A high purity Germanium detector was used to measure the
gamma peaks three days after irradiation.
The peak that dominated the readings was the 931 keV Cobalt 55 line. After calibrating the detector and
adjusting the readings, this peak was measured at 44,300Bq+/-2,000Bq. The activity of this peak as predicted
by the Activity code was 44,565Bq.
A target of high purity Molybdenum was irradiated with 13 MeV protons by the University of Birmingham
Scanditronix MC-40 Cyclotron. The target was 0.5mm thick and was irradiated at a current of 5 micro Amps
14

262

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Table 1.1: Gamma peaks predicted and measured for a 13 MeV ion irradiated sample of Mo
Gamma Energy (keV) Predicted Activity (Bq) Experimental Activity (Bq)
766
4.45E6
5.11E5+/-2.5E4
778
6.14E6
1.36E6+/-6.8E4
812
5.04E6
1.15E6+/-5.8E4
850
6.00E6
1.39E6+/-7.0E4
126
9.33E5
2.10E5+/-1.1E4

Figure 1.6: Sample Activity code output chart for the top five most active isotopes for Iron irradiated by 36MeV
protons.

for 1500 seconds, irradiating approximately 0.3g of Molybdenum. A high purity Germanium detector was used
to measure the gamma peaks three days after irradiation.
Five peaks were of interest, and these are listed in Table 1.1.

15

263

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

Figure 1.7: Sample Activity code output chart for the expected gamma lines to be measured for Iron irradiated
by 36MeV protons.

Figure 1.8: Sample Activity code output chart for the top five most active isotopes for Molybdenum irradiated
by 13MeV protons.

16

264

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Figure 1.9: Sample Activity code output chart for the expected gamma lines to be measured for Molybdenum
irradiated by 13MeV protons.

17

265

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

Chapter 2

Installation and Using the Activity
Code
2.1

Getting Started

2.1.1

Prerequisites

This code was designed to run on Linux and has been developed and tested on the Debian based distribution
Mint. It has not been tested on any other versions of Linux or Unix, nor has it been tested on cygwin.
The minimal requirements of the code are:
∙ 250MB per process + 200MB overhead
∙ 1GB Hard Drive space
∙ Ideally a modern multicore processor
∙ Fortran90
∙ OpenMPI
Optional:
∙ GNUPlot
∙ Python & MatPlotLib

2.2
2.2.1

Installing Activity
Download Source Code

The most recent source code is available for download from github. It may be downloaded and extracted using
the terminal and the commands in listing 1.

18

266

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Listing 2.1: bash
1

cd ~

2

mkdir -p ~/activity/tar

3

cd ~/activity/tar

4

wget https://github.com/BenPalmer1983/activity/raw/master/activity.tar.gz

5

tar -xzvf activity.tar.gz

2.2.2

Compile Source Code

Once the source files have been downloaded and extracted, run the install script then remove the downloaded
files (if you need to free up space). The terminal commands are given in listing 2. Providing the prerequisites
are available, the process will only take a few minutes (with a reasonable Internet connection).
Listing 2.2: bash
1

cd ~/activity/tar

2

./install.sh #choose installation directory when prompted; default is ~/activity

3

rm -R ~/activity/tar

The activity code is now installed and the activity.x binary may be executed on the terminal. If the terminal
fails to find the binary, the .bashrc or .bash profile file must be edited, or a symlink created from the bin file to
a valid and accessible bin directory.

2.3

Input File

The input file sets the target starting composition, the beam and simulated experiment settings as well as the
paths to the required data files.
#elements
The elements keyword instructs the code to read in the composition of the target material. The elements and
their percentage by weight are listed under the keyword.
Listing 2.3: Input File
1

#elements

2

Fe 72

3

Cr 18

4

Ni 8

5

Mg 2

#isotopes #decaymodes #gammaenergies #xsfiles
Four sets of data files are distributed with the code, and the paths to these files are defined underneath each
keyword. N.B. the path for the xsfiles is to the directory that holds all the cross section data files, rather than
each individual file.
Listing 2.4: Input File
1

#isotopes

2

"/home/ben/activity/data/isotopes.txt"

3

#decaymodes

4

"/home/ben/activity/data/decaymodes.txt"

19

267

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

5

#gammaenergies

6

"/home/ben/activity/data/gammaenergies.txt"

7

#xsfiles

8

"/home/ben/activity/data/xs"

#trajfile
The SRIM exyz file used for the calculation is pointed to under this keyword.
Listing 2.5: Input File
1

#trajfile

2

"/home/ben/activity/examples/Fe36MeV.exyz"

#polyfitorder #integrationgranularity
The code calculates the reaction rate of each projectile and target nucleus by first fitting a polynomial to the
energy/depth data file. This polynomial gives an average path for the projectiles travelling through the target,
allowing E(x) to be calculated quickly. The order of the polynomial is selected here, and a 5th order shold give
a reasonable fit. The integration granularity keyword determines how many sections the polynomial is split up
into. The energy, cross section for each section and the beam settings are used to calculate the reaction rate
for each section, and these are all summed up to give the overall reaction rate.
Listing 2.6: Input File
1

#polyfitorder

2

5

3

#integrationgranularity

4

10

#beamflux #beamenergy #beamduration #beamarea
These keywords are self explanatory and control the beam settings used in the calculation.
Listing 2.7: Input File
1

#beamflux

2

0.5 uA

3

#beamenergy

4

36 MeV

5

#beamduration

6

300 s

7

#beamarea

8

100 mm2

#amtime #timestep
The time at which the activity of the sample is measured is set by the #amtime keyword. The Activity code
calculates the activity of each radioactive isotope in the calculation from the time the beam starts until the
äctivity measured time,̈ and the intervals at which these calculations are made is determined by the #timestep
keyword.
Listing 2.8: Input File
1

#amtime

2

260000 s

20

268

APPENDIX C. ACTIVITY CODE

3

#timestep

4

1000 s

C.1. ACTIVITY V1

#projectile
The current version only supports protons as the projectile, therefore the only possible atomic and mass number
combination for a projectile is 1 1.
Listing 2.9: Input File
1

#projectile

2

1 1

#targetthickness #materialdensity
Both the target thickness and density of the material it is made from are input with these keywords.
Listing 2.10: Input File
1

#targetthickness

2

0.5 mm

3

#materialdensity

4

8000 kgm3

#vpi
This keyword is only being used for a feature currently under testing, so the keyword can be ommited from the
input file.
Listing 2.11: Input File
1

#vpi

2

60.2

#individualisotopeactivity #verboseterminal
If the #individualisotopeactivity keyword is followed by ÿes,̈ additional data files are output containing the activity of each individual isotope in the calulcation. #verboseterminal followed by ÿesẅill output more verbosely
to the terminal.
Listing 2.12: Input File
1

#individualisotopeactivity

2

yes

3

#verboseterminal

4

yes

#targetdpa
This keyword is only being used for a feature currently under testing, so the keyword can be ommited from the
input file.
Listing 2.13: Input File
1

#targetdpa

2

0.0

21

269

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

#gammachartresolution
The gamma chart is created by tallying the gamma values into bins, and this figure specifies the resolution(number of bins) used to create the output chart.
Listing 2.14: Input File
1

#gammachartresolution

2

200

2.4

Acknowledgements

We would like to thank and acknowledge the input and advice of the following:
∙ Dr Chris Cooper and John Hewett for irradiation activation data points.
∙ The University of Birmingham for providing the funding for this project.

22

270

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Appendices

23

271

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

Appendix A

Example Input File
A.1

Iron 36MeV Proton Beam
Listing A.1: Fe36MeV.in

1

#elements

2

Fe 100

3

#isotopes

4

"/home/ben/activity/data/isotopes.txt"

5

#decaymodes

6

"/home/ben/activity/data/decaymodes.txt"

7

#gammaenergies

8

"/home/ben/activity/data/gammaenergies.txt"

9

#xsfiles

10

"/home/ben/activity/data/xs"

11

#trajfile

12

"/home/ben/activity/examples/Fe36MeV.exyz"

13

#polyfitorder

14

5

15

#integrationgranularity

16

10

17

#beamflux

18

0.5 uA

19

#beamenergy

20

36 MeV

21

#beamduration

22

300 s

23

#beamarea

24

100 mm2

25

#amtime

26

260000 s

27

#timestep

28

1000 s

29

#projectile

30

1 1

31

#targetthickness

32

0.5 mm

33

#materialdensity

34

8000 kgm3

24

272

APPENDIX C. ACTIVITY CODE

35

#vpi

36

60.2

37

#individualisotopeactivity

38

yes

39

#verboseterminal

40

yes

41

#targetdpa

42

0.0

43

#gammachartresolution

44

200

C.1. ACTIVITY V1

25

273

C.1. ACTIVITY V1

APPENDIX C. ACTIVITY CODE

Appendix B

Fortran 90 Code
B.1

Fortran 90 Implementation of Analytic Method
Listing B.1: Fortran 90

1

Type :: decayChainObj

2

Real(kind=DoubleReal) :: time = 0.0D0

3

!Real(kind=DoubleReal) :: productionRate = 0.0D0

4

Integer(kind=StandardInteger) :: isotopes

5

Character(Len=16), Dimension(1:100) :: label

6

Real(kind=DoubleReal), Dimension(1:100) :: productionRate = 0.0D0

7

Real(kind=DoubleReal), Dimension(1:100) :: branchFactor = 1.0D0 ! from isotope parent

8

Real(kind=DoubleReal), Dimension(1:100) :: decayConstant = -1.0D0 ! negative for stable

9

Real(kind=DoubleReal), Dimension(1:100) :: halfLife = -1.0D0 ! negative for stable

10
11
12

Real(kind=DoubleReal), Dimension(1:100) :: amountStart = 0.0D0
Real(kind=DoubleReal), Dimension(1:100) :: amountEnd = 0.0D0
End Type

13
14

Subroutine CalcIsotopeChain(decayChain)

15

! Uses inverse laplace transform to calculate isotope amounts at time t (after time = 0)

16

! t time in seconds after t=0

17

! w production rate of parent isotope

18

! isotope chain data

19
20
21
22

Implicit None ! Force declaration of all variables
! Vars In/Out
Type(decayChainObj) :: decayChain
! Vars Private

23

Integer(kind=StandardInteger) :: i

24

Real(kind=DoubleReal) :: t, nEnd

25

Real(kind=DoubleReal), Dimension(1:100) :: W ! Production Rate

26

Real(kind=DoubleReal), Dimension(1:100) :: L ! Lambda

27

Real(kind=DoubleReal), Dimension(1:100) :: N ! Starting number of atoms

28
29
30
31

Real(kind=DoubleReal), Dimension(1:100) :: B ! Exp
! Complete decay chain data
Call decayChainComplete(decayChain)
! store input in shortned name arrays to make equations clearer

32

t = decayChain%time

33

Do i=1,decayChain%isotopes

34

W(i) = decayChain%productionRate(i)

26

274

APPENDIX C. ACTIVITY CODE

35

L(i) = decayChain%decayConstant(i)

36

B(i) = decayChain%branchFactor(i)
N(i) = decayChain%amountStart(i)

37

End Do

38
39

C.1. ACTIVITY V1

! Break infinities
Call DecayBreakInfinities(L,decayChain%isotopes)

40
41

! Run analytic calculations

42

! Loop through isotopes

43

! Using L-1(1/(q+ps) = (1/p)*exp(-1*(q/p)*t) and partial fractions
Do i=1,decayChain%isotopes

44

nEnd = CalcIsotopeChainCalc(t,i,W,L,N,B)

45

decayChain%amountEnd(i) = nEnd

46

End Do

47

End Subroutine CalcIsotopeChain

48
49

Subroutine decayChainComplete(decayChain)

50
51

! Completes the decay chain object
Implicit None ! Force declaration of all variables

52
53

! Vars In/Out
Type(decayChainObj) :: decayChain

54
55

! Vars Private

56

Integer(kind=StandardInteger) :: i, n

57

n = 0

58

Do i=1,100
n = n + 1

59

If(decayChain%decayConstant(i).eq.-1.0D0.and.decayChain%halfLife(i).gt.0.0D0)Then

60
61

! complete decay constant from half life
decayChain%decayConstant(i) = lnTwo/decayChain%halfLife(i)

62

End If

63

If(decayChain%halfLife(i).le.0.0D0.and.decayChain%decayConstant(i).gt.0.0D0)Then

64
65

! complete decay constant from half life
decayChain%halfLife(i) = lnTwo/decayChain%decayConstant(i)

66

End If

67
68

! Adjust for stable isotope
If(decayChain%decayConstant(i).lt.0.0D0)Then

69

decayChain%halfLife(i) = -1.0D0

70

decayChain%decayConstant(i) = 0.0D0

71
72

End If

73

If(decayChain%halfLife(i).lt.0.0D0)Then
decayChain%halfLife(i) = -1.0D0

74

decayChain%decayConstant(i) = 0.0D0

75

End If

76
77

! Break out if stable
If(decayChain%decayConstant(i).eq.0.0D0)Then

78
79

Exit

80

End If
End Do

81

decayChain%isotopes = n

82

End Subroutine decayChainComplete

83
84

Subroutine DecayBreakInfinities(L,n)

85
86
87

!
Implicit None ! Force declaration of all variables

27

275

C.1. ACTIVITY V1

88
89
90
91

! Vars In/Out
Real(kind=DoubleReal), Dimension(:) :: L ! Lambda
Integer(kind=StandardInteger) :: n
! Vars Private

92

Integer(kind=StandardInteger) :: i,j

93

Logical :: breaking

94

! Loop and alter matching decay constants slightly

95

breaking = .true.

96

Do While(breaking)

97

breaking = .false.

98

Do i=1,n-1
Do j=i+1,n

99
100

If(L(i).eq.L(j))Then

101

breaking = .true.
L(i) = L(i)*1.0000001D0 ! Vary by 0.00001%

102

End If

103

End Do

104
105
106
107

APPENDIX C. ACTIVITY CODE

End Do
End Do
End Subroutine DecayBreakInfinities

108
109
110
111

Function CalcIsotopeChainCalc(t,m,W,L,N,B) Result (nEnd)
Implicit None ! Force declaration of all variables
! Vars In

112

Real(kind=DoubleReal) :: t

113

Integer(kind=StandardInteger) :: m

114

Real(kind=DoubleReal), Dimension(1:100) :: W ! Production Rate

115

Real(kind=DoubleReal), Dimension(1:100) :: L ! Lambda

116

Real(kind=DoubleReal), Dimension(1:100) :: N ! Starting number of atoms

117
118
119
120

Real(kind=DoubleReal), Dimension(1:100) :: B ! Branch factor
! Vars Out
Real(kind=DoubleReal) :: nEnd
! Vars Private

121

Integer(kind=StandardInteger) :: i, j, k, z

122

Real(kind=DoubleReal) :: mult, multR

123
124
125

Real(kind=DoubleReal) :: nChange
! Init
nEnd = 0.0D0

126

! ---------------------------------------------

127

! UNSTABLE Isotopes

128

! ---------------------------------------------

129
130
131
132

If(L(m).gt.0.0D0)Then
! Loop through terms
Do k=1,m
multR = CalcIsotopeChainMultR(k,m,L,B)

133

mult = multR * N(k)

134

! decay of starting matter

135
136
137

nChange = CalcIsotopeChainF_Unstable(k,m,t,mult,L)
nEnd = nEnd + nChange
! production term

138

mult = multR * W(k)

139

nChange = CalcIsotopeChainG_Unstable(k,m,t,mult,L)

140

nEnd = nEnd + nChange

28

276

APPENDIX C. ACTIVITY CODE

141
142
143

print *,k,nEnd
End Do
Else

144

! ---------------------------------------------

145

! STABLE Isotopes

146

! ---------------------------------------------

147

! Loop through terms

148

nEnd = N(m)+t*W(m)

149

Do k=1,m-1

150

multR = CalcIsotopeChainMultR(k,m,L,B)

151

mult = multR * N(k)

152

! decay of starting matter

153
154
155

C.1. ACTIVITY V1

nChange = CalcIsotopeChainF_Stable(k,m,t,mult,L)
nEnd = nEnd + nChange
! production term

156

mult = multR * W(k)

157

nChange = CalcIsotopeChainG_Stable(k,m,t,mult,L)

158

nEnd = nEnd + nChange

159
160
161
162

print *,k,nEnd
End Do
End If
End Function CalcIsotopeChainCalc

163
164
165

Function CalcIsotopeChainMultR(k,m,L,B) Result (multR)
! Vars In

166

Integer(kind=StandardInteger) :: k, m

167

Real(kind=DoubleReal), Dimension(1:100) :: L ! Lambda

168
169
170
171
172
173

Real(kind=DoubleReal), Dimension(1:100) :: B ! Branching Factor
! Vars Out
Real(kind=DoubleReal) :: multR
! Private
Integer(kind=StandardInteger) :: i
! Result

174

multR = 1.0D0

175

If(k.lt.m)Then

176

Do i=k,m-1

177
178
179
180

multR = multR * B(i+1) * L(i)
End Do
End If
End Function CalcIsotopeChainMultR

181
182

! --------------------------

183

! Unstable Isotope Functions

184

! --------------------------

185
186
187

Function CalcIsotopeChainF_Unstable(k,m,t,mult,L) Result (nChange)
! Vars In

188

Integer(kind=StandardInteger) :: k, m

189

Real(kind=DoubleReal) :: t, mult

190
191
192
193

Real(kind=DoubleReal), Dimension(1:100) :: L ! Lambda
! Vars Out
Real(kind=DoubleReal) :: nChange
! Private

29

277

C.1. ACTIVITY V1

194

Real(kind=DoubleReal) :: multP

195

Real(kind=DoubleReal) :: p, q, r, s

196
197

Integer(kind=StandardInteger) :: i, j
! Calculate isotope amount change

198

nChange = 0.0D0

199

multP = (-1.0D0)**(m-k)

200
201

! Loop through pfrac
Do i=k,m

202

r = 1.0D0

203

Do j=k,m

204
205
206
207
208
209
210

APPENDIX C. ACTIVITY CODE

If(j.ne.i)Then
r = r * (L(i)-L(j))
End If
End Do
nChange = nChange + (1.0D0/r)*exp(-1.0D0*L(i)*t)*multP*mult
End Do
End Function CalcIsotopeChainF_Unstable

211
212
213

Function CalcIsotopeChainG_Unstable(k,m,t,mult,L) Result (nChange)
! Vars In

214

Integer(kind=StandardInteger) :: k, m

215

Real(kind=DoubleReal) :: t, mult

216
217
218
219

Real(kind=DoubleReal), Dimension(1:100) :: L ! Lambda
! Vars Out
Real(kind=DoubleReal) :: nChange
! Private

220

Real(kind=DoubleReal) :: multP

221

Real(kind=DoubleReal) :: p, q, r, s

222
223
224
225
226

Integer(kind=StandardInteger) :: i, j
! Calculate isotope amount change
nChange = 0.0D0
multP = (-1.0D0)**(m-k+1)
! term A

227

r = 1.0D0

228

Do i=k,m

229
230
231
232
233

r = r * L(i)
End Do
nChange = nChange + (1.0D0/r)*mult
! Loop through pfrac
Do i=k,m

234

r = 1.0D0*L(i)

235

Do j=k,m

236
237
238
239
240
241
242

If(j.ne.i)Then
r = r * (L(i)-L(j))
End If
End Do
nChange = nChange + (1.0D0/r)*exp(-1.0D0*L(i)*t)*multP*mult
End Do
End Function CalcIsotopeChainG_Unstable

243
244

! --------------------------

245

! Stable Isotope Functions

246

! --------------------------

30

278

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

247
248
249

Function CalcIsotopeChainF_Stable(k,mIn,t,mult,L) Result (nChange)
! Vars In

250

Integer(kind=StandardInteger) :: k, mIn

251

Real(kind=DoubleReal) :: t, mult

252

Real(kind=DoubleReal), Dimension(1:100) :: L ! Lambda

253
254
255

! Vars Out
Real(kind=DoubleReal) :: nChange
! Private

256

Integer(kind=StandardInteger) :: m

257

Real(kind=DoubleReal) :: multP

258

Real(kind=DoubleReal) :: p, q, r, s

259
260
261
262

Integer(kind=StandardInteger) :: i, j
! In
m = mIn-1
! Calculate isotope amount change

263

nChange = 0.0D0

264

multP = (-1.0D0)**(m-k+1)

265

! term A

266

r = 1.0D0

267

Do i=k,m

268
269
270
271
272

r = r * L(i)
End Do
nChange = nChange + (1.0D0/r)*mult
! Loop through pfrac
Do i=k,m

273

r = 1.0D0*L(i)

274

Do j=k,m
If(j.ne.i)Then

275

r = r * (L(i)-L(j))

276

End If

277
278
279
280
281

End Do
nChange = nChange + (1.0D0/r)*exp(-1.0D0*L(i)*t)*multP*mult
End Do
End Function CalcIsotopeChainF_Stable

282
283
284

Function CalcIsotopeChainG_Stable(k,mIn,t,mult,L) Result (nChange)

285

! Vars In

286

Integer(kind=StandardInteger) :: k, mIn

287

Real(kind=DoubleReal) :: t, mult

288
289
290
291

Real(kind=DoubleReal), Dimension(1:100) :: L ! Lambda
! Vars Out
Real(kind=DoubleReal) :: nChange
! Private

292

Integer(kind=StandardInteger) :: m

293

Real(kind=DoubleReal) :: multP

294

Real(kind=DoubleReal) :: p, q, r, s

295
296
297
298
299

Integer(kind=StandardInteger) :: i, j
! In
m = mIn-1
! Calculate isotope amount change
nChange = 0.0D0

31

279

C.1. ACTIVITY V1

300
301

multP = (-1.0D0)**(m-k)
! term A

302

r = 1.0D0

303

Do i=k,m

304
305
306
307

r = r * L(i)
End Do
nChange = nChange + (1.0D0/r)*t*mult
! term B

308

p = CalcIsotopeChainC(L,k,m)

309

q = 1.0D0

310

Do i=k,m

311

q = q*L(i)*L(i)

312

End Do

313

r = (-1.0D0)*(p/q)

314
315
316

nChange = nChange + r*mult
! Loop through pfrac
Do i=k,m

317

r = 1.0D0*L(i)*L(i)

318

Do j=k,m

319

If(j.ne.i)Then
r = r * (L(i)-L(j))

320
321
322
323
324
325

APPENDIX C. ACTIVITY CODE

End If
End Do
nChange = nChange + (1.0D0/r)*exp(-1.0D0*L(i)*t)*multP*mult
End Do
End Function CalcIsotopeChainG_Stable

326
327
328
329
330
331
332
333
334
335

Function CalcIsotopeChainC(L,k,m) Result (numerator)
! Calculates numerator in isotope activity function
Implicit None ! Force declaration of all variables
! Vars In
Real(kind=DoubleReal), Dimension(:) :: L
Integer(kind=StandardInteger) :: k, m
! Vars Out
Real(kind=DoubleReal) :: numerator
! Vars Private

336

Integer(kind=StandardInteger) :: i, j

337

Real(kind=DoubleReal) :: tempMult

338

numerator = 0.0D0

339

Do i=k,m

340

tempMult = 1.0D0

341

Do j=k,m

342
343
344
345
346
347
348

If(j.ne.i)Then
tempMult = tempMult * L(j)
End If
End Do
numerator = numerator + tempMult
End Do
End Function CalcIsotopeChainC

32

280

APPENDIX C. ACTIVITY CODE

C.1. ACTIVITY V1

Bibliography
[1] A. J. Koning D. Rochman. “Modern Nuclear Data Evaluation With The TALYS Code System”. In: Nuclear
Data Sheets 113 (2012).
[2]

J. P. Biersack James F. Ziegler M. D. Ziegler. “SRIM - The stopping and range of ions in matter”. In:
Nuclear Instruments and Methods in Physics Research Section B 268 (2010), pp. 1818–1823.

[3]

A. A. Sonzogni. Nuclear Data Services. www-nds.iaea.org. 2006. url: http://www-nds.iaea.org/ndspub/
download-endf/ENDF-B-VII.0/decay-index.htm (visited on 08/14/2015).

[4]

M. Herman M. B. Chadwick. “ENDF/B-VII.0: Next generation evaluated nuclear data library for nuclear
science and technology.” In: Nucl. Data Sheets 107 (2006), p. 2931.

[5]

P. Blaise M. Coste A. Courcelle T.D. Huynh C. Jouanne P. Leconte O. Litaize S. Mengelle G. Nogure J-M.
Ruggiri O. Srot J. Tommasi C. Vaglio J-F. Vidal A. Santamarina D. Bernard. The JEFF-3.1.1 Nuclear
Data Library. 2009. isbn: 978-92-64-99074-6.

[6]

H. Stehfest. “Algorithm 368: Numerical Inversion of Laplace Transform”. In: Communications of the ACM
13 (1970), pp. 47–49.

[7] J. D. Hunter. “Matplotlib: A 2D graphics environment”. In: Computing In Science & Engineering 9 (2007),
pp. 90–95.

33

281

C.2. ACTIVITY V2

C.2
C.2.1

APPENDIX C. ACTIVITY CODE

Activity V2
Accompanying Manual

282

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

Department of Metallurgy & Materials

Activity V2 Manual

283

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

Contents
1 Overview

2

1.1

Reason for the Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

1.2

Program Requirements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

2 Installation

3

3 How To Use

4

3.1

SRIM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4

3.2

Activity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

3.3

Input Keywords . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

4 Examples

12

4.1

Iron - 28MeV Protons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

4.2

Iron Fe56 (only) - 28MeV Protons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

4.3

Steel - 5MeV Protons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

5 Decay Equation
5.1

5.2

14

Bateman Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
5.1.1

Laplace Transform . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

5.1.2

Constructing the Differential Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

5.1.3

Numerical Inversion of the Laplace Transform . . . . . . . . . . . . . . . . . . . . . . . . . 15

5.1.4

Analytic Solution by Partial Fraction Expansion . . . . . . . . . . . . . . . . . . . . . . . 16

5.1.5

Preference: Analytic over Numeric . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

Python Isotopes Class . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

6 Future Plans
6.1

22

Selection of Cross Section Databases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

1

284

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

Chapter 1

Overview
1.1

Reason for the Program

The Activity program calculates how radioactive a target becomes after being irradiated by high energy ions. It
uses the TENDL-2019[1] database that contains cross-section data for protons and deuterons, and the JEFF-3.3
Radioactive Decay Data File[2].

1.2

Program Requirements

The user must provide a exyz file from the SRIM[3] ion transport program and a breakdown of the composition of
the target, as well as other irradiation parameters (beam projectile, beam duration, beam area, target thickness,
target composition, simulation end time etc).

2

285

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

Chapter 2

Installation
The program needs Python 3 installed in order to run. At the time of writing, it has only been developed to
run on a Linux operating system, but it shouldn’t require much adjusting to run on a Windows computer too.
Download and install the latest version of Python 3:
https://www.python.org/downloads
The latest version of the activity code with data files must also be downloaded:
https://github.com/BenPalmer1983/activity v2
For example, I have installed to /home/ben/activity

3

286

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

Chapter 3

How To Use
3.1

SRIM

If you haven’t done so already, run the required simulation in SRIM. When setting up the calculation, be sure to
set an increment for the EXYZ file. Sane values that have been used in examples range from 10eV to 10,000KeV,
but this will depend on the resolution of the data in the TENDL database, the thickness of your target and the
energy of the projectiles.

4

287

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

Take a copy of the EXYZ.txt file as it will be required by the activity program.

3.2

Activity

Create a directory to run the calculation. Copy in the EXYZ.txt file and create an input file.

5

288

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

The input file is just a text file, and will specify the calculation details. The data file paths must be specified,
and then the simulations can be detailed, each with it’s own unique name. The example below is for two
simulations - the first with a 300s beam, and the second with a 3000s beam.
1

# Data files

2

data isotopes="/home/ben/activity/data/isotopes" xs="/home/ben/activity/data/xs"

3
4

# Sim 1

5

sim1 exyz="EXYZ.txt" target_composition=Fe,100.0 target_depth=0.5,mm target_density=7808,kgm3
beam_projectile=’proton’ beam_energy=28,MeV beam_area=64,mm2 beam_duration=300,s beam_current=0.5,
uA end_time=260000,s

6
7

# Sim 2

8

sim2 exyz="EXYZ.txt" target_composition=Fe,100.0 target_depth=0.5,mm target_density=7808,kgm3
beam_projectile=’proton’ beam_energy=28,MeV beam_area=64,mm2 beam_duration=3000,s beam_current
=5.0,uA end_time=260000,s

The program is run from the terminal/command line. Depending on your computer system, python3 might run
through the command python3 or python, and on my computer the command is python3.
1

python3 /home/ben/activity/activity.py /home/ben/activity_28mev/28mev.txt

The program outputs into a directory for each simulation.

6

289

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

Within each directory are various plots and data files, including the activity over time and predicted gamma
lines.

Predicted Gamma Lines

1e7

3.0

2.5

Activity (Bq)

2.0

1.5

1.0

0.5

0.0
0

1

2

Energy (eV)

7

290

3

4

5

1e9

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

Predicted Gamma Lines
120000

100000

Activity (Bq)

80000

60000

40000

20000

0
0

1

2

Energy (eV)

3

4

5

1e9

Total Activity Throughout Simulation
109

106

Activity (Bq)

103

100

10−3

10−6

0

50000

100000

Time (s)

150000

200000

250000

The program analyses the exyz file and output a chart showing the distribution of energy lost by projectiles as
they pass through the target.
As a target is irradiated, the residual radioactive isotopes begin to decay. To begin with, the production
outweighs the decay, but at a certain point there’s enough of the radioactive isotope within the target that the
decay balances with the production. At this point the radioactive isotope in the target is saturated, and will
not increase above this amount unless the beam parameters are adjusted.
The saturation times depend on the isotope and the various reaction cross sections with the projectile. The
saturation plots for each radioactive isotope are created and saved by the program.

8

291

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

Ion Energy Lost In Target

0.0000020

0.0000015

0.0000010

0.0000005

0.0000000

5400000

5600000
5800000
Energy Lost In Target (eV)

6000000

Saturation In Beam

1e9
0.8

Activity (Bq)

0.6

0.4

0.2

0.0
0

100000

200000
Time (s)

300000

400000

Figure 3.1: Saturation of Cobalt-55

Saturation In Beam

1e9
8
7
6

Activity (Bq)

5
4
3
2
1
0
0

1

2

3
Time (s)

4

5

Figure 3.2: Saturation of Iron-55

9

292

6
1e8

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

The program calculates the dose a human may receive from the target at the time it is removed from the beam,
and at the time the simulation stops.
Listing 3.1: Predicted Dose
1

Gamma Dose - Beam End

2

===================================================

3
4

Activity/Bq

54.4306601689

5

Power eV/s

28342871818.2

6

Power J/s

4.54103823697e-09

7

Dose Gy/s

4.51575003676e-12

8

Dose Gy/hr

1.62567001323e-08

9

Percentage of annual dose/hr 0.0142506237521

10
11

Gamma Dose - Sim End

12

===================================================

13
14

Activity/Bq

5.80221584491

15

Energy eV/s

2227911995.02

16

Energy J/s

3.56951604018e-10

17

Dose Gy

8.52319971389e-13

18

Dose Gy/hr

1.27786970412e-09

19

Percentage of annual dose/hr 0.00112018061534

20
21
22

Absorbed Dose Calculations

23

===================================================

24

Absorbed dose assumptions:

25

1. radiation from point, emitted isotropically

26

2. 80Kg human

27

3. 1m from point source

28

4. 1m squared surface area

29

5. all energy absorbed

30
31
32

Dose Limits

33

===================================================

34

employees 18+

35

trainees 18+

6 millisieverts/year

36

public and under 18s

1 millisievert/year

37

public and under 18s

1.140771128E-04 millisieverts/hour

20 millisieverts/year

38
39

Dose averaged over area of skin not exceeding 1cm2

40

Source: http://www.hse.gov.uk/radiation/ionising/doses/

10

293

C.2. ACTIVITY V2

3.3

APPENDIX C. ACTIVITY CODE

Input Keywords

Command

Sub Command

data

Description
data fields are input here

data

isotopes

path to isotopes directory

data
sim1

xs

path to cross section directory
each simulation is numbered sequentially from

sim1

exyz

path to exyz SRIM file

sim1

target composition

isotopes that make up the beam target

sim1

target depth

1 i.e. sim1 sim2 sim3...

the depth of material through which the beam
passes

sim1

target density

how dense (specify kgm3 or GCM3)

sim1

beam projectile

currently, only ”proton”, but this could be extended in the future

sim1

beam energy

sim1

beam area

how much area the beam covers

sim1

beam duration

how long the beam will be on for (specify

energy of the protons/projectiles

s,minute,hour) t=0 to beam duration is the
first part of the calculation
sim1

end time

the time the calculation and final activity is
measured after t=0 (specify s,minute,hour)
end time to beam duration is the second part
of the calculation

11

294

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

Chapter 4

Examples
4.1

Iron - 28MeV Protons

In this example, natural iron makes up the target .
1

# Data files

2

data isotopes="/home/ben/activity/data/isotopes" xs="/home/ben/activity/data/xs"

3
4

# Sim

5

sim1 exyz="EXYZ.txt" target_composition=Fe,100.0 target_depth=0.5,mm target_density=7808,kgm3
beam_projectile=’proton’ beam_energy=28,MeV beam_area=64,mm2 beam_duration=300,s beam_current=0.5,
uA end_time=260000,s

The simulation section defines what the target material is made of as well as the beam parameters.

4.2

Iron Fe56 (only) - 28MeV Protons

In this example, the target is made of Fe56 only, and contains none of the other naturally occurring stable
isotopes.
1

# Data files

2

data isotopes="/home/ben/activity/data/isotopes" xs="/home/ben/activity/data/xs"

3
4

# Sim

5

sim1 exyz="EXYZ.txt" target_composition=Fe56,100.0 target_depth=0.5,mm target_density=7808,kgm3
beam_projectile=’proton’ beam_energy=28,MeV beam_area=64,mm2 beam_duration=300,s beam_current=0.5,
uA end_time=260000,s

4.3

Steel - 5MeV Protons

This example was provided by Alex Dickinson-Lomas, with a steel containing a wider range of elements.
1

# Data files

2

data isotopes="/home/ben/activity/data/isotopes" xs="/home/ben/activity/data/xs"

3

12

295

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

4

# Sim

5

sim1 exyz="EXYZ.txt" target_composition=Fe,96.375,C,0.772,Cu,0.024,Mn,1.36,Ni,0.698,Si,0.381,Cr,0.092,
V,0.008,P,0.009,Si,0.003,Mo,0.278 target_depth=0.1,mm target_density=7808,kgm3 beam_projectile=’
proton’ beam_energy=5,MeV beam_area=64,mm2 beam_duration=300,s beam_current=0.5,uA end_time
=260000,s

13

296

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

Chapter 5

Decay Equation
5.1

Bateman Equation

The Bateman equation was derived using Laplace transforms, and this same method has been used to develop a
modified equation that incorporates branching factors and production rates for each isotope in the decay chain,
as illustrated by Figure 5.1.
Parent Isotope

Parent Source

Branching

External Source

Daughter 1 (Branch A)

Daughter 1 (Branch B)

External Source

Daughter 2 (Branch B)

External Source

Branching

External Source

Daughter 2 (Branch A)

Figure 5.1: An example of several decay chains including branching factors and possible external source terms
for each isotope on each chain.

5.1.1

Laplace Transform

Laplace Transforms (5.1) are a useful mathematical tool, and allow ordinary differential equations to be solved
by simple algebraic manipulation in the s domain. Bateman took advantage of Laplace Transforms in deriving
his equation, and this is the method that has been taken here as well.

𝐹 (𝑠) =

∫︁∞

𝑓 (𝑡) exp(−𝑠𝑡)𝑑𝑡

0

14

297

(5.1)

C.2. ACTIVITY V2

5.1.2

APPENDIX C. ACTIVITY CODE

Constructing the Differential Equations

The first step is to set up differential equations for the parent isotope, unstable daughter isotopes and stable
daughter isotope. The parent isotope has a source term, due to production, and a loss term, due to decay. The
unstable daughter isotopes have two source terms, from the production by irradiation induced transmutation
and the decay of preceding isotopes in the decay chain, and a loss term, due to decay. Finally, the stable
daughter that finalizes the decay chain has two source terms (the same as the unstable daughters) but no loss
term.
The variables (and vectors) used in these equations are defined as follows:
∙ ⃗𝜆 vector containing isotope decay constants 𝜆𝑖
∙ ⃗𝑏 vector containing isotope to isotope branching factors 𝑏𝑖
∙ 𝑤
⃗ vector containing isotope production rates 𝑤𝑖
∙ 𝑡 time at which activity/amount of isotope is measured
∙ 𝑁𝑖 (0) starting amount of the ith isotope
∙ 𝑁𝑖 (𝑡) amount of the ith isotope at time t
∙ 𝑁𝑖′ (𝑡) change in amount of the ith isotope, with respect to time, at time t
The differential equations for the parent isotope (first isotope), unstable daughter isotopes (ith isotopes) and
stable, final, daughter isotope (zth isotope) in the time domain are as follows:
𝑁1′ (𝑡) = 𝜔1 − 𝜆1 𝑁1 (𝑡)

(5.2)

𝑁𝑖′ (𝑡) = 𝜔𝑖 + 𝑏𝑖−1 𝜆𝑖−1 𝑁𝑖−1 (𝑡) − 𝜆𝑖 𝑁𝑖 (𝑡)

(5.3)

𝑁𝑧′ (𝑡) = 𝜔𝑧 + 𝑏𝑧−1 𝜆𝑧−1 𝑁𝑧−1 (𝑡)

(5.4)

Applying the Laplace Transform to these three differential equations allows them to be manipulated and solved
algebraically in the s-domain.
1
1
𝑁1 (0) +
𝜔1
𝑠 + 𝜆1
𝑠(𝑠 + 𝜆1 )

(5.5)

1
1
1
(𝜔𝑖 ) +
(𝑏𝑖−1 𝜆𝑖−1 𝑁𝑖−1 (𝑠)) +
𝑁𝑖 (0)
𝑠(𝑠 + 𝜆𝑖 )
𝑠 + 𝜆𝑖
𝑠 + 𝜆𝑖

(5.6)

1
1
1
𝜔𝑧 + 𝑏𝑧−1 𝜆𝑧−1 𝑁𝑧−1 (𝑠) + 𝑁𝑧 (0)
𝑠2
𝑠
𝑠

(5.7)

𝑁1 (𝑠) =

𝑁𝑖 (𝑠) =

𝑁𝑧 (𝑠) =

5.1.3

Numerical Inversion of the Laplace Transform

The Gaver-Stehfest[4] algorithm was developed in the 1960s and 1970s and is a method of calculating the inverse
of a Laplace Transform in the real number domain. It is an easy to implement and reasonably accurate method,

15

298

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

although it is an approximation to the real value. A comparison between an analytic and numeric inversion for
the unstable isotope Po-218 is discussed at the end of this section (figure 5.2).
2𝑛

𝑓 (𝑡) ≈ 𝑓𝑛 (𝑡) =

ln(2) ∑︁
𝑎𝑘 (𝑛)𝐹 (𝑠) where 𝑛 ≥ 1, 𝑡 > 0
𝑡
𝑘 ln(2)
𝑡

𝑠=

𝑎𝑘 (𝑛) =

(−1)(𝑛+𝑘)
𝑛!

(5.8)

𝑘=1

∑︁

𝑗 𝑛+1

𝑗=𝐹 𝑙𝑜𝑜𝑟( 𝑘+1
2 )

(5.9)
(︃ )︃ (︃ )︃ (︃
)︃
𝑛
2𝑗
𝑗
𝑗

𝑗

𝑘−𝑗

(5.10)

The equation for the ith isotope may be calculated by recursively calculating the equations by numeric inversion,
starting from the first (parent isotope) and inserting the result into each subsequent recursion until the ith isotope
is reached (changing the equations appropriately for the parent, unstable daugher and stable daughter isotopes).

5.1.4

Analytic Solution by Partial Fraction Expansion

The equation for the ith isotope in the s domain can be written in full by substituting the preceding equation
until the parent isotope is reached, and this full equation may be rearranged with the production amount of
each isotope and starting amount of each isotope in individual terms. Each of these terms is multiplied by a
fraction that can be expanded, using partial fractions, and inverted analytically.
This is illustrated with an example unstable isotope, fourth in the decay chain (including the parent isotope):

𝑁4 (𝑠) =

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝑁1 (0)
(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝑏3 𝑏4 𝜆2 𝜆3 𝑁2 (0)
(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
𝑏4 𝜆3 𝑁3 (0)
+
(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝑁4 (0)
(𝑠 + 𝜆4 )
1
+
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝜔1
𝑠(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝑏3 𝑏4 𝜆2 𝜆3 𝜔2
𝑠(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝑏4 𝜆3 𝜔3
𝑠(𝑠 + 𝜆3 )(𝑠 + 𝜆4 )
1
+
𝜔4
𝑠(𝑠 + 𝜆4 )

An example stable isotope, fourth (last) in the decay chain (including the parent isotope):

16

299

(5.11)

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝑁1 (0)
𝑠(𝑠 + 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+
𝑏3 𝑏4 𝜆2 𝜆3 𝑁2 (0)
𝑠(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+
𝑏4 𝜆3 𝑁3 (0)
𝑠(𝑠 + 𝜆3 )

𝑁4 (𝑠) =

+𝑁4 (0)
+

𝑠2 (𝑠

(5.12)

1
𝑏2 𝑏3 𝑏4 𝜆1 𝜆2 𝜆3 𝜔1
+ 𝜆1 )(𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
𝑏3 𝑏4 𝜆2 𝜆3 𝜔2
+ 2
𝑠 (𝑠 + 𝜆2 )(𝑠 + 𝜆3 )
1
+ 2
𝑏4 𝜆3 𝜔3
𝑠 (𝑠 + 𝜆3 )
1
+ 2 𝜔4
𝑠

By using partial fraction expansion and standard Laplace Transforms, the set of equations below is used to
calculate the amount of the mth isotope in the decay chain, providing the mth isotope is unstable.

𝑁𝑚 (𝑡; ⃗𝜆, ⃗𝑏, 𝑤)
⃗ =

∑︁

𝑘=1,𝑚

[︁
]︁
𝑟(𝑘; ⃗𝜆, ⃗𝑏) 𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆)𝑁𝑘 (0) + 𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆)𝑤𝑘

𝑟(𝑘, 𝑚, ⃗𝜆) =

⎧
⎨∏︀

𝑖=𝑘,𝑚−1

⎩1,

𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆) = (−1)𝑚−𝑘

∑︁

𝑖=𝑘,𝑚

𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

1

𝑖=𝑘,𝑚

𝜆𝑖

(𝑏𝑖+1 𝜆𝑖 ) , if 𝑘 < 𝑚

+ (−1)

(5.13)

(5.14)

if 𝑘 = 𝑚

⎡

⎣exp(−𝜆𝑖 𝑡)

𝑚−𝑘+1

∑︁

𝑖=𝑘,𝑚

⎡

∏︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

⎣ 1 exp(−𝜆𝑖 𝑡)
𝜆𝑖

(︂

⎤
)︂
1
⎦
𝜆𝑖 − 𝜆𝑗
∏︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

(︂

⎤
)︂
1
⎦
𝜆𝑖 − 𝜆𝑗

(5.15)

(5.16)

The set of equations below is used to calculate the amount of the mth isotope in the decay chain, where the mth
isotope is stable.

𝑁𝑚 (𝑡; ⃗𝜆, ⃗𝑏, 𝑤)
⃗ = 𝑁𝑚 + 𝑤𝑚 𝑡 +

∑︁

𝑘=1,𝑚−1

𝑟(𝑘, 𝑚, ⃗𝜆) =

[︁
]︁
𝑟(𝑘; ⃗𝜆, ⃗𝑏) 𝑓 (𝑡; 𝑘, 𝑚 − 1, ⃗𝜆)𝑁𝑘 (0) + 𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆)𝑤𝑘

⎧
⎨∏︀

𝑖=𝑘,𝑚−1

⎩1,

(𝑏𝑖+1 𝜆𝑖 ) , if 𝑘 < 𝑚
if 𝑘 = 𝑚

17

300

(5.17)

(5.18)

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

𝑓 (𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

1

𝑖=𝑘,𝑚

𝑔(𝑡; 𝑘, 𝑚, ⃗𝜆) = ∏︀

1

𝑖=𝑘,𝑚

5.1.5

𝜆𝑖

𝑡+

∑︀

𝑖=𝑘,𝑚

𝜆𝑖

+ (−1)

𝑖=𝑘,𝑚

[︁∏︀

∏︀

𝑚−𝑘+1

∑︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

𝑖=𝑘,𝑚

𝜆2𝑖

𝜆𝑗

]︁

⎡

⎣ 1 exp(−𝜆𝑖 𝑡)
𝜆𝑖

+ (−1)

𝑚−𝑘+1

∑︁

𝑖=𝑘,𝑚

∏︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

⎡

(︂

⎤
)︂
1
⎦
𝜆𝑖 − 𝜆𝑗

⎣ 1 exp(−𝜆𝑖 𝑡)
𝜆2𝑖

∏︁

𝑗=𝑘,𝑚;𝑗̸=𝑖

(5.19)

(︂

⎤
)︂
1
⎦
𝜆𝑖 − 𝜆𝑗

(5.20)

Preference: Analytic over Numeric

The numeric solution only requires the equation to be solved in the s-domain; the Gaver-Stehfest algorithm
performs the inversion. It is worth the extra effort to derive and implement an analytic solution, as the numeric
is only an approximation. Examples of the pitfalls of the numeric solution are that it can give negative amounts
of an isotope and the difference between the numeric and analytic calculated amounts can become quite large
when the isotope decays away to a very small value. Figure 5.2 shows the predicted decay of a sample of Po-218
irradiated for 1,000s, and sampled until 10,000s. In the region between 4,000s and 9,000s the amount from
the numeric calculation drops below zero, whereas the analytic calculation remains above zero, as would be
expected.

18

301

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

Po-218 (Analytic)
Po-218 (Gaver-Stehfest)

1e+08

1e+06

Po-218 (mircograms)

10000

100

1

0.01

0.0001

1e-06
0

1000

2000

3000

4000

5000

6000

7000

8000

9000

10000

Time (seconds)

Figure 5.2: Decay of Po-218: Analytice and Gaver-Stehfest Calculations [jeff311]

5.2

Python Isotopes Class

The decay equations are computed within the isotopes class in the isotopes.py file.
1
2

class isotopes:

3
4

##########################################

5

# DECAY EQUATIONS

6

##########################################

7
8

@staticmethod

9

def calculate_activity(t, l, b, w, n0):

10

nt = numpy.zeros((len(n0),),)

11

for m in range(0,len(n0)):

12
13
14
15
16

if(l[m] > 0.0):
nt[m] = isotopes.activity_unstable(t, l, b, w, n0, m)
elif(l[m] == 0.0):
nt[m] = isotopes.activity_stable(t, l, b, w, n0, m)
return nt

17
18

@staticmethod

19

def activity_unstable(t, l, b, w, n0, m):

20

s = 0.0

21

for k in range(0, m+1):

22

s = s + isotopes.r(k, m, b, l) * ( isotopes.f_unstable(t,k,m,l) * n0[k] + isotopes.g_unstable(t,
k,m,l) * w[k])

23

return s

24
25

@staticmethod

26

def activity_stable(t, l, b, w, n0, m):

27

s = n0[m] + w[m] * t

19

302

APPENDIX C. ACTIVITY CODE

28
29

C.2. ACTIVITY V2

for k in range(0, m):
s = s + isotopes.r(k, m, b, l) * (isotopes.f_stable(t,k,m,l) * n0[k] + isotopes.g_stable(t,k,m,l
) * w[k])

30

return s

31
32

@staticmethod

33

def r(k, m, b, l):

34
35
36

if(k == m):
return 1.0
else:

37

p = 1.0

38

for i in range(k, m):

39
40

p = p * (b[i] * l[i])
return p

41
42

@staticmethod

43

def f_unstable(t,k,m,l):

44

s = 0.0

45

for i in range(k, m+1):

46

p = 1.0

47

for j in range(k, m+1):

48
49
50

if(i != j):
p = p * (1 / (l[i] - l[j]))
s = s + numpy.exp(-1 * l[i] * t) * p

51

s = (-1)**(m-k) * s

52

return s

53
54

@staticmethod

55

def g_unstable(t,k,m,l):

56

pa = 1.0

57

for i in range(k,m+1):

58

pa = pa * l[i]

59

pa = 1.0 / pa

60

s = 0.0

61

for i in range(k, m+1):

62

pb = 1.0

63

for j in range(k, m+1):

64
65
66
67

if(i != j):
pb = pb * (1 / (l[i]-l[j]))
s = s + (1/l[i]) * numpy.exp(-l[i]*t) * pb
return pa + s * (-1)**(m-k+1)

68
69
70

@staticmethod

71

def f_stable(t,k,m_in,l):

72

m = m_in - 1

73
74

p = 1.0

75

for i in range(k, m+1):

76

p = p * l[i]

77
78

s = 0.0

79

for i in range(k, m+1):

20

303

C.2. ACTIVITY V2

80

r = l[i]

81

for j in range(k, m+1):

82
83
84

APPENDIX C. ACTIVITY CODE

if(i != j):
r = r * (l[i] - l[j])
s = s + (1/r)*numpy.exp(-1*l[i]*t)

85
86

return (1.0/p) + s * (-1.0)**(m-k+1)

87
88
89

@staticmethod

90

def g_stable(t,k,m_in,l):

91

m = m_in - 1

92
93

pa = 1.0

94

for i in range(k,m+1):

95
96

pa = pa * l[i]
pa = 1.0 / pa

97
98

sa = 0.0

99

for i in range(k, m+1):

100

pb = 1.0

101

for j in range(k,m+1):

102
103
104

if(j != i):
pb = pb * l[j]
sa = sa + pb

105

pc = 1.0

106

for i in range(k, m+1):

107

pc = pc * l[i]**2

108
109

sb = 0.0

110

for i in range(k, m+1):

111

pd = 1.0

112

for j in range(k, m+1):

113
114
115

if(i != j):
pd = pd * (1 / (l[i]-l[j]))
sb = sb + (1/(l[i]**2)) * numpy.exp(-l[i]*t) * pd

116
117

return pa * t + sa / pc + sb * (-1)**(m-k+1)

21

304

APPENDIX C. ACTIVITY CODE

C.2. ACTIVITY V2

Chapter 6

Future Plans
6.1

Selection of Cross Section Databases

The Scanditronix MC40 Cyclotron at the University of Birmingham has several beamlines and is capable of
accelerating protons, deuterons, Helium 3 and Helium 4 and fluxes and energy ranges detailed below.
Particle
p
d
4
𝐻𝑒2+
3
𝐻𝑒2+

Energy (MeV)
8-40
8-40
8-53
4-20

Max Current (micro A)
60
30
30
60

Flux (ions per second)
3.75 × 101 4
1.87 × 101 4
9.36 × 101 3
1.87 × 101 4

Table 6.1: Beam Characteristics of the Scanditronix MC-40
The current data file is for Protons, and the range of energies (for Fe-54 and Fe-56 at the very least) only range
up to 30MeV. Previous versions of the TENDL data files have covered larger ranges (TENDL-2009 extended
up to 200MeV).
As the energies do not cover the full range of possible energies for our own cyclotron, it would be desirable to
use the TALYS program to calculate the reaction cross sections for a range up to at least 100MeV (for Protons,
Deuterons, Helium 3 and Helium 4 ions) and save this cross section data into an alternate database.

22

305

C.2. ACTIVITY V2

APPENDIX C. ACTIVITY CODE

Bibliography
[1] A.J. Koning et al. “TENDL: Complete Nuclear Data Library for Innovative Nuclear Science and Technology”. In: Nuclear Data Sheets 155 (2019).
[2]
[3]

A.J.M. Plompen et al. “The JEFF-3.3 Nuclear Data Library”. In: Eur. Phys. J. A 56 (181 2020).
J. P. Biersack James F. Ziegler M. D. Ziegler. “SRIM - The stopping and range of ions in matter”. In:
Nuclear Instruments and Methods in Physics Research Section B 268 (2010), pp. 1818–1823.

[4]

H. Stehfest. “Algorithm 368: Numerical Inversion of Laplace Transform”. In: Communications of the ACM
13 (1970), pp. 47–49.

23

306

Appendix D

Activity V1 Full Results
D.1

36MeV Proton Irradiated Iron

Fe irradiated by 36MeV protons: output file produced by Activity V1: https://github.com/BenPalmer1983/activity
Listing D.1: Isotope Activity at End of Simulation
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38

======================================
ACTIVITY code University of Birmingham
======================================
Compiled: 15:08:41 11/01/2016
MPI Processes: 1
Date: 21:21 24/06/2016
Read user input
Read Isotope Data
Read Activity User Input File
Read Trajectory File
Data point count: 100887
XS Data
Reading
Reading
Reading
Reading

0.0000
0.0000
0.0720
0.0720
0.9560

Files Loaded:
xs file 1_1-26_54_0.dat
xs file 1_1-26_56_0.dat
xs file 1_1-26_57_0.dat
xs file 1_1-26_58_0.dat

Calculation Settings
Beam Duration/s:
Beam Current/uA:
Beam Energy/MeV:
Beam Area/mm2:
Target Thickness/Angstrom:
Target Density/kgm-3:
Activity Measurement Time/s:
Input File:
Isotope File:
Decay Modes File:
Gamma Energies File:
XS File Directory:

Create material tally

0.3000000000D+03
0.5000000000D+00
0.3600000000D+02
0.1000000000D+03
0.5000000000D+07
0.8000000000D+04
0.2600000000D+06
/home/ben/activity/examples/Fe36MeV.in
/home/ben/activity/data/isotopes.txt
/home/ben/activity/data/decaymodes.txt
/home/ben/activity/data/gammaenergies.txt
/home/ben/activity/data/xs

1.2640

307

D.1. 36MEV PROTON IRRADIATED IRON

APPENDIX D. ACTIVITY V1 FULL RESULTS

39
40
41
42

Fill tally with blank data
Fill tally with isotope data

43
44
45

Starting Isotope Tally - Input Material
Element Z A M mk sim Half life
Decay Constant Activity
Reaction Rate
Atoms/mg
--------------------------------------------------------------------------------------------------------------------------------

46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97

FE 026 054 0 000 001
FE 026 056 0 000 001
FE 026 057 0 000 001
FE 026 058 0 000 001
Total starting isotopes:

1.2640
1.2640

--------------------------------------------------------------------------------------------------------------------------------

-0.1000000000D+01
-0.1000000000D+01
-0.1000000000D+01
-0.1000000000D+01
4

0.0000000000D+00
0.0000000000D+00
0.0000000000D+00
0.0000000000D+00

0.0000000000D+00
0.0000000000D+00
0.0000000000D+00
0.0000000000D+00

0.0000000000D+00
0.0000000000D+00
0.0000000000D+00
0.0000000000D+00

---------------------------------------------------------------------Pre-Simulation Summary
1.2840
---------------------------------------------------------------------Beam flux ions/s:

0.3120754681E+13

Calculate projectile-target-product reaction rates 1.2840
Reaction rates to calculate: 424
Trajectory fit equation:
0
0.3665497627E+05
1 -0.1783622595E-02
2
0.2947794093E-09
3 -0.3735372827E-16
4
0.1919778602E-23
5 -0.3566818320E-31
Affected material depth: 0.5000000000E+07
---------------------------------------------------------------------Calculated variables
---------------------------------------------------------------------Beam flux ions/s:
0.3120754681E+13
Affected depth/m:
0.5000000000E-03
Affected depth/ang:
0.5000000000E+07
Affected volume/m3:
0.5000000054E-07
Number Density:
0.8626809746E+29
VPI:
0.6020000000E+02
DPA:
0.1306643605E-04
---------------------------------------------------------------------Reaction rates in the target material 1.2840
Sym Z A M Sym Z A M Reaction Rate
Average XS
Number Density
---------------------------------------------------------------------1:
FE 26 54 0 NN 0 1 0
0.3508066664E+09 0.4160433001E-28 0.5403805016E+28
2:
FE 26 54 0 H
1 1 0
0.1351444089E+10 0.1602761044E-27 0.5403805016E+28
3:
FE 26 54 0 H
1 2 0
0.3205323639E+08 0.3801391343E-29 0.5403805016E+28
4:
FE 26 54 0 H
1 3 0
0.7165361660E+06 0.8497845101E-31 0.5403805016E+28
5:
FE 26 54 0 HE 2 3 0
0.8617826538E+07 0.1022041294E-29 0.5403805016E+28
6:
FE 26 54 0 HE 2 4 0
0.5675883691E+08 0.6731381151E-29 0.5403805016E+28
67:
FE 26 54 0 TI 22 46 0
0.4687831440E+01 0.5559588940E-36 0.5403805016E+28
76:
FE 26 54 0 V 23 47 0
0.3452942314E+06 0.4095057628E-31 0.5403805016E+28
78:
FE 26 54 0 V 23 49 0
0.5791127831E+07 0.6868056297E-30 0.5403805016E+28
85:
FE 26 54 0 CR 24 49 0
0.2416421986E+07 0.2865784131E-30 0.5403805016E+28
86:
FE 26 54 0 CR 24 50 0
0.4290008294E+08 0.5087785892E-29 0.5403805016E+28

308

0.5405383878D+28
0.7890272999D+29
0.1758807969D+28
0.2263810953D+27

APPENDIX D. ACTIVITY V1 FULL RESULTS

98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158

87:
88:
92:
93:
94:
95:
99:
100:
101:
104:
105:
106:
107:
108:
109:
110:
111:
112:
169:
179:
181:
188:
189:
190:
191:
192:
196:
197:
198:
199:
200:
204:
205:
206:
207:
210:
211:
212:
213:
214:
215:
216:
217:
218:
273:
282:
283:
284:
285:
293:
294:
295:
296:
297:
301:
302:
303:
304:
305:
309:
310:

FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE

26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26

54
54
54
54
54
54
54
54
54
54
54
54
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57
57

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

CR
CR
MN
MN
MN
MN
FE
FE
FE
CO
CO
CO
NN
H
H
H
HE
HE
TI
V
V
CR
CR
CR
CR
CR
MN
MN
MN
MN
MN
FE
FE
FE
FE
CO
CO
CO
NN
H
H
H
HE
HE
TI
V
V
V
V
CR
CR
CR
CR
CR
MN
MN
MN
MN
MN
FE
FE

24
24
25
25
25
25
26
26
26
27
27
27
0
1
1
1
2
2
22
23
23
24
24
24
24
24
25
25
25
25
25
26
26
26
26
27
27
27
0
1
1
1
2
2
22
23
23
23
23
24
24
24
24
24
25
25
25
25
25
26
26

51
52
50
51
52
53
52
53
54
53
54
55
1
1
2
3
3
4
48
49
51
50
51
52
53
54
51
52
53
54
55
53
54
55
56
55
56
57
1
1
2
3
3
4
49
49
50
51
52
51
52
53
54
55
52
53
54
55
56
54
55

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0.2135062196E+07
0.8659953579E+08
0.1542445948E+07
0.1778372502E+07
0.9863724488E+08
0.2232277074E+09
0.1143967233E+08
0.1888610876E+09
0.1103802931E+09
0.4251641576E+06
0.8026455518E+07
0.1175568630E+06
0.1294835964E+11
0.1322708565E+11
0.6485018658E+09
0.2804930290E+08
0.1152252073E+09
0.8396082900E+09
0.7417367941E+02
0.1002075285E+08
0.3129496674E+07
0.3047989029E+03
0.1903672236E+09
0.2832038545E+09
0.1158364999E+07
0.1165756880E+08
0.9817102039E+01
0.1545890268E+09
0.8815593471E+08
0.1267995071E+10
0.7253812202E+09
0.2156782879E+02
0.2975937641E+10
0.4948211136E+10
0.1551234326E+10
0.3083905589E+09
0.2971765420E+09
0.3041404939E+07
0.3649443293E+09
0.2670335825E+09
0.1672940269E+08
0.1275440383E+07
0.2836366558E+07
0.2332170710E+08
0.7752833017E+00
0.3281858226E+02
0.1835618293E+06
0.6679861824E+00
0.3050010636E+01
0.3269383508E+04
0.7230173808E+07
0.1653080211E+07
0.4518951495E+05
0.7219801309E+04
0.2058316554E+07
0.9698739328E+07
0.2412989059E+07
0.1977898329E+08
0.5440385638E+07
0.2296404190E+07
0.9449535161E+08

D.1. 36MEV PROTON IRRADIATED IRON

0.2532102172E-30
0.1027037400E-28
0.1829281950E-30
0.2109081827E-30
0.1169800030E-28
0.2647395303E-28
0.1356701421E-29
0.2239820325E-28
0.1309068094E-28
0.5042284431E-31
0.9519069510E-30
0.1394179471E-31
0.1052010224E-27
0.1074655765E-27
0.5268857307E-29
0.2278910553E-30
0.9361656570E-30
0.6821532069E-29
0.6026359420E-36
0.8141521197E-31
0.2542609711E-31
0.2476387520E-35
0.1546669008E-29
0.2300935089E-29
0.9411322022E-32
0.9471378543E-31
0.7976061834E-37
0.1255983315E-29
0.7162370153E-30
0.1030202911E-28
0.5893475939E-29
0.1752312805E-36
0.2417848215E-28
0.4020253414E-28
0.1260325181E-28
0.2505568504E-29
0.2414458427E-29
0.2471038170E-31
0.1330164742E-27
0.9732954535E-28
0.6097604437E-29
0.4648779807E-30
0.1033811047E-29
0.8500395818E-29
0.2825785826E-36
0.1196185760E-34
0.6690540276E-31
0.2434704685E-36
0.1111680957E-35
0.1191638922E-32
0.2635284756E-29
0.6025217646E-30
0.1647086821E-31
0.2631504144E-32
0.7502240448E-30
0.3535038104E-29
0.8794966005E-30
0.7209128654E-29
0.1982935089E-29
0.8370032473E-30
0.3444207100E-28

309

0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.5403805016E+28
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.7887968323E+29
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28

D.1. 36MEV PROTON IRRADIATED IRON

159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197

311:
312:
315:
316:
317:
318:
319:
320:
321:
322:
323:
324:
376:
385:
386:
388:
396:
397:
398:
399:
400:
405:
406:
407:
408:
409:
414:
415:
416:
417:
421:
422:
423:
424:

FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE

26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26
26

57
57
57
57
57
57
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58
58

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

FE
FE
CO
CO
CO
CO
NN
H
H
H
HE
HE
TI
V
V
V
CR
CR
CR
CR
CR
MN
MN
MN
MN
MN
FE
FE
FE
FE
CO
CO
CO
CO

26
26
27
27
27
27
0
1
1
1
2
2
22
23
23
23
24
24
24
24
24
25
25
25
25
25
26
26
26
26
27
27
27
27

56
57
55
56
57
58
1
1
2
3
3
4
50
50
51
53
52
53
54
55
56
53
54
55
56
57
55
56
57
58
56
57
58
59

Prepare full isotope tally

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0.1023020929E+09
0.2808424683E+08
0.4515569494E+07
0.1114292806E+08
0.5878105202E+07
0.3965181061E+05
0.5793566623E+08
0.2791132972E+08
0.2037087602E+07
0.1593981581E+06
0.2598326212E+06
0.2551528049E+07
0.9741805634E+00
0.2503943210E+00
0.9310532844E+04
0.1852730029E-06
0.4688542450E+04
0.1090733133E+06
0.7904949881E+05
0.5894353392E-05
0.3341354293E-04
0.1200142917E+07
0.1053914972E+07
0.2219588486E+06
0.4947583955E+06
0.3707982841E+06
0.4036879251E+06
0.1504003971E+08
0.8926880873E+07
0.3876895164E+07
0.2685676346E+07
0.3377108415E+07
0.7015543919E+06
0.7735041844E+04

APPENDIX D. ACTIVITY V1 FULL RESULTS

0.3728750553E-28
0.1023626672E-28
0.1645854134E-29
0.4061422208E-29
0.2142476992E-29
0.1445246198E-31
0.1640601429E-27
0.7903830301E-28
0.5768551650E-29
0.4513779906E-30
0.7357847030E-30
0.7225325669E-29
0.2758649600E-35
0.7090576626E-36
0.2636523317E-31
0.5246494484E-42
0.1327684645E-31
0.3088698988E-30
0.2238495372E-30
0.1669141865E-40
0.9461927315E-40
0.3398521693E-29
0.2984438639E-29
0.6285351112E-30
0.1401039090E-29
0.1050013290E-29
0.1143148996E-29
0.4258984535E-28
0.2527882127E-28
0.1097845276E-28
0.7605202007E-29
0.9563174557E-29
0.1986636580E-29
0.2190381423E-31

0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.1758294237E+28
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27
0.2263149715E+27

1.2840

--------------------------------------------------------------------------------------------------------------------------------

198
199
200

Full Starting Isotope Tally
Key Element Z A M mk sim Half life
Activity
Reaction Rate
Atoms
--------------------------------------------------------------------------------------------------------------------------------

201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217

000001
000591
000592
000593
001183
001184
008881
009472
009473
009474
009476
010062
010063
010064
010065
010066
010067

NN
H
H
H
HE
HE
P
S
S
S
S
CL
CL
CL
CL
CL
CL

000
001
001
001
002
002
015
016
016
016
016
017
017
017
017
017
017

001
001
002
003
003
004
031
032
033
034
036
032
033
034
035
036
037

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000

001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001

-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3885235200D+09 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2980000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2511000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1526400000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.9492336000D+13 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00

310

APPENDIX D. ACTIVITY V1 FULL RESULTS

218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278

010068
010069
010070
010071
010653
010654
010655
010656
010657
010658
010659
010660
010661
010662
010663
011245
011246
011247
011248
011249
011250
011251
011252
011253
011254
011255
011256
011837
011838
011839
011840
011841
011842
011843
011844
011845
011846
011847
011848
012429
012430
012431
012432
012433
012434
012435
012436
012437
012438
012439
012440
013021
013022
013023
013024
013025
013026
013027
013028
013029
013030

CL
CL
CL
CL
AR
AR
AR
AR
AR
AR
AR
AR
AR
AR
AR
K
K
K
K
K
K
K
K
K
K
K
K
CA
CA
CA
CA
CA
CA
CA
CA
CA
CA
CA
CA
SC
SC
SC
SC
SC
SC
SC
SC
SC
SC
SC
SC
TI
TI
TI
TI
TI
TI
TI
TI
TI
TI

017
017
017
017
018
018
018
018
018
018
018
018
018
018
018
019
019
019
019
019
019
019
019
019
019
019
019
020
020
020
020
020
020
020
020
020
020
020
020
021
021
021
021
021
021
021
021
021
021
021
021
022
022
022
022
022
022
022
022
022
022

038
039
040
041
033
034
035
036
037
038
039
040
041
042
043
035
036
037
038
039
040
041
042
043
044
045
046
037
038
039
040
041
042
043
044
045
046
047
048
039
040
041
042
043
044
045
046
047
048
049
050
041
042
043
044
045
046
047
048
049
050

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000

001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001

D.1. 36MEV PROTON IRRADIATED IRON

0.2234400000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3372000000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.8100000000D+02 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3840000000D+02 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1730000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.8445000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1775000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3027456000D+07 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.8483184000D+10 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.6576600000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1037534400D+10 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3222000000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1780000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3420000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1226000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.4581600000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3935692800D+17 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.4449600000D+05 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.8028000000D+05 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1327800000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1038000000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1050000000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1811000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.4400000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.8596000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3216672000D+13 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1404950400D+08 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3919104000D+06 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3000000000D-06 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1823000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.5963000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.6813000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1400760000D+05 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1429200000D+05 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.7239456000D+07 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2893708800D+06 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1572120000D+06 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3432000000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1025000000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.8040000000D-01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1990000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.5090000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1892160000D+10 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1108800000D+05 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00

311

D.1. 36MEV PROTON IRRADIATED IRON

279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339

013031
013032
013613
013614
013615
013616
013617
013618
013619
013620
013621
013622
013623
013624
013625
014205
014206
014207
014208
014209
014210
014211
014212
014213
014214
014215
014216
014797
014798
014799
014800
014801
014802
014803
014804
014805
014806
014807
015389
015390
015391
015392
015393
015394
015395
015396
015397
015398
015981
015982
015983
015984
015985
015986
015987
015988
015989

TI
TI
V
V
V
V
V
V
V
V
V
V
V
V
V
CR
CR
CR
CR
CR
CR
CR
CR
CR
CR
CR
CR
MN
MN
MN
MN
MN
MN
MN
MN
MN
MN
MN
FE
FE
FE
FE
FE
FE
FE
FE
FE
FE
CO
CO
CO
CO
CO
CO
CO
CO
CO

022
022
023
023
023
023
023
023
023
023
023
023
023
023
023
024
024
024
024
024
024
024
024
024
024
024
024
025
025
025
025
025
025
025
025
025
025
025
026
026
026
026
026
026
026
026
026
026
027
027
027
027
027
027
027
027
027

051
052
043
044
045
046
047
048
049
050
051
052
053
054
055
045
046
047
048
049
050
051
052
053
054
055
056
047
048
049
050
051
052
053
054
055
056
057
049
050
051
052
053
054
055
056
057
058
051
052
053
054
055
056
057
058
059

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000
000

001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001
001

APPENDIX D. ACTIVITY V1 FULL RESULTS

0.3456000000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1020000000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.8000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1110000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.5470000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.4225000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1956000000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1380110400D+07 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2851200000D+08 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.4415040000D+25 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2245800000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.9600000000D+02 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.4980000000D+02 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.6540000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.5000000000D-01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2600000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.5000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.7761600000D+05 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2538000000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2393496000D+07 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2098200000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3564000000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1581000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3820000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2838800000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2772000000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.4830624000D+06 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1179446400D+15 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2696716800D+08 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.9284040000D+04 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.8540000000D+02 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.7000000000D-01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1550000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.3050000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2979000000D+05 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.5106000000D+03 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.5405383878D+28
0.8631403200D+08 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.7890272999D+29
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.1758807969D+28
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.2263810953D+27
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1150000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2400000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.1932300000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.6310800000D+05 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.6672931200D+07 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.2347833600D+08 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
0.6122304000D+07 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00
-0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00

312

APPENDIX D. ACTIVITY V1 FULL RESULTS

340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381

D.1. 36MEV PROTON IRRADIATED IRON

================================================================================================================================

START of SIMULATION
Simulation time from 0.0000000000E+00 to 0.2600000000E+06
Beam from
0.0000000000E+00 to 0.3000000000E+03

================================================================================================================================

---------------------------------------------------------------------Simulation tally at 0.3000000000E+03
----------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------------------------------

Isotope Tally 1.2880
Key Element Z A M mk sim Half life
Decay Constant Activity
Reaction Rate
Start Atoms
Beam
End Atoms Atoms At Time
-------------------------------------------------------------------------------------------------------------------------------000001
+00
000593
+00
001183
+00
013027
+00
013029
+00
013617
+00
013619
+00
013621
+00
013622
+00
013623
+00
014209
+00
014210
+00
014211
+00
014212
+00
014213

NN 000 001 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.4116613889D+13 0.4116613889D+13
H 001 003 0 000 001 0.3885235200D+09 0.1784054619D-08 0.1616389319D+02 0.0000000000D+00 0.0000000000D
0.9060200854D+10 0.9060200854D+10
HE 002 003 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.2424000000D+04 0.2424000000D+04
TI 022 047 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.5316233671D+07 0.5316233671D+07
TI 022 049 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.1736864062D+05 0.1736864062D+05
V 023 047 0 000 001 0.1956000000D+04 0.3543697242D-03 0.3482463420D+05 0.0000000000D+00 0.0000000000D
0.9827203574D+08 0.9827203574D+08
V 023 049 0 000 001 0.2851200000D+08 0.2431071761D-07 0.1160219131D+03 0.0000000000D+00 0.0000000000D
0.4772459413D+10 0.4772459413D+10
V 023 051 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.2509195042D+07 0.2509195042D+07
V 023 052 0 000 001 0.2245800000D+03 0.3086415445D-02 0.1841703348D+01 0.0000000000D+00 0.0000000000D
0.5967127177D+03 0.5967127177D+03
V 023 053 0 000 001 0.9600000000D+02 0.7220283131D-02 0.1640359913D-06 0.0000000000D+00 0.0000000000D
0.2271877547D-04 0.2271877547D-04
CR 024 049 0 000 001 0.2538000000D+04 0.2731076362D-03 0.1900894319D+06 0.0000000000D+00 0.0000000000D
0.6960238630D+09 0.6960238630D+09
CR 024 050 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.4621020723D+09 0.4621020723D+09
CR 024 051 0 000 001 0.2393496000D+07 0.2895961307D-06 0.1672958542D+05 0.0000000000D+00 0.0000000000D
0.5776867728D+11 0.5776867728D+11
CR 024 052 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.1648354473D+08 0.1648354473D+08
CR 024 053 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D

313

D.1. 36MEV PROTON IRRADIATED IRON

382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414

+00
014214
+00
014215
+00
014216
+00
014800
+00
014801
+00
014802
+00
014803
+00
014804
+00
014805
+00
014806
+00
014807
+00
015392
+00
015393
+00
015394
+28
015395
+00
015396
+29
015397
+28
015398
+27
015983
+00
015984
+00
015985
+00
015986
+00
015987
+00
015988
+00

APPENDIX D. ACTIVITY V1 FULL RESULTS

0.4169728000D+07 0.4169728000D+07
CR 024 054 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.1470632000D+07 0.1470632000D+07
CR 024 055 0 000 001 0.2098200000D+03 0.3303532459D-02 0.4539932896D+04 0.0000000000D+00 0.0000000000D
0.1374266169D+07 0.1374266169D+07
CR 024 056 0 000 001 0.3564000000D+03 0.1944857409D-02 0.1476992152D-04 0.0000000000D+00 0.0000000000D
0.7594346737D-02 0.7594346737D-02
MN 025 050 0 000 001 0.2838800000D+00 0.2441690787D+01 0.1542445948D+07 0.0000000000D+00 0.0000000000D
0.6317122367D+06 0.6317122367D+06
MN 025 051 0 000 001 0.2772000000D+04 0.2500530954D-03 0.1285259866D+06 0.0000000000D+00 0.0000000000D
0.5139947831D+09 0.5139947831D+09
MN 025 052 0 000 001 0.4830624000D+06 0.1434901952D-05 0.1098860016D+06 0.0000000000D+00 0.0000000000D
0.7658084333D+11 0.7658084333D+11
MN 025 053 0 000 001 0.1179446400D+15 0.5876885805D-14 0.6277577829D-03 0.0000000000D+00 0.0000000000D
0.1068181012D+12 0.1068181012D+12
MN 025 054 0 000 001 0.2696716800D+08 0.2570337310D-07 0.9804220660D+04 0.0000000000D+00 0.0000000000D
0.3814371220D+12 0.3814371220D+12
MN 025 055 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.2614130226D+07 0.2614130226D+07
MN 025 056 0 000 001 0.9284040000D+04 0.7466008123D-04 0.1314578074D+06 0.0000000000D+00 0.0000000000D
0.1760750930D+10 0.1760750930D+10
MN 025 057 0 000 001 0.8540000000D+02 0.8116477524D-02 0.3383153467D+06 0.0000000000D+00 0.0000000000D
0.4168253355D+08 0.4168253355D+08
FE 026 052 0 000 001 0.2979000000D+05 0.2326778048D-04 0.7957468329D+05 0.0000000000D+00 0.0000000000D
0.3419951609D+10 0.3419951609D+10
FE 026 053 0 000 001 0.5106000000D+03 0.1357515042D-02 0.6332089595D+08 0.0000000000D+00 0.0000000000D
0.4664471036D+11 0.4664471036D+11
FE 026 054 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.5405383878D
0.5405383878D+28 0.5405383878D+28
FE 026 055 0 000 001 0.8631403200D+08 0.8030527187D-08 0.1215087645D+05 0.0000000000D+00 0.0000000000D
0.1513085775D+13 0.1513085775D+13
FE 026 056 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.7890272999D
0.7890272999D+29 0.7890272999D+29
FE 026 057 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.1758807969D
0.1758807969D+28 0.1758807969D+28
FE 026 058 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.2263810953D
0.2263810953D+27 0.2263810953D+27
CO 027 053 0 000 001 0.2400000000D+00 0.2888113252D+01 0.4251641576D+06 0.0000000000D+00 0.0000000000D
0.1472117332D+06 0.1472117332D+06
CO 027 054 0 000 001 0.1932300000D+00 0.3587161313D+01 0.8026455518D+07 0.0000000000D+00 0.0000000000D
0.2237550759D+07 0.2237550759D+07
CO 027 055 0 000 001 0.6310800000D+05 0.1098350733D-04 0.1029731940D+07 0.0000000000D+00 0.0000000000D
0.9375256095D+11 0.9375256095D+11
CO 027 056 0 000 001 0.6672931200D+07 0.1038744683D-06 0.9691497262D+04 0.0000000000D+00 0.0000000000D
0.9330009018D+11 0.9330009018D+11
CO 027 057 0 000 001 0.2347833600D+08 0.2952284100D-07 0.1089088520D+03 0.0000000000D+00 0.0000000000D
0.3688969230D+10 0.3688969230D+10
CO 027 058 0 000 001 0.6122304000D+07 0.1132167205D-06 0.2517465310D+02 0.0000000000D+00 0.0000000000D
0.2223580845D+09 0.2223580845D+09

---------------------------------------------------------------------Simulation tally at 0.2600000000E+06
----------------------------------------------------------------------

--------------------------------------------------------------------------------------------------------------------------------

Isotope Tally 1.7640
Key Element Z A M mk sim Half life
Decay Constant Activity
Reaction Rate
Start Atoms
Beam
End Atoms Atoms At Time
--------------------------------------------------------------------------------------------------------------------------------

314

APPENDIX D. ACTIVITY V1 FULL RESULTS

415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449

000001
+00
000593
+00
001183
+00
013027
+00
013029
+00
013619
+00
013621
+00
014210
+00
014211
+00
014212
+00
014213
+00
014214
+00
014802
+00
014803
+00
014804
+00
014805
+00
015392
+00
015394
+28
015395
+00
015396
+29
015397
+28
015398
+27
015985
+00
015986
+00
015987
+00
015988
+00

D.1. 36MEV PROTON IRRADIATED IRON

NN 000 001 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.4116613889D+13 0.4116613889D+13
H 001 003 0 000 001 0.3885235200D+09 0.1784054619D-08 0.1615640588D+02 0.0000000000D+00 0.0000000000D
0.9060200854D+10 0.9056004063D+10
HE 002 003 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.2424000000D+04 0.4199214759D+07
TI 022 047 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.5316233671D+07 0.1035882694D+09
TI 022 049 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.1736864062D+05 0.6440824599D+08
V 023 049 0 000 001 0.2851200000D+08 0.2431071761D-07 0.1313773643D+03 0.0000000000D+00 0.0000000000D
0.4772459413D+10 0.5404092399D+10
V 023 051 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.2509195042D+07 0.8409826886D+10
CR 024 050 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.4621020723D+09 0.4627337845D+09
CR 024 051 0 000 001 0.2393496000D+07 0.2895961307D-06 0.1444370965D+05 0.0000000000D+00 0.0000000000D
0.5776867728D+11 0.4987535437D+11
CR 024 052 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.1648354473D+08 0.4857309090D+11
CR 024 053 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.4169728000D+07 0.4170359063D+07
CR 024 054 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.1470632000D+07 0.2539147607D+10
MN 025 052 0 000 001 0.4830624000D+06 0.1434901952D-05 0.4510767081D+05 0.0000000000D+00 0.0000000000D
0.7658084333D+11 0.3143606485D+11
MN 025 053 0 000 001 0.1179446400D+15 0.5876885805D-14 0.1176009917D-02 0.0000000000D+00 0.0000000000D
0.1068181012D+12 0.2001076685D+12
MN 025 054 0 000 001 0.2696716800D+08 0.2570337310D-07 0.9738993802D+04 0.0000000000D+00 0.0000000000D
0.3814371220D+12 0.3788994450D+12
MN 025 055 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.0000000000D
0.2614130226D+07 0.6439401457D+10
FE 026 052 0 000 001 0.2979000000D+05 0.2326778048D-04 0.1890116552D+03 0.0000000000D+00 0.0000000000D
0.3419951609D+10 0.8123321232D+07
FE 026 054 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.5405383878D
0.5405383878D+28 0.5405383878D+28
FE 026 055 0 000 001 0.8631403200D+08 0.8030527187D-08 0.1280863433D+05 0.0000000000D+00 0.0000000000D
0.1513085775D+13 0.1594992960D+13
FE 026 056 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.7890272999D
0.7890272999D+29 0.7890272999D+29
FE 026 057 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.1758807969D
0.1758807969D+28 0.1758807969D+28
FE 026 058 0 000 001 -0.1000000000D+01 0.0000000000D+00 0.0000000000D+00 0.0000000000D+00 0.2263810953D
0.2263810953D+27 0.2263810953D+27
CO 027 055 0 000 001 0.6310800000D+05 0.1098350733D-04 0.5942036078D+05 0.0000000000D+00 0.0000000000D
0.9375256095D+11 0.5409962319D+10
CO 027 056 0 000 001 0.6672931200D+07 0.1038744683D-06 0.9433552328D+04 0.0000000000D+00 0.0000000000D
0.9330009018D+11 0.9081685308D+11
CO 027 057 0 000 001 0.2347833600D+08 0.2952284100D-07 0.1080770318D+03 0.0000000000D+00 0.0000000000D
0.3688969230D+10 0.3660793752D+10
CO 027 058 0 000 001 0.6122304000D+07 0.1132167205D-06 0.2444523420D+02 0.0000000000D+00 0.0000000000D
0.2223580845D+09 0.2159154063D+09

---------------------------------------------------------------------Gamma Lines at end of Simulation 0.2600000000E+06
---------------------------------------------------------------------Z
A
M
Gamma Energy/KeV
Gamma count/s
24
51
0
0.3200824000E+03
0.1432815997E+04
25
52
0
0.2005800000E+03
0.3428182982E+02
25
52
0
0.3460199000E+03
0.4420551289E+03
25
52
0
0.3980899000E+03
0.4014582702E+02

315

D.1. 36MEV PROTON IRRADIATED IRON

450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510

25
25
25
25
25
25
25
25
25
25
25
25
25
25
25
25
25
26
26
26
26
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27

52
52
52
52
52
52
52
52
52
52
52
52
52
52
52
52
54
52
52
52
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
55
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0.3995700000E+03
0.5020600000E+03
0.6001600000E+03
0.6474699000E+03
0.7442329000E+03
0.8481800000E+03
0.9018899000E+03
0.9355440000E+03
0.1045750000E+04
0.1246278000E+04
0.1247879000E+04
0.1333648000E+04
0.1434092000E+04
0.1645819000E+04
0.1981120000E+04
0.2257419000E+04
0.8348479000E+03
0.1686880000E+03
0.3777479000E+03
0.1039928000E+04
0.1259999000E+03
0.9190000000E+02
0.3853999000E+03
0.4114999000E+03
0.4771999000E+03
0.5199999000E+03
0.8036999000E+03
0.8270000000E+03
0.9311000000E+03
0.9845999000E+03
0.1212799000E+04
0.1316600000E+04
0.1369999000E+04
0.1408499000E+04
0.1555999000E+04
0.1622299000E+04
0.1792100000E+04
0.1940599000E+04
0.2144200000E+04
0.2177600000E+04
0.2578700000E+04
0.2872400000E+04
0.2938900000E+04
0.3108300000E+04
0.2634099000E+03
0.4113799000E+03
0.4865399000E+03
0.6550000000E+03
0.6746999000E+03
0.7335109000E+03
0.7877419000E+03
0.8467709000E+03
0.8527800000E+03
0.8965309000E+03
0.9773729000E+03
0.9973299000E+03
0.1037839000E+04
0.1089030000E+04
0.1140404000E+04
0.1159919000E+04
0.1175101000E+04

APPENDIX D. ACTIVITY V1 FULL RESULTS

0.8254703759E+02
0.9472610871E+02
0.1759199162E+03
0.1804306833E+03
0.4059690373E+05
0.1497574671E+04
0.1984737065E+02
0.4262674892E+05
0.3157536957E+02
0.1899032941E+04
0.1714091491E+03
0.2286958910E+04
0.4510767081E+05
0.2120060528E+02
0.1533660808E+02
0.1217907112E+01
0.9736656444E+04
0.1874526871E+03
0.3106047431E+01
0.1798237987E+00
0.1639505194E-04
0.6907616941E+03
0.3208699482E+03
0.6372833694E+03
0.1198805779E+05
0.4902179764E+03
0.1109675238E+04
0.1247827576E+03
0.4456527059E+05
0.3075003670E+03
0.1559783876E+03
0.4211417476E+04
0.1733589026E+04
0.1002718588E+05
0.2718481506E+02
0.2673916235E+02
0.4857614494E+02
0.8467401411E+01
0.5347832470E+02
0.1738045553E+03
0.2540220423E+02
0.6996747482E+02
0.3386960565E+02
0.3119568941E+01
0.2075380569E+01
0.2358388082E+01
0.5754466920E+01
0.3584749885E+01
0.3584749885E+01
0.1792374942E+02
0.2971568983E+02
0.9427420519E+04
0.4716776164E+01
0.8112855002E+01
0.1366921732E+03
0.1216928250E+02
0.1336733422E+04
0.4716776164E+01
0.1292396669E+02
0.8961874712E+01
0.2158396773E+03

316

APPENDIX D. ACTIVITY V1 FULL RESULTS

511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570

27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27
27

56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
56
57
57
57
57
57
57
57
57
57
58
58
58

0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

0.1198780000E+04
0.1238281000E+04
0.1272200000E+04
0.1335389000E+04
0.1360215000E+04
0.1442750000E+04
0.1462340000E+04
0.1640404000E+04
0.1771351000E+04
0.1810771000E+04
0.1963714000E+04
0.2015181000E+04
0.2034755000E+04
0.2113123000E+04
0.2212933000E+04
0.2276360000E+04
0.2373700000E+04
0.2523860000E+04
0.2598459000E+04
0.2657400000E+04
0.3009595000E+04
0.3201962000E+04
0.3253415000E+04
0.3272990000E+04
0.3369690000E+04
0.3451152000E+04
0.3547930000E+04
0.3600700000E+04
0.3611799000E+04
0.1441290000E+02
0.1220606000E+03
0.1364735000E+03
0.3396899000E+03
0.3523300000E+03
0.3667999000E+03
0.5700900000E+03
0.6924099000E+03
0.7065399000E+03
0.8107592000E+03
0.8639510000E+03
0.1674725000E+04

D.1. 36MEV PROTON IRRADIATED IRON

0.4811111687E+01
0.6311046508E+04
0.2264052559E+01
0.1113159175E+02
0.4046993949E+03
0.1745207181E+02
0.6131809013E+01
0.6792156733E+01
0.1459370545E+04
0.6018606385E+02
0.6829891886E+02
0.2867799908E+03
0.7443072787E+03
0.3547015675E+02
0.3726253170E+02
0.1207494698E+02
0.7735512909E+01
0.6414815583E+01
0.1632004553E+04
0.1981045989E+01
0.1094292070E+03
0.3131939373E+03
0.7660044491E+03
0.1820674656E+03
0.1037689813E+01
0.9169411920E+02
0.1886710466E+02
0.1556536134E+01
0.8018519479E+00
0.9899856117E+01
0.9251393926E+02
0.1154261619E+02
0.3998850178E-02
0.3242310955E-02
0.1296924382E-02
0.1707617103E-01
0.1610347774E+00
0.5403851592E-02
0.2431078541E+02
0.1686720915E+00
0.1271152178E+00

---------------------------------------------------------------------Activities Ordered by Most Active
---------------------------------------------------------------------15985
14802
14211
15395
14804
15986
15392
13619
15987
15988
593
14803

CO
MN
CR
FE
MN
CO
FE
V
CO
CO
H
MN

27
25
24
26
25
27
26
23
27
27
1
25

55
52
51
55
54
56
52
49
57
58
3
53

0
0
0
0
0
0
0
0
0
0
0
0

0.5942036078E+05
0.4510767081E+05
0.1444370965E+05
0.1280863433E+05
0.9738993802E+04
0.9433552328E+04
0.1890116552E+03
0.1313773643E+03
0.1080770318E+03
0.2444523420E+02
0.1615640588E+02
0.1176009917E-02

--------------------------------------------------------------------------------------------------------------------------------

317

D.1. 36MEV PROTON IRRADIATED IRON

571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595

APPENDIX D. ACTIVITY V1 FULL RESULTS

Totals
1.8880
--------------------------------------------------------------------------------------------------------------------------------

Total Activity/Bq:
Total Gamma Power/eV/s:
Total Gamma Power/Watts:
Absorbed Dose*/Grays/s:
Absorbed Dose*/Grays/hr:
Fraction of annual dosage if exposed for 1 hr:

0.1514219906E+06
0.2559334931E+12
0.4100506435E-07
0.4078849177E-10
0.1468385704E-06
0.1468385634E-03

Absorbed dose, assumes all energy absorbed, 80kg human, 1m from point-target, 1m surface area exposed to
irradiation.
Dose Limits:
employees 18+ 20 millisieverts/year
trainees 18+ 6 millisieverts/year
public and under 18s 1 millisieverts/year
public and under 18s millisieverts averaged per hour: 0.1140771128E-03
Dose averaged over area of skin not exceeding 1cm2
Source: http://www.hse.gov.uk/radiation/ionising/doses/

--------------------------------------------------------------------------------------------------------------------------------

Activity calculation complete. 1.8880
--------------------------------------------------------------------------------------------------------------------------------

318

Appendix E

Activity V2 Full Results

319

E.1. 36MEV PROTON IRRADIATED IRON

E.1
E.1.1

APPENDIX E. ACTIVITY V2 FULL RESULTS

36MeV Proton Irradiated Iron
Calculation Settings
Material
Sheet thickness
Density
Beam energy
Beam projectile
Beam current
Beam duration
Simulation end time

Pure Iron
0.5mm
7,808 𝑘𝑔𝑚3
36MeV
proton
0.5 microamps
300s
260,000s

Table E.1: Simulation settings for 36 MeV proton irradiated iron

E.1.2

Results File
Listing E.1: Isotope Activity at End of Simulation

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38

13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.130
13.620
13.620
13.620
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746

######################################################
Sim 1
######################################################
Beam flux:
Target depth:
Projectile:
Beam duration/s:
Sim end time/s:

3120754564499.886
0.0005
p
300.0
260000.0

Starting Target Material:
####################################################
Isotopes
####################################################
Isotope
Percentage by Mass
26 Fe 56
91.753250
26 Fe 54
5.845279
26 Fe 57
2.119074
26 Fe 58
0.282397
Loading exyz /cloud/Code/python/activity/examples/fe/Fe36MeV.exyz
Load complete
Calculate residual reaction rates
Save reaction rates

#################################################################
Particle & Residual Reaction Rates
#################################################################
Source isotope: 54Fe (26054)
helium-3:
8128226.96053868
deuteron:
31267425.752861295
triton:
658063.9037544213
alpha:
47929259.98417321
gamma:
529302786.1997857
proton:
1280534004.9887292

320

APPENDIX E. ACTIVITY V2 FULL RESULTS

39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99

25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.746
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747

neutron:
52Fe:
54Co(meta
52Fe(meta
53Fe:
53Fe(meta
50Mn(meta
54Co:
50Mn:
52Mn(meta
52Mn:
54Fe:
55Co:
47V:
53Mn:
49Cr:
53Co:
51Mn:
51Cr:
52Cr:
46Ti:
50Cr:
49V:

1):
1):
1):
1):

1):

E.1. 36MEV PROTON IRRADIATED IRON

341994739.706016
10375758.270700272
1268489.4293415854
91996.5249677117
109537376.08734141
7878234.293365053
447309.355049635
6134948.952811248
405358.7041290127
51514257.29426319
79833423.71247151
92416418.45220399
140959.1816623515
128374.10459496645
121917363.90080762
2248642.2236076766
166474.72453697983
13144593.549430655
2004868.7752378457
39343113.4701649
10113.753559680361
20277932.722341496
4456332.156319902

Source isotope: 56Fe (26056)
helium-3:
113796332.11233293
deuteron:
640048071.8232051
triton:
27462082.512083083
alpha:
784412097.0717504
gamma:
12750097788.074738
proton:
12862634835.97489
neutron:
13361355665.752747
53Fe(meta 2):
35110.96922030936
54Co(meta 1):
2098133.50324677
48Ti:
130153.19806252541
53Fe:
1650122.878507311
48Ti(meta 2):
1.3498721704564602
54Co:
2217228.5579557572
52Mn(meta 1):
51722330.55364108
52Mn:
69812825.68860963
53Mn:
617186326.652764
56Co:
297046346.5343496
57Co:
3332169.8943027295
56Fe:
1324989311.7401316
54Mn:
1105697455.8025718
48V:
6824.981311026873
54Cr:
8886829.249919416
51V:
1908704.2981555585
54Fe:
1768658520.9905515
55Mn:
469054279.81113464
51Mn:
18427975.828979623
51Cr:
157917501.71033847
55Co:
158802991.55014923
55Fe:
3310150310.2897525
52Cr:
198718293.6955533
53Cr:
868047.1046782847
50Cr:
24883.064209825417
49V:
3730773.4294895227

321

E.1. 36MEV PROTON IRRADIATED IRON

100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160

25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747

APPENDIX E. ACTIVITY V2 FULL RESULTS

Source isotope: 57Fe (26057)
helium-3:
2815186.114818401
deuteron:
16795071.729165718
triton:
1290070.0147642847
alpha:
18996008.688927133
gamma:
318048823.03063726
proton:
263457267.1862257
neutron:
381235458.34554696
58Co(meta 1):
17711.056288183212
58Co:
45119.123356589305
52Mn(meta 1):
756983.0649500752
52Mn:
1130057.9800183107
54Mn:
10749922.705687553
57Co:
6645538.449427711
57Fe:
22282747.27841167
53Mn:
9077540.382290483
56Mn:
5561497.664552677
54Cr:
32475.710066264975
51V:
278.34482695928915
50V:
60535.34442859975
56Co:
7513776.276815263
54Fe:
2335917.272526654
49Ti:
66.6465837718329
55Mn:
17896651.547242593
55Cr:
5259.683969248049
51Cr:
3777.5330594318025
55Co:
1040282.7451955614
55Fe:
52180477.480709895
52Cr:
3736281.5484410194
53Cr:
810918.822403883
52V:
1714.7498473523403
56Fe:
82701492.44833918
49V:
29701.937810047228

Source isotope: 58Fe (26058)
helium-3:
265562.0411442721
deuteron:
2046736.073932219
triton:
161109.31102851706
alpha:
2132323.5017096302
gamma:
43596863.655506425
proton:
27781338.358164437
neutron:
60156638.64809996
58Co(meta 1):
393025.0417438573
58Co:
787138.5782124916
58Fe:
3578387.673606792
59Co:
7298.027151484427
55Mn:
917307.4059246042
53Mn:
519923.8215990508
50Ti:
139.09122070067937
56Mn:
495624.1780436759
54Mn:
750596.5413600848
54Cr:
42781.814693838154
51V:
3640.3531430735275
50V:
610.1198082776706
56Co:
528863.6120293873
54Fe:
188.91955540759065
57Co:
2188175.452108935
57Fe:
7076618.451591522
55Cr:
26.068658806358545
57Mn:
347080.97455489024

322

APPENDIX E. ACTIVITY V2 FULL RESULTS

161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221

25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.747
25.748
27.168
30.417
30.417
30.417
30.419
30.420
30.422
30.424
30.528
30.655
30.771
30.793
30.797
30.800
30.803
30.807
30.809
30.811
30.814
31.061
31.297
31.542
31.790
31.966
32.119
32.266
32.294
32.294
32.294
45.551
45.551
45.551
45.551
45.551
45.551
45.551
45.551
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552

55Co:
55Fe:
52Cr:
53Cr:
56Fe:

E.1. 36MEV PROTON IRRADIATED IRON

3843.437575999017
445703.4711783764
1584.071467022736
94533.22614130769
8672082.613410642

Calculate residual amounts over time
In beam time steps: 101
Out of beam time steps: 201
In beam activity over 101 time steps
In beam activity over 201 time steps
Tally amount by residual isotope
Tally amount of residual isotopes by target isotope
Activity per target isotope by residual radioactive isotope over time
Activity by residual radioactive isotope over time
Activity resulting from each target isotope over time
Total activity from all targets and residuals over time
Activity per target and residual over time
Activity per residual over time
Activity per target over time
Activity data for pie charts
Tally gammas by target -> residual -> energy
Tally gammas by residual -> energy
Tally gammas by target -> energy
Tally gammas -> by gamma energy
Tally gammas by residual and gamma energies
Tally gammas by target and gamma energies
Tally gammas by target, residual and gamma energies
Per target and residual gamma lines over time
Per residual gamma lines over time
Per target gamma lines over time
Tallied gamma lines over time
Per residual gamma lines over time
Per target gamma lines over time
Total activity and energy of gammas over time
Gamma data for pie charts
Activity and Gamma totals over time for charts

Gamma Dose - Beam End
===================================================
Activity (Bq)
1.1873e+08
Gamma Energy (eV)
9.7722e+13
Gamma Energy (mW)
1.5657e-02
Absorbed Dose (mGy/s)
1.5570e-11
Absorbed Dose (mGy/hr) 5.6051e-08

Gamma Dose - Sim End
===================================================
Activity (Bq)
1.8420e+05
Gamma Energy (eV)
3.5639e+11
Gamma Energy (mW)
5.7100e-05
Absorbed Dose (mGy/s)
5.6782e-14
Absorbed Dose (mGy/hr) 2.0442e-10

Absorbed Dose Calculations

323

E.1. 36MEV PROTON IRRADIATED IRON

222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246

45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552
45.552

APPENDIX E. ACTIVITY V2 FULL RESULTS

===================================================
Absorbed dose assumptions:
1. radiation from point, emitted isotropically
2. 80Kg human
3. 1m from point source
4. 1m squared surface area
5. all energy absorbed

Dose Limits
===================================================
employees 18+
20 millisieverts/year
trainees 18+
6 millisieverts/year
public and under 18s
1 millisievert/year
public and under 18s
1.140771128E-04 millisieverts/hour
public and under 18s
3.2E-08 millisieverts/second
Dose averaged over area of skin not exceeding 1cm2
Source: http://www.hse.gov.uk/radiation/ionising/doses/
1mW gammas completely absorbed by 80kg human will give public limit for entire year over 80 seconds.
Dose under 1W gammas absorbed for 1s no imediate changes (under 100 Rads)
Dose 1W-2W gammas absorbed for 1s acute radiation syndrome (100-200 Rads)
Dose 10W+ gammas absorbed for 1s mostly fatal (1000+ Rads)

324

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.1.3

E.1. 36MEV PROTON IRRADIATED IRON

Activity Tallied by Residual Isotope

Residual activity at time t=3.0
Total activity: 13658991.008165512

0.3%
1.3%
4.9%
0.0%
0.8%
0.0%
2.3%
0.1%
0.0%
3.1%
0.0%
0.1%

74.4%

12.6%

52Mn(meta 1) 2.3%
52Mn 0.0%
54Co(meta 1) 0.8%
52Fe(meta 1) 0.0%
53Fe 4.9%
53Fe(meta 1) 1.3%
50Mn(meta 1) 0.3%
54Co 74.4%
50Mn 12.6%
55Co 0.1%
49Cr 0.0%
53Co 3.1%
51Mn 0.1%
56Mn 0.0%
57Mn 0.1%

Figure E.1: Residual isotope activity by isotope at 3 seconds into irradiation

Residual activity at time t=60.0
Total activity: 38065946.53520206

52Fe 0.0%

0.2%
4.8%
0.1%

34.3%

16.6%
0.4%
0.1%
0.0%
0.9%
1.1%
0.1%
0.0%
0.5%
4.5%

8.3%
1.6%

26.7%

52Mn(meta 1) 16.6%
52Mn 0.1%
54Co(meta 1) 4.8%
52Fe(meta 1) 0.2%
53Fe 34.3%
53Fe(meta 1) 8.3%
50Mn(meta 1) 1.6%
54Co 26.7%
50Mn 4.5%
55Co 0.5%
55Fe 0.0%
47V 0.0%
49Cr 0.1%
53Co 1.1%
51Mn 0.9%
51Cr 0.0%
56Co 0.0%
54Mn 0.0%
56Mn 0.1%
57Mn 0.4%

Figure E.2: Residual isotope activity by isotope at 60 seconds into irradiation

325

E.1. 36MEV PROTON IRRADIATED IRON

APPENDIX E. ACTIVITY V2 FULL RESULTS

Residual activity at time t=300.0
Total activity: 118728909.78631218

52Fe 0.1%

0.1%
3.7%
0.1%
25.0%

0.3%
0.1%
0.0%
1.4%
0.4%
0.2%
0.0%
0.8%
1.4%

48.3%

8.3%

8.6%
1.3%

52Mn(meta 1) 25.0%
52Mn 0.1%
54Co(meta 1) 3.7%
52Fe(meta 1) 0.1%
53Fe 48.3%
53Fe(meta 1) 8.3%
50Mn(meta 1) 1.3%
54Co 8.6%
50Mn 1.4%
55Co 0.8%
55Fe 0.0%
47V 0.0%
49Cr 0.2%
53Co 0.4%
51Mn 1.4%
51Cr 0.0%
56Co 0.0%
54Mn 0.0%
56Mn 0.1%
57Mn 0.3%

Figure E.3: Residual isotope activity by isotope at 300 seconds into irradiation - end of irradiation

Residual activity at time t=86001.0
Total activity: 554898.1962193253

18.0%
2.1%
2.1%
0.0%
0.1%
1.7%
0.0%
1.7%
3.4%
0.0%
2.1%

68.6%

52Fe 2.1%

52Mn(meta 1) 2.1%
52Mn 18.0%
55Co 68.6%
55Fe 2.1%
49V 0.0%
51Cr 3.4%
56Co 1.7%
57Co 0.0%
54Mn 1.7%
58Co(meta 1) 0.1%
56Mn 0.0%

Figure E.4: Residual isotope activity by isotope at 1 day, with approximately 1 day of cooling

326

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.1. 36MEV PROTON IRRADIATED IRON

Residual activity at time t=173000.5
Total activity: 287692.0694298974

30.6%

52Fe 0.5%

0.5%
0.0%
3.4%
0.0%
3.3%

50.9%

6.4%
0.0%
4.2%

52Mn(meta 1) 0.5%
52Mn 30.6%
55Co 50.9%
55Fe 4.2%
49V 0.0%
51Cr 6.4%
56Co 3.3%
57Co 0.0%
54Mn 3.4%
58Co(meta 1) 0.0%
58Co 0.0%

Figure E.5: Residual isotope activity by isotope at 2 days, with approximately 2 days of cooling

Residual activity at time t=260000.0
Total activity: 184007.52249499888

42.3%
52Fe 0.1%

0.1%
0.0%
5.2%
0.1%
5.2%

30.6%
6.6%0.1%

9.7%

52Mn(meta 1) 0.1%
52Mn 42.3%
55Co 30.6%
55Fe 6.6%
49V 0.1%
51Cr 9.7%
56Co 5.2%
57Co 0.1%
54Mn 5.2%
58Co(meta 1) 0.0%
58Co 0.0%

Figure E.6: Residual isotope activity by isotope at approximately 3 days, with approximately 3 days of cooling

327

E.1. 36MEV PROTON IRRADIATED IRON

E.1.4

APPENDIX E. ACTIVITY V2 FULL RESULTS

Gamma Output Tallied by Residual Isotope

Residual gamma power at time t=3.0
Total gamma power: 0.00024354619226584488 mW

52Fe 0.0%

0.2%

30.0%

21.6%
0.0%
0.1%
2.1%
0.0%
0.8%
0.2%
0.0%

1.2%
8.1%
35.5%

52Mn(meta 1) 30.0%
52Mn 0.2%
54Co(meta 1) 21.6%
52Fe(meta 1) 1.2%
53Fe 8.1%
53Fe(meta 1) 35.5%
54Co 0.0%
50Mn 0.2%
55Co 0.8%
49Cr 0.0%
53Co 2.1%
51Mn 0.0%
56Co 0.0%
54Mn 0.0%
56Mn 0.1%
57Mn 0.1%

Figure E.7: Gamma activity by isotope at 3 seconds into irradiation

Residual gamma power at time t=60.0
Total gamma power: 0.004306486573204578 mW

52Fe 0.0%

33.4%

0.3%
19.7%

0.2%
0.1%
0.0%
0.9%
0.0%

0.9%
9.0%
35.5%

52Mn(meta 1) 33.4%
52Mn 0.3%
54Co(meta 1) 19.7%
52Fe(meta 1) 0.9%
53Fe 9.0%
53Fe(meta 1) 35.5%
50Mn 0.0%
55Co 0.9%
49Cr 0.0%
53Co 0.1%
51Mn 0.0%
56Co 0.0%
54Mn 0.0%
56Mn 0.2%
57Mn 0.0%

Figure E.8: Gamma activity by isotope at 60 seconds into irradiation

328

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.1. 36MEV PROTON IRRADIATED IRON

Residual gamma power at time t=300.0
Total gamma power: 0.015656781568754878 mW

43.1%

52Fe 0.0%

0.4%
0.2%
0.0%
1.2%

13.1%
0.4%
10.8%

30.6%

52Mn(meta 1) 43.1%
52Mn 0.4%
54Co(meta 1) 13.1%
52Fe(meta 1) 0.4%
53Fe 10.8%
53Fe(meta 1) 30.6%
55Co 1.2%
49Cr 0.0%
53Co 0.0%
51Mn 0.0%
56Co 0.0%
54Mn 0.0%
56Mn 0.2%
57Mn 0.0%

Figure E.9: Gamma activity by isotope at 300 seconds into irradiation

Residual gamma power at time t=86001.0
Total gamma power: 0.00013470195336474222 mW

37.5%
52Fe 0.2%

2.0%
0.2%
0.0%
1.0%
3.9%
0.1%

52Mn(meta 1) 2.0%
52Mn 37.5%
55Co 55.2%
51Cr 0.1%
56Co 3.9%
54Mn 1.0%
56Mn 0.0%

55.2%

Figure E.10: Gamma activity by isotope with approximately 1 day of cooling

329

E.1. 36MEV PROTON IRRADIATED IRON

APPENDIX E. ACTIVITY V2 FULL RESULTS

Residual gamma power at time t=173000.5
Total gamma power: 8.027298909252732e-05 mW

55.6%
52Fe 0.1%

0.4%
0.1%
0.0%
1.6%
6.5%
0.1%

52Mn(meta 1) 0.4%
52Mn 55.6%
55Co 35.6%
51Cr 0.1%
56Co 6.5%
54Mn 1.6%
58Co 0.0%

35.6%

Figure E.11: Gamma activity by isotope with approximately 2 days of cooling

Residual gamma power at time t=260000.0
Total gamma power: 5.703563656739926e-05 mW

69.1%
52Fe 0.0%

0.1%
0.0%
2.3%
9.1%
0.2%

52Mn(meta 1) 0.1%
52Mn 69.1%
55Co 19.3%
51Cr 0.2%
56Co 9.1%
54Mn 2.3%
58Co 0.0%

19.3%

Figure E.12: Gamma activity by isotope with approximately 3 days of cooling

330

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.1.5

E.1. 36MEV PROTON IRRADIATED IRON

Activity Tallied by Target Isotope

Target activity at time t=3.0
Total activity: 13658991.008165512

79.5%
0.1%
0.0%

54Fe 79.5%
56Fe 20.4%
57Fe 0.0%
58Fe 0.1%

20.4%

Figure E.13: Isotope activity contribution by target isotope at 3 seconds into irradiation

Target activity at time t=60.0
Total activity: 38065946.53520206

76.5%

0.4%
0.2%

54Fe 76.5%
56Fe 23.0%
57Fe 0.2%
58Fe 0.4%

23.0%

Figure E.14: Isotope activity contribution by target isotope at 60 seconds into irradiation

331

E.1. 36MEV PROTON IRRADIATED IRON

APPENDIX E. ACTIVITY V2 FULL RESULTS

Target activity at time t=300.0
Total activity: 118728909.78631218

74.7%

0.3%

54Fe 74.7%
56Fe 24.7%
57Fe 0.3%
58Fe 0.3%

24.7%

Figure E.15: Isotope activity contribution by target isotope at 300 seconds into irradiation

Target activity at time t=86001.0
Total activity: 554898.1962193253

11.6%
0.1%
1.6%
86.7%

54Fe 11.6%
56Fe 86.7%
57Fe 1.6%
58Fe 0.1%

Figure E.16: Isotope activity contribution by target isotope with approximately 1 day of cooling

332

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.1. 36MEV PROTON IRRADIATED IRON

Target activity at time t=173000.5
Total activity: 287692.0694298974

13.6%
0.1%
1.5%
84.8%

54Fe 13.6%
56Fe 84.8%
57Fe 1.5%
58Fe 0.1%

Figure E.17: Isotope activity contribution by target isotope with approximately 2 days of cooling

Target activity at time t=260000.0
Total activity: 184007.52249499888

17.6%
0.1%
1.3%

54Fe 17.6%
56Fe 81.0%
57Fe 1.3%
58Fe 0.1%

81.0%

Figure E.18: Isotope activity contribution by target isotope with approximately 3 days of cooling

333

E.1. 36MEV PROTON IRRADIATED IRON

E.1.6

APPENDIX E. ACTIVITY V2 FULL RESULTS

Gamma Output Tallied by Target Isotope

Target gamma power at time t=3.0
Total gamma power: 0.00024354619226584488 mW

63.3%

0.1%
0.4%

54Fe 63.3%
56Fe 36.2%
57Fe 0.4%
58Fe 0.1%

36.2%

Figure E.19: Gamma activity contribution by target isotope at 3 seconds into irradiation

Target gamma power at time t=60.0
Total gamma power: 0.004306486573204578 mW

62.0%

0.1%
0.4%

54Fe 62.0%
56Fe 37.5%
57Fe 0.4%
58Fe 0.1%

37.5%

Figure E.20: Gamma activity contribution by target isotope at 60 seconds into irradiation

334

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.1. 36MEV PROTON IRRADIATED IRON

Target gamma power at time t=300.0
Total gamma power: 0.015656781568754878 mW

59.0%

0.1%
0.6%

54Fe 59.0%
56Fe 40.4%
57Fe 0.6%
58Fe 0.1%

40.4%

Figure E.21: Gamma activity contribution by target isotope at 300 seconds into irradiation

Target gamma power at time t=86001.0
Total gamma power: 0.00013470195336474222 mW

17.5%
0.1%
1.6%

54Fe 17.5%
56Fe 80.9%
57Fe 1.6%
58Fe 0.1%

80.9%

Figure E.22: Gamma activity contribution by target isotope with approximately 1 day of cooling

335

E.1. 36MEV PROTON IRRADIATED IRON

APPENDIX E. ACTIVITY V2 FULL RESULTS

Target gamma power at time t=173000.5
Total gamma power: 8.027298909252732e-05 mW

23.1%
0.1%
1.4%

54Fe 23.1%
56Fe 75.4%
57Fe 1.4%
58Fe 0.1%

75.4%

Figure E.23: Gamma activity contribution by target isotope with approximately 2 days of cooling

Target gamma power at time t=260000.0
Total gamma power: 5.703563656739926e-05 mW

28.1%

0.1%
1.4%

54Fe 28.1%
56Fe 70.4%
57Fe 1.4%
58Fe 0.1%

70.4%

Figure E.24: Gamma activity contribution by target isotope with approximately 3 days of cooling

336

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.2
E.2.1

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

13MeV Proton Irradiated Molybdenum
Calculation Settings
Material
Sheet thickness
Density
Beam energy
Beam projectile
Beam current
Beam duration
Simulation end time

Pure Molybdenum
506 micrometers
10,220 𝑘𝑔𝑚3
13MeV
proton
5.0 microamps
1500s
260,000s

Table E.2: Simulation settings for 13 MeV proton irradiated molybdenum

E.2.2

Results
Listing E.2: Final results for Molybdenum Irradiation

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38

23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
23.132
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630

######################################################
Sim 1
######################################################
Beam flux:
Target depth:
Projectile:
Beam duration/s:
Sim end time/s:

31207545644998.863
0.000506
p
1500.0
606300.0

Starting Target Material:
####################################################
Isotopes
####################################################
Isotope
Percentage by Mass
42 Mo 98
24.127937
42 Mo 96
16.678431
42 Mo 95
15.917894
42 Mo 92
14.840324
42 Mo 100
9.630239
42 Mo 97
9.555955
42 Mo 94
9.249221

#################################################################
Particle & Residual Reaction Rates
#################################################################
Source isotope: 92Mo (42092)

Source isotope: 94Mo (42094)
helium-3:
3.1332823136574574e-12
deuteron:
26779.397771044376
triton:
4.691618589935858
alpha:
35497160.708963595
gamma:
4046256131.9846444
proton:
474276321.7635846

337

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99

196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.630
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631

neutron:
94Tc(meta
95Tc(meta
95Tc:
91Nb:
91Nb(meta
94Tc:
93Mo:
93Mo(meta
94Mo:
90Zr:

1):
1):

1):

1):

APPENDIX E. ACTIVITY V2 FULL RESULTS

2939219987.127653
982541746.5227002
3220288.2361354767
4316294.073460804
16990624.30575451
18484514.956021547
1914038155.7223403
42473999.299622655
126.22443599491
431701273.0135327
18272.130848077595

Source isotope: 95Mo (42095)
helium-3:
5.46887072783639e-07
deuteron:
1234961.9156552393
triton:
41.10937959624232
alpha:
54324719.08951578
gamma:
9102804904.23539
proton:
894337849.3520026
neutron:
5518562890.307192
95Tc(meta 1):
1218252833.6464837
92Nb(meta 1):
33006155.92287399
96Tc(meta 1):
2679422.9964109
95Tc:
3689625934.027424
92Nb:
14122020.720040252
96Tc:
4182516.45184412
94Tc(meta 1):
13905093.155669797
91Nb:
6611098.919676594
91Nb(meta 1):
576457.3002812921
94Tc:
59984103.84506015
95Mo:
439173380.2083463
94Mo:
456055572.20441234

Source isotope: 96Mo (42096)
helium-3:
5.5873148279970936e-15
deuteron:
89980.87611341325
triton:
146.48193254666154
alpha:
16359850.77593771
gamma:
11880347277.430742
proton:
319281355.5874101
neutron:
6458872187.0255995
93Nb:
10952560.277578255
97Tc:
5027859.164271742
96Tc(meta 1):
2314902593.6163425
97Tc(meta 1):
2657069.708104688
96Tc:
2988618887.151654
93Nb(meta 1):
5392146.865275863
89Y:
4.699677647993188
89Y(meta 1):
0.024318699111099025
95Tc(meta 1):
186850567.4939038
92Nb(meta 1):
2991.5174685434013
95Tc:
387490658.45324874
92Nb:
2926.3241012165836
96Mo:
313532526.5135967
95Mo:
5619671.213466896

Source isotope: 97Mo (42097)
helium-3:
2.6147848182753646e-08

338

APPENDIX E. ACTIVITY V2 FULL RESULTS

100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160

196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
196.631
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077

deuteron:
triton:
alpha:
gamma:
proton:
neutron:
97Tc:
94Nb(meta 1):
97Tc(meta 1):
90Y:
94Nb:
90Y(meta 1):
93Nb:
96Tc(meta 1):
96Tc:
93Nb(meta 1):
98Tc:
97Mo:
96Mo:

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

1162205.9105530165
185.73563697784863
10097428.581276963
6269889067.613607
197692275.39840198
4202157441.703513
2012907421.2696567
7124606.3063902855
515939120.74455863
0.0007502229001053001
2737836.422765725
5.501140264263349e-05
173177.71086113452
293382016.0592189
530173961.5847317
40771.640492079096
2366306.0908124447
172514065.24175954
26186498.548734967

Source isotope: 98Mo (42098)

Source isotope: 100Mo (42100)
Gamma Dose - Beam End
===================================================
Activity (Bq)
1.2188e+09
Gamma Energy (eV)
7.0916e+14
Gamma Energy (mW)
1.1362e-01
Absorbed Dose (mGy/s)
1.1299e-10
Absorbed Dose (mGy/hr) 4.0676e-07

Gamma Dose - Sim End
===================================================
Activity (Bq)
6.0485e+06
Gamma Energy (eV)
1.4080e+13
Gamma Energy (mW)
2.2558e-03
Absorbed Dose (mGy/s)
2.2433e-12
Absorbed Dose (mGy/hr) 8.0757e-09

Absorbed Dose Calculations
===================================================
Absorbed dose assumptions:
1. radiation from point, emitted isotropically
2. 80Kg human
3. 1m from point source
4. 1m squared surface area
5. all energy absorbed

Dose Limits
===================================================
employees 18+
20 millisieverts/year
trainees 18+
6 millisieverts/year
public and under 18s
1 millisievert/year
public and under 18s
1.140771128E-04 millisieverts/hour
public and under 18s
3.2E-08 millisieverts/second

339

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

161
162
163
164
165
166
167
168
169

216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077
216.077

APPENDIX E. ACTIVITY V2 FULL RESULTS

Dose averaged over area of skin not exceeding 1cm2
Source: http://www.hse.gov.uk/radiation/ionising/doses/
1mW gammas completely absorbed by 80kg human will give public limit for entire year over 80 seconds.
Dose under 1W gammas absorbed for 1s no imediate changes (under 100 Rads)
Dose 1W-2W gammas absorbed for 1s acute radiation syndrome (100-200 Rads)
Dose 10W+ gammas absorbed for 1s mostly fatal (1000+ Rads)

340

APPENDIX E. ACTIVITY V2 FULL RESULTS

Total Decay Rates Over Time

Total activity over time
Total gamma activity

Activity (Bq)

109

108

107

0

100000

200000

300000
Time (s)

400000

500000

600000

Figure E.25: Total activity over time

Total gamma power over time
Total gamma output

10−1

Gamma Power (mW)

E.2.3

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

10−2

10−3

0

100000

200000

300000
Time (s)

400000

500000

600000

Figure E.26: Total gamma power output over time

341

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

E.2.4

APPENDIX E. ACTIVITY V2 FULL RESULTS

Residual Activity Tallied by Target Isotope
Target activity at time t=1500.0
Total activity: 1218779121.4255266

31.9%

5.0%

0.0%
7.6%

92Mo 0.0%
94Mo 31.9%
95Mo 5.0%
96Mo 55.5%
97Mo 7.6%
98Mo 0.0%
100Mo 0.0%

55.5%

Figure E.27: Radioactive decay from residual isotopes tallied by target isotope - end of beam (1,500 seconds)

Target activity at time t=260700.0
Total activity: 15752756.584976912

29.5%

0.1%
0.0%
9.4%
61.0%

92Mo 0.0%
94Mo 0.1%
95Mo 29.5%
96Mo 61.0%
97Mo 9.4%
98Mo 0.0%
100Mo 0.0%

Figure E.28: Radioactive decay from residual isotopes tallied by target isotope - 3 days after irradiation

342

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.2.5

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

Residual Activity Tallied by Residual Isotope
Residual activity at time t=1500.0
Total activity: 1218779121.4255266

4.8%
0.0%

9.3%

23.2%

0.5%
0.9%

94Tc(meta 1) 23.2%
95Tc(meta 1) 0.0%
95Tc 4.8%
94Tc 9.3%
96Tc(meta 1) 61.2%
96Tc 0.9%
94Nb(meta 1) 0.5%

61.2%

Figure E.29: Radioactive decay from residual isotopes tallied by residual isotope - end of beam (1,500 seconds)

Residual activity at time t=260700.0
Total activity: 15752756.584976912

0.0%
0.2%

30.7%

1.7%
0.4%

95Tc(meta 1) 1.7%
95Tc 30.7%
91Nb(meta 1) 0.0%
94Tc 0.0%
92Nb(meta 1) 0.2%
96Tc 66.9%
97Tc(meta 1) 0.4%

66.9%

Figure E.30: Radioactive decay from residual isotopes tallied by residual isotope - 3 days after irradiation

E.2.6

Residual Gamma Energy Tallied by Residual Isotope

343

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

APPENDIX E. ACTIVITY V2 FULL RESULTS

Residual gamma power at time t=1500.0
Total gamma power: 0.11362050036786574 mW

49.2%

0.0%
6.5%

3.9%
0.0%

94Tc(meta 1) 49.2%
95Tc(meta 1) 0.0%
95Tc 6.5%
94Tc 40.5%
92Nb(meta 1) 0.0%
96Tc 3.9%

40.5%

Figure E.31: Radioactive decay from residual isotopes tallied by residual isotope - end of beam (1,500 seconds)

Residual gamma power at time t=260700.0
Total gamma power: 0.004850933370399499 mW

0.1%
0.0%
12.5%
0.6%
86.7%

95Tc(meta 1) 0.6%
95Tc 12.5%
94Tc 0.0%
92Nb(meta 1) 0.1%
96Tc 86.7%

Figure E.32: Radioactive decay from residual isotopes tallied by residual isotope - 3 days after irradiation

344

APPENDIX E. ACTIVITY V2 FULL RESULTS

Gamma Lines

Gamma Lines at time 1500s

1e8
2.5

Activity (Bq)

2.0

1.5

1.0

0.5

0.0
0

500

1000

1500

2000
2500
Energy (keV)

3000

3500

4000

Figure E.33: Predicted gamma lines - end of beam (1,500 seconds)

Gamma Lines at time 260700s

1e7
1.0

0.8

Activity (Bq)

E.2.7

E.2. 13MEV PROTON IRRADIATED MOLYBDENUM

0.6

0.4

0.2

0.0
0

500

1000

1500

2000
2500
Energy (keV)

3000

3500

4000

Figure E.34: Predicted gamma lines - 3 days after irradiation

345

E.3. 13MEV PROTON IRRADIATED STEEL

E.3
E.3.1

APPENDIX E. ACTIVITY V2 FULL RESULTS

13MeV Proton Irradiated Steel
Calculation Settings

Material
Compotision
Ni: 0.698%, Si: 0.381%, Cr: 0.092%, V: 0.008%,
P:0.009%, Si: 0.003%, Mo: 0.278%
Sheet thickness
Density
Beam energy
Beam projectile
Beam current
Beam duration
Simulation end time

Steel
Fe: 96.375%, C,0.772%, Cu: 0.024%, Mn: 1.36%,

0.1mm
10,220 𝑘𝑔𝑚3
13MeV
proton
5.0 microamps
1500s
260,000s

Table E.3: Simulation settings for 13 MeV proton irradiated steel

E.3.2

Results
Listing E.3: Final results for steel irradiation

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35

22.923
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924

######################################################
Sim 1
######################################################
Beam flux:
Target depth:
Projectile:
Beam duration/s:
Sim end time/s:

3120754564499.886
0.0001
p
300.0
260000.0

Starting Target Material:
####################################################
Isotopes
####################################################
Isotope
Percentage by Mass
26 Fe 56
88.427066
26 Fe 54
5.633380
26 Fe 57
2.042255
25 Mn 55
1.359982
6 C 12
0.763791
28 Ni 58
0.475171
14 Si 28
0.354158
26 Fe 58
0.272159
28 Ni 60
0.183035
24 Cr 52
0.077085
42 Mo 98
0.067089
42 Mo 96
0.046375
42 Mo 95
0.044261
42 Mo 92
0.041264
42 Mo 100
0.026777
42 Mo 97
0.026571
42 Mo 94
0.025718
28 Ni 62
0.025369
14 Si 29
0.017983

346

APPENDIX E. ACTIVITY V2 FULL RESULTS

36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96

22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
22.924
25.233
25.233
25.233
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202

29 Cu 63
14 Si 30
15 P 31
24 Cr 53
6 C 13
23 V 51
28 Ni 61
29 Cu 65
28 Ni 64
24 Cr 50
24 Cr 54
23 V 50

E.3. 13MEV PROTON IRRADIATED STEEL

0.016601
0.011855
0.009000
0.008741
0.008322
0.007980
0.007957
0.007400
0.006461
0.003997
0.002176
0.000020

No neutron data - check input file if this was expected.
Loading exyz /cloud/Code/python/activity/examples/steel_mo_alex/EXYZ.txt
Load complete
Calculate residual reaction rates
Save reaction rates

#################################################################
Particle & Residual Reaction Rates
#################################################################
Source isotope: 54Fe (26054)
gamma:
9437.040170446791
proton:
1565268.3669538412
54Fe:
1565266.518538786
55Co:
6775.591316791584

Source isotope: 56Fe (26056)
alpha:
141.08685329154952
gamma:
789287.6222288499
proton:
52520697.287055105
57Co:
481048.9617216237
56Fe:
52520681.59831387
53Mn:
10.002522668635752

Source isotope: 57Fe (26057)
alpha:
162.32061306305624
gamma:
535353.864872089
proton:
978777.8004339848
neutron:
3688622.628908507
58Co(meta 1):
728.6876378115435
58Co:
6881.800814627011
54Mn:
160.22643404225298
57Co:
3688627.1514117825
57Fe:
978777.3418067234

Source isotope: 58Fe (26058)
alpha:
43.943611364864445
gamma:
98344.38755516597
proton:
41017.57430083777
neutron:
492403.40262528614
58Co(meta 1):
56789.67542912096
58Co:
435614.24931542686
58Fe:
41017.52981489155
59Co:
1538.890109035841

347

E.3. 13MEV PROTON IRRADIATED STEEL

97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157

2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.202
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203

55Mn:

APPENDIX E. ACTIVITY V2 FULL RESULTS

43.5574480094259

Source isotope: 12C (6012)
gamma:
9.297962900075367
proton:
0.16469844495501224
13N:
0.007674329520104557
12C:
0.0015485788201596345

Source isotope: 13C (6013)
deuteron:
22007.034476038276
alpha:
0.18762061472548627
gamma:
2.126677081939579
proton:
15575.860814489852
neutron:
40043.90782911613
14N:
1.5936166964929555
13N:
40043.90713723769
13C:
15575.759126042365
10B:
0.1781070935677874
12C:
22007.033370066518

Source isotope: 63Cu (29063)
alpha:
1692.0838953018506
gamma:
299.2627214435676
proton:
6379.155491720199
neutron:
5394.987689364512
63Zn:
5394.984586472825
64Zn:
126.03966676776412
60Ni:
1692.0790143093795
63Cu:
6379.15167174332

Source isotope: 65Cu (29065)
alpha:
179.81444103349426
gamma:
4570.928464143155
proton:
196.27149662965846
neutron:
11626.041286478714
65Zn:
11626.108047914477
62Ni:
179.8126241955046
66Zn:
22.545359039206943
65Cu:
196.26876049878186

Source isotope: 55Mn (25055)
alpha:
7559.4602195728685
gamma:
1089436.2434572722
proton:
208787.722901346
neutron:
3762868.238725696
55Mn:
208787.29464964083
55Fe:
3762867.731630595
52Cr:
7558.225085207358
56Fe:
4020.3882860207686

Source isotope: 58Ni (28058)

Source isotope: 60Ni (28060)
alpha:
3.7350612746683702

348

APPENDIX E. ACTIVITY V2 FULL RESULTS

158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218

2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203

gamma:
proton:
61Cu:
57Co:
60Ni:

E.3. 13MEV PROTON IRRADIATED STEEL

1068.8890413081508
54079.322487803365
700.3202719179782
3.5767113271911004
54079.26781602166

Source isotope: 61Ni (28061)
alpha:
1.1816684320989317
gamma:
128.82855291693463
proton:
5102.959336011498
neutron:
7047.509511295016
58Co(meta 1):
0.3875470184903323
58Co:
0.7908643602588629
62Cu:
52.814624350057834
61Cu:
7047.508588933512
61Ni:
5102.957885289876

Source isotope: 62Ni (28062)
alpha:
8.267816891537628
gamma:
388.1397871255684
proton:
8527.037047829523
neutron:
1844.9955288027365
62Cu:
1844.9955288027365
62Ni:
8527.031845278989
59Co:
8.243744437281922
63Cu:
208.7277615583037

Source isotope: 64Ni (28064)
alpha:
0.07630525559968063
gamma:
5151.320921833089
proton:
56.99767595200096
neutron:
11845.401695288525
64Ni:
56.99418413333431
64Cu:
11845.473066627274
65Cu:
30.98952258201603
61Co:
0.06685196871380082

Source isotope: 28Si (14028)
gamma:
13.702062307864928
proton:
1178590.0836380594
28Si:
1178590.0604642944
29P:
8.050395593678346

Source isotope: 29Si (14029)
gamma:
9.078347487191659
proton:
84781.9498117798
30P:
7.820937171960048
29Si:
84781.94527177457

Source isotope: 30Si (14030)
alpha:
18.012799203689656
gamma:
44.536475045039495
proton:
22280.059950660707
27Al:
18.00443071564093
30Si:
22280.03863765834

349

E.3. 13MEV PROTON IRRADIATED STEEL

219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279

2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.203
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204

31P:

APPENDIX E. ACTIVITY V2 FULL RESULTS

37.96948319612531

Source isotope: 50Cr (24050)

Source isotope: 52Cr (24052)
gamma:
1716.8903887877764
proton:
44745.238196387676
53Mn:
1002.4329343842852
52Cr:
44745.207512644854

Source isotope: 53Cr (24053)
alpha:
0.0008749097159051281
gamma:
3819.8654210053855
proton:
1286.541940389091
neutron:
24768.975739576643
53Mn:
24768.990352716894
54Mn:
30.94645047824251
53Cr:
1286.5399503518554

Source isotope: 54Cr (24054)
alpha:
0.4269079942609668
gamma:
1865.3489179309959
proton:
221.4928772397376
neutron:
6388.425420578959
54Mn:
6388.361753557401
54Cr:
221.492609742648
51V:
0.42442091852428715
55Mn:
7.8571555539379725

Source isotope: 50V (23050)

Source isotope: 51V (23051)
alpha:
8.793906047440933
gamma:
2562.072010807901
proton:
1847.832021588929
neutron:
25029.202918484196
48Ti:
8.793777777102894
48Ti(meta 2):
1.579638927783296e-10
51V:
1847.8305644822933
51Cr:
25029.073649384834
52Cr:
40.93279078441332

Source isotope: 31P (15031)
alpha:
20500.994041875198
gamma:
10.0954990307587
proton:
26364.330767920488
32S:
9.264165864007683
28Si:
20500.992316322965
31P:
26364.329727107408

Source isotope: 92Mo (42092)

350

APPENDIX E. ACTIVITY V2 FULL RESULTS

280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340

2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204
2093.204

E.3. 13MEV PROTON IRRADIATED STEEL

Source isotope: 94Mo (42094)
alpha:
6.316988840379401
gamma:
703.8931041262591
proton:
415.92814568579826
95Tc(meta 1):
168.5967957674172
95Tc:
154.37353711985034
91Nb:
2.8488760993901363
91Nb(meta 1):
3.4681060226552836
94Mo:
415.92255867168075

Source isotope: 95Mo (42095)
alpha:
0.3612518926731171
gamma:
2837.9324213752393
proton:
27.983772297098664
neutron:
4837.221144492528
95Tc(meta 1):
1722.2145927476358
92Nb(meta 1):
0.2650312237060021
96Tc(meta 1):
10.515615095353965
95Tc:
3114.998741697279
92Nb:
0.06524726219560126
96Tc:
14.174191939937892
95Mo:
27.966253449261647

Source isotope: 96Mo (42096)
alpha:
0.3896402613477655
gamma:
4292.6274939880095
proton:
21.500556624813015
neutron:
4752.57364472505
93Nb:
0.09566857523677805
97Tc:
132.8134009610271
96Tc(meta 1):
2590.5566655407283
97Tc(meta 1):
144.62005700946108
96Tc:
2162.0149844513953
93Nb(meta 1):
0.2760343367542316
96Mo:
21.48595210274134

Source isotope: 97Mo (42097)
alpha:
0.045466521561900126
gamma:
3929.5034765150745
proton:
2.6604200399980016
neutron:
3129.4062378018352
deuteron:
2.725811726999687e-37
97Tc:
2321.9708779633056
94Nb(meta 1):
0.016376736489314845
97Tc(meta 1):
807.3747270640994
94Nb:
0.0032273192037714157
98Tc:
3.2573253415058523
97Mo:
2.639546007559529

Source isotope: 98Mo (42098)

Source isotope: 100Mo (42100)

Calculate residual amounts over time

351

E.3. 13MEV PROTON IRRADIATED STEEL

341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399

2093.204
2093.204
2093.204
2093.204
2101.162
2101.163
2101.163
2101.164
2101.165
2101.167
2101.169
2101.381
2101.621
2101.858
2101.947
2101.951
2101.954
2101.958
2101.961
2101.963
2101.965
2101.967
2102.366
2102.692
2103.016
2103.310
2103.534
2103.746
2103.937
2106.475
2106.589
2106.589
2106.589

APPENDIX E. ACTIVITY V2 FULL RESULTS

In beam time steps: 401
Out of beam time steps: 201
In beam activity over 401 time steps
Tally amount by residual isotope
Tally amount of residual isotopes by target isotope
Activity per target isotope by residual radioactive isotope over time
Activity by residual radioactive isotope over time
Activity resulting from each target isotope over time
Total activity from all targets and residuals over time
Activity per target and residual over time
Activity per residual over time
Activity per target over time
Activity data for pie charts
Tally gammas by target -> residual -> energy
Tally gammas by residual -> energy
Tally gammas by target -> energy
Tally gammas -> by gamma energy
Tally gammas by residual and gamma energies
Tally gammas by target and gamma energies
Tally gammas by target, residual and gamma energies
Per target and residual gamma lines over time
Per residual gamma lines over time
Per target gamma lines over time
Tallied gamma lines over time
Per residual gamma lines over time
Per target gamma lines over time
Total activity and energy of gammas over time
Gamma full details over time
Gamma data for pie charts
Activity and Gamma totals over time for charts

#######################################################
Results
#######################################################

####################################################################################################################
Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

0.75s (0.0hr)
0.75s (0.0hr)

54Fe
54Fe

55Co
55Fe

0.055814587778344006 63108.0
1.6736042369180374e-10 86686900.0

0.75s (0.0hr)
0.75s (0.0hr)

56Fe
56Fe

57Co
53Mn

0.010649106656255231 23483500.0
4.477590405477266e-14 116132000000000.0

0.75s
0.75s
0.75s
0.75s

(0.0hr)
(0.0hr)
(0.0hr)
(0.0hr)

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

0.011563273217088194 32760.0
0.0005844341330063274 6121440.0
3.0880790906605835e-06 26973200.0
0.08165610379858611 23483500.0

0.75s (0.0hr)
0.75s (0.0hr)

58Fe
58Fe

58Co(meta 1)
58Co

0.9011742464423667 32760.0
0.03699436999751045 6121440.0

0.75s (0.0hr)

12C

13N

6.668416321011822e-06 598.02

352

APPENDIX E. ACTIVITY V2 FULL RESULTS

400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460

E.3. 13MEV PROTON IRRADIATED STEEL

0.75s (0.0hr)

13C

13N

34.79514962336404

598.02

0.75s (0.0hr)

63Cu

63Zn

1.2193763813285798

2299.8

0.75s (0.0hr)

65Cu

65Zn

0.0002866810350129723 21082500.0

0.75s (0.0hr)

55Mn

55Fe

0.022565876380973456 86686900.0

0.75s (0.0hr)
0.75s (0.0hr)

60Ni
60Ni

61Cu
57Co

0.030043982065932458 12117.6
7.917859393268095e-08 23483500.0

0.75s
0.75s
0.75s
0.75s

(0.0hr)
(0.0hr)
(0.0hr)
(0.0hr)

61Ni
61Ni
61Ni
61Ni

58Co(meta 1)
58Co
62Cu
61Cu

6.149839556397991e-06 32760.0
6.716403863623248e-08 6121440.0
0.046912880496271896 585.0
0.3023405578072741 12117.6

0.75s (0.0hr)

62Ni

62Cu

1.6388274237301088

0.75s (0.0hr)
0.75s (0.0hr)
0.75s (0.0hr)

64Ni
64Ni
64Ni

64Cu
64Zn
61Co

0.13468435317630206 45721.4
7.429964442377365e-13 7.25825e+25
5.8505335806687024e-06 5940.0

0.75s (0.0hr)

28Si

29P

0.9495652750019146

0.75s (0.0hr)

29Si

30P

0.02708001354637464 149.88

0.75s (0.0hr)

52Cr

53Mn

4.487352078898796e-12 116132000000000.0

0.75s (0.0hr)
0.75s (0.0hr)

53Cr
53Cr

53Mn
54Mn

1.1087742285697869e-10 116132000000000.0
5.96437705321599e-07 26973200.0

0.75s (0.0hr)

54Cr

54Mn

0.00012312429264658056 26973200.0

0.75s (0.0hr)

51V

51Cr

0.005435937241889871 2393630.0

0.75s
0.75s
0.75s
0.75s

(0.0hr)
(0.0hr)
(0.0hr)
(0.0hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

1.6630007396704765e-05 5270400.0
0.001114616624310585 72000.0
6.901505818874096e-11 21459200000.0
3.426478676454852e-07 5261760.0

0.75s
0.75s
0.75s
0.75s
0.75s
0.75s

(0.0hr)
(0.0hr)
(0.0hr)
(0.0hr)
(0.0hr)
(0.0hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.0001698753602388515 5270400.0
0.022491091694841127 72000.0
1.571100087308151e-07 876960.0
0.001768994138678013 3090.0
1.9927543958366358e-05 369792.0
3.070969006681852e-17 1104520000000000.0

0.75s
0.75s
0.75s
0.75s
0.75s

(0.0hr)
(0.0hr)
(0.0hr)
(0.0hr)
(0.0hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

8.414941390781586e-13 82049800000000.0
0.43579757491119436 3090.0
0.003039698444859858 369792.0
9.647059513113265e-06 7793280.0
2.820913718831165e-10 508698000.0

0.75s (0.0hr)
0.75s (0.0hr)

97Mo
97Mo

97Tc
94Nb(meta 1)

1.4711805215270783e-11 82049800000000.0
2.265103167746589e-05 375.6

353

585.0

4.142

E.3. 13MEV PROTON IRRADIATED STEEL

APPENDIX E. ACTIVITY V2 FULL RESULTS

461
462
463
464
465
466
467
468
469

0.75s (0.0hr)
0.75s (0.0hr)
0.75s (0.0hr)

470
471

Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519

97Mo
97Mo
97Mo

94Nb
97Tc(meta 1)
98Tc

2.6703911020600714e-15 630720000000.0
5.385692830187033e-05 7793280.0
1.2479121614454708e-14 135695000000000.0

####################################################################################################################

50.25s (0.014hr)
50.25s (0.014hr)

54Fe
54Fe

55Co
55Fe

3.738560993240823
63108.0
7.511426371579283e-07 86686900.0

50.25s (0.014hr)
50.25s (0.014hr)

56Fe
56Fe

57Co
53Mn

0.7134896238985547 23483500.0
2.999985571669768e-12 116132000000000.0

50.25s
50.25s
50.25s
50.25s

(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

0.7743337413479942 32760.0
0.03915914760310734 6121440.0
0.00020690116752995448 26973200.0
5.4709549513294125 23483500.0

50.25s (0.014hr)
50.25s (0.014hr)

58Fe
58Fe

58Co(meta 1)
58Co

60.34706719745709
2.4787849942804443

50.25s (0.014hr)

12C

13N

0.00043421045643969174 598.02

50.25s (0.014hr)

13C

13N

2265.6680495850946

598.02

50.25s (0.014hr)

63Cu

63Zn

81.09183068156304

2299.8

50.25s (0.014hr)

65Cu

65Zn

0.019207613764897446 21082500.0

50.25s (0.014hr)

55Mn

55Fe

1.5119134139965489

50.25s (0.014hr)
50.25s (0.014hr)

60Ni
60Ni

61Cu
57Co

2.01009969369476
12117.6
5.304961911773244e-06 23483500.0

50.25s
50.25s
50.25s
50.25s

(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)

61Ni
61Ni
61Ni
61Ni

58Co(meta 1)
58Co
62Cu
61Cu

0.00041182355402259496 32760.0
4.501132308031655e-06 6121440.0
3.052777485942192
585.0
20.228166203341885 12117.6

50.25s (0.014hr)

62Ni

62Cu

106.64396237416076

50.25s (0.014hr)
50.25s (0.014hr)
50.25s (0.014hr)

64Ni
64Ni
64Ni

64Cu
64Zn
61Co

9.020466624081012
45721.4
7.429964442377365e-13 7.25825e+25
0.00039085584374088246 5940.0

50.25s (0.014hr)

28Si

29P

8.048601788032434

4.142

50.25s (0.014hr)

29Si

30P

1.621774855486964

149.88

50.25s (0.014hr)

52Cr

53Mn

3.0065258928621933e-10 116132000000000.0

354

32760.0
6121440.0

86686900.0

585.0

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.3. 13MEV PROTON IRRADIATED STEEL

520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558

50.25s (0.014hr)
50.25s (0.014hr)

53Cr
53Cr

53Mn
54Mn

7.428787331417573e-09 116132000000000.0
3.996130084981988e-05 26973200.0

50.25s (0.014hr)

54Cr

54Mn

0.008249322362539599 26973200.0

50.25s (0.014hr)

51V

51Cr

0.36420518492744636 2393630.0

50.25s
50.25s
50.25s
50.25s

(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.0011142068677962946 5270400.0
0.07466153318459061 72000.0
4.624057292233371e-09 21459200000.0
2.295733228812532e-05 5261760.0

50.25s
50.25s
50.25s
50.25s
50.25s
50.25s

(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.011381612078236538 5270400.0
1.5065442574004724 72000.0
1.052616466794706e-05 876960.0
0.11786702793260355 3090.0
0.0013404518318805023 369792.0
2.0575492344768407e-15 1104520000000000.0

50.25s
50.25s
50.25s
50.25s
50.25s

(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

5.638010731823663e-11 82049800000000.0
29.036933369041623 3090.0
0.20497285253117498 369792.0
0.0006463515654757437 7793280.0
1.8900121288447782e-08 508698000.0

50.25s
50.25s
50.25s
50.25s
50.25s

(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)
(0.014hr)

97Mo
97Mo
97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb
97Tc(meta 1)
98Tc

9.856909494231425e-10 82049800000000.0
0.0014503810447542796 375.6
2.186889219617751e-13 630720000000.0
0.00360840625812568 7793280.0
8.361011481684656e-13 135695000000000.0

559
560

Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578

####################################################################################################################

100.5s (0.028hr)
100.5s (0.028hr)

54Fe
54Fe

55Co
55Fe

7.4750591645609195 63108.0
3.0040173294533986e-06 86686900.0

100.5s (0.028hr)
100.5s (0.028hr)

56Fe
56Fe

57Co
53Mn

1.4269781895860318 23483500.0
5.999971143339536e-12 116132000000000.0

100.5s
100.5s
100.5s
100.5s

(0.028hr)
(0.028hr)
(0.028hr)
(0.028hr)

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

1.5478446435096864 32760.0
0.07832247595455813 6121440.0
0.0004138020679218949 26973200.0
10.941901788420102 23483500.0

100.5s (0.028hr)
100.5s (0.028hr)

58Fe
58Fe

58Co(meta 1)
58Co

120.63000709551221
4.957899072383595

100.5s (0.028hr)

12C

13N

0.0008438534610925341 598.02

100.5s (0.028hr)

13C

13N

4403.145518432949

355

32760.0
6121440.0

598.02

E.3. 13MEV PROTON IRRADIATED STEEL

579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639

APPENDIX E. ACTIVITY V2 FULL RESULTS

100.5s (0.028hr)

63Cu

63Zn

160.96477280137393

100.5s (0.028hr)

65Cu

65Zn

0.038415195798267444 21082500.0

100.5s (0.028hr)

55Mn

55Fe

3.023826220039065

100.5s (0.028hr)
100.5s (0.028hr)

60Ni
60Ni

61Cu
57Co

4.014429883148813
12117.6
1.0609915955500094e-05 23483500.0

100.5s
100.5s
100.5s
100.5s

(0.028hr)
(0.028hr)
(0.028hr)
(0.028hr)

61Ni
61Ni
61Ni
61Ni

58Co(meta 1)
58Co
62Cu
61Cu

0.0008232094872364905 32760.0
9.004581005597246e-06 6121440.0
5.929099103962157
585.0
40.39827235570322
12117.6

100.5s (0.028hr)

62Ni

62Cu

207.12371755469115

100.5s (0.028hr)
100.5s (0.028hr)
100.5s (0.028hr)

64Ni
64Ni
64Ni

64Cu
64Zn
61Co

18.03406405706832
45721.4
7.429964442377365e-13 7.25825e+25
0.0007794265148305085 5940.0

100.5s (0.028hr)

28Si

29P

8.050395193978895

4.142

100.5s (0.028hr)

29Si

30P

2.9072532257752615

149.88

100.5s (0.028hr)

52Cr

53Mn

6.013051785724387e-10 116132000000000.0

100.5s (0.028hr)
100.5s (0.028hr)

53Cr
53Cr

53Mn
54Mn

1.4857574662835146e-08 116132000000000.0
7.992255010407519e-05 26973200.0

100.5s (0.028hr)

54Cr

54Mn

0.01649863407406345 26973200.0

100.5s (0.028hr)

51V

51Cr

0.7284050702016738

100.5s
100.5s
100.5s
100.5s

(0.028hr)
(0.028hr)
(0.028hr)
(0.028hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.0022284063721276894 5270400.0
0.14928697782598677 72000.0
9.24815191666299e-09 21459200000.0
4.5914512609520086e-05 5261760.0

100.5s
100.5s
100.5s
100.5s
100.5s
100.5s

(0.028hr)
(0.028hr)
(0.028hr)
(0.028hr)
(0.028hr)
(0.028hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.022763148938752323 5270400.0
3.012360100335684
72000.0
2.1051911271401087e-05 876960.0
0.23441291238974704 3090.0
0.0026915956508928164 369792.0
4.115098468953681e-15 1104520000000000.0

100.5s
100.5s
100.5s
100.5s
100.5s

(0.028hr)
(0.028hr)
(0.028hr)
(0.028hr)
(0.028hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

1.1276021463647326e-10 82049800000000.0
57.748398659853486 3090.0
0.4125915084644436 369792.0
0.0012927002421992155 7793280.0
3.780024123177908e-08 508698000.0

100.5s (0.028hr)
100.5s (0.028hr)
100.5s (0.028hr)

97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb

1.971381898846285e-09 82049800000000.0
0.0027723112729276726 375.6
5.134863356884003e-13 630720000000.0

356

2299.8

86686900.0

585.0

2393630.0

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.3. 13MEV PROTON IRRADIATED STEEL

640
641
642
643
644
645
646
647

100.5s (0.028hr)
100.5s (0.028hr)

648
649

Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698

97Mo
97Mo

97Tc(meta 1)
98Tc

0.007216796389127465 7793280.0
1.6722022963369312e-12 135695000000000.0

####################################################################################################################

150.0s (0.042hr)
150.0s (0.042hr)

54Fe
54Fe

55Co
55Fe

11.153772944664176 63108.0
6.690738505026423e-06 86686900.0

150.0s (0.042hr)
150.0s (0.042hr)

56Fe
56Fe

57Co
53Mn

2.1298166375882355 23483500.0
8.955180810954531e-12 116132000000000.0

150.0s
150.0s
150.0s
150.0s

(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

2.3090069484237934 32760.0
0.1169053600570036 6121440.0
0.0006176146339266021 26973200.0
16.33118476925999
23483500.0

150.0s (0.042hr)
150.0s (0.042hr)

58Fe
58Fe

58Co(meta 1)
58Co

179.95056916072608
7.400332844162393

150.0s (0.042hr)

12C

13N

0.0012247147993447935 598.02

150.0s (0.042hr)

13C

13N

6390.443043406799

598.02

150.0s (0.042hr)

63Cu

63Zn

238.4716705046397

2299.8

150.0s (0.042hr)

65Cu

65Zn

0.057336066476241516 21082500.0

150.0s (0.042hr)

55Mn

55Fe

4.513172569543883

150.0s (0.042hr)
150.0s (0.042hr)

60Ni
60Ni

61Cu
57Co

5.9832198284623175 12117.6
1.5835683888057496e-05 23483500.0

150.0s
150.0s
150.0s
150.0s

(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)

61Ni
61Ni
61Ni
61Ni

58Co(meta 1)
58Co
62Cu
61Cu

0.0012280279122376598 32760.0
1.3443076405121306e-05 6121440.0
8.59989033064392
585.0
60.21072760764531
12117.6

150.0s (0.042hr)

62Ni

62Cu

300.42359296293176

150.0s (0.042hr)
150.0s (0.042hr)
150.0s (0.042hr)

64Ni
64Ni
64Ni

64Cu
64Zn
61Co

26.906419105746956 45721.4
7.429964442377365e-13 7.25825e+25
0.0011599763551937959 5940.0

150.0s (0.042hr)

28Si

29P

8.050395593577374

4.142

150.0s (0.042hr)

29Si

30P

3.912638144261762

149.88

150.0s (0.042hr)

52Cr

53Mn

8.974704157797592e-10 116132000000000.0

150.0s (0.042hr)

53Cr

53Mn

2.2175484571395738e-08 116132000000000.0

357

32760.0
6121440.0

86686900.0

585.0

E.3. 13MEV PROTON IRRADIATED STEEL

APPENDIX E. ACTIVITY V2 FULL RESULTS

699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736

150.0s (0.042hr)

53Cr

54Mn

0.00011928731234452378 26973200.0

150.0s (0.042hr)

54Cr

54Mn

0.024624811314053138 26973200.0

150.0s (0.042hr)

51V

51Cr

1.0871639547718752

150.0s
150.0s
150.0s
150.0s

(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.003325968833693196 5270400.0
0.22276334223053978 72000.0
1.3803265588860933e-08 21459200000.0
6.852889986732321e-05 5261760.0

150.0s
150.0s
150.0s
150.0s
150.0s
150.0s

(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.03397473857280299 5270400.0
4.494989234861635
72000.0
3.142014844403659e-05 876960.0
0.34794200031714023 3090.0
0.00403290799680174 369792.0
6.141938013363704e-15 1104520000000000.0

150.0s
150.0s
150.0s
150.0s
150.0s

(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

1.6829882781563173e-10 82049800000000.0
85.71666611698106
3090.0
0.6196689367250918 369792.0
0.0019293990993875707 7793280.0
5.641826863745964e-08 508698000.0

150.0s
150.0s
150.0s
150.0s
150.0s

(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)
(0.042hr)

97Mo
97Mo
97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb
97Tc(meta 1)
98Tc

2.9423610430541566e-09 82049800000000.0
0.003959992861262792 375.6
8.717414920608875e-13 630720000000.0
0.010771314183369815 7793280.0
2.4958243228909417e-12 135695000000000.0

737
738

Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757

2393630.0

####################################################################################################################

200.25s (0.056hr)
200.25s (0.056hr)

54Fe
54Fe

55Co
55Fe

14.886179632175939 63108.0
1.192220801352644e-05 86686900.0

200.25s (0.056hr)
200.25s (0.056hr)

56Fe
56Fe

57Co
53Mn

2.8433031026161735 23483500.0
1.19551663826243e-11 116132000000000.0

200.25s
200.25s
200.25s
200.25s

(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

3.0808870431111814 32760.0
0.1560769735770539 6121440.0
0.0008245150039385325 26973200.0
21.802115498739134 23483500.0

200.25s (0.056hr)
200.25s (0.056hr)

58Fe
58Fe

58Co(meta 1)
58Co

240.10641341128093
9.880099092615463

200.25s (0.056hr)

12C

13N

0.0015896313883998717 598.02

200.25s (0.056hr)

13C

13N

8294.542413479194

358

32760.0
6121440.0

598.02

APPENDIX E. ACTIVITY V2 FULL RESULTS

758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818

E.3. 13MEV PROTON IRRADIATED STEEL

200.25s (0.056hr)

63Cu

63Zn

315.97904157988637

200.25s (0.056hr)

65Cu

65Zn

0.07654358551646347 21082500.0

200.25s (0.056hr)

55Mn

55Fe

6.025084169990238

200.25s (0.056hr)
200.25s (0.056hr)

60Ni
60Ni

61Cu
57Co

7.976146139025349
12117.6
2.1140622312890297e-05 23483500.0

200.25s
200.25s
200.25s
200.25s

(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)

61Ni
61Ni
61Ni
61Ni

58Co(meta 1)
58Co
62Cu
61Cu

0.00163854651280914 32760.0
1.7951115899039187e-05 6121440.0
11.155579142643226 585.0
80.26607350294381
12117.6

200.25s (0.056hr)

62Ni

62Cu

389.70254721425994

200.25s (0.056hr)
200.25s (0.056hr)
200.25s (0.056hr)

64Ni
64Ni
64Ni

64Cu
64Zn
61Co

35.90639617621384
45721.4
7.429964442377365e-13 7.25825e+25
0.001544050296385634 5940.0

200.25s (0.056hr)

28Si

29P

8.050395593678322

4.142

200.25s (0.056hr)

29Si

30P

4.723075685375102

149.88

200.25s (0.056hr)

52Cr

53Mn

1.1981230050659784e-09 116132000000000.0

200.25s (0.056hr)
200.25s (0.056hr)

53Cr
53Cr

53Mn
54Mn

2.9604271902813308e-08 116132000000000.0
0.00015924845916013463 26973200.0

200.25s (0.056hr)

54Cr

54Mn

0.032874101878883

26973200.0

200.25s (0.056hr)

51V

51Cr

1.451353320064039

2393630.0

200.25s
200.25s
200.25s
200.25s

(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.004440153721141497 5270400.0
0.29731720012442947 72000.0
1.8427432112335176e-08 21459200000.0
9.148577852438231e-05 5261760.0

200.25s
200.25s
200.25s
200.25s
200.25s
200.25s

(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.04535612612200328 5270400.0
5.999360164324543
72000.0
4.194506520753931e-05 876960.0
0.4619090291438015 3090.0
0.005404915292026131 369792.0
8.199487247840544e-15 1104520000000000.0

200.25s
200.25s
200.25s
200.25s
200.25s

(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

2.2467893513386836e-10 82049800000000.0
113.7928217675642
3090.0
0.8324507936749032 369792.0
0.0025757420417801347 7793280.0
7.531838602506962e-08 508698000.0

200.25s
200.25s
200.25s
200.25s

(0.056hr)
(0.056hr)
(0.056hr)
(0.056hr)

97Mo
97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb
97Tc(meta 1)

3.928051992477299e-09 82049800000000.0
0.005059663092108257 375.6
1.2982374959935042e-12 630720000000.0
0.014379672301150559 7793280.0

359

2299.8

86686900.0

585.0

E.3. 13MEV PROTON IRRADIATED STEEL

APPENDIX E. ACTIVITY V2 FULL RESULTS

819
820
821
822
823
824
825

200.25s (0.056hr)

826
827

Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877

97Mo

98Tc

3.3319254710594074e-12 135695000000000.0

####################################################################################################################

249.75s (0.069hr)
249.75s (0.069hr)

54Fe
54Fe

55Co
55Fe

18.560865202663734 63108.0
1.854145921090801e-05 86686900.0

249.75s (0.069hr)
249.75s (0.069hr)

56Fe
56Fe

57Co
53Mn

3.546139481166703
23483500.0
1.4910376050239297e-11 116132000000000.0

249.75s
249.75s
249.75s
249.75s

(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

3.840444575329131
32760.0
0.19466801007425735 6121440.0
0.0010283270475086531 26973200.0
27.191382611265727 23483500.0

249.75s (0.069hr)
249.75s (0.069hr)

58Fe
58Fe

58Co(meta 1)
58Co

299.3019088281487
12.323174590494997

249.75s (0.069hr)

12C

13N

0.0019289088052710573 598.02

249.75s (0.069hr)

13C

13N

10064.859069723912

598.02

249.75s (0.069hr)

63Cu

63Zn

391.19044260937596

2299.8

249.75s (0.069hr)

65Cu

65Zn

0.09546439414110316 21082500.0

249.75s (0.069hr)

55Mn

55Fe

7.514429331832644

249.75s (0.069hr)
249.75s (0.069hr)

60Ni
60Ni

61Cu
57Co

9.933734415962824
12117.6
2.6366374858591404e-05 23483500.0

249.75s
249.75s
249.75s
249.75s

(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)

61Ni
61Ni
61Ni
61Ni

58Co(meta 1)
58Co
62Cu
61Cu

0.0020425114515680858 32760.0
2.2394128727353758e-05 6121440.0
13.528648695941389 585.0
99.9658033958523
12117.6

249.75s (0.069hr)

62Ni

62Cu

472.60198594459

249.75s (0.069hr)
249.75s (0.069hr)
249.75s (0.069hr)

64Ni
64Ni
64Ni

64Cu
64Zn
61Co

44.7653442924128
45721.4
7.429964442377365e-13 7.25825e+25
0.0019201962278281332 5940.0

249.75s (0.069hr)

28Si

29P

8.050395593678346

4.142

249.75s (0.069hr)

29Si

30P

5.356926631484682

149.88

249.75s (0.069hr)

52Cr

53Mn

1.494288242273299e-09 116132000000000.0

249.75s (0.069hr)
249.75s (0.069hr)

53Cr
53Cr

53Mn
54Mn

3.6922181811373905e-08 116132000000000.0
0.0001986131204965335 26973200.0

360

32760.0
6121440.0

86686900.0

585.0

APPENDIX E. ACTIVITY V2 FULL RESULTS

878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936

E.3. 13MEV PROTON IRRADIATED STEEL

249.75s (0.069hr)

54Cr

54Mn

0.04100025828896936 26973200.0

249.75s (0.069hr)

51V

51Cr

1.8101018418226418

249.75s
249.75s
249.75s
249.75s

(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.005537701784079425 5270400.0
0.3707230800913098 72000.0
2.2982616761795117e-08 21459200000.0
0.00011409986862291262 5261760.0

249.75s
249.75s
249.75s
249.75s
249.75s
249.75s

(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.05656756867421637 5270400.0
7.480566634503592
72000.0
5.231248495802371e-05 876960.0
0.5729260152583443 3090.0
0.006766546361289079 369792.0
1.0226326792250566e-14 1104520000000000.0

249.75s
249.75s
249.75s
249.75s
249.75s

(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

2.8021754831302685e-10 82049800000000.0
141.14222460890036 3090.0
1.044556869653262
369792.0
0.0032124352502421326 7793280.0
9.393641087502887e-08 508698000.0

249.75s
249.75s
249.75s
249.75s
249.75s

(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)
(0.069hr)

97Mo
97Mo
97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb
97Tc(meta 1)
98Tc

4.89903113668517e-09 82049800000000.0
0.0060476562997528556 375.6
1.7748131840298384e-12 630720000000.0
0.01793415856007896 7793280.0
4.155547497613418e-12 135695000000000.0

2393630.0

####################################################################################################################
Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

300.0s (0.083hr)
300.0s (0.083hr)

54Fe
54Fe

55Co
55Fe

22.289184886562694 63108.0
2.674825884512542e-05 86686900.0

300.0s (0.083hr)
300.0s (0.083hr)

56Fe
56Fe

57Co
53Mn

4.259623845535102
23483500.0
1.7910361621909062e-11 116132000000000.0

300.0s
300.0s
300.0s
300.0s

(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

4.6106973008040555
0.23384789026830938
0.001235226887171251
32.662297233133316

32760.0
6121440.0
26973200.0
23483500.0

300.0s (0.083hr)
300.0s (0.083hr)

58Fe
58Fe

58Co(meta 1)
58Co

359.33092538932937
14.803591567872898

32760.0
6121440.0

300.0s (0.083hr)

12C

13N

0.0022539823826422723 598.02

300.0s (0.083hr)

13C

13N

11761.06146902423

598.02

300.0s (0.083hr)

63Cu

63Zn

466.40230299114216

2299.8

361

E.3. 13MEV PROTON IRRADIATED STEEL

937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997

APPENDIX E. ACTIVITY V2 FULL RESULTS

300.0s (0.083hr)

65Cu

65Zn

0.11467185018960104 21082500.0

300.0s (0.083hr)

55Mn

55Fe

9.026339726234497

300.0s (0.083hr)
300.0s (0.083hr)

60Ni
60Ni

61Cu
57Co

11.915321731382196 12117.6
3.1671297664530146e-05 23483500.0

300.0s
300.0s
300.0s
300.0s

(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)

61Ni
61Ni
61Ni
61Ni

58Co(meta 1)
58Co
62Cu
61Cu

0.0024521645481107514 32760.0
2.690674917959629e-05 6121440.0
15.799446670291239 585.0
119.90704197644182 12117.6

300.0s (0.083hr)

62Ni

62Cu

551.9287285096955

300.0s (0.083hr)
300.0s (0.083hr)
300.0s (0.083hr)

64Ni
64Ni
64Ni

64Cu
64Zn
61Co

53.751721581959615 45721.4
7.429964442377365e-13 7.25825e+25
0.002299825477480381 5940.0

300.0s (0.083hr)

28Si

29P

8.050395593678346

4.142

300.0s (0.083hr)

29Si

30P

5.8678718354078985

149.88

300.0s (0.083hr)

52Cr

53Mn

1.7949408315595183e-09 116132000000000.0

300.0s (0.083hr)
300.0s (0.083hr)

53Cr
53Cr

53Mn
54Mn

4.4350969142791475e-08 116132000000000.0
0.00023857416487942494 26973200.0

300.0s (0.083hr)

54Cr

54Mn

0.049249527708328356 26973200.0

300.0s (0.083hr)

51V

51Cr

2.1742806874398735

300.0s
300.0s
300.0s
300.0s

(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.006651872054830488 5270400.0
0.44520541994874957 72000.0
2.76068556452053e-08 21459200000.0
0.00013705644562074192 5261760.0

300.0s
300.0s
300.0s
300.0s
300.0s
300.0s

(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.06794880691399967 5270400.0
8.983494037369907
72000.0
6.283657194688268e-05 876960.0
0.6843712517853651 3090.0
0.008158945988498494 369792.0
1.2283876026727408e-14 1104520000000000.0

300.0s
300.0s
300.0s
300.0s
300.0s

(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

3.3659765563126346e-10 82049800000000.0
168.59712836012204 3090.0
1.2623858552993041 369792.0
0.0038587724583517054 7793280.0
1.1283652570691754e-07 508698000.0

300.0s
300.0s
300.0s
300.0s
300.0s

(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)
(0.083hr)

97Mo
97Mo
97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb
97Tc(meta 1)
98Tc

5.884722086108313e-09 82049800000000.0
0.0069624357569702455 375.6
2.310861793346944e-12 630720000000.0
0.021542484664906172 7793280.0
4.9916486457818834e-12 135695000000000.0

362

86686900.0

585.0

2393630.0

APPENDIX E. ACTIVITY V2 FULL RESULTS

E.3. 13MEV PROTON IRRADIATED STEEL

998
999
1000
1001
1002
1003

####################################################################################################################

1004
1005

Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056

86001.0s (23.889hr) 54Fe
86001.0s (23.889hr) 54Fe

55Co
55Fe

8.695485791859939
63108.0
0.009919018911598666 86686900.0

86001.0s (23.889hr) 56Fe
86001.0s (23.889hr) 56Fe

57Co
53Mn

4.248862400311241
23483500.0
1.791036161274762e-11 116132000000000.0

86001.0s
86001.0s
86001.0s
86001.0s

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

0.7520806650206214 32760.0
0.2521111916219682 6121440.0
0.0012325095253074784 26973200.0
32.579779730342956 23483500.0

86001.0s (23.889hr) 58Fe
86001.0s (23.889hr) 58Fe

58Co(meta 1)
58Co

58.61279188337828
16.259965861785876

86001.0s (23.889hr) 12C

13N

1.6329359412455045e-46 598.02

86001.0s (23.889hr) 13C

13N

8.520501370314096e-40 598.02

86001.0s (23.889hr) 63Cu

63Zn

2.8249771788938045e-09 2299.8

86001.0s (23.889hr) 65Cu

65Zn

0.11434919819296589 21082500.0

86001.0s (23.889hr) 55Mn

55Fe

9.020156419962703

86001.0s (23.889hr) 60Ni
86001.0s (23.889hr) 60Ni

61Cu
57Co

0.08852973508987912 12117.6
3.159128380712283e-05 23483500.0

86001.0s
86001.0s
86001.0s
86001.0s

58Co(meta 1)
58Co
62Cu
61Cu

0.0003999884233912975 32760.0
3.756117465823082e-05 6121440.0
1.2546407363270588e-43 585.0
0.8908981982103821 12117.6

86001.0s (23.889hr) 62Ni

62Cu

4.3828893554833387e-42 585.0

86001.0s (23.889hr) 64Ni
86001.0s (23.889hr) 64Ni
86001.0s (23.889hr) 64Ni

64Cu
64Zn
61Co

14.660083227726215 45721.4
7.429964537133324e-13 7.25825e+25
1.0435205328684376e-07 5940.0

86001.0s (23.889hr) 28Si

29P

0.0

86001.0s (23.889hr) 29Si

30P

4.3681782556436495e-172 149.88

86001.0s (23.889hr) 52Cr

53Mn

1.7949408306413768e-09 116132000000000.0

86001.0s (23.889hr) 53Cr
86001.0s (23.889hr) 53Cr

53Mn
54Mn

4.435096912010523e-08 116132000000000.0
0.00023804932823276695 26973200.0

(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)

(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)

61Ni
61Ni
61Ni
61Ni

363

32760.0
6121440.0

86686900.0

4.142

E.3. 13MEV PROTON IRRADIATED STEEL

APPENDIX E. ACTIVITY V2 FULL RESULTS

1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092

86001.0s (23.889hr) 54Cr

54Mn

0.04914118422115742 26973200.0

86001.0s (23.889hr) 51V

51Cr

2.1209849987211724

86001.0s
86001.0s
86001.0s
86001.0s

(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.0065773188250607085 5270400.0
0.19523943137423416 72000.0
2.7974990678177886e-08 21459200000.0
0.00013551782846282147 5261760.0

86001.0s
86001.0s
86001.0s
86001.0s
86001.0s
86001.0s

(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.06718724641303317 5270400.0
3.9381668369886524 72000.0
5.872111574303616e-05 876960.0
3.0636520637167826e-09 3090.0
0.011760947971286923 369792.0
1.2283876026066756e-14 1104520000000000.0

86001.0s
86001.0s
86001.0s
86001.0s
86001.0s

(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

3.393807557284754e-10 82049800000000.0
7.547408499257139e-07 3090.0
2.260695558186092
369792.0
0.0038294712108109985 7793280.0
1.128233499471212e-07 508698000.0

86001.0s
86001.0s
86001.0s
86001.0s
86001.0s

(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)
(23.889hr)

97Mo
97Mo
97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb
97Tc(meta 1)
98Tc

5.900259379540796e-09 82049800000000.0
1.4337326674050271e-71 375.6
6.436329568549951e-12 630720000000.0
0.021378903711994034 7793280.0
4.991648643596682e-12 135695000000000.0

1093
1094

Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115

2393630.0

####################################################################################################################

173000.5s (48.056hr) 54Fe
173000.5s (48.056hr) 54Fe

55Co
55Fe

3.3442564122033365 63108.0
0.013806245058191325 86686900.0

173000.5s (48.056hr) 56Fe
173000.5s (48.056hr) 56Fe

57Co
53Mn

4.2379657110936195 23483500.0
1.7910361603447373e-11 116132000000000.0

173000.5s
173000.5s
173000.5s
173000.5s

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

0.11935218799048451 32760.0
0.2530045030032729 6121440.0
0.0012297571056677618 26973200.0
32.49622519243321
23483500.0

173000.5s (48.056hr) 58Fe
173000.5s (48.056hr) 58Fe

58Co(meta 1)
58Co

9.301615213469551
16.36279843820864

173000.5s (48.056hr) 12C

13N

2.626344531585545e-90 598.02

173000.5s (48.056hr) 13C

13N

1.3704011048481893e-83 598.02

173000.5s (48.056hr) 63Cu

63Zn

1.1569200743006014e-20 2299.8

(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)

364

32760.0
6121440.0

APPENDIX E. ACTIVITY V2 FULL RESULTS

1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176

E.3. 13MEV PROTON IRRADIATED STEEL

173000.5s (48.056hr) 65Cu

65Zn

0.11402258609895961 21082500.0

173000.5s (48.056hr) 55Mn

55Fe

9.013883759715732

173000.5s (48.056hr) 60Ni
173000.5s (48.056hr) 60Ni

61Cu
57Co

0.0006106814505442664 12117.6
3.1510264379050344e-05 23483500.0

173000.5s
173000.5s
173000.5s
173000.5s

58Co(meta 1)
58Co
62Cu
61Cu

6.347656005929455e-05
3.898246631850751e-05
2.139011981303592e-88
0.0061454493613704135

173000.5s (48.056hr) 62Ni

62Cu

7.472300693465575e-87 585.0

173000.5s (48.056hr) 64Ni
173000.5s (48.056hr) 64Ni
173000.5s (48.056hr) 64Ni

64Cu
64Zn
61Co

3.920407042818884
45721.4
7.429964563165702e-13 7.25825e+25
4.069126104613427e-12 5940.0

173000.5s (48.056hr) 28Si

29P

0.0

4.142

173000.5s (48.056hr) 29Si

30P

0.0

149.88

173000.5s (48.056hr) 52Cr

53Mn

1.7949408297093244e-09 116132000000000.0

173000.5s (48.056hr) 53Cr
173000.5s (48.056hr) 53Cr

53Mn
54Mn

4.435096909707526e-08 116132000000000.0
0.0002375177204579015 26973200.0

173000.5s (48.056hr) 54Cr

54Mn

0.04903144295117779 26973200.0

173000.5s (48.056hr) 51V

51Cr

2.0682178505494626

173000.5s
173000.5s
173000.5s
173000.5s

(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.006502490620724443 5270400.0
0.08463765809831882 72000.0
2.8344474693315093e-08 21459200000.0
0.00013397356522212487 5261760.0

173000.5s
173000.5s
173000.5s
173000.5s
173000.5s
173000.5s

(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.06642287704960351 5270400.0
1.7057909975131167 72000.0
5.4818908450236494e-05 876960.0
1.0249114194195995e-17 3090.0
0.009991258471636892 369792.0
1.2283876025396093e-14 1104520000000000.0

173000.5s
173000.5s
173000.5s
173000.5s
173000.5s

(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

3.4218440888468736e-10 82049800000000.0
2.5249032843921147e-15 3090.0
1.9205249199593584 369792.0
0.003799953574939192 7793280.0
1.1280997612825722e-07 508698000.0

173000.5s
173000.5s
173000.5s
173000.5s
173000.5s

(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)

97Mo
97Mo
97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb
97Tc(meta 1)
98Tc

5.915911415107868e-09 82049800000000.0
2.688275357702702e-141 375.6
6.436328953169255e-12 630720000000.0
0.021214114721459905 7793280.0
4.991648641378372e-12 135695000000000.0

(48.056hr)
(48.056hr)
(48.056hr)
(48.056hr)

61Ni
61Ni
61Ni
61Ni

365

86686900.0

32760.0
6121440.0
585.0
12117.6

2393630.0

E.3. 13MEV PROTON IRRADIATED STEEL

APPENDIX E. ACTIVITY V2 FULL RESULTS

1177
1178
1179
1180
1181

####################################################################################################################

1182
1183

Time
Target
Residual
Activity
Half-life/s
####################################################################################################################

1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235

260000.0s (72.222hr) 54Fe
260000.0s (72.222hr) 54Fe

55Co
55Fe

1.286190469201019
63108.0
0.015294311892069673 86686900.0

260000.0s (72.222hr) 56Fe
260000.0s (72.222hr) 56Fe

57Co
53Mn

4.227096967670594
23483500.0
1.791036159414712e-11 116132000000000.0

260000.0s
260000.0s
260000.0s
260000.0s

57Fe
57Fe
57Fe
57Fe

58Co(meta 1)
58Co
54Mn
57Co

0.018940713996051697 32760.0
0.25105831080080615 6121440.0
0.0012270108326855093 26973200.0
32.41288493960651
23483500.0

260000.0s (72.222hr) 58Fe
260000.0s (72.222hr) 58Fe

58Co(meta 1)
58Co

1.4761290632870192
16.244011041791023

260000.0s (72.222hr) 12C

13N

4.2241005445249467e-134 598.02

260000.0s (72.222hr) 13C

13N

2.20409469648376e-127 598.02

260000.0s (72.222hr) 63Cu

63Zn

4.7379641447008975e-32 2299.8

260000.0s (72.222hr) 65Cu

65Zn

0.11369690689702112 21082500.0

260000.0s (72.222hr) 55Mn

55Fe

9.00761546150693

260000.0s (72.222hr) 60Ni
260000.0s (72.222hr) 60Ni

61Cu
57Co

4.212503670774942e-06 12117.6
3.1429452734484396e-05 23483500.0

260000.0s
260000.0s
260000.0s
260000.0s

58Co(meta 1)
58Co
62Cu
61Cu

1.0073475734120185e-05 32760.0
3.888431409471208e-05 6121440.0
3.646758887771052e-133 585.0
4.239154140061418e-05 12117.6

260000.0s (72.222hr) 62Ni

62Cu

1.2739376499137902e-131 585.0

260000.0s (72.222hr) 64Ni
260000.0s (72.222hr) 64Ni
260000.0s (72.222hr) 64Ni

64Cu
64Zn
61Co

1.0483972800588075 45721.4
7.429964570127294e-13 7.25825e+25
1.5867236660626395e-16 5940.0

260000.0s (72.222hr) 28Si

29P

0.0

4.142

260000.0s (72.222hr) 29Si

30P

0.0

149.88

260000.0s (72.222hr) 52Cr

53Mn

1.7949408287772715e-09 116132000000000.0

260000.0s (72.222hr) 53Cr
260000.0s (72.222hr) 53Cr

53Mn
54Mn

4.435096907404529e-08 116132000000000.0
0.00023698729986061976 26973200.0

260000.0s (72.222hr) 54Cr

54Mn

0.048921946753565204 26973200.0

(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)

(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)

61Ni
61Ni
61Ni
61Ni

366

32760.0
6121440.0

86686900.0

APPENDIX E. ACTIVITY V2 FULL RESULTS

1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296

E.3. 13MEV PROTON IRRADIATED STEEL

260000.0s (72.222hr) 51V

51Cr

2.016763475418512

260000.0s
260000.0s
260000.0s
260000.0s

(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)

94Mo
94Mo
94Mo
94Mo

95Tc(meta 1)
95Tc
91Nb
91Nb(meta 1)

0.006428513714662307 5270400.0
0.036770852278538234 72000.0
2.8709746401498208e-08 21459200000.0
0.00013244689928935163 5261760.0

260000.0s
260000.0s
260000.0s
260000.0s
260000.0s
260000.0s

(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)

95Mo
95Mo
95Mo
95Mo
95Mo
95Mo

95Tc(meta 1)
95Tc
92Nb(meta 1)
96Tc(meta 1)
96Tc
92Nb

0.06566720368958137 5270400.0
0.7396681801118211 72000.0
5.117601540178146e-05 876960.0
3.4287294895436346e-26 3090.0
0.00848785709077453 369792.0
1.2283876024725429e-14 1104520000000000.0

260000.0s
260000.0s
260000.0s
260000.0s
260000.0s

(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)

96Mo
96Mo
96Mo
96Mo
96Mo

97Tc
96Tc(meta 1)
96Tc
97Tc(meta 1)
93Nb(meta 1)

3.4496645142583677e-10 82049800000000.0
8.446788849658192e-24 3090.0
1.6315403215882949 369792.0
0.0037706634615579594 7793280.0
1.1279660389469478e-07 508698000.0

260000.0s
260000.0s
260000.0s
260000.0s
260000.0s

(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)
(72.222hr)

97Mo
97Mo
97Mo
97Mo
97Mo

97Tc
94Nb(meta 1)
94Nb
97Tc(meta 1)
98Tc

5.931442804446482e-09 82049800000000.0
5.040566183032934e-211 375.6
6.436328337788618e-12 630720000000.0
0.021050595927553588 7793280.0
4.99164863916006e-12 135695000000000.0

2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681

Gamma Dose - Beam End
===================================================
Activity (Bq)
1.3624e+04
Gamma Energy (eV)
1.5362e+08
Gamma Energy (mW)
2.4613e-08
Absorbed Dose (mGy/s)
2.4475e-17
Absorbed Dose (mGy/hr) 8.8112e-14

Gamma Dose - Sim End
===================================================
Activity (Bq)
7.0682e+01
Gamma Energy (eV)
2.4486e+07
Gamma Energy (mW)
3.9231e-09
Absorbed Dose (mGy/s)
3.9013e-18
Absorbed Dose (mGy/hr) 1.4045e-14

Absorbed Dose Calculations
===================================================
Absorbed dose assumptions:
1. radiation from point, emitted isotropically
2. 80Kg human
3. 1m from point source
4. 1m squared surface area
5. all energy absorbed

367

2393630.0

E.3. 13MEV PROTON IRRADIATED STEEL

1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313

2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681
2108.681

APPENDIX E. ACTIVITY V2 FULL RESULTS

Dose Limits
===================================================
employees 18+
20 millisieverts/year
trainees 18+
6 millisieverts/year
public and under 18s
1 millisievert/year
public and under 18s
1.140771128E-04 millisieverts/hour
public and under 18s
3.2E-08 millisieverts/second
Dose averaged over area of skin not exceeding 1cm2
Source: http://www.hse.gov.uk/radiation/ionising/doses/
1mW gammas completely absorbed by 80kg human will give public limit for entire year over 80 seconds.
Dose under 1W gammas absorbed for 1s no imediate changes (under 100 Rads)
Dose 1W-2W gammas absorbed for 1s acute radiation syndrome (100-200 Rads)
Dose 10W+ gammas absorbed for 1s mostly fatal (1000+ Rads)

368

Appendix F

Iron Activity: Irradiated to 100DPA
F.1

Activity vs Beam Energy

The beam energy was set to 5MeV, 10MeV, 15MeV, 20MeV, 25MeV and 30MeV within SRIM, and the Activity
V2 code was used to calculate how radioactive each sample would be if irradiated to 100 DPA of damage.
The beam settings are:
• target material = pure iron
• target thickness = 0.5mm
• beam current = 60 micro amps (maximum proton current for the Scanditronix MC-40)
• beam area = 64𝑚𝑚2

Gamma Power Output 100DPA Fe Cooling for 1 Week
1.2

Gamma Power (mW)

1.0

5MeV Protons
10MeV Protons
15MeV Protons
20MeV Protons
25MeV Protons
30MeV Protons

0.8

0.6

0.4

0.2

0.0
0

100000

200000

300000

Time (s)

400000

500000

600000

Figure F.1: Cooling measured by gamma power for iron samples irradiated to 100DPA at a range of proton energies

369

F.1. ACTIVITY VS BEAM ENERGY

F.1.1

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

5MeV Proton Beam - 60 microamp 100DPA

With a proton energy of 5MeV the target must be irradiated for 205 days to reach 100DPA.

1.6
1.4
1.2

Activity - all residual isotopes

1e6
54Fe -> 55Co
54Fe -> 55Fe
56Fe -> 53Mn
56Fe -> 57Co
57Fe -> 58Co(meta 1)
57Fe -> 58Co
57Fe -> 54Mn
57Fe -> 57Co
58Fe -> 58Co(meta 1)
58Fe -> 58Co

Activity (Bq)

1.0
0.8
0.6
0.4
0.2
0.0
0.00

0.25

0.50

0.75

1.00
Time (s)

1.25

1.50

1.75

1e7

Figure F.2: Residual isotope activity over time with 5MeV protons

Residual gamma power at time t=17712000.0
Total gamma power: 9.435311052144465e-05 mW

36.2%

1.4%
0.0%

55Co 1.4%
57Co 36.2%
58Co 62.4%
54Mn 0.0%

62.4%

Figure F.3: Residual isotope gamma output at the end of irradiation with 5MeV protons

370

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

F.1. ACTIVITY VS BEAM ENERGY

Residual gamma power at time t=18316800.0
Total gamma power: 8.852972608256112e-05 mW

37.9%

0.0%

57Co 37.9%
58Co 62.1%
54Mn 0.0%

62.1%

Figure F.4: Residual isotope gamma output after 1 week of cooling

371

F.1. ACTIVITY VS BEAM ENERGY

F.1.2

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

10MeV Proton Beam - 60 microamp 100DPA

The vacancies per ion are at a maximum out of the six settings here with a proton energy of 10MeV. As a
result, the target must be irradiated for just 134 days to reach 100DPA.

Activity - all residual isotopes

1e8
7
6

Activity (Bq)

5

54Fe -> 54Co(meta 1)
54Fe -> 54Co
54Fe -> 55Co
54Fe -> 55Fe
54Fe -> 51Mn
54Fe -> 51Cr
56Fe -> 53Mn
56Fe -> 56Co
56Fe -> 57Co
57Fe -> 58Co(meta 1)
57Fe -> 58Co
57Fe -> 54Mn
57Fe -> 57Co
58Fe -> 58Co(meta 1)
58Fe -> 58Co

4
3
2
1
0
0.0

0.2

0.4

0.6
Time (s)

0.8

1.0

1.2
1e7

Figure F.5: Residual isotope activity over time with 10MeV protons

Residual gamma power at time t=11577600.0
Total gamma power: 0.3872607000597164 mW

99.7%

0.2%
0.1%

56Co 99.7%
57Co 0.1%
58Co 0.2%

Figure F.6: Residual isotope gamma output at the end of irradiation with 10MeV protons

372

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

F.1. ACTIVITY VS BEAM ENERGY

Residual gamma power at time t=12182400.0
Total gamma power: 0.3636776414065111 mW

99.7%

0.2%
0.1%

56Co 99.7%
57Co 0.1%
58Co 0.2%

Figure F.7: Residual isotope gamma output after 1 week of cooling

373

F.1. ACTIVITY VS BEAM ENERGY

15MeV Proton Beam - 60 microamp 100DPA

2.5

2.0

Activity (Bq)

F.1.3

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

Activity - all residual isotopes

1e9
54Fe -> 54Co(meta 1)
54Fe -> 53Fe
54Fe -> 53Mn
54Fe -> 53Fe(meta 1)
54Fe -> 54Co
54Fe -> 55Co
54Fe -> 55Fe
54Fe -> 51Mn
54Fe -> 51Cr
56Fe -> 53Mn
56Fe -> 56Co
56Fe -> 57Co
56Fe -> 55Fe

57Fe -> 58Co(meta 1)
57Fe -> 58Co
57Fe -> 54Mn
57Fe -> 57Co
57Fe -> 53Mn
57Fe -> 56Mn
57Fe -> 56Co
57Fe -> 55Fe
58Fe -> 58Co(meta 1)
58Fe -> 58Co
58Fe -> 54Mn
58Fe -> 57Co

1.5

1.0

0.5

0.0
0.0

0.2

0.4

0.6

Time (s)

0.8

1.0

1.2

1.4
1e7

Figure F.8: Residual isotope activity over time with 15MeV protons

Residual gamma power at time t=13392000.0
Total gamma power: 1.3232690955956106 mW

0.0%
0.1%

99.7%

54Co(meta 1) 0.1%
56Co 99.7%
57Co 0.1%
58Co 0.1%
54Mn 0.0%

Figure F.9: Residual isotope gamma output at the end of irradiation with 15MeV protons

374

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

F.1. ACTIVITY VS BEAM ENERGY

Residual gamma power at time t=13996800.0
Total gamma power: 1.2411065809416568 mW

99.8%

0.0%
0.1%

56Co 99.8%
57Co 0.1%
58Co 0.1%
54Mn 0.0%

Figure F.10: Residual isotope gamma output after 1 week of cooling

375

F.1. ACTIVITY VS BEAM ENERGY

20MeV Proton Beam - 60 microamp 100DPA

Activity - all residual isotopes

1e9
2.0

1.5
Activity (Bq)

F.1.4

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

1.0

54Fe -> 52Fe
54Fe -> 52Mn(meta 1)
54Fe -> 52Mn
54Fe -> 54Co(meta 1)
54Fe -> 53Fe
54Fe -> 53Mn
54Fe -> 53Fe(meta 1)
54Fe -> 54Co
54Fe -> 55Co
54Fe -> 55Fe
54Fe -> 51Mn
54Fe -> 51Cr

56Fe -> 52Mn(meta 1)
56Fe -> 52Mn
56Fe -> 53Mn
56Fe -> 56Co
56Fe -> 57Co
56Fe -> 54Mn
56Fe -> 55Co
56Fe -> 55Fe
57Fe -> 58Co(meta 1)
57Fe -> 58Co
57Fe -> 54Mn

57Fe -> 57Co
57Fe -> 53Mn
57Fe -> 56Mn
57Fe -> 56Co
57Fe -> 55Fe
58Fe -> 58Co(meta 1)
58Fe -> 58Co
58Fe -> 56Mn
58Fe -> 54Mn
58Fe -> 57Co
58Fe -> 57Mn

0.5

0.0
0.0

0.5

1.0

1.5
Time (s)

2.0

2.5

3.0
1e7

Figure F.11: Residual isotope activity over time with 20MeV protons

Residual gamma power at time t=28771200.0
Total gamma power: 1.2934181154506263 mW

52Mn 0.0%

4.3%
0.1%
0.3%
0.0%
0.1%

95.0%

54Co(meta 1) 0.3%
53Fe 0.1%
55Co 4.3%
56Co 95.0%
57Co 0.1%
54Mn 0.1%
58Co 0.1%

Figure F.12: Residual isotope gamma output at the end of irradiation with 20MeV protons

376

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

F.1. ACTIVITY VS BEAM ENERGY

Residual gamma power at time t=29376000.0
Total gamma power: 1.1564199406474385 mW

99.8%

0.1%

56Co 99.8%
57Co 0.1%
54Mn 0.1%
58Co 0.1%

Figure F.13: Residual isotope gamma output after 1 week of cooling

377

F.1. ACTIVITY VS BEAM ENERGY

25MeV Proton Beam - 60 microamp 100DPA

Activity - all residual isotopes

1e9
2.0

1.5
Activity (Bq)

F.1.5

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

54Fe -> 52Fe
54Fe -> 52Mn(meta 1)
54Fe -> 52Mn
54Fe -> 54Co(meta 1)
54Fe -> 52Fe(meta 1)
54Fe -> 53Fe
54Fe -> 53Mn
54Fe -> 53Fe(meta 1)
54Fe -> 50Mn(meta 1)
54Fe -> 50Cr
54Fe -> 54Co
54Fe -> 50Mn

54Fe -> 55Co
54Fe -> 55Fe
54Fe -> 47V
54Fe -> 53Co
54Fe -> 51Mn
54Fe -> 51Cr
56Fe -> 52Mn(meta 1)
56Fe -> 52Mn
56Fe -> 53Mn
56Fe -> 56Co
56Fe -> 57Co

56Fe -> 54Mn
56Fe -> 55Co
56Fe -> 55Fe
56Fe -> 49V
57Fe -> 58Co(meta 1)
57Fe -> 58Co
57Fe -> 54Mn
57Fe -> 57Co
57Fe -> 53Mn
57Fe -> 56Mn
57Fe -> 56Co

57Fe -> 55Co
57Fe -> 55Fe
58Fe -> 58Co(meta 1)
58Fe -> 58Co
58Fe -> 53Mn
58Fe -> 56Mn
58Fe -> 54Mn
58Fe -> 56Co
58Fe -> 57Co
58Fe -> 57Mn
58Fe -> 55Fe

1.0

0.5

0.0
0.0

0.5

1.0

1.5
2.0
Time (s)

2.5

3.0

3.5
1e7

Figure F.14: Residual isotope activity over time with 25MeV protons

Residual gamma power at time t=33782400.0
Total gamma power: 0.6047827408353267 mW

28.6%
0.0%

0.4%
1.0%
0.3%
6.1%
2.3%
0.0%
0.1%

52Mn(meta 1) 2.3%
52Mn 6.1%
54Co(meta 1) 0.3%
53Fe 1.0%
53Fe(meta 1) 0.4%
55Co 28.6%
51Cr 0.0%
56Co 60.9%
57Co 0.1%
54Mn 0.1%
58Co 0.0%
56Mn 0.1%

60.9%

Figure F.15: Residual isotope gamma output at the end of irradiation with 25MeV protons

378

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

F.1. ACTIVITY VS BEAM ENERGY

Residual gamma power at time t=34387200.0
Total gamma power: 0.363158186267968 mW

0.0%
0.1%
4.3%
0.2%
0.1%

95.2%

52Mn 4.3%
55Co 0.1%
51Cr 0.0%
56Co 95.2%
57Co 0.1%
54Mn 0.2%
58Co 0.1%

Figure F.16: Residual isotope gamma output after 1 week of cooling

379

F.1. ACTIVITY VS BEAM ENERGY

30MeV Proton Beam - 60 microamp 100DPA

Activity - all residual isotopes

1e9

2.5

2.0
Activity (Bq)

F.1.6

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

54Fe -> 52Fe
54Fe -> 52Mn(meta 1)
54Fe -> 52Mn
54Fe -> 54Co(meta 1)
54Fe -> 52Fe(meta 1)
54Fe -> 53Fe
54Fe -> 53Mn
54Fe -> 53Fe(meta 1)
54Fe -> 50Mn(meta 1)
54Fe -> 50Cr
54Fe -> 54Co

1.5

1.0

54Fe -> 50Mn
54Fe -> 55Co
54Fe -> 55Fe
54Fe -> 47V
54Fe -> 49Cr
54Fe -> 49V
54Fe -> 53Co
54Fe -> 51Mn
54Fe -> 51Cr
56Fe -> 53Fe
56Fe -> 53Mn

56Fe -> 52Mn(meta 1)
56Fe -> 52Mn
56Fe -> 56Co
56Fe -> 57Co
56Fe -> 54Mn
56Fe -> 51Mn
56Fe -> 51Cr
56Fe -> 55Co
56Fe -> 55Fe
56Fe -> 49V

57Fe -> 58Co(meta 1)
57Fe -> 58Co
57Fe -> 52Mn(meta 1)
57Fe -> 52Mn
57Fe -> 54Mn
57Fe -> 57Co
57Fe -> 53Mn
57Fe -> 56Mn
57Fe -> 56Co
57Fe -> 55Co

57Fe -> 55Fe
58Fe -> 58Co(meta 1)
58Fe -> 58Co
58Fe -> 53Mn
58Fe -> 56Mn
58Fe -> 54Mn
58Fe -> 56Co
58Fe -> 57Co
58Fe -> 57Mn
58Fe -> 55Fe

0.5

0.0
0

1

2

3
Time (s)

4

5

1e7

Figure F.17: Residual isotope activity over time with 30MeV protons

Residual gamma power at time t=53312850.0
Total gamma power: 0.5744878670833383 mW

0.2%
1.3%
1.3%
23.4%

19.4%

52Mn(meta 1) 8.6%

8.6%
0.3%
0.0%
3.3%
0.1%

0.0%

52Mn 19.4%
54Co(meta 1) 0.2%
53Fe 1.3%
53Fe(meta 1) 1.3%
55Co 23.4%
51Cr 0.0%
56Co 42.3%
57Co 0.1%
54Mn 3.3%
58Co 0.0%
56Mn 0.3%

42.3%

Figure F.18: Residual isotope gamma output at the end of irradiation with 30MeV protons

380

APPENDIX F. IRON ACTIVITY: IRRADIATED TO 100DPA

F.1. ACTIVITY VS BEAM ENERGY

Residual gamma power at time t=53917650.0
Total gamma power: 0.2943024889030366 mW

0.1%
15.9%
0.1%
6.3%
0.1%

77.6%

52Mn 15.9%
55Co 0.1%
56Co 77.6%
57Co 0.1%
54Mn 6.3%
58Co 0.1%

Figure F.19: Residual isotope gamma output after 1 week of cooling

381

Appendix G

SRIM Results
G.0.1

Ion paths through an iron sample

Figure G.1: SRIM trajectories for 12MeV, 14MeV and 16MeV protons in iron

Figure G.2: SRIM trajectories for 18MeV, 20MeV and 22MeV protons in iron

Figure G.3: SRIM trajectories for 24MeV, 26MeV and 28MeV protons in iron

382

APPENDIX G. SRIM RESULTS

Figure G.4: SRIM trajectories for 30MeV, 32MeV and 34MeV protons in iron

Figure G.5: SRIM trajectories for 36MeV protons in iron

383

Appendix H

Crystal Structures
H.1

Common Cubic Structures

H.1.1

Simple Cubic

Sample Configuration
[︀
]︀
0.0 0.0 0.0

Table H.1: Simple cubic configuration

384

APPENDIX H. CRYSTAL STRUCTURES

H.1.2

Body Centered Cubic

Sample Configuration
[︀
]︀
0.0 0.0 0.0
[︀
]︀
0.5 0.5 0.5

H.1.3

H.1. COMMON CUBIC STRUCTURES

Table H.2: Body centered cubic configuration

Face Centered Cubic

385

H.1. COMMON CUBIC STRUCTURES

Sample Configuration
[︀
]︀
0.0 0.0 0.0
[︀
]︀
0.0 0.5 0.5
[︀
]︀
0.5 0.0 0.5
[︀
]︀
0.5 0.5 0.0

H.1.4

APPENDIX H. CRYSTAL STRUCTURES

Table H.3: Face centered cubic configuration

Zincblende

Sample Configuration
[︀
]︀
0.0 0.0 0.0
[︀
]︀
0.0 0.5 0.5
[︀
]︀
0.5 0.0 0.5
[︀
]︀
0.5 0.5 0.0
[︀
]︀
0.25 0.25 0.25
[︀
]︀
0.75 0.75 0.25
[︀
]︀
0.25 0.75 0.75
[︀
]︀
0.75 0.25 0.75

Table H.4: Zincblende configuration

386

APPENDIX H. CRYSTAL STRUCTURES

H.2

FCC Defects

H.2.1

Dumbbell < 100 >

H.2.2

Dumbbell < 110 >

H.2.3

Dumbbell < 111 >

H.2. FCC DEFECTS

387

H.2. FCC DEFECTS

H.2.4

Crowdion

H.2.5

Octahedral Interstitial

H.2.6

Tetrahedral Interstitial

APPENDIX H. CRYSTAL STRUCTURES

388

Appendix I

Elastic Constants
I.1

Elastic Constant Matrices

Crystal:

Cubic

Sides:

a=b=c

Angles:

𝛼=𝛽=𝛾=

Symmetry:

𝜋
2 radians

No. Independent Elastic Constants:

3
⎡
⎢𝐶11
⎢
⎢𝐶12
⎢
⎢
⎢
⎢𝐶12
⎢
⎢
⎢ 0
⎢
⎢
⎢ 0
⎢
⎣
0

Elastic Constants:

𝜋
2 radians

rotation, 3 mutually orthogonal planes of symmetry

𝐶12

𝐶12

0

0

𝐶11

𝐶12

0

0

𝐶12

𝐶11

0

0

0

0

𝐶44

0

0

0

0

𝐶44

0

0

0

0

⎤

0 ⎥
⎥
0 ⎥
⎥
⎥
⎥
0 ⎥
⎥
⎥
0 ⎥
⎥
⎥
0 ⎥
⎥
⎦
𝐶44

Table I.1: Independent elastic constants for a cubic crystal[199]

389

I.1. ELASTIC CONSTANT MATRICES

APPENDIX I. ELASTIC CONSTANTS

Crystal:

Orthorhombic/Orthotropic

Sides:

𝑎 ̸= 𝑏 ̸= 𝑐

Angles:

𝛼=𝛽=𝛾=

Symmetry:

3 mutually orthogonal planes of symmetry

No. Independent Elastic Constants:

9
⎡
⎢𝐶11
⎢
⎢𝐶12
⎢
⎢
⎢
⎢𝐶13
⎢
⎢
⎢ 0
⎢
⎢
⎢ 0
⎢
⎣
0

Elastic Constants:

𝜋
2 radians

𝐶12

𝐶13

0

0

𝐶22

𝐶23

0

0

𝐶23

𝐶33

0

0

0

0

𝐶44

0

0

0

0

𝐶55

0

0

0

0

⎤
0 ⎥
⎥
0 ⎥
⎥
⎥
⎥
0 ⎥
⎥
⎥
0 ⎥
⎥
⎥
0 ⎥
⎥
⎦
𝐶66

Table I.2: Independent elastic constants for an orthorhombic/orthotropic crystal[199]

Crystal:

Monoclinic

Sides:

𝑎 ̸= 𝑏 ̸= 𝑐

Angles:

𝛼<

Symmetry:

symmetry in the xy plane

No. Independent Elastic Constants:

13
⎡
⎢𝐶11
⎢
⎢𝐶12
⎢
⎢
⎢
⎢𝐶13
⎢
⎢
⎢ 0
⎢
⎢
⎢ 0
⎢
⎣
𝐶16

Elastic Constants:

𝜋
2 radians, 𝛽

=𝛾=

𝜋
2 radians

𝐶12

𝐶13

0

0

𝐶22

𝐶23

0

0

𝐶23

𝐶33

0

0

0

0

𝐶44

𝐶45

0

0

𝐶45

𝐶55

𝐶26

𝐶36

0

0

⎤
𝐶16 ⎥
⎥
𝐶26 ⎥
⎥
⎥
⎥
𝐶36 ⎥
⎥
⎥
0 ⎥
⎥
⎥
0 ⎥
⎥
⎦
𝐶66

Table I.3: Independent elastic constants for a monoclinic crystal[199]

390

APPENDIX I. ELASTIC CONSTANTS

I.2. SETS OF STRAINS APPLIED TO CALCULATE ELASTIC CONSTANTS

Crystal:

Triclinic

Sides:

𝑎 ̸= 𝑏 ̸= 𝑐

Angles:

𝛼<

Symmetry:

no symmetry

No. Independent Elastic Constants:

21
⎡
⎢𝐶11
⎢
⎢𝐶12
⎢
⎢
⎢
⎢𝐶13
⎢
⎢
⎢ 0
⎢
⎢
⎢ 0
⎢
⎣
𝐶16

Elastic Constants:

𝜋
2 radians, 𝛽

<

𝜋
2 radians, 𝛾

𝐶12

𝐶13

0

0

𝐶22

𝐶23

0

0

𝐶23

𝐶33

0

0

0

0

𝐶44

𝐶45

0

0

𝐶45

𝐶55

𝐶26

𝐶36

0

0

<

𝜋
2 radians

⎤

𝐶16 ⎥
⎥
𝐶26 ⎥
⎥
⎥
⎥
𝐶36 ⎥
⎥
⎥
0 ⎥
⎥
⎥
0 ⎥
⎥
⎦
𝐶66

Table I.4: Independent elastic constants for a triclinic crystal[199]

I.2

Sets of Strains Applied to Calculate Elastic Constants

Strains are applied to a relaxed cell to determine the elastic constants. Various methods have been used, and
these differ from paper to paper based on the crystal structure and the author. Several of these strains have
been used throughout this work in various computer codes, including the QE EOS and EAMPA codes.

I.2.1

Cubic Crystals - Mehl, Singh, Klein and Papaconstantopoulos 1993

𝑒1

𝑒2

𝑒3

𝑒4

𝑒5

𝑒6

𝐸(𝜎)

𝜎

𝜎

𝜎

0

0

0

BM EoS Fit 𝐵0

2

𝜎

−𝜎

𝜎
1−𝜎 2

0

0

0

∆𝐸(𝜎) = ∆𝐸(−𝜎) = 𝑉0 ((𝐶11 − 𝐶12 ) 𝜎2 + 𝑂[𝜎 4 ]

0

0

𝜎2
4−𝜎 2

0

0

𝜎

∆𝐸(𝜎) = ∆𝐸(−𝜎) = 𝑉0 𝐶44 𝜎2 + 𝑂[𝜎 4 ]

Table I.5: Calculation of elastic constants using the equation of state, a volume conserving orthorhombic strain and
volume conserving monoclinic strain.[110][104]

These values are inserted into the strain matrix in eq. I.1.

⎡

⎢ 𝑒1
⎢
⎢
⃗𝜖 = ⎢
⎢ 𝑒26
⎢
⎣
𝑒5
2

𝑒6
2

⎤

𝑒2

𝑒5
2 ⎥

𝑒4
2

𝑒3

⎥
⎥

𝑒4 ⎥
2 ⎥
⎥

(I.1)

⎦

The values for 𝐶11 and 𝐶12 are computed using the polynomial fit to the change in energy due to the second
strain and the bulk modulus.

391

I.2. SETS OF STRAINS APPLIED TO CALCULATE ELASTIC CONSTANTS

⎡

⎢1
⎢
⎣
1
3

I.2.2

⎤⎡

𝑒3

𝑒4

𝑒5

𝑒6

𝜎

0

0

0

0

0

0

𝜎

0

0

0

0

0

0

𝜎

0

0

0

0

0

1

(1−𝜎 2 ) 3
1

(1−𝜎 2 ) 3
1

1

(1−𝜎 2 ) 3
1+𝜎

1

(1−𝜎 2 ) 3
1+𝜎

1

(1−𝜎 2 ) 3
1

(I.2)

Orthorhombic Crystals - Ravindran, Fast, Korzhavyi and Johansson

𝑒2

1

⎤

𝐶𝑝
⎢ 𝑉0 ⎥

−1⎥ ⎢𝐶11 ⎥
⎥=⎢ ⎥
⎥⎢
⎦ ⎣ ⎦
⎦⎣
2
𝐶
𝐵0
12
3

𝑒1

1

⎡

⎤

APPENDIX I. ELASTIC CONSTANTS

1

(1−𝜎 2 ) 3

1

1

(1−𝜎 2 ) 3
1

1

(1−𝜎 2 ) 3
1

1

(1−𝜎 2 ) 3
1−𝜎

1

(1−𝜎 2 ) 3
1

1

(1−𝜎 2 ) 3
1+𝜎

1

(1−𝜎 2 ) 3

1

1

1

1

(1−𝜎 2 ) 3

(1−𝜎 2 ) 3

1

1

0

1

0

0

1

0

0

0

1

0

0

0

1

0

0

0

(1−𝜎 2 ) 3
1

(1−𝜎 2 ) 3
1

(1−𝜎 2 ) 3
1−𝜎

(1−𝜎 2 ) 3
1−𝜎

(1−𝜎 2 ) 3

1

𝐸(𝜎)
(︀
)︀
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 𝜏1 𝜎 + 𝐶211 𝜎 2
)︀
(︀
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 𝜏2 𝜎 + 𝐶222 𝜎 2
(︀
)︀
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 𝜏3 𝜎 + 𝐶233 𝜎 2
(︀
)︀
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 2𝜏4 𝜎 + 2𝐶44 𝜎 2
(︀
)︀
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 2𝜏5 𝜎 + 2𝐶55 𝜎 2
(︀
)︀
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 2𝜏6 𝜎 + 2𝐶66 𝜎 2
)︀
(︀
−2𝐶12 2
𝜎
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 (𝜏1 − 𝜏2 )𝜎 + 𝐶11 +𝐶22
2
(︀
)︀
−2𝐶13 2
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 (𝜏1 − 𝜏3 )𝜎 + 𝐶11 +𝐶33
𝜎
2
(︀
)︀
−2𝐶23 2
𝐸(𝑉, 𝜎) = 𝐸(𝑉0 , 0) + 𝑉0 (𝜏2 − 𝜏3 )𝜎 + 𝐶22 +𝐶33
𝜎
2

0

1

(1−𝜎 2 ) 3

1

1

(1−𝜎 2 ) 3

Table I.6: Calculation of orthorhombic elastic constants by Ravindran et al.[dfttisiravindran]

These values are inserted into the strain matrix in eq. I.3.

⎡

⎢𝑒1
⎢
⎢
⃗𝜖 = ⎢
⎢𝑒6
⎢
⎣
𝑒5

𝑒6
𝑒2
𝑒4

⎤

𝑒5 ⎥
⎥
⎥
⎥
𝑒4 ⎥
⎥
⎦
𝑒3

(I.3)

The 9 elastic constants are calculated by polynomial fit to the strain-energy data. Using the second order of
each polynomial, 𝑝1 to 𝑝9 , the elastic constants are calculated by solving eq I.4.

392

APPENDIX I. ELASTIC CONSTANTS

⎡

⎢ 𝑉20
⎢

⎢
⎢
⎢0
⎢
⎢
⎢
⎢0
⎢
⎢
⎢
⎢0
⎢
⎢
⎢
⎢
⎢0
⎢
⎢
⎢
⎢0
⎢
⎢
⎢ 𝑉0
⎢
⎢2
⎢
⎢
⎢ 𝑉0
⎢2
⎢
⎣
0

I.2.3

I.2. SETS OF STRAINS APPLIED TO CALCULATE ELASTIC CONSTANTS

⎤

⎤⎡

0

0

0

0

0

0

0

𝑉0
2

0

0

0

0

0

0

0

𝑉0
2

0

0

0

0

0

0

0

2𝑉0

0

0

0

0

0

0

0

2𝑉0

0

0

0

0

0

0

0

2𝑉0

0

0

𝑉0
2

0

0

0

0

−𝑉0

0

0

𝑉0
2

0

0

0

0

−𝑉0

𝑉0
2

𝑉0
2

0

0

0

0

0

⎡ ⎤

0 ⎥ ⎢𝐶11 ⎥ ⎢𝑝1 ⎥
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
0 ⎥ ⎢𝐶22 ⎥ ⎢𝑝2 ⎥
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
⎢ ⎥
⎢
⎥
0 ⎥ ⎢𝐶33 ⎥
⎥ ⎢𝑝3 ⎥
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎢
0 ⎥
⎥ ⎢𝐶44 ⎥ ⎢𝑝4 ⎥
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
0 ⎥ ⎢𝐶55 ⎥ = ⎢𝑝5 ⎥
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
0 ⎥ ⎢𝐶66 ⎥ ⎢𝑝6 ⎥
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
⎥ ⎢ ⎥
⎥⎢
⎢𝐶12 ⎥ ⎢𝑝7 ⎥
0 ⎥
⎥ ⎢ ⎥
⎥⎢
⎥⎢
⎥ ⎢ ⎥
⎥ ⎢ ⎥
⎥⎢
⎢𝐶 ⎥ ⎢𝑝 ⎥
0 ⎥
⎥ ⎢ 13 ⎥ ⎢ 8 ⎥
⎥ ⎢ ⎥
⎥⎢
⎦ ⎣ ⎦
⎦⎣
𝑝9
𝐶23
−𝑉0

(I.4)

Cubic Crystals - Connetable and Thomas 2009

𝑒1

𝑒2

𝑒3

𝑒4

𝑒5

𝑒6

𝐸(𝜎)

𝜎

𝜎

𝜎

0

0

0

BM EoS Fit 𝐵0

𝜎

0

0

0

0

0

0

0

0

2𝜎

2𝜎

2𝜎

∆𝐸(𝜎) =

𝑉0
2
2 𝐶11 𝜎

+ 𝑂[𝜎 4 ]

∆𝐸(𝜎) = 6𝑉0 𝐶44 𝜎 2 + 𝑂[𝜎 4 ]

Table I.7: Calculation of elastic constants for a cubic crystal[137]

.

⎡

⎢2𝑒1
⎢
⎢
⃗𝜖 = ⎢
⎢ 𝑒6
⎢
⎣
𝑒5

I.2.4

𝑒6
2𝑒2
𝑒4

⎤

𝑒5 ⎥
⎥
⎥
⎥
𝑒4 ⎥
⎥
⎦
2𝑒3

(I.5)

Orthorhombic Crystals - Connetable and Thomas 2009
⎡

⎢2𝑒1
⎢
⎢
⃗𝜖 = ⎢
⎢ 𝑒6
⎢
⎣
𝑒5

𝑒6
2𝑒2
𝑒4

393

⎤

𝑒5 ⎥
⎥
⎥
⎥
𝑒4 ⎥
⎥
⎦
2𝑒3

(I.6)

I.2. SETS OF STRAINS APPLIED TO CALCULATE ELASTIC CONSTANTS

APPENDIX I. ELASTIC CONSTANTS

𝑒1

𝑒2

𝑒3

𝑒4

𝑒5

𝑒6

𝐸(𝜎)

𝜎

0

0

0

0

0

∆𝐸(𝜎) =

𝑉0
2
2 𝐶11 𝜎

0

𝜎

0

0

0

0

∆𝐸(𝜎) =

𝑉0
2
2 𝐶22 𝜎

0

0

𝜎

0

0

0

∆𝐸(𝜎) =

𝑉0
2
2 𝐶33 𝜎

0

0

0

2𝜎

0

0

∆𝐸(𝜎) = 2𝑉0 𝐶44 𝜎 2

0

0

0

0

2𝜎

0

∆𝐸(𝜎) = 2𝑉0 𝐶55 𝜎 2

0

0

0

0

0

2𝜎

∆𝐸(𝜎) = 2𝑉0 𝐶66 𝜎 2

𝑢(1 + 𝜎) − 1

𝑢(1 − 𝜎) − 1

𝑢−1

0

0

0

∆𝐸(𝜎) =

𝑉0
2 (𝐶11

+ 𝐶22 − 2𝐶12 )𝜎 2

𝑢(1 + 𝜎) − 1

𝑢−1

𝑢(1 − 𝜎) − 1

0

0

0

∆𝐸(𝜎) =

𝑉0
2 (𝐶11

+ 𝐶33 − 2𝐶13 )𝜎 2

𝑢−1

𝑢(1 + 𝜎) − 1

𝑢(1 − 𝜎) − 1

0

0

0

∆𝐸(𝜎) =

𝑉0
2 (𝐶22

+ 𝐶33 − 2𝐶23 )𝜎 2
1

Table I.8: Calculation of elastic constants for a cubic crystal[137], 𝑢 = (1 − 𝜎 2 )− 3

.

394

Appendix J

PBE Functional
The GGA PBE functional was the primary type used in this work for the DFT calculated data. The LDA,
LSDA and GGA are described in detail in “Density functionals from LDA to GGA”[150].
The local density approximation is:

𝐿𝐷𝐴
𝐸𝑥𝑐
[𝜌] =

∫︁

𝑑3 𝑟𝜌(⃗𝑟) [𝑒𝑥 (𝜌(⃗𝑟)) + 𝑒𝑐 (𝜌(⃗𝑟))]

(J.1)

Exchange energy per electron of the unpolarized uniform electron gas:

𝑒𝑥 (𝜌)

(J.2)

Correlation energy per electron of the unpolarized uniform electron gas:

𝑒𝑐 (𝜌)

(J.3)

Splitting the density into spin up and spin down:

𝜌↑ (⃗𝑟) =

𝑜𝑐𝑐
𝑜𝑐𝑐
∑︁
∑︁
|𝜑𝑘,↑ (⃗𝑟|2 𝜌↓ (⃗𝑟) =
|𝜑𝑘,↓ (⃗𝑟|2 𝜌(⃗𝑟) = 𝜌↑ (⃗𝑟) + 𝜌↓ (⃗𝑟)
𝑘

(J.4)

𝑘

The relative spin polarization is:

𝜁=

𝜌↑ − 𝜌↓
𝜌↑ + 𝜌↓

(J.5)

The LSDA is:

𝐿𝑆𝐷𝐴
𝐸𝑥𝑐
[𝜌↑ , 𝜌↓ ] =

∫︁

𝑑3 𝑟𝜌(⃗𝑟) [𝑒𝑥 (𝜌(⃗𝑟))𝑓 (𝜁(⃗𝑟)) + 𝑒𝑐 (𝑟𝑠 (⃗𝑟), 𝜁(⃗𝑟))]
395

(J.6)

APPENDIX J. PBE FUNCTIONAL

where

𝑓 (𝜁) =

]︁
4
4
1 [︁
(1 + 𝜁) 3 + (1 − 𝜁) 3
2

(J.7)

The correlation energy per electron of the spin-polarized uniform electron gas is:

𝑒𝑐 (𝑟𝑠 , 𝜁)

(J.8)

𝜌 = 3/4𝜋𝑟𝑠3
√︂
3 4𝜌
𝑟𝑠 =
3𝜋

(J.9)

where 𝑟𝑠 is the local Seitz radius:

The PBE correlation energy functional is:

𝐸𝑐𝑃 𝐵𝐸 [𝜌↑ , 𝜌↓] =

∫︁

𝑑3 𝑟𝜌[𝑒𝑐 (𝑟𝑠 , 𝜁) + 𝐻(𝑟𝑠 , 𝜁, 𝑡)]

(J.10)

where

(︁ 𝜋 )︁ 12 (︂ 9𝜋 )︂ 16 𝑠
𝑡=
1
4
4
𝜑𝑟𝑠2

𝑠=

|∇𝜌|

1

4

2(3𝜋 2 ) 3 𝜌 3

𝑎𝐵 =

𝜑(𝜁) =

=

3
2

(︂

4
9𝜋

)︂ 13

𝑎𝐵 |∇𝑟𝑠 |

(J.11)

(J.12)

~2
(the Bohr radius)
𝑚𝜖2

(J.13)

]︁
2
2
1 [︁
(1 + 𝜁) 3 + (1 − 𝜁) 3
2

(J.14)

[︂
(︂
)︂]︂
𝛽
1 + 𝐴𝑡2
𝐻 = 𝛾𝜑3 𝑙𝑛 1 + 𝑡2
𝛾
1 + 𝐴𝑡2 + 𝐴2 𝑡4

(J.15)

(︂ )︂
𝛽
1
𝐴=
𝛾 𝑒𝑥𝑝(−𝑒𝑐 (𝑟𝑠 , 𝜁)/(𝛾𝜑3 )) − 1

(J.16)

396

APPENDIX J. PBE FUNCTIONAL

where 𝛽 = 0.066725 and 𝛾 = 0.031091 Hartree.
The PBE exchange energy functional is:

𝐸𝑥𝑃 𝐵𝐸 [𝜌]

=

∫︁

𝑑3 𝑟𝜌𝑒𝑥 (𝜌)𝐹𝑥 (𝑠)

(J.17)

where

𝜅
1 + 𝜇𝑠2 /𝜅

(J.18)

1 𝑃 𝐵𝐸
1
𝐸𝑥
[2𝜌↑ ] + 𝐸𝑥𝑃 𝐵𝐸 [2𝜌↓ ]
2
2

(J.19)

𝐹𝑥 (𝑠) = 1 + 𝜅 −
where 𝜅 = 0.804 and 𝜇 = 0.21951.
The spin density functional is:

𝐸𝑥𝑃 𝐵𝐸 [𝜌↑ , 𝜌↓ ] =

397

Appendix K

QECONVERGE
The full code is available at https://github.com/BenPalmer1983/qeconverge
Listing K.1: QECONVERGE Readme File
QECONVERGE
=================================
Python code.
Before running DFT calculations, the ecutwfc and ecutrho values need to be chosen. They are minimised such that
the values are within a given converged limit. They are also minimised because using an arbitrarily large
cutoff would affect computer resources and computational time.
A suitable k-point mesh and smearing must also be determined.
Qeconverge takes an input file and a template pwscf file. The position of the atoms can be varied slightly. It
starts at a specified ecutwfc and uses ecutrho = 4.0 x ecutwfc. The value of ecutwfc (and ecutrho) are
increased until the energy and forces converge. The next stage is to reduce ecutrho while remaining in the
convergence threshold (fixing ecutwfc). Finally ecutrho is fixed and the code attemts to reduce ecutwfc
further.
Further calculations are run and a 2D map ecutwfc on one axis and ecutrho on the other is mapped to visualise the
convergence for the user.
Finally a 2D map with k-points on one axis and smearing on the other is created, to aid the user in choosing a kpoint and smearing values.

Example 1:
examples/example1
The run file packages the python files into one called qeconverge.py - it then runs the python program. System
settings are stored in environment variables in the run.sh bash file:
export
export
export
export
export
export

OMP_NUM_THREADS=1
PROC_COUNT=4
PWSCF_SCRATCH=/opt/scratch
PWSCF_PP=/opt/pp
PWSCF_CACHE=/opt/pwscf_cache
PWSCF_BIN=/opt/qe/bin/pw.x

Example 2:

398

APPENDIX K. QECONVERGE

examples/example2
Same as example 1, but it runs the python file in its own directory.

Example 3:
examples/example3
This is similar to example 2, but the run.sh file is replaced with a batch.sh file - the names don’t matter, but
the batch.sh file contains more settings that are used on the BlueBEAR computer. It is submitted to the job
queue:
sbatch batch.sh
The settings may be modified to work on other supercomputers with different scheduling programs. The python
module and quantum espresso modules may beed to be loaded, although I use my own compiled quantum espresso.
batch.sh:
#!/bin/bash
#
#SBATCH --job-name=pwaleos
#SBATCH --output=jobout.txt
#SBATCH --account=readmsd02
#
#SBATCH --ntasks 20
#SBATCH --nodes 1
#SBATCH --time=360:00
#SBATCH --cpus-per-task=1
#
#SBATCH --get-user-env
#SBATCH --export=NONE
#
unset SLURM_EXPORT_ENV
module
module
module
module
module

purge; module load bluebear
load bear-apps/2018a
load iomkl/2018a
load Python/3.6.3-iomkl-2018a
load matplotlib/2.1.1-iomkl-2018a-Python-3.6.3

# Change to $PBS_O_WORKDIR
cd "$PBS_O_WORKDIR"
# Set the number of threads to 1
export OMP_NUM_THREADS=1
export PROC_COUNT=20
export PWSCF_SCRATCH=/scratch
export PWSCF_PP=/rds/homes/b/bxp912/pp
export PWSCF_CACHE=/rds/homes/b/bxp912/pwscf_cache
export PWSCF_BIN=/rds/homes/b/bxp912/apps/qe-6.3/bin/pw.x
python qeconverge.py input.in > result.txt

399

Appendix L

DFT Convergence Plots

400

−0.00206

−0.00204

−0.00202

−0.00200

−0.00198

−0.00196

−0.00194

−0.00192

−0.00190

−0.000064

−0.000063

−0.000062

−0.000061

−0.000060

−0.000059

Energy (RY)

Energy (RY)

−0.00190
−0.00192
−0.00194
−0.00196
−0.00198
−0.00200
−0.00202
−0.00204
−0.00206

30.0

−3.95e1

100

−3.9502e1

30

−3.95e1

32.5

120

35

35.0

42.5

45.0

180

50

47.5

50.0

200

55

0.00008540

0.00008545

0.00008550

0.00008555

0.00008560

0.00008565

0.00008570

0.00008575

0.00008569

0.00008570

0.00008571

0.00008572

0.00008573

0.00008574

0.00008575

0.00008545

0.00008550

0.00008555

0.00008560

0.00008565

0.00008570

30.0

100

30

32.5

120

35

35.0

160

40.0

42.5

Ecut)fc (RY)

37.5

Decreasing Ecut)fc

140

Ecutr o (BOHR-3)

Decreasing Ecutrho

45

Ecut)fc (RY)

40

Increasing Ecut)fc

Figure L.1: Ecutwfc and Ecutrho convergence for aluminium (energy and force)

40.0

Ecutwfc (RY)

37.5

Decreasing Ecut)fc

160

Ecutr o (BOHR-3)

140

Decreasing Ecutr o

45

Ecutwfc (RY)

40

Increasing Ecut)fc

Force (RY/BOHR)
Force (RY/BOHR)

401

Energy (RY)

Force (RY/BOHR)

Ecut)fc and Ecutr o Con(ergence

45.0

180

50

47.5

50.0

200

55

APPENDIX L. DFT CONVERGENCE PLOTS

402

3.00

3.25

Ecutrho/Ecutwfc

2.75

3.50

3.75

0.010

0.015

0.020

0.025

5

6

7

K-points

8

9

10

11

0.010

0.015

0.020

0.025

0.030

0.035

0.040

0.045

0.050

3

30
2.00

40

50

60

70

80

90

100

2.50

3.00

3.25

Ecutrho/Ecutwfc

2.75

3.50

3.75

4

5

6

7

K-points

8

9

10

Force (Ry/Bohr) Kpoint and Degauss

2.25

Force (Ry/Bohr) Ecutwfc and Ecutrho

11

4.00

1e−7

Figure L.2: 2D density map - force and energy convergence with k-points and smearing - alluminium

0.000000

0.000104

0.000208

0.000312

0.000416

0.030

0.000728

0.000832

0.000936

0.000520

4

4.00

0.0000000

0.0000195

0.0000390

0.0000585

0.0000780

0.0000975

0.0001170

0.0001365

0.0001560

0.0001755

0.000624

3

2.50

Energy (Ry) Kpoint and Degauss

2.25

Energy (Ry) Ecutwfc and Ecutrho

0.035

0.040

0.045

0.050

30
2.00

40

50

60

70

80

90

100

Degauss/Ry

Ecutwfc/Ry

Degauss/Ry

Ecutwfc/Ry

Ecutwfc and Ecutrh , Kp int and Degauss

0.00000000

0.00000052

0.00000104

0.00000156

0.00000208

0.00000260

0.00000312

0.00000364

0.00000416

0.00000468

0.00

0.66

1.32

1.98

2.64

3.30

3.96

4.62

5.28

5.94

APPENDIX L. DFT CONVERGENCE PLOTS

−0.0300
−0.0325
−0.0350
−0.0375
−0.0400
−0.0425
−0.0450
−0.0475

−0.045

−0.040

−0.035

−0.030

−0.000024

−0.000022

−0.000020

−0.000018

−0.000016

−0.000014

−0.000012

−0.000010

−0.000008

Energy (RY)

Energy (RY)

60

−3.292e2

425

60

450

−3.292485e2

−3.292e2

100

Ecutwfc (RY)

120

525

550

120

575

600

140

140

160

625

160

0.000100

0.000125

0.000150

0.000175

0.000200

0.000225

0.000250

0.000106
0.000105
0.000104
0.000103
0.000102
0.000101
0.000100
0.000099
0.000098
0.000097

0.000100

0.000125

0.000150

0.000175

0.000200

0.000225

0.000250

425

450

60

60

100

Ecut)fc (RY)

120

525

550

100

Ecut)fc (RY)

120

Decreasing Ecut)fc

500

Ecutr o (BOHR-3)

Decreasing Ecutrho

80

475

80

Increasing Ecut)fc

Figure L.3: Ecutwfc and Ecutrho convergence for iron (energy and force)

100

Ecutwfc (RY)

Decreasing Ecut)fc

500

Ecutr o (BOHR-3)

Decreasing Ecutr o

80

475

80

Increasing Ecut)fc
Force (RY/BOHR)
Force (RY/BOHR)
Force (RY/BOHR)

403

Energy (RY)

Ecut)fc and Ecutr o Con(ergence

575

600

140

140

160

625

160

APPENDIX L. DFT CONVERGENCE PLOTS

404

0.010
3.00

0.015

0.020

0.025

0.030

0.035

0.040

0.045

0.050

50

60

70

80

90

100

110

120

2.6

3.2

3.4

Ecutrho/Ecutwfc

3.0

3.6

3.8

3.25

3.75

4.00

K-points

4.25

4.50

4.75

5.00

4.0

0.000000

0.000096

0.000192

0.000288

0.000384

0.000480

0.000576

0.000672

0.000768

0.000864

0.010
3.00

0.015

0.020

0.025

0.030

0.035

0.040

0.045

0.050

50

60

70

80

90

100

110

2.8

3.2

3.4

Ecutrho/Ecutwfc

3.0

3.6

3.8

3.25

3.50

3.75

4.00

K-points

4.25

4.50

4.75

Force (Ry/Bohr) Kpoint and Degauss

2.6

5.00

4.0

Figure L.4: 2D density map - force and energy convergence with k-points and smearing - iron

3.50

Energy (Ry) Kpoint and Degauss

2.8

0.000

0.002

0.004

0.006

0.008

0.010

0.012

0.014

0.016

0.018

Degauss/Ry

Ecutwfc/Ry

Degauss/Ry

Ecutwfc/Ry

Ecutwfc and Ecutrho, Kpoint and Degauss
Energy (Ry) Ecutwfc and Ecutrho
Force (Ry/Bohr) Ecutwfc and Ecutrho
120

0.00000

0.00006

0.00012

0.00018

0.00024

0.00030

0.00036

0.00042

0.00048

0.00054

0.000000

0.000052

0.000104

0.000156

0.000208

0.000260

0.000312

0.000364

0.000416

0.000468

APPENDIX L. DFT CONVERGENCE PLOTS

−0.0100

−0.0095

−0.0090

−0.0085

−0.0080

−0.0075

−0.0070

−0.0100

−0.0095

−0.0090

−0.0085

−0.0080

−0.0075

−0.0070

−0.000204

−0.000202

−0.000200

−0.000198

−0.000196

−0.000194

−0.000192

Energy (RY)

Energy (RY)

−5.1202e2

450

−5.1203e2

−5.1202e2

80

80

500

120

Ecutwfc (RY)

140

100

160

160

650

0.000361

0.000362

0.000363

0.000364

0.000365

0.000366

0.000354

0.000356

0.000358

0.000360

0.000362

0.000350

0.000355

0.000360

0.000365

0.000370

450

80

80

500

120

Ecut)fc (RY)

140

100

120

Ecut)fc (RY)

140

600

Decreasing Ecut)fc

550

Ecutr o (BOHR-3)

Decreasing Ecutrho

100

Increasing Ecut)fc

Figure L.5: Ecutwfc and Ecutrho convergence for palladium (energy and force)

120

Ecutwfc (RY)

140

600

Decreasing Ecut)fc

550

Ecutr o (BOHR-3)

Decreasing Ecutr o

100

Increasing Ecut)fc
Force (RY/BOHR)
Force (RY/BOHR)
Force (RY/BOHR)

405

Energy (RY)

Ecut)fc and Ecutr o Con(ergence

160

160

650

APPENDIX L. DFT CONVERGENCE PLOTS

406

0.010

0.015

0.020

0.025

0.030

0.035

0.040

0.045

0.050

3

70
2.00

80

90

100

110

120

130

140

2.50

3.00

3.25

Ecutrho/Ecutwfc

2.75

3.50

3.75

4

6

7

K-points

8

9

10

11

4.00

0.00000

0.00039

0.00078

0.00117

0.00156

0.00195

0.00234

0.00273

0.00312

0.00351

3.00

3.25

Ecutrho/Ecutwfc

2.75

3.50

3.75

0.010

0.015

0.020

0.025

0.030

5

6

7

K-points

8

9

10

11

0.0000000

0.0000088

0.0000176

0.0000264

0.0000352

0.0000440

0.0000528

0.0000704

0.0000792

0.000000

0.035

4

4.00

0.0000616

3

2.50

Force (Ry/Bohr) Kpoint and Degauss

2.25

0.000036

0.000072

0.000108

0.000144

0.000180

0.000216

0.000252

0.000288

0.000324

0.040

0.045

0.050

70
2.00

80

90

100

110

120

130

Figure L.6: 2D density map - force and energy convergence with k-points and smearing - palladium

5

Energy (Ry) Kpoint and Degauss

2.25

0.00000

0.00325

0.00650

0.00975

0.01300

0.01625

0.01950

0.02275

0.02600

0.02925

Degauss/Ry

Ecutwfc/Ry

Degauss/Ry

Ecutwfc/Ry

Ecutwfc and Ecutrho, Kpoint and Degauss
Energy (Ry) Ecutwfc and Ecutrho
Force (Ry/Bohr) Ecutwfc and Ecutrho
140

APPENDIX L. DFT CONVERGENCE PLOTS

Appendix M

QEEOS
The full code is available at https://github.com/BenPalmer1983/qeeos
Several of the important classes that make up the code are listed below.
Listing M.1: QEEOS Readme File
QEEOS
=================================
Quantum Espresso - Equation of State (and Elastic Constants)
Python code.
This code uses pwscf from the Quantum Espresso suite to calculate crystal energies using DFT.
For a full run, this is what the code does:
1.
2.
3.
4.
5.
6.
7.
8.
9.

Reads in the user’s input
Creates a template file for PWscf based on the user’s input and supplied template file
Creates a vc-relax input file and runs this to find the relaxed a0 and cell parameters
Also calculates the density of the material based on the DFT results
Creates and executes a series of SFC or RELAX input files over a range of strains
in order to calculate the equation of state
Creates and executes a series of SFC or RELAX input files over a range of strains from MSKP
in order to calculate the cubic elastic constants
Creates and executes a series of SFC or RELAX input files over a range of strains from RFKJ
in order to calculate the orthorhombic elastic constants
Processes the results
Creates plots
Using the elastic constants, other material properties are calculated or estimated

Melh, Singh, Klein, Papaconstatopolous
Ravindran, Fast, Korzhavyi, Johansson

Listing M.2: Calculation of Bulk Property
1

#!/bin/python3

2
3
4
5
6
7

import
import
import
import
import

os
sys
numpy
time
shutil

8

407

APPENDIX M. QEEOS

9
10

from g import g
from ds import ds

11
12
13
14
15
16
17
18
19
20
21

from
from
from
from
from
from
from
from
from
from

display import display
output import output
units import units
template import template
pwscf_inout import pwscf_input
pwscf_inout import pwscf_output
pwout_read import pwout_read
pwe import pwe
transforms import transforms
adjust_energy import adjust_energy

22
23
24
25

class eos_bm:

26
27
28
29
30
31
32

@staticmethod
def run():
if(not g.ifile[’eos_bm’]):
return False
output.log("Run PWscf for EoS BM", verbose=0)

33
34
35
36

# Get total strain and steps
eos_strain = g.ifile[’eos_bm_strain’]
eos_steps = g.ifile[’eos_bm_steps’]

37
38
39
40

# Make
g.results[’eos_bm_se’] = numpy.zeros((2 * eos_steps + 1, 2,), dtype=numpy.float64)
g.results[’eos_bm_ve’] = numpy.zeros((2 * eos_steps + 1, 2,), dtype=numpy.float64)

41
42
43
44

# Load template
eos = template.load_relaxed()
uv = eos.get_cp_array()

45
46
47
48
49
50
51
52

# Prepare files
files = []
n = 0
for i in range(-eos_steps, eos_steps+1):
n_str = str(n + 1)
while(len(n_str)<4):
n_str = "0" + n_str

53
54
55
56

# Make and store strain
s = eos_strain * (i / eos_steps)
g.results[’eos_bm_se’][n, 0] = s

57
58
59
60

# Transform
d = transforms.eos(s)
uv_new = numpy.matmul(d, uv)

61
62
63
64
65
66
67
68
69

# Update pw obj
eos.set_prefix()
eos.set_cp_arr(uv_new)
if(g.ifile[’eos_bm_calc’] == ’relax’):
eos.set_calculation("relax")
else:
eos.set_calculation("scf")
eos.save("eos_bm_" + n_str + ".in", g.dirs[’eos_bm’])

408

APPENDIX M. QEEOS

files.append(os.path.join(g.dirs[’eos_bm’], "eos_bm_" + n_str + ".in"))

70
71

# Increment
n = n + 1

72
73
74
75
76
77
78
79

# Run PWscf
output.log("Running PWscf", verbose=0)
out = pwe.run(files)

80
81
82
83
84
85
86
87

output.log("Read EoS BM results", verbose=0)
# Read results
for n in range(len(out)):
o = pwout_read.read(out[n][1])
vol = units.convert(’BOHR3’, ’ANG3’, o[’vpa’])
energy = adjust_energy.run(o[’energy’], o[’labels’], unit_in=’ry’, epa=True)

88

g.results[’eos_bm_se’][n, 1] = energy
g.results[’eos_bm_ve’][n, 0] = vol
g.results[’eos_bm_ve’][n, 1] = energy

89
90
91
92
93
94
95

# Save to file
output.log("Save EoS BM results to file", verbose=0)
numpy.savetxt(g.files[’eos_bm’], g.results[’eos_bm_ve’], delimiter=",")

Listing M.3: Calculation of Elastic Constants - MSKP
1

#!/bin/python3

2
3
4
5
6
7

import
import
import
import
import

os
sys
numpy
time
shutil

8
9
10

from g import g
from ds import ds

11
12
13
14
15
16
17
18
19
20
21

from
from
from
from
from
from
from
from
from
from

display import display
output import output
units import units
template import template
pwscf_inout import pwscf_input
pwscf_inout import pwscf_output
pwout_read import pwout_read
pwe import pwe
transforms import transforms
adjust_energy import adjust_energy

22
23
24
25
26

class ec_mskp:

27
28
29
30
31
32
33

@staticmethod
def run():
if(not g.ifile[’ec_mskp’]):
return False
output.log("Run PWscf for EC MSKP", verbose=0)

409

APPENDIX M. QEEOS

34
35
36
37

# Get total strain and steps
ec_mskp_strain = g.ifile[’ec_mskp_strain’]
ec_mskp_steps = g.ifile[’ec_mskp_steps’]

38
39
40

# Make
g.results[’ec_mskp_se’] = {}

41
42
43
44

# Load template
ec = template.load_relaxed()
uv = ec.get_cp_array()

45
46
47

# Prepare files
files = []

48
49
50
51
52
53
54
55

for stype in g.mskp:
g.results[’ec_mskp_se’][stype] = numpy.zeros((ec_mskp_steps, 2,), dtype=numpy.float64)
n = 0
for i in range(ec_mskp_steps):
n_str = str(n + 1)
while(len(n_str)<4):
n_str = "0" + n_str

56
57
58
59

# Make and store strain
s = ec_mskp_strain * (i / ec_mskp_steps)
g.results[’ec_mskp_se’][stype][n, 0] = s

60
61
62
63

# Transform
d = transforms.ec_mskp(s, stype)
uv_new = numpy.matmul(d, uv)

64
65
66
67
68
69
70
71
72
73

# Update pw obj
ec.set_prefix()
ec.set_cp_arr(uv_new)
if(g.ifile[’ec_mskp_calc’] == ’relax’):
ec.set_calculation("relax")
else:
ec.set_calculation("scf")
ec.save("ec_mskp_" + stype + "_" + n_str + ".in", g.dirs[’ec_mskp’])
files.append(os.path.join(g.dirs[’ec_mskp’], "ec_mskp_" + stype + "_" + n_str + ".in"))

74
75
76

# Increment
n = n + 1

77
78
79
80

# Run PWscf
output.log("Running PWscf", verbose=0)
out = pwe.run(files)

81
82
83
84
85
86
87
88
89
90
91
92
93

# Read results
output.log("Read EC MSKP results", verbose=0)
n = 0
for stype in g.mskp:
m = 0
for i in range(ec_mskp_steps):
o = pwout_read.read(out[n][1])
vol = units.convert(’BOHR3’, ’ANG3’, o[’vpa’])
energy = adjust_energy.run(o[’energy’], o[’labels’], unit_in=’ry’, epa=True)
g.results[’ec_mskp_se’][stype][m, 1] = energy
m = m + 1
n = n + 1

94

410

APPENDIX M. QEEOS

95
96
97
98

# Save to file
output.log("Save EC MSKP results to file", verbose=0)
for stype in g.mskp:
numpy.savetxt(g.files[’ec_mskp’][stype], g.results[’ec_mskp_se’][stype], delimiter=",")

Listing M.4: Calculation of Elastic Constants - RFKJ
1

#!/bin/python3

2
3
4
5
6
7

import
import
import
import
import

os
sys
numpy
time
shutil

8
9
10

from g import g
from ds import ds

11
12
13
14
15
16
17
18
19
20
21

from
from
from
from
from
from
from
from
from
from

display import display
output import output
units import units
template import template
pwscf_inout import pwscf_input
pwscf_inout import pwscf_output
pwout_read import pwout_read
pwe import pwe
transforms import transforms
adjust_energy import adjust_energy

22
23
24
25
26

class ec_rfkj:

27
28
29
30
31
32
33

@staticmethod
def run():
if(not g.ifile[’ec_rfkj’]):
return False
output.log("Run PWscf for EC RFKJ", verbose=0)

34
35
36
37

# Get total strain and steps
strain = g.ifile[’ec_rfkj_strain’]
steps = g.ifile[’ec_rfkj_steps’]

38
39
40

# Make
g.results[’ec_rfkj_se’] = {}

41
42
43
44

# Load template
ec = template.load_relaxed()
uv = ec.get_cp_array()

45
46
47

# Prepare files
files = []

48
49
50
51
52
53
54
55

for stype in g.rfkj:
g.results[’ec_rfkj_se’][stype] = numpy.zeros((2*steps+1, 2,), dtype=numpy.float64)
n = 0
#for i in range(steps):
for i in range(-steps, steps+1):
n_str = str(n + 1)
while(len(n_str)<4):

411

APPENDIX M. QEEOS

56

n_str = "0" + n_str

57
58
59
60

# Make and store strain
s = strain * (i / steps)
g.results[’ec_rfkj_se’][stype][n, 0] = s

61
62
63
64

# Transform
d = transforms.ec_rfkj(s, stype)
uv_new = numpy.matmul(d, uv)

65
66
67
68
69
70
71
72
73
74

# Update pw obj
ec.set_prefix()
ec.set_cp_arr(uv_new)
if(g.ifile[’ec_rfkj_calc’] == ’relax’):
ec.set_calculation("relax")
else:
ec.set_calculation("scf")
ec.save("ec_rfkj_" + stype + "_" + n_str + ".in", g.dirs[’ec_rfkj’])
files.append(os.path.join(g.dirs[’ec_rfkj’], "ec_rfkj_" + stype + "_" + n_str + ".in"))

75
76
77

# Increment
n = n + 1

78
79
80
81

# Run PWscf
output.log("Running PWscf", verbose=0)
out = pwe.run(files)

82
83
84
85
86
87
88
89
90
91
92

# Read results
output.log("Read EC RFKJ results", verbose=0)
for stype in g.rfkj:
n = 0
for i in range(-steps, steps+1):
o = pwout_read.read(out[n][1])
vol = units.convert(’BOHR3’, ’ANG3’, o[’vpa’])
energy = adjust_energy.run(o[’energy’], o[’labels’], unit_in=’ry’, epa=True)
g.results[’ec_rfkj_se’][stype][n, 1] = energy
n = n + 1

93
94
95
96
97

# Save to file
output.log("Save EC RFKJ results to file", verbose=0)
for stype in g.rfkj:
numpy.savetxt(g.files[’ec_rfkj’][stype], g.results[’ec_rfkj_se’][stype], delimiter=",")

412

Appendix N

DFT Calculated Properties
N.1

QEEOS

These results were calculated using the QEEOS python program that automatically creates and runs PWscf
input files, collects the output files and processes the data.

413

N.2. FCC ALUMINIUM

APPENDIX N. DFT CALCULATED PROPERTIES

N.2

FCC Aluminium

N.2.1

DFT Settings for PWscf

The calculations were performed with the Quantum Espresso PWscf package along with the QEEOS python
program.
Setting

Value

ecutwfc (Ry)
ecutrho
smearing (Ry)
k-points
nspin
pseudopotential
etot conv thr
forc conv thr
conv thr
diagonalization
mixing beta
mixing mode

50
200
0.04
11 11 11 1 1 1
0 (Non-magnetic)
Al.pbe-nl-kjpaw psl.1.0.0.UPF
0.0001
0.001
1.0D-6
david
0.1
plain

Table N.1: Aluminium DFT settings

Resulting Plots
Equation of State
−0.00064

Distortion D1

−0.00064

−0.00066

−0.00068

−0.00068

−0.00070
−0.00072
−0.00074

−0.00070
−0.00072
−0.00074

−0.00076

−0.00076

−0.00078

−0.00078
0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

−0.000600

Distortion D4

−0.000600

112.0

112.5

113.0

−0.000675
−0.000700
−0.000725

−0.000750

−0.000750

−0.000775

−0.000775

−0.000725
−0.000750
−0.000775
0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

Strain / Alat

−1.264085e3

Strain / Alat

Distortion D8

−1.264085e3
−0.00068

−0.00070

−0.00070

Energ / R

−0.00068

−0.00070

−0.00074

−0.00072
−0.00074

−0.00076

−0.00076

−0.00078

−0.00078

Strain / Alat

Distortion D6

−0.000700

−0.00068

−0.00072

−1.264085e3

−0.000675

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

Distortion D7

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

Figure N.1: Aluminium FCC equation of state plot

Energ / R

−0.000725

Energ / R
111.5

Strain / Alat

−0.000600
−0.000650

−0.000700

−0.00007

111.0

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

Distortion D5

−0.000625

−1.264085e3

110.5

−1.264085e3

−0.000650

−0.00006

110.0

−0.00078

−0.000625

Strain / Alat

109.5

−0.00076

−0.000650

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

−0.00008

−0.00074

−0.000625
−0.000675

Distortion D3

−0.00072

Strain / Alat

Energ / R

Energ / R

−1.264085e3

−1.264085e3

−0.00070

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

Strain / Alat

−0.00005

−0.00064

−0.00068

−0.00003

−0.00004

Elastic Constant Curves
Distortion D2

−1.264085e3

−0.00066

Energ / R

Energ / R

−0.00002

−1.264085e3

−0.00066

Energ / R

−3.95026e1
−0.00001

Energ / R

N.2.2

Distortion D9

−0.00072
−0.00074
−0.00076
−0.00078

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

Strain / Alat

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035

Strain / Alat

Figure N.2: Aluminium FCC elastic constants plot

414

APPENDIX N. DFT CALCULATED PROPERTIES

N.2.3

N.2. FCC ALUMINIUM

Aluminium FCC Results File
Listing N.1: Aluminium FCC DFT Calculated Properties

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58

################################################################
#
RESULTS
#
################################################################
Thu, 26 Mar 2020 13:32:45 +0000
INPUT SETTINGS
Structure:
Size:
Alat (Bohr):
Alat (Bohr) (exp.):
Alat (Ang):
Alat (Ang) (exp.):
Atoms in crystal:
Atoms in crystal (exp.):
AMU per crystal:

fcc
2
6.9
13.8
3.6501000000000006
7.300200000000001
32
32
863.4239999999994

Ecutwfc:
Ecutrho:
Degauss:
Kpoints:

50
200
0.04
automatic 11 11 11 1 1 1

EOS Points:
Total Strain:

11
0.005

V0 (Bohr^3):
E0:
B0 (RY/BOHR3):
B0 (GPA):
B0P:

111.192295309
-39.5027342866
0.00531912635008
77.572208693
2.0

EC Points:
Total Strain:

9
0.005

Relaxed
Relaxed
Relaxed
Relaxed
Relaxed

7.6325799
15.2651598
4.0376347671
8.0752695342
1.0
0.0
0.0
0.0
1.0
0.0
0.0
0.0
1.0
3557.16544569
2722.71416748

alat
alat
alat
alat
cp:

(Bohr):
(Bohr) (exp):
(Ang):
(Ang) (exp):

Relaxed volume (Bohr^3):
Relaxed density (kgm^-3):
Stiffness (RY/BOHR3):

0.0076028
0.0039542
0.0039563
0.0
0.0
0.0

0.0039542
0.0075973
0.003945
0.0
0.0
0.0

0.0039563
0.003945
0.0076068
0.0
0.0
0.0

0.0
0.0
0.0
0.0023326
0.0
0.0

Stiffness (GPA):

110.877131 57.6666837 57.6978857 0.0
0.0
0.0
57.6666837 110.796070 57.5331112 0.0
0.0
0.0
57.6978857 57.5331112 110.934314 0.0
0.0
0.0
0.0
0.0
0.0
34.0184756 0.0
0.0
0.0
0.0
0.0
0.0
34.0513488 0.0
0.0
0.0
0.0
0.0
0.0
34.037456

415

0.0
0.0
0.0
0.0
0.0023349
0.0

0.0
0.0
0.0
0.0
0.0
0.0023339

N.2. FCC ALUMINIUM

59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86

APPENDIX N. DFT CALCULATED PROPERTIES

Compliance (1/GPA):

0.0140133 -0.0048022 -0.0047979 0.0
-0.0048022 0.0139977 -0.0047619 0.0
-0.0047979 -0.0047619 0.0139794 0.0
0.0
-0.0
-0.0
0.0293958
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0

Bulk Modulus B (GPA):
BR (GPA):
BV (GPA):

75.378064563
75.3780315039
75.378097622

Shear Modulus G (GPA):
GR:
GV:

30.8455908955
30.6224032645
31.0687785264

Young’s Modulus E (GPA):

81.4294731854

Poisson’s Ratio v:

0.319953205977

L Elastic Wave V:
T Elastic Wave V:
M Elastic Wave V:

0.206857953612
0.106437709845
0.119193708075

Debye Temperature:

0.00139515659606

Melting Point:

1300.0K

N.2.4

0.0
0.0
0.0
-0.0
0.0293674
0.0

0.0
0.0
0.0
-0.0
0.0
0.0293794

Known and Calculated Values

Structure
𝑎0 (Angs)
Nearest Neighbour
Basis vectors
𝐸𝑐𝑜ℎ (eV)
Bulk Modulus 𝐵0 (GPA)
Bulk Modulus 𝐵0,𝑟 (GPA)
Bulk Modulus 𝐵0,𝑔 (GPA)
Young’s modulus 𝐸 (GPA)
Shear Modulus 𝐺 (GPA)
Poisson Ratio 𝜈

Elastic Constants (GPA)

Al Experimental

Al DFT (this work)

Face Centered Cubic
4.05 Angstrom
2.86 Angstrom
⎡
⎤
1.0 0.0 0.0
⎢
⎥
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-3.36 eV
76
70
26
0.35
⎡
114 62
62 0
⎢
62
114
62 0
⎢
⎢
⎢ 62
62 114 0
⎢
⎢ 0
0
0 32
⎢
⎢
⎣ 0
0
0
0
0
0
0
0

Face Centered Cubic
4.04 Angstrom
2.86 Angstrom
⎡
⎤
1.0 0.0 0.0
⎢
⎥
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
Not Calculated
77.6
75.4
75.4
81.4
30.8
0.32
⎡
110.9 57.7 57.7
⎢
⎢ 57.7 110.8 57.5
⎢
⎢ 57.7 57.5 110.9
⎢
⎢ 0
0
0
⎢
⎢
⎣ 0
0
0
0
0
0

0
0
0
0
32
0

⎤
0
⎥
0⎥
⎥
0⎥
⎥
0⎥
⎥
⎥
0⎦
32

⎤
0
0
0
⎥
0
0
0 ⎥
⎥
0
0
0 ⎥
⎥
34.0
0
0 ⎥
⎥
⎥
0
34.0
0 ⎦
0
0
34.0

Table N.2: FCC Aluminium: Experimental Values vs DFT Calculated Variables

416

APPENDIX N. DFT CALCULATED PROPERTIES

N.3

BCC Iron [No Magnetism]

N.3.1

Major DFT Settings

N.3. BCC IRON [NO MAGNETISM]

Ecutwfc: 71
Ecutrho: 430
Smearing: 0.04
K-points: 9 9 9 1 1 1
Nspin: 1 (non-polarized calculation)
Pseudopotential: Fe.pbe-spn-kjpaw psl.1.0.0.UPF

N.3.2

Equation of State and Elastic Constants
Equation of State

−3.29231e2

−0.00072

−0.00074

−0.00074

−0.00078
−0.00080

0.001

−0.0004

0.003

Strain / Alat

0.004

0.005

−3.292316e2

−0.00008
−0.00009

0.000

Distortion D5

0.001

0.002

0.003

Strain / Alat

0.004

−0.00008
−0.00009

0.005

0.001

0.002

0.003

Strain / Alat

0.004

0.000

−0.000700

−0.000705

−0.000705

Energ / R

−0.000700

−0.000710
−0.000715
−0.000720
−0.000725

0.001

0.002

0.003

Strain / Alat

0.004

0.005

−0.000730

0.001

0.005

0.004

0.005

0.004

0.005

Distortion D6

0.002

0.003

Strain / Alat

Distortion D9

−3.29231e2

−0.000705

−0.000720

0.004

−0.00009

0.005

−0.000700

−0.000715

0.003

−0.00008

Distortion D8

−3.29231e2

−0.000710

0.002

Strain / Alat

−0.00010
0.000

Distortion D7

0.001

−3.292316e2

−0.00010

0.000

Figure N.3: Iron BCC equation of state plot

0.005

−0.00007

Energ / R

Energ / R
71.0

Strain / Alat

0.004

−0.00006

−0.000725

70.5

0.003

−0.00007

−3.29231e2

70.0

0.002

−0.00006

−0.0007

69.5

−0.00078

−0.00082
0.001

−0.00007

0.000

69.0

−0.00076

−0.00006

−0.00010

−0.0009

−0.00074

−0.00080

0.000

Energ / R

Energ / R

0.002

Distortion D4

−3.292316e2

−0.0008

−0.00078

−0.00082
0.000

−0.0006

−0.00076

−0.00080

−0.00082

−0.0005

Energ / R

−0.00072

−0.00076

Distortion D3

−3.29231e2
−0.00070

−0.00072

Energ / R

−0.0003

−3.29231e2
−0.00070

Energ / R

Energ / R

−0.0002

Elastic Constant Curves
Distortion D2

Distortion D1

−3.29231e2
−0.00070

−0.000710
−0.000715
−0.000720
−0.000725

0.000

0.001

0.002

0.003

Strain / Alat

0.004

0.005

0.000

0.001

0.002

0.003

Strain / Alat

Figure N.4: Iron BCC elastic constants plot

417

N.3. BCC IRON [NO MAGNETISM]

N.3.3

APPENDIX N. DFT CALCULATED PROPERTIES

Iron BCC Results File
Listing N.2: Iron BCC DFT Calculated Properties

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58

################################################################
#
RESULTS
#
################################################################
Tue, 03 Nov 2020 06:01:22 +0000
INPUT SETTINGS
################################
Structure:
Size:
A0:
A0 Units:
A0 (Bohr):
A0 (Angs):

bcc
2
2.8
ang
10.584
5.598936

Ecutwfc:
Ecutrho:
Degauss:
Kpoints:
Kpoints Type:
EOS Points:
EOS Strain:
EC Points:
EC Strain:

71
430
0.04
9 9 9 1 1 1
automatic
9
0.005
9
0.005

RELAXED
################################
a0 (Bohr):
CP:

10.391466456
1.0
0.0
0.0
0.0
1.0
0.0
0.0
0.0
1.0
Volume (Bohr^3/unit cell): 1122.09730705
Density KG/m^3:
8932.14485799
AMU per crystal unit:
893.5200000000003
Atoms per crystal unit:
16
Total Energy/Ry:
-5267.70721439
Energy per Atom/Ry:
-329.231700899375
Total Force Ry/Bohr:
1.7e-05
Force per atom Ry/Bohr:
1.0625e-06

a0 primitive (Bohr):
a0 primitive (Ang):

5.195733228
2.748542877612

EOS
################################
V0 (Bohr^3 / atom):
E0 (Ry / atom):
B0 (RY/BOHR3):
B0 (GPA):
B0P:

71.4368199046
-329.231932186
0.0195284174344
287.272784669
4.98933790197

EC

418

APPENDIX N. DFT CALCULATED PROPERTIES

59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119

N.3. BCC IRON [NO MAGNETISM]

################################
Stiffness (RY/BOHR3):

0.0043229
0.0225755
0.0216226
0.0
0.0
0.0

0.0225755
0.0121066
0.0217004
0.0
0.0
0.0

0.0216226
0.0217004
0.0083439
0.0
0.0
0.0

0.0
0.0
0.0
0.0121324
0.0
0.0

0.0
0.0
0.0
0.0
0.0123943
0.0

Stiffness (GPA):

63.04417 329.233427 315.336007 0.0
0.0
0.0
329.233427 176.558337 316.470988 0.0
0.0
0.0
315.336007 316.470988 121.684505 0.0
0.0
0.0
0.0
0.0
0.0
176.934632 0.0
0.0
0.0
0.0
0.0
0.0
180.753497 0.0
0.0
0.0
0.0
0.0
0.0
180.022531

Compliance (1/GPA):

-0.0026218 0.0019907 0.001617 0.0
0.0019907 -0.0030583 0.0027951 0.0
0.001617 0.0027951 -0.0032415 0.0
0.0
0.0
0.0
0.0056518
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0

0.0
0.0
0.0
0.0
0.0055324
0.0

Stability:
C11:
63.044169998 (Stable)
C11C22 - C12C12:
-97263.6756949 (Unstable)
C11*C22*C33+2*C12*C13*C23-C11*C23*C23-C33*C12*C12: 47561899.9206 (Stable)
C44:
176.934632292 (Stable)
C55:
180.753497554 (Stable)
C66:
180.022531471 (Stable)
Bulk Modulus B (GPA):
BR (GPA):
BV (GPA):

255.592980231
257.478420517
253.707539944

Shear Modulus G (GPA):
GR:
GV:

-643.096162505
-1353.7508966
67.5585715904

Young’s Modulus E (GPA):

-11960.7418627

Poisson’s Ratio v:

8.29934165372

L Elastic Wave V:
T Elastic Wave V:
M Elastic Wave V:

nan
nan
nan

Debye Temperature:

nan

Melting Point:

1357.0K

References
=======================================

419

0.0
0.0
0.0
0.0
0.0
0.0123441

0.0
0.0
0.0
0.0
0.0
0.0055549

N.3. BCC IRON [NO MAGNETISM]

120
121
122
123
124
125
126
127
128
129
130
131
132
133

APPENDIX N. DFT CALCULATED PROPERTIES

First Principles Calculations of Elastic Properties of Metals
M. J. Mehl, B. M. Klein, D. A. Papaconstantopoulos
1994
Ab Initio Study of the Elastic and Mechanical Properties of B19 TiAl
Y. Wen, L. Wang, H. Liu and L. Song
Crystals
2017
Density functional theory for calculation of elastic properties of orthorhombic crystals - applications to TiSi2
P. Ravindran, Lars Fast, P. A. Korzhavyi, B. Johansson
Journal of Applied Physics
1998

420

APPENDIX N. DFT CALCULATED PROPERTIES

N.4

BCC Iron [Ferromagnetic]

N.4.1

Major DFT Settings

N.4. BCC IRON [FERROMAGNETIC]

Setting

Value

ecutwfc (Ry)
ecutrho
smearing (Ry)
k-points
nspin
pseudopotential
etot conv thr
forc conv thr
conv thr
diagonalization
mixing beta
mixing mode

71
430
0.04
999111
0 (Non-magnetic) and 2 (Collinear Spin)
Fe.pbe-spn-kjpaw psl.1.0.0.UPF
0.0001
0.001
1.0D-6
david
0.1
plain

Table N.3: Iron DFT settings

Equation of State and Elastic Constants
Equation of State
−0.00084

−0.0590

Distortion D1

−0.00084

−0.00086

−0.00087

−0.00087

−0.00087

−0.00088
−0.00089
−0.00090

−0.00088
−0.00089
−0.00090

−0.00091

−0.00091

−0.00092

−0.00092

−0.0595

−3.292618e2

−0.000040

74

76

78

−0.000035

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

Strain / Alat

Distortion D7

−0.000032

−3.292618e2

Strain / Alat

Distortion D8

−0.000032

−0.000034

−0.000034

−0.000034

−0.000036

−0.000036

−0.000036

−0.000038
−0.000040

−0.000038
−0.000040

−0.000042

−0.000042

−0.000044

−0.000044

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

Strain / Alat

Figure N.5: Iron BCC (magnetic) equation of state plot

−0.000030

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

Energ / R

Energ / R
72

−3.292618e2

Distortion D6

−0.000040

−0.000040

−0.0610

70

Strain / Alat

−3.292618e2
−0.000025

−0.000035

Strain / Alat

−0.0620

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

Distortion D5

−0.000030

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

−0.0615

−0.00092

−3.292618e2

Energ / R

Energ / R

−0.000035

−0.00090
−0.00091

−0.000025

−0.000030

Distortion D3

−0.00089

Strain / Alat

Distortion D4

−3.29261e2

−0.00088

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

−0.000025

−0.000032

Energ / R

−0.00085

−0.00086

Strain / Alat

−0.0605

−0.00084

−0.00086

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

−0.0600

Elastic Constant Curves
Distortion D2

−3.29261e2

−0.00085

Energ / R

−0.0585

−3.29261e2

−0.00085

Energ / R

−3.292e2

Energ / R

−0.0580

Energ / R

N.4.2

−3.292618e2

Distortion D9

−0.000038
−0.000040
−0.000042

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

Strain / Alat

−0.000044

0.0000 0.0005 0.0010 0.0015 0.0020 0.0025 0.0030 0.0035 0.0040

Strain / Alat

Figure N.6: Iron BCC (magnetic) elastic constants plot

421

N.4. BCC IRON [FERROMAGNETIC]

N.4.3

APPENDIX N. DFT CALCULATED PROPERTIES

Iron Ferromagnetic BCC Results File
Listing N.3: Iron BCC DFT calculated properties

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58

################################################################
#
RESULTS
#
################################################################
INPUT SETTINGS
################################
Structure:
Size:
A0:
A0 Units:
A0 (Bohr):
A0 (Angs):

bcc
2
2.8
ang
10.584
5.598936

Ecutwfc:
Ecutrho:
Degauss:
Kpoints:
Kpoints Type:
EOS Points:
EOS Strain:
EC Points:
EC Strain:

71
430
0.04
9 9 9 1 1 1
automatic
15
0.02
7
0.004

RELAXED
################################
a0 (Bohr):
CP:

10.5935195777
1.0
0.0
0.0
0.0
1.0
0.0
0.0
0.0
1.0
Volume (Bohr^3/unit cell): 1188.83291445
Density KG/m^3:
8430.73536197
AMU per crystal unit:
893.5200000000003
Atoms per crystal unit:
16
Total Energy/Ry:
-5268.18846365
Energy per Atom/Ry:
-329.261778978125
Total Force Ry/Bohr:
2.2e-05
Force per atom Ry/Bohr:
1.375e-06

a0 primitive (Bohr):
a0 primitive (Ang):

5.2967597888519995
2.8019859283027078

EOS
################################
V0 (Bohr^3 / atom):
E0 (Ry / atom):
B0 (RY/BOHR3):
B0 (GPA):
B0P:

75.8702665574
-329.262127846
0.0162627705061
239.23348553
3.31889649178

EC
################################

422

APPENDIX N. DFT CALCULATED PROPERTIES

59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119

0.0124976
0.0170822
0.0125444
0.0
0.0
0.0

N.4. BCC IRON [FERROMAGNETIC]

Stiffness (RY/BOHR3):

0.0171516
0.0124976
0.0125676
0.0
0.0
0.0

0.0125676
0.0125444
0.0172259
0.0
0.0
0.0

0.0
0.0
0.0
0.0095442
0.0
0.0

0.0
0.0
0.0
0.0
0.0095793
0.0

Stiffness (GPA):

250.132354 182.259753 183.281653 0.0
0.0
0.0
182.259753 249.120311 182.943207 0.0
0.0
0.0
183.281653 182.943207 251.216687 0.0
0.0
0.0
0.0
0.0
0.0
139.188774 0.0
0.0
0.0
0.0
0.0
0.0
139.701368 0.0
0.0
0.0
0.0
0.0
0.0
139.328420

Compliance (1/GPA):

0.0104302 -0.0043908 -0.0044121 0.0
-0.0043908 0.0104768 -0.0044261 0.0
-0.0044121 -0.0044261 0.0104228 0.0
0.0
0.0
0.0
0.0071845
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0

0.0
0.0
0.0
0.0
0.0071581
0.0

Stability:
C11:
250.132354807 (Stable)
C11C22 - C12C12:
29094.4322943 (Stable)
C11*C22*C33+2*C12*C13*C23-C11*C23*C23-C33*C12*C12: 11159910.6986 (Stable)
C44:
139.188774163 (Stable)
C55:
139.701368243 (Stable)
C66:
139.328420919 (Stable)
Bulk Modulus B (GPA):
BR (GPA):
BV (GPA):

205.266912094
205.262870468
205.270953721

Shear Modulus G (GPA):
GR:
GV:

79.4449473647
61.7805328168
97.1093619125

Young’s Modulus E (GPA):

211.100586016

Poisson’s Ratio v:

0.328596676183

L Elastic Wave V:
T Elastic Wave V:
M Elastic Wave V:

0.192124405208
0.0970734382597
0.108830261337

Debye Temperature:

0.000728462251696

Melting Point:

2076.0K

References
=======================================

423

0.0
0.0
0.0
0.0
0.0
0.0095537

0.0
0.0
0.0
0.0
0.0
0.0071773

N.4. BCC IRON [FERROMAGNETIC]

120
121
122
123
124
125
126
127
128
129
130
131
132

APPENDIX N. DFT CALCULATED PROPERTIES

First Principles Calculations of Elastic Properties of Metals
M. J. Mehl, B. M. Klein, D. A. Papaconstantopoulos
1994
Ab Initio Study of the Elastic and Mechanical Properties of B19 TiAl
Y. Wen, L. Wang, H. Liu and L. Song
Crystals
2017
Density functional theory for calculation of elastic properties of orthorhombic crystals - applications to TiSi2
P. Ravindran, Lars Fast, P. A. Korzhavyi, B. Johansson
Journal of Applied Physics
1998

424

425

Elastic Constants (GPA)

𝐸𝑐𝑜ℎ (eV)
Bulk Modulus 𝐵0 (GPA)
Bulk Modulus 𝐵0,𝑟 (GPA)
Bulk Modulus 𝐵0,𝑔 (GPA)
Young’s modulus 𝐸 (GPA)
Shear Modulus 𝐺 (GPA)
Poisson Ratio 𝜈

Basis vectors

0
0
0
0
116
0

⎤
0
⎥
0 ⎥
⎥
0 ⎥
⎥[122]
0 ⎥
⎥
⎥
0 ⎦
116

Body Centered Cubic
2.75 Angstrom
2.38 Angstrom
⎡
⎤
1.0 0.0 0.0
⎢
⎥
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
Not Calculated
287.3
257.5
253.7
-11960.7
-643.1
8.29
⎡
⎤
63.0 329.2 315.3
0
0
0
⎢
⎥
0
0
0 ⎥
⎢329.2 176.6 316.4
⎢
⎥
⎢315.3 316.5 121.7
0
0
0 ⎥
⎢
⎥
⎢ 0
0
0
176.9
0
0 ⎥
⎢
⎥
⎢
⎥
⎣ 0
0
0
0
180.8
0 ⎦
0
0
0
0
0
180.0

Fe DFT No Magnetism (this work)

Table N.4: BCC Iron: Experimental Values vs DFT Calculated Variables

Body Centered Cubic
2.86 Angstrom[122]
2.48 Angstrom[122]
⎡
⎤
1.0 0.0 0.0
⎢
⎥
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-4.32 [122]
170
211
82
0.29
⎡
243 145 145 0
⎢
⎢145 243 145 0
⎢
⎢145 145 243 0
⎢
⎢ 0
0
0 116
⎢
⎢
⎣ 0
0
0
0
0
0
0
0

Fe Experimental

Known and Calculated Results

Structure
𝑎0 (Angs)
Nearest Neighbour

N.4.4

2.80 Angstrom
2.42 Angstrom
⎡
⎤
1.0 0.0 0.0
⎢
⎥
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
Not Calculated
239.2
205.3
205.3
211.1
79.4
0.33
⎡
250.1 182.3 183.3
⎢
⎢182.3 249.1 182.9
⎢
⎢183.2 182.9 251.2
⎢
⎢ 0
0
0
⎢
⎢
⎣ 0
0
0
0
0
0

⎤
0
0
0
⎥
0
0
0 ⎥
⎥
0
0
0 ⎥
⎥
139.2
0
0 ⎥
⎥
⎥
0
139.7
0 ⎦
0
0
139.3

Fe DFT Ferromagnetic (this work)

APPENDIX N. DFT CALCULATED PROPERTIES
N.4. BCC IRON [FERROMAGNETIC]

N.5. FCC IRON [ANTIFERROMAGNETIC]

APPENDIX N. DFT CALCULATED PROPERTIES

N.5

FCC Iron [Antiferromagnetic]

N.5.1

Major DFT Settings
Setting

Value

ecutwfc (Ry)
ecutrho
smearing (Ry)
k-points
nspin
pseudopotential
etot conv thr
forc conv thr
conv thr
diagonalization
mixing beta
mixing mode

71
430
0.04
999111
2 (Collinear Spin)
Fe.pbe-spn-kjpaw psl.1.0.0.UPF
0.0001
0.001
1.0D-6
david
0.1
plain

Table N.5: Iron DFT settings

N.5.2

Equation of State and Elastic Constants
Equation of State
Distortion D1

−3.29257e2

−0.007825

−0.00084

−0.0050

−0.00090
−0.00092
−0.00094

−0.007900
−0.007925
−0.007950

−0.00096

−0.007975

−0.00098

−0.008000
0.000

0.002

−0.0055
−0.000650

0.004

0.006

Strain / Alat

0.008

0.010

Distortion D4

−3.29257e2

Energ / R

Energ / R

−0.0065

0.004

0.006

Strain / Alat

0.008

−0.000750
−0.000775
−0.000800

0.000

0.002

−0.0070

0.004

0.006

Strain / Alat

0.008

−0.000650

−0.00070
−0.00075

Distortion D7

−3.29257e2

0.004

0.006

Strain / Alat

0.008

0.010

0.008

0.010

−0.000775

0.010

0.000

Distortion D8

0.002

0.004

0.006

Strain / Alat

Distortion D9

−3.29257e2
−0.00074
−0.00076

−0.00079
−0.00080
−0.00081
−0.00082

−0.00082

0.008

−0.000750

Energ / R

−0.00080

0.010

−0.000825
0.002

−3.29257e2

−0.00078

0.008

−0.000725

−0.00078

Energ / R

Energ / R

−0.0080

0.006

−0.000700

−0.00077

−0.00076

0.004

Strain / Alat

Distortion D6

−0.000800

0.000

−0.00074

−0.0075

0.002

−3.29257e2

−0.000675

−0.00065

0.010

−0.00094

0.000

Distortion D5

−0.00080

−0.000825

−0.00092

0.010

−0.00060

−0.000725

−0.00090

−0.00098
0.002

−3.29257e2

−0.000700

−0.00088

−0.00096

0.000

−0.000675

−0.0060

−0.00086

Energ / R

−0.00088

Distortion D3

−3.29257e2
−0.00084

−0.007875

Energ / R

Energ / R

−0.00086

−0.0045

Elastic Constant Curves
Distortion D2

−3.2925e2

−0.007850

Energ / R

−3.2925e2

−0.00078
−0.00080
−0.00082

−0.00083

68

70

72

74

76

0.000

Figure N.7: Iron FCC (magnetic) equation of state plot

0.002

0.004

0.006

Strain / Alat

0.008

0.010

0.000

0.002

0.004

0.006

Strain / Alat

0.008

0.010

0.000

0.002

0.004

0.006

Strain / Alat

Figure N.8: Iron FCC (magnetic) elastic constants plot

426

APPENDIX N. DFT CALCULATED PROPERTIES

N.5.3

N.5. FCC IRON [ANTIFERROMAGNETIC]

Iron FCC Results File
Listing N.4: Iron FCC DFT Calculated Properties

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58

################################################################
#
RESULTS
#
################################################################
INPUT SETTINGS
################################
Structure:
Size:
A0:
A0 Units:
A0 (Bohr):
A0 (Angs):

fcc
2
3.4278156
ang
12.957142968
6.854328630072

Ecutwfc:
Ecutrho:
Degauss:
Kpoints:
Kpoints Type:
EOS Points:
EOS Strain:
EC Points:
EC Strain:

71
430
0.04
9 9 9 1 1 1
automatic
7
0.02
7
0.01

RELAXED
################################
a0 (Bohr):
CP:

12.9381866998
1.0
0.0
0.0
0.0
1.05447369502
0.0
0.0
0.0
0.999986980953
Volume (Bohr^3/unit cell): 2283.75934496
Density KG/m^3:
8777.4009231
AMU per crystal unit:
1787.0400000000006
Atoms per crystal unit:
32
Total Energy/Ry:
-10536.25057837
Energy per Atom/Ry:
-329.2578305740625
Total Force Ry/Bohr:
5.1e-05
Force per atom Ry/Bohr:
1.59375e-06

a0 primitive (Bohr):
a0 primitive (Ang):

6.4690933498955
3.4221503820947197

EOS
################################
V0 (Bohr^3 / atom):
E0 (Ry / atom):
B0 (RY/BOHR3):
B0 (GPA):
B0P:

73.1321918692
-329.258178984
0.0153732026949
226.147498244
3.74220549488

EC
################################

427

N.5. FCC IRON [ANTIFERROMAGNETIC]

59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119

0.009711
0.0204815
0.0089411
0.0
0.0
0.0

APPENDIX N. DFT CALCULATED PROPERTIES

Stiffness (RY/BOHR3):

0.0250005
0.009711
0.0160292
0.0
0.0
0.0

0.0160292
0.0089411
0.0250019
0.0
0.0
0.0

0.0
0.0
0.0
0.0127715
0.0
0.0

0.0
0.0
0.0
0.0
0.0182966
0.0

Stiffness (GPA):

364.598330 141.621966 233.764448 0.0
0.0
0.0
141.621966 298.695202 130.394083 0.0
0.0
0.0
233.764448 130.394083 364.619131 0.0
0.0
0.0
0.0
0.0
0.0
186.254349 0.0
0.0
0.0
0.0
0.0
0.0
266.830684 0.0
0.0
0.0
0.0
0.0
0.0
186.346168

Compliance (1/GPA):

0.004966 -0.0011431 -0.002775 0.0
-0.0011431 0.0042304 -0.00078 0.0
-0.002775 -0.00078 0.0048006 0.0
0.0
0.0
0.0
0.005369
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0

0.0
0.0
0.0
0.0
0.0037477
0.0

Stability:
C11:
364.598330439 (Stable)
C11C22 - C12C12:
88846.9908456 (Stable)
C11*C22*C33+2*C12*C13*C23-C11*C23*C23-C33*C12*C12: 34829887.0518 (Stable)
C44:
186.254349116 (Stable)
C55:
266.830684551 (Stable)
C66:
186.346168623 (Stable)
Bulk Modulus B (GPA):
BR (GPA):
BV (GPA):

221.980853006
217.35352142
226.608184591

Shear Modulus G (GPA):
GR:
GV:

144.783544731
126.872037967
162.695051494

Young’s Modulus E (GPA):

356.782113599

Poisson’s Ratio v:

0.232122456533

L Elastic Wave V:
T Elastic Wave V:
M Elastic Wave V:

0.217447522685
0.128433002219
0.142291445915

Debye Temperature:

0.0009653163572

Melting Point:

2528.0K

References
=======================================

428

0.0
0.0
0.0
0.0
0.0
0.0127778

0.0
0.0
0.0
0.0
0.0
0.0053664

APPENDIX N. DFT CALCULATED PROPERTIES

120
121
122
123
124
125
126
127
128
129
130
131
132

N.5. FCC IRON [ANTIFERROMAGNETIC]

First Principles Calculations of Elastic Properties of Metals
M. J. Mehl, B. M. Klein, D. A. Papaconstantopoulos
1994
Ab Initio Study of the Elastic and Mechanical Properties of B19 TiAl
Y. Wen, L. Wang, H. Liu and L. Song
Crystals
2017
Density functional theory for calculation of elastic properties of orthorhombic crystals - applications to TiSi2
P. Ravindran, Lars Fast, P. A. Korzhavyi, B. Johansson
Journal of Applied Physics
1998

Iron FCC (this work)
Structure
𝑎0 (Angs)
Nearest Neighbour

𝐸𝑐𝑜ℎ (eV)
Bulk Modulus 𝐵0 (GPA)
Bulk Modulus 𝐵0,𝑟 (GPA)
Bulk Modulus 𝐵0,𝑣 (GPA)
Young’s modulus 𝐸 (GPA)
Shear Modulus 𝐺 (GPA)
Poisson Ratio 𝜈

Face
⎡
1.0
⎢
⎣0.0
0.0
-

Elastic Constants (GPA)

-

Basis vectors

Centered Cubic
⎤
0.0 0.0
⎥
1.0 0.0⎦
0.0 1.0

Face Centered Cubic
3.42 Angstrom
2.86 Angstrom
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-4.26
226.1
217.3
226.6
356.8
144.8
0.23
⎡
364.6 141.6 233.8
⎢
⎢141.6 298.7 130.4
⎢
⎢233.8 130.4 364.6
⎢
⎢ 0
0
0
⎢
⎢
⎣ 0
0
0
0
0
0

Table N.6: Iron FCC: DFT Calculated Properties

429

⎤
0
0
0
⎥
0
0
0 ⎥
⎥
0
0
0 ⎥
⎥
186.3
0
0 ⎥
⎥
⎥
0
266.8
0 ⎦
0
0
186.3

N.6. FCC PALLADIUM

APPENDIX N. DFT CALCULATED PROPERTIES

N.6

FCC Palladium

N.6.1

Major DFT Settings
Setting

Value

Ecutwfc (Ry)
Ecutrho
Smearing (Ry)
K-points
Nspin
Pseudopotential
etot conv thr
forc conv thr
conv thr
diagonalization
mixing beta
mixing mode

71
430
0.04
999111
0 (Non-magnetic)
Pd.pbe-spn-kjpaw psl.1.0.0.UPF
0.0001
0.001
1.0D-6
david
0.1
plain

Table N.7: Palladium DFT settings

N.6.2

Equation of State and Elastic Constants
Equation of State

−5.12029e2

−5.120299e2

−0.000050

−0.000050

−0.000055

−0.000055

−0.000055

−0.000060
−0.000065
−0.000070

0.001

0.002

0.003

Strain / Alat

0.004

Distortion D4

102.0

102.5

103.0

103.5

−0.000070

0.005

0.000

Distortion D5

−0.000035

Energ / R

−0.000020

−0.000030

−0.000025
−0.000030
−0.000035
−0.000040

0.001

0.002

0.003

Strain / Alat

0.004

0.005

0.001

−5.120299e2

0.002

0.003

Strain / Alat

0.004

0.000

Distortion D8
−0.000032

−0.000034
−0.000036
−0.000038
−0.000040

−0.000042

−0.000042
0.001

0.002

0.003

Strain / Alat

0.004

0.005

0.001

−5.120299e2
−0.000030

−0.000032

−0.000040

0.005

0.004

0.005

0.004

0.005

−0.000035

0.005

−0.000030

−0.000038

0.004

−0.000030

−0.000032

−0.000036

0.003

−0.000025

−0.000030

−0.000034

0.002

Strain / Alat

Distortion D6

−0.000040
0.000

Distortion D7

0.001

−5.120299e2
−0.000015

0.000

Figure N.9: Palladium FCC equation of state plot

Strain / Alat

0.004

−0.000020

Energ / R

Energ / R
101.5

0.003

−0.000015

−5.120299e2

101.0

0.002

−0.000020

−0.00090

100.5

−0.000065

−0.000015

0.000

−0.00100

−0.000060

−0.000080
0.001

−5.120299e2

−0.000025

Distortion D3

−0.000075
0.000

−0.000040

−0.00095

−0.000070

0.005

Energ / R

Energ / R

−5.120299e2

−0.00085

−0.000065

−0.000080
0.000

−0.00080

−0.000060

−0.000075

−0.000080

−0.00075

Energ / R

−0.000045

−0.000050

−0.000075

−0.00070

−5.120299e2

−0.000045

Energ / R

−0.00065

Elastic Constant Curves
Distortion D2

Distortion D1
Energ / R

Energ / R

−5.120299e2
−0.000045

0.002

0.003

Strain / Alat

Distortion D9

−0.000034
−0.000036
−0.000038
−0.000040
−0.000042

0.000

0.001

0.002

0.003

Strain / Alat

0.004

0.005

0.000

0.001

0.002

0.003

Strain / Alat

Figure N.10: Palladium FCC elastic constants plot

430

APPENDIX N. DFT CALCULATED PROPERTIES

N.6.3

N.6. FCC PALLADIUM

Palladium FCC Results File
Listing N.5: Palladium FCC DFT Calculated Properties

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58

################################################################
#
RESULTS
#
################################################################
INPUT SETTINGS
################################
Structure:
Size:
A0:
A0 Units:
A0 (Bohr):
A0 (Angs):

fcc
2
3.89
ang
14.7042
7.7785218

Ecutwfc:
Ecutrho:
Degauss:
Kpoints:
Kpoints Type:
EOS Points:
EOS Strain:
EC Points:
EC Strain:

71
430
0.04
9 9 9 1 1 1
automatic
7
0.005
7
0.005

RELAXED
################################
a0 (Bohr):
CP:

14.8394198232
1.0
0.0
0.0
0.0
1.0
0.0
0.0
0.0
1.0
Volume (Bohr^3/unit cell): 3267.76460963
Density KG/m^3:
11689.7296625
AMU per crystal unit:
3405.4400000000014
Atoms per crystal unit:
32
Total Energy/Ry:
-16384.95810846
Energy per Atom/Ry:
-512.029940889375
Total Force Ry/Bohr:
0.000188
Force per atom Ry/Bohr:
5.875e-06

a0 primitive (Bohr):
a0 primitive (Ang):

7.4197099116
3.9250265432364

EOS
################################
V0 (Bohr^3 / atom):
E0 (Ry / atom):
B0 (RY/BOHR3):
B0 (GPA):
B0P:

103.055133214
-512.029995887
0.012538146479
184.442403779
4.7014295893

EC
################################

431

N.6. FCC PALLADIUM

59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119

APPENDIX N. DFT CALCULATED PROPERTIES

Stiffness (RY/BOHR3):

0.0149806
0.010383
0.0103812
0.0
0.0
0.0

0.010383
0.0149801
0.0103722
0.0
0.0
0.0

0.0103812
0.0103722
0.0149778
0.0
0.0
0.0

0.0
0.0
0.0
0.0055032
0.0
0.0

0.0
0.0
0.0
0.0
0.0055036
0.0

Stiffness (GPA):

218.471929 151.422406 151.395627 0.0
0.0
0.0
151.422406 218.464281 151.264808 0.0
0.0
0.0
151.395627 151.264808 218.430622 0.0
0.0
0.0
0.0
0.0
0.0
80.2564574 0.0
0.0
0.0
0.0
0.0
0.0
80.2629605 0.0
0.0
0.0
0.0
0.0
0.0
80.2449828

Compliance (1/GPA):

0.0105867 -0.0043366 -0.0043346 0.0
-0.0043366 0.0105705 -0.0043144 0.0
-0.0043346 -0.0043144 0.0105702 0.0
0.0
0.0
0.0
0.0124601
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0

0.0
0.0
0.0
0.0
0.012459
0.0

Stability:
C11:
218.471929458 (Stable)
C11C22 - C12C12:
24799.5680651 (Stable)
C11*C22*C33+2*C12*C13*C23-C11*C23*C23-C33*C12*C12: 7353517.38556 (Stable)
C44:
80.256457365 (Stable)
C55:
80.262960524 (Stable)
C66:
80.244982752 (Stable)
Bulk Modulus B (GPA):
BR (GPA):
BV (GPA):

173.725818131
173.725800894
173.725835369

Shear Modulus G (GPA):
GR:
GV:

56.5595512391
51.5472895795
61.5718128987

Young’s Modulus E (GPA):

153.067378318

Poisson’s Ratio v:

0.35315234089

L Elastic Wave V:
T Elastic Wave V:
M Elastic Wave V:

0.145988361768
0.0695585857774
0.0782389075958

Debye Temperature:

0.000471028127273

Melting Point:

1910.0K

References
=======================================

432

0.0
0.0
0.0
0.0
0.0
0.0055024

0.0
0.0
0.0
0.0
0.0
0.0124618

APPENDIX N. DFT CALCULATED PROPERTIES

120
121
122
123
124
125
126
127
128
129
130
131
132

N.6. FCC PALLADIUM

First Principles Calculations of Elastic Properties of Metals
M. J. Mehl, B. M. Klein, D. A. Papaconstantopoulos
1994
Ab Initio Study of the Elastic and Mechanical Properties of B19 TiAl
Y. Wen, L. Wang, H. Liu and L. Song
Crystals
2017
Density functional theory for calculation of elastic properties of orthorhombic crystals - applications to TiSi2
P. Ravindran, Lars Fast, P. A. Korzhavyi, B. Johansson
Journal of Applied Physics
1998

N.6.4

Known and Calculated Values

Structure
𝑎0 (Angs)
Nearest Neighbour
Basis vectors
𝐸𝑐𝑜ℎ (eV)
Bulk Modulus 𝐵0 (GPA)
Bulk Modulus 𝐵0,𝑟 (GPA)
Bulk Modulus 𝐵0,𝑣 (GPA)
Young’s modulus 𝐸 (GPA)
Shear Modulus 𝐺 (GPA)
Poisson Ratio 𝜈

Elastic Constants (GPA)

Palladium FCC

Palladium FCC (this work)

Face Centered Cubic
3.89
2.75
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-3.91
195.5
121
44
0.39
⎡
234 176.1 176.1
⎢
⎢176.1 234 176.1
⎢
⎢176.1 176.1 234
⎢
⎢ 0
0
0
⎢
⎢
⎣ 0
0
0
0
0
0

Face Centered Cubic
3.92
2.77
⎡
⎤
1.0 0.0 0.0
⎢
⎥
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
not calculated
184.4
173.7
173.7
153.1
56.6
0.35
⎤
⎡
218.5 151.4 151.4
0
0
0
⎥
⎢
0
0
0 ⎥
⎢151.4 218.5 151.3
⎥
⎢
⎢151.4 151.3 218.5
0
0
0 ⎥
⎢
⎥
⎢ 0
0
0
80.3
0
0 ⎥
⎢
⎥
⎢
⎥
⎣ 0
0
0
0
80.3
0 ⎦
0
0
0
0
0
80.3

⎤
0
0
0
⎥
0
0
0 ⎥
⎥
0
0
0 ⎥
⎥
71.2
0
0 ⎥
⎥
⎥
0
71.2
0 ⎦
0
0
71.2

Table N.8: FCC Palladium: Experimental Values vs DFT Calculated Properties

433

N.7. FCC RUTHENIUM

APPENDIX N. DFT CALCULATED PROPERTIES

N.7

FCC Ruthenium

N.7.1

Major DFT Settings

Ecutwfc: 71
Ecutrho: 430
Smearing: 0.04
K-points: 9 9 9 1 1 1
Nspin: 1 (non-polarized calculation)
Pseudopotential: Ru 101.07 Ru.pbe-spn-kjpaw psl.1.0.0.UPF

N.7.2

Equation of State and Elastic Constants
Setting

Value

ecutwfc (Ry)
ecutrho
smearing (Ry)
k-points
nspin
pseudopotential
etot conv thr
forc conv thr
conv thr
diagonalization
mixing beta
mixing mode

71
430
0.04
999111
2 (Collinear Spin)
Ru.pbe-spn-kjpaw psl.1.0.0.UPF
0.0001
0.001
1.0D-6
david
0.1
plain

Table N.9: Ruthenium DFT settings

434

APPENDIX N. DFT CALCULATED PROPERTIES

N.7.3

N.7. FCC RUTHENIUM

Ruthenium FCC Results File
Listing N.6: Ruthenium FCC DFT Calculated Properties

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58

################################################################
#
RESULTS
#
################################################################
Fri, 26 Nov 2021 04:44:37 +0000
INPUT SETTINGS
################################
Structure Type:
Size:
A0:
A0 Units:
A0 (Bohr):
A0 (Angs):

fcc
2
4.0
angs
15.12
7.99848

Ecutwfc:
Ecutrho:
Degauss:
Kpoints:
Kpoints Type:
EOS Points:
EOS Strain:
EC Points:
EC Strain:

71
430
0.04
9 9 9 1 1 1
automatic
11
0.005
9
0.005

RELAXED
################################
a0 (Bohr):
CP:

14.4007416
1.0
0.0
0.0
0.0
1.0
0.0
0.0
0.0
1.0
Volume (Bohr^3/unit cell): 2986.445358287136
Density KG/m^3:
12147.856996566989
AMU per crystal unit:
3234.240000000001
Atoms per crystal unit:
32
Total Energy/Ry:
-13813.30088106
Energy per Atom/Ry:
-431.665652533125
Total Force Ry/Bohr:
0.000137
Force per atom Ry/Bohr:
4.28125e-06

a0 primitive (Bohr):
a0 primitive (Ang):

7.2003708
3.8089961532000003

EOS
################################
V0 (Bohr^3 / atom):
E0 (Ry / atom):
B0 (RY/BOHR3):
B0 (GPA):
B0P:

93.41718637560044
-431.66565367812325
0.020926676273491183
307.84187132119206
2.2239400402684173

EC

435

N.7. FCC RUTHENIUM

59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119

APPENDIX N. DFT CALCULATED PROPERTIES

################################
Stiffness (RY/BOHR3):

0.0323332
0.0150236
0.0150295
0.0
0.0
0.0

0.0150236
0.032334
0.0150304
0.0
0.0
0.0

0.0150295
0.0150304
0.0323458
0.0
0.0
0.0

0.0
0.0
0.0
0.0167987
0.0
0.0

0.0
0.0
0.0
0.0
0.0167978
0.0

Stiffness (GPA):

471.535040 219.099143 219.185184 0.0
0.0
0.0
219.099143 471.546672 219.197356 0.0
0.0
0.0
219.185184 219.197356 471.719577 0.0
0.0
0.0
0.0
0.0
0.0
244.986869 0.0
0.0
0.0
0.0
0.0
0.0
244.973541 0.0
0.0
0.0
0.0
0.0
0.0
244.969279

Compliance (1/GPA):

0.0030075 -0.0009538 -0.0009542 0.0
-0.0009538 0.0030075 -0.0009543 0.0
-0.0009542 -0.0009543 0.0030067 0.0
0.0
0.0
0.0
0.0040819
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0

0.0
0.0
0.0
0.0
0.0040821
0.0

0.0
0.0
0.0
0.0
0.0
0.0167975

0.0
0.0
0.0
0.0
0.0
0.0040821

Stability:
C11:
471.535040254 (Stable)
C11C22 - C12C12:
174346.3443625905 (Stable)
C11*C22*C33+2*C12*C13*C23-C11*C23*C23-C33*C12*C12: 80639667.71993023 (Stable)
C44:
244.986869322 (Stable)
C55:
244.97354179 (Stable)
C66:
244.969279805 (Stable)
Bulk Modulus B (GPA):
BR (GPA):
BV (GPA):

303.30717357998026
303.3071627547384
303.3071844052222

Shear Modulus G (GPA):
GR:
GV:

187.73207685789976
177.99024187226613
197.47391184353336

Young’s Modulus E (GPA):

466.87258322673495

Poisson’s Ratio v:

0.24345447789438046

L Elastic Wave V:
T Elastic Wave V:
M Elastic Wave V:

0.21347878392203118
0.12431381857023048
0.1379068118794884

Debye Temperature:

0.0008555430077179703

Melting Point:

3072.0K

References
=======================================

436

APPENDIX N. DFT CALCULATED PROPERTIES

120
121
122
123
124
125
126
127
128
129
130
131
132
133

N.7. FCC RUTHENIUM

First Principles Calculations of Elastic Properties of Metals
M. J. Mehl, B. M. Klein, D. A. Papaconstantopoulos
1994
Ab Initio Study of the Elastic and Mechanical Properties of B19 TiAl
Y. Wen, L. Wang, H. Liu and L. Song
Crystals
2017
Density functional theory for calculation of elastic properties of orthorhombic crystals - applications to TiSi2
P. Ravindran, Lars Fast, P. A. Korzhavyi, B. Johansson
Journal of Applied Physics
1998

N.7.4

Calculated Results
Ruthenium FCC (this work)

Structure
𝑎0 (Angs)
Nearest Neighbour

𝐸𝑐𝑜ℎ (eV)
Bulk Modulus 𝐵0 (GPA)
Bulk Modulus 𝐵0,𝑟 (GPA)
Bulk Modulus 𝐵0,𝑣 (GPA)
Young’s modulus 𝐸 (GPA)
Shear Modulus 𝐺 (GPA)
Poisson Ratio 𝜈

Face
⎡
1.0
⎢
⎣0.0
0.0
-

Elastic Constants (GPA)

-

Basis vectors

Centered Cubic
⎤
0.0 0.0
⎥
1.0 0.0⎦
0.0 1.0

Face Centered Cubic
3.81 Angstrom
2.69 Angstrom
⎡
⎤
1.0 0.0 0.0
⎢
⎥
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-6.62
307.8
303.3
303.3
466.9
187.7
0.24
⎡
471.54 219.10 219.20
⎢
⎢219.10 471.55 219.20
⎢
⎢219.19 219.20 471.72
⎢
⎢ 0
0
0
⎢
⎢
⎣ 0
0
0
0
0
0

Table N.10: Ruthenium FCC: DFT Calculated Properties

437

⎤
0
0
0
⎥
0
0
0 ⎥
⎥
0
0
0 ⎥
⎥
244.99
0
0 ⎥
⎥
⎥
0
244.97
0 ⎦
0
0
244.97

Appendix O

Transferability of Interatomic
Potentials
O.1
O.1.1

Sheng Aluminium Potential
FCC Structure

The EAMPA code was used to compute both the Birch-Murnaghan and Rose-Vinet equations of state using
the known values for Aluminium and the Sheng Al potential[36].

438

APPENDIX O. TRANSFERABILITY

O.1. SHENG ALUMINIUM POTENTIAL

Equation of State

−3.24

−3.26

Energy (e /atom)

−3.28

−3.30

−3.32

−3.34

−3.36

14

15

16

17

Volume (ang^3/atom)

18

19

Figure O.1: Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al
potential

Rose Equation of State
This otential
Rose redicted energy-volume

2

1

Energy (ev/atom)

0

(1

(2

(3

3

4

5

Lattice Constant (ang)

6

7

8

Figure O.2: Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al potential

439

O.2. MENDELEV ET AL 2003 IRON POTENTIAL

O.1.2

O.2

APPENDIX O. TRANSFERABILITY

BCC Structure

Mendelev et al 2003 Iron Potential

The EAMPA code was used to compute both the Birch-Murnaghan and Rose-Vinet equations of state using
the known values for Aluminium and the Sheng Al potential[122].

O.2.1

BCC Structure

O.2.2

FCC Structure

O.3

Ackland et al 1997 Iron Potential

The EAMPA code was used to compute both the Birch-Murnaghan and Rose-Vinet equations of state using
the known values for Aluminium and the Sheng Al potential[Fe˙abch].

O.3.1

BCC Structure

O.3.2

FCC Structure

The EAMPA code was used to compute both the Birch-Murnaghan and Rose-Vinet equations of state using
the known values for Aluminium and the Sheng Al potential[36].

440

APPENDIX O. TRANSFERABILITY

O.3. ACKLAND ET AL 1997 IRON POTENTIAL

Equation of State
−3.175

−3.200

−3.225

Energ (ev/atom)

−3.250

−3.275

−3.300

−3.325

−3.350

14

15

16

Volume (ang^3/atom)

17

18

Figure O.3: Birch Murnaghan equation of state for BCC Aluminium - comparison of experimental data to the Sheng Al
potential

Rose Equation of State
This potential
Rose p edicted ene gy-volume
6

Ene gy (ev/atom)

4

2

0

−2

2

3

4

5

Lattice Constant (ang)

6

7

Figure O.4: Rose-Vinet equation of state for BCC Aluminium - comparison of experimental data to the Sheng Al
potential

441

O.3. ACKLAND ET AL 1997 IRON POTENTIAL

APPENDIX O. TRANSFERABILITY

Equation of State
−3.95

−4.00

−4.05

Energy (ev/atom)

−4.10

−4.15

−4.20

−4.25

−4.30

10.0

10.5

11.0

11.5

12.0

12.5

Volume (ang^3/atom)

13.0

13.5

Figure O.5: Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al
potential

Rose Equation of State
This potential
Rose predicted energy-volume

70

60

Energy (ev/atom)

50

40

30

20

10

0

2

3

4

Lattice Constant (ang)

5

6

7

Figure O.6: Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al potential

442

APPENDIX O. TRANSFERABILITY

O.3. ACKLAND ET AL 1997 IRON POTENTIAL

Equation of State

−3.5

−3.6

Energy (e /atom)

−3.7

−3.8

−3.9

−4.0

−4.1

−4.2

−4.3

10.5

11.0

11.5

12.0

12.5

Volume (ang^3/atom)

13.0

13.5

14.0

Figure O.7: Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al
potential

Rose Equation of State
This potential
Rose predicted energy-volume

40

Energy (ev/atom)

30

20

10

0

3

4

5

Lattice Constant (ang)

6

7

Figure O.8: Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al potential

443

O.3. ACKLAND ET AL 1997 IRON POTENTIAL

APPENDIX O. TRANSFERABILITY

Equation of State
−3.95

−4.00

−4.05

Energy (ev/atom)

−4.10

−4.15

−4.20

−4.25

−4.30

10.0

10.5

11.0

11.5

12.0

12.5

Volume (ang^3/atom)

13.0

13.5

Figure O.9: Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al
potential

Rose Equation of State
This potential
Rose predicted energy-volume

70

60

Energy (ev/atom)

50

40

30

20

10

0

2

3

4

Lattice Constant (ang)

5

6

7

Figure O.10: Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al
potential

444

APPENDIX O. TRANSFERABILITY

O.3. ACKLAND ET AL 1997 IRON POTENTIAL

Equation of State

−3.5

−3.6

Energy (e /atom)

−3.7

−3.8

−3.9

−4.0

−4.1

−4.2

−4.3

10.5

11.0

11.5

12.0

12.5

Volume (ang^3/atom)

13.0

13.5

14.0

Figure O.11: Birch Murnaghan equation of state for FCC Aluminium - comparison of experimental data to the Sheng
Al potential

Rose Equation of State
This potential
Rose predicted energy-volume

40

Energy (ev/atom)

30

20

10

0

3

4

5

Lattice Constant (ang)

6

7

Figure O.12: Rose-Vinet equation of state for FCC Aluminium - comparison of experimental data to the Sheng Al
potential

445

Appendix P

Optimization
P.1
P.1.1

Optimization
Introduction

Optimization is the process of finding the best solution for a problem that may also need to satisfy a number
of imposed constraints. In terms of this work, there are several tasks where optimization plays a key role. The
DFT code used, PWscf, employs the Broyden Fletcher Goldfarb Shanno algorithm to relax structures to give
the optimum volume and optimal structure of an arrangement of atoms. During the fitting of the variety options
of equation of state to the energy-volume points, the Levenberg-Marquardt Algorithm is used. Finally, a genetic
algorithm and simulated annealing algorithm are coupled with LMA to locate the global optimal parameters
for interatomic potential functions.

P.1.2

Continuous and Discrete Optimization

Problems that may be solved using discrete optimisation have, as the name suggests, discrete solutions. An
example would be the travelling salesman problem, where the aim is to minimise the distance travelled by the
salesman between cities. An example of the solution may be city E to A to B to C to D. There’s a set of possible
solutions to the problem. If the problem was changed such that any point within a 1 mile radius of the centre
of each city is a valid solution, and the aim is to find the optimal points to travel between within the area of
each city, it would become a continuous problem.
Fitting interatomic potentials to data is an example of continuous optimisation. The Morse potential takes
three parameters plus the separation r between the two atoms. If the parameters are being optimised such that
Morse potential matches the experimental forces (assuming they could be measured experimentally) between
two atoms for a set of separation values, the choice of parameters isn’t discrete; they are taken from a continuous
range of real numbers.

P.1.3

Constrained and Unconstrained Optimization

There are constraints that may need to be considered, and constraints that apply to the fitting of interatomic
potentials are as follows:
• continuous well behaved function
• continuous first-derivative, smooth change in force wrt r
446

APPENDIX P. OPTIMIZATION

P.1. OPTIMIZATION

• positive electron density
• smooth cutoff at some 𝑟 = 𝑟𝑐𝑢𝑡
• repulsion (ZBL/exponential) as r approaches 0
• continuous second-derivative
• enough parameters coupled with a good choice of functions so the potential is flexible enough to replicate
all the experimental data well
• a small enough range of parameters to keep the parameter space small enough to search in a reasonable
amount of time
• maintain physical elegance
• ignore physical elegance
Certain constraints listed will battle one-another, while others may be dropped, such as restricting to positive
electron-densities if the choice to ignore physical elegance is selected.

P.1.4

Global and Local Optimization

An example to discuss the difference between local and global optimization will be given in a very literal sense.
I am located near Birmingham, and I wish to find the highest point local to me. Using a modern smartphone
and map I could quickly find the nearest hill to my current position; this would be the local maxima. I would,
however, need to go up and down many peaks and troughs, scouring the entire surface of the Earth, until I
found the global maxima, somewhere amongst the many peaks and troughs in the Himalayas.
When optimising the parameters of a function, it is relatively easy to find a local extreme that would give me
the optimum parameters locally. It is a much harder task to find the global optimum, especially if very little,
or nothing at all, is known about the function for which the parameters are being optimised.

P.1.5

Global Optimization Algorithms

Simulated Annealing
A large amount of computing power is required today to solve many problems in Physics. The optimum
arrangement of Iron atoms, at various concentrations and temperatures is one such example, but nature knows
the correct structure it should take because it has access to the rule book. It makes perfect sense to look to
nature when designing optimisation algorithms.
Simulated annealing mimics the way a solid cools, with its atoms settling into the optimum relaxed positions
as time passes. Initially, the solid is hot and the atoms are able to take non-optimal positions, but as the solid
cools the atoms take their optimal places. The heating allows the atoms to move from non-optimal positions in
the initial configuration.
The algorithm was originally developed to improve upon the Metropolis algorithm, solving the issue of becoming
stuck in non-global minima. Motivation for the algorithm included applying it to the optimum placement of
chips on a circuit board[200], the travelling salesman (and similar) problem as well as finding the optimum
arrangement of atoms.

447

P.1. OPTIMIZATION

APPENDIX P. OPTIMIZATION

Listing P.1: Pseudocode for the simulated annealing algorithm
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17

# Calculate the starting rss
rss = get_rss(p)
# Loop (n times, until a threshold is met, time runs out etc)
while(loop)
{
p_new = vary(p)
# Make a new set of parameters
rss_new = get_rss(p_new) # Get rss for these parameters
# Always accept BETTER
# Sometimes accept WORSE (depends on temperature and how bad it is)
if(rss_new < rss or rand(0.0,1.0) < exp((rss-rss_new) / temp))
{
p = p_new
rss = rss_new
}
}

The simulated annealing algorithm takes in a starting set of parameters. These are varied and, if the new
parameters give a better solution to the problem, the parameters are updated. However, there is a chance
that a worse set of parameters are used, and this depends on how bad they are and the current value of the
temperature in the algorithm (listing P.1). The algorithm used is this work is available in the appendix (section
Q.5).
Genetic Algorithm
It is unclear whether life started on this planet, or was brought to this planet, and this idea only removes the
problem of how life as we are able to understand it was conceived to a different time and place. However it
started, there is evidence of life on this planet approximately 3.5 billion years ago. Prokaryotes were the simple
single cell organisms that inhabited our planet for billions of these. Their cell does not have a nucleus and the
genetic information is contained in RNA and DNA within the cell.
Approximately 1.5 billion years ago, life made a leap forward in complexity and evolved into the first Eukaryotic
cells. These are larger and more complex than Prokaryotes, and the genetic material is stored within a nucleus.
Through processes of inheritance, variation, natural selection and the vast expanse of time, more complex
organisms developed.
A set of solutions are bred with one another, and where there is an improvement the new variation is reinserted
into the gene pool. There is a danger that the population can become a set of clones, so a large pool of sets
of parameters is required, fresh parameters proposed every so often as well as a mechanism to prevent clones
appearing.
As simulated annealing takes inspiration from cooling solids, genetic algorithms take inspiration from evolution.
The algorithm used is this work is available in the appendix (section Q.5).
Basin-Hopping
Lennard-Jones clusters are test systems of atoms models using the potential of the same name. Clusters of
varying sizes have an optimal configuration with the minimum amount of energy. An algorithm was developed
in the 1990s to improve upon existing global search algorithms and was applied to clusters of between 2 and 110
atoms[201]. The resulting basin-hopping algorithm allowed Wales and Doye to find three previously unknown
minima.

448

APPENDIX P. OPTIMIZATION

P.1. OPTIMIZATION

˜ 𝑋)
⃗ = 𝑚𝑖𝑛 (𝐸(⃗𝑥))
𝐸(

(P.1)

⃗ is the coordinates of the atoms. A
The objective of the algorithm was to solve eq. P.1 where the vector 𝑋
number of iterations, set by the user, are stepped through. The co-ordinates are randomly perturbed before
the local minima is determined by using a local optimizer such as BFGS, LM-BFGS or CG[202]. Similar to SA,
the minimized parameters are either accepted or discarded dependent upon how good the new parameters are.

P.1.6

Local Optimization Algorithms

Quadratric Programming (QP)
The method of Quadratric Programming, or quadratic optimization, is the task of minimising the matrix
equation eq. P.2 subject to imposed conditions[124].

1 𝑇⃗
⃗𝑥 𝐺⃗𝑥 + ⃗𝑥𝑇 𝑐
2
subject to 𝑎𝑇𝑖 𝑥 = 𝑏𝑖 , 𝑖 ∈ 𝜀

𝑚𝑖𝑛𝑥 𝑞(⃗𝑥) =

(P.2)

𝑎𝑇𝑖 𝑥 ≥ 𝑏𝑖 , 𝑖 ∈ 𝐼

This is the method used by Bonny et al. in their potential fitting program and will be discussed in section 5.6.
Gradient Descent
The gradient descent method it a reliable way of searching for a local minimum. It requires only the first
derivative coupled with a line search to move closer to the minimum point. Close to the minimum, it is slower
than the Newton-Gauss and LMA, but these require the computation of the Jacobian to estimate the Hessian
matrix, so these are more computationally intensive. A pseudocode for the algorithm is available in the appendix
(section Q.5).
Newton-Gauss
The Newton-Gauss method is an algorithm that finds the local minimum of a function by approximating the
Hessian matrix with the Jacobian and its transpose (eq. P.3). By estimating the Hessian, the algorithm only
requires the computation of the first order derivatives with respect to each parameter, at each point pair x,
y. It is possible to use the function and the analytical derivative, but as this work requires the calculation of
functions that have no simple analytical form, the first derivative will be approximated within the algorithm.

𝐽⃗𝑇 𝐽⃗𝑝⃗ = 𝐽⃗𝑇 ⃗𝑟
⃗𝑟 = ⃗𝑦 − 𝑓 (⃗𝑥, 𝑝⃗)

(P.3)

Close to a minima, the NG method quickly moves to the optimum point. Depending on the starting point, it
may converge only to a local minimum, and not the global, and it may also be unstable, not converging at all.

449

P.1. OPTIMIZATION

APPENDIX P. OPTIMIZATION

Levenberg Marquardt
The LMA is a NG type algorithm that includes the addition of a dampening term that helps to increase the
robustness of the algorithm. The particular algorithm here uses a number of other schemes to improve the
overall effectiveness of the algorithm. The equation at the center of the algorithm is similar to that of NG (eq.
P.4).
(︁

(︁
)︁)︁
(︁
)︁
⃗ 𝐽⃗ + 𝜆𝑑𝑖𝑎𝑔 𝐽⃗𝑇 𝑊
⃗ 𝐽⃗ 𝑝⃗ = 𝐽⃗𝑇 𝑊
⃗ ⃗𝑟
𝐽⃗𝑇 𝑊

(P.4)

⃗𝑟 = ⃗𝑦 − 𝑓 (⃗𝑥, 𝑝⃗)

The starting value for lambda is calculated as a function of the estimate of the Hessian and a cutoff for lambda
is introduced to remove dampening altogether. A delayed gratification scheme has also been introduced to
increase lambda by 50 percent if the trial solution is worse, and to decrease lambda by a factor of 5 if the trial
solution is better. Finally, a diagonal weighting matrix has been included to allow certain parameters to be
preferential during their optimisation.
Conjugate Gradient
In the method of steepest decent an initial value is selected and the gradient at that point is computed. This
gives a search direction to look in and, following a line search, a new point is selected where the gradient is
orthogonal to the search gradient. The process is iterative and at each new point the search gradient is replaced
with the new orthogonal gradient (eq. P.5[203]).

𝑟(𝑖) = 𝑏 − 𝐴𝑥(𝑖)
𝛼=

𝑟𝑖𝑇 𝑟(𝑖)
𝑇 𝐴𝑟
𝑟(𝑖)
(𝑖)

(P.5)

𝑥(𝑖+1) = 𝑥(𝑖) + 𝛼(𝑖) 𝑟(𝑖)
The conjugate gradient method is similar.

𝑑(0) = 𝑟(0) = 𝑏 − 𝐴𝑥(0)
𝛼𝑖 =

𝑇
𝑟(𝑖)
𝑟(𝑖)

𝑑𝑇(𝑖) 𝐴𝑑(𝑖)

𝑥(𝑖+1) = 𝑥(𝑖) + 𝛼(𝑖) 𝑑(𝑖)
𝑟(𝑖+1) = 𝑟(𝑖) − 𝛼(𝑖) 𝐴𝑑(𝑖)
𝛽(𝑖+1) =

𝑇
𝑟(𝑖+1)
𝑟(𝑖+1)
𝑇 𝑟
𝑟(𝑖)
(𝑖)

𝑑(𝑖+1) = 𝑟(𝑖+1) + 𝛽(𝑖+1) 𝑑(𝑖)
Broyden Fletcher Goldfarb Shanno
The BFGS method is a Quazi-Newton method where the Hessian is approximated in eq. P.7[124].

450

(P.6)

APPENDIX P. OPTIMIZATION

P.1. OPTIMIZATION

𝑇
𝑇
⃗ 𝑘+1 = 𝐵
⃗ 𝑘 − 𝐵𝑘 𝑆𝑘 𝑆𝑘 𝐵𝑘 + 𝑦𝑘 𝑦𝑘
𝐵
𝑇
𝑇
𝑆𝑘 𝐵𝑘 𝑆𝑘
𝑦𝑘 𝑠𝑘

(P.7)

This optimzation method is implemented in SciPy in Python along with a number of other methods listed here.

451

Appendix Q

EAMPA Code
The full code is available at https://github.com/BenPalmer1983/eampa
Several of the important functions and subroutines that make up the code are listed below.

Q.1

Energy, Force, and Stress Subroutine
Listing Q.1: Energy, Force and Stress subroutine (Fortran)

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32

SUBROUTINE efs(nlabels, r, rvec, inhalo, clabels, volume, energy, forces, stress)
!############################################################
IMPLICIT NONE
!############################################################
INTEGER(kind=StandardInteger), INTENT(IN) :: nlabels(:,:)
REAL(kind=DoubleReal), INTENT(IN) ::
r(:)
REAL(kind=DoubleReal), INTENT(IN) ::
rvec(:, :)
INTEGER(KIND=StandardInteger), INTENT(IN) :: inhalo(:)
INTEGER(KIND=StandardInteger), INTENT(IN) :: clabels(:)
REAL(kind=DoubleReal), INTENT(IN) ::
volume
REAL(kind=DoubleReal), INTENT(INOUT) ::
energy(1:3)
REAL(kind=DoubleReal), INTENT(INOUT) ::
forces(:, :)
REAL(kind=DoubleReal), INTENT(INOUT) ::
stress(:, :)
!############################################################
INTEGER(KIND=StandardInteger) :: n, cc, nc, fn, fgroup
INTEGER(KIND=StandardInteger) :: i, j
REAL(kind=DoubleReal), ALLOCATABLE ::
density(:,:)
REAL(kind=DoubleReal), ALLOCATABLE ::
nl_force(:,:)
REAL(kind=DoubleReal), ALLOCATABLE ::
fgradA(:)
REAL(kind=DoubleReal), ALLOCATABLE ::
fgradB(:)
REAL(kind=DoubleReal), ALLOCATABLE ::
dgradA(:)
REAL(kind=DoubleReal), ALLOCATABLE ::
dgradB(:)
REAL(kind=DoubleReal), ALLOCATABLE ::
density_thread(:,:)
REAL(kind=DoubleReal), ALLOCATABLE ::
nl_force_thread(:,:)
REAL(kind=DoubleReal) ::
energy_thread(1:3)
REAL(kind=DoubleReal) ::
forces_thread(1:SIZE(forces,1), 1:SIZE(forces,2))
REAL(kind=DoubleReal) ::
y(1:2)
REAL(kind=DoubleReal) ::
fv(1:3)
!############################################################
! Neighbourlist Count
nc = SIZE(nlabels, 1)
cc = SIZE(clabels, 1)

33
34

! Allocate density array

452

APPENDIX Q. EAMPA CODE

35
36
37
38
39
40
41
42

Q.1. ENERGY, FORCE, AND STRESS SUBROUTINE

ALLOCATE(density(1:cc, 0:group_max-1))
ALLOCATE(density_thread(1:cc, 0:group_max-1))
ALLOCATE(fgradA(0:group_max-1))
ALLOCATE(fgradB(0:group_max-1))
ALLOCATE(dgradA(0:group_max-1))
ALLOCATE(dgradB(0:group_max-1))
ALLOCATE(nl_force(1:nc, 1:3))
ALLOCATE(nl_force_thread(1:nc, 1:3))

43
44
45
46
47
48
49
50

! Zero
energy = 0.0D0
density = 0.0D0
forces = 0.0D0
stress = 0.0D0
nl_force = 0.0D0

51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69

!$OMP PARALLEL &
!$OMP PRIVATE(n, y, fgroup, fn, energy_thread, density_thread, &
!$OMP forces_thread, fv, nl_force_thread) &
!$OMP SHARED(nc, nlabels, r, rvec, energy, density, forces, nl_force)
energy_thread(1) = 0.0D0
density_thread(:,:) = 0.0D0
forces_thread(:,:) = 0.0D0
nl_force_thread(:,:) = 0.0D0
!$OMP DO
DO n = 1, nc
! PAIR ENERGY
CALL getparr(1, nlabels(n,1), nlabels(n,2), 0, r(n), y)
energy_thread(1) = energy_thread(1) + y(1)
! PAIR FORCE
fv(:) = y(2) * rvec(n, 1:3)
forces_thread(nlabels(n, 3), 1:3) = forces_thread(nlabels(n, 3), 1:3) + fv(1:3)
forces_thread(nlabels(n, 4), 1:3) = forces_thread(nlabels(n, 4), 1:3) - fv(1:3)
nl_force_thread(n, 1:3) = -fv(1:3)

70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95

! DENSITY
IF(nlabels(n,1) .EQ. nlabels(n,2))THEN
fn = 0
DO WHILE(dens_index_a(nlabels(n,1), fn) .GT. -1)
fgroup = dens_index_a(nlabels(n,1), fn)
CALL getp(2, nlabels(n,1), -1, fgroup, r(n), y(1))
density_thread(nlabels(n,4), fgroup) = density_thread(nlabels(n,4),
density_thread(nlabels(n,3), fgroup) = density_thread(nlabels(n,3),
fn = fn + 1
END DO
ELSE
fn = 0
DO WHILE(dens_index_a(nlabels(n,1), fn) .GT. -1)
fgroup = dens_index_a(nlabels(n,1), fn)
CALL getp(2, nlabels(n,1), -1, fgroup, r(n), y(1))
density_thread(nlabels(n,4), fgroup) = density_thread(nlabels(n,4),
fn = fn + 1
END DO
fn = 0
DO WHILE(dens_index_a(nlabels(n,2), fn) .GT. -1)
fgroup = dens_index_a(nlabels(n,2), fn)
CALL getp(2, nlabels(n, 2), -1, fgroup, r(n), y(1))
density_thread(nlabels(n,3), fgroup) = density_thread(nlabels(n,3),
fn = fn + 1
END DO

453

fgroup) + y(1)
fgroup) + y(1)

fgroup) + y(1)

fgroup) + y(1)

Q.1. ENERGY, FORCE, AND STRESS SUBROUTINE

96
97
98
99
100
101
102
103
104
105

APPENDIX Q. EAMPA CODE

END IF
END DO
!$OMP END DO
!$OMP CRITICAL
energy(1) = energy(1) + energy_thread(1)
density(:,:) = density(:,:) + density_thread(:,:)
forces(:,:) = forces(:,:) + forces_thread(:,:)
nl_force(:,:) = nl_force(:,:) + nl_force_thread(:,:)
!$OMP END CRITICAL
!$OMP END PARALLEL

106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139

! Embedding Energy
! If a small number of atoms, just use one thread
IF(cc .LE. 100)THEN
DO n = 1, cc
fn = 0
DO WHILE(embe_index_a(clabels(n), fn) .GT. -1)
fgroup = embe_index_a(clabels(n), fn)
CALL getp(3, clabels(n), -1, fgroup, density(n, fgroup), y(1))
energy(2) = energy(2) + y(1)
fn = fn + 1
END DO
END DO
ELSE
!$OMP PARALLEL &
!$OMP PRIVATE(n, y, fgroup, fn, energy_thread) &
!$OMP SHARED(cc, nlabels, clabels, energy, density)
energy_thread(2) = 0.0D0
!$OMP DO
DO n = 1, cc
fn = 0
DO WHILE(embe_index_a(clabels(n), fn) .GT. -1)
fgroup = embe_index_a(clabels(n), fn)
CALL getp(3, clabels(n), -1, fgroup, density(n, fgroup), y(1))
energy_thread(2) = energy_thread(2) + y(1)
fn = fn + 1
END DO
END DO
!$OMP END DO
!$OMP CRITICAL
energy(2) = energy(2) + energy_thread(2)
!$OMP END CRITICAL
!$OMP END PARALLEL
END IF

140
141
142
143
144
145
146
147
148
149
150
151
152

! Embedding Force
!$OMP PARALLEL &
!$OMP PRIVATE(n, fgroup, fn, forces_thread, dgradA, dgradB, fgradA, fgradB, fv) &
!$OMP SHARED(nc, nlabels, rvec, density, forces)
forces_thread(:,:) = 0.0D0
nl_force_thread(:,:) = 0.0D0
!$OMP DO
DO n = 1, nc
dgradA(:) = 0.0D0
dgradB(:) = 0.0D0
fgradA(:) = 0.0D0
fgradB(:) = 0.0D0

153
154
155
156

! Loop through groups and compute density and embedding gradients
fn = 0
DO WHILE(embe_index_a(nlabels(n, 1), fn) .GT. -1)

454

APPENDIX Q. EAMPA CODE

157
158
159
160
161
162
163

Q.2. NEIGHBOUR LIST SUBROUTINE

fgroup = embe_index_a(nlabels(n, 1), fn)
CALL getpgrad(2, nlabels(n,1), -1, fgroup, r(n), dgradA(fgroup))
CALL getpgrad(2, nlabels(n,2), -1, fgroup, r(n), dgradB(fgroup))
CALL getpgrad(3, nlabels(n,1), -1, fgroup, density(nlabels(n, 3), fgroup), fgradA(fgroup))
CALL getpgrad(3, nlabels(n,2), -1, fgroup, density(nlabels(n, 4), fgroup), fgradB(fgroup))
fn = fn + 1
END DO

164
165
166
167
168
169
170
171
172
173
174
175
176

! Compute forces
fv(1:3) = SUM(fgradA(:) * dgradB(:) + fgradB(:) * dgradA(:)) * rvec(n, 1:3)
forces_thread(nlabels(n, 3), 1:3) = forces_thread(nlabels(n, 3), 1:3) + fv(1:3)
forces_thread(nlabels(n, 4), 1:3) = forces_thread(nlabels(n, 4), 1:3) - fv(1:3)
nl_force_thread(n, 1:3) = -fv(1:3)
END DO
!$OMP END DO
!$OMP CRITICAL
forces(:,:) = forces(:,:) + forces_thread(:,:)
nl_force(:,:) = nl_force(:,:) + nl_force_thread(:,:)
!$OMP END CRITICAL
!$OMP END PARALLEL

177
178
179

! Energy (pair + embed)
energy(3) = SUM(energy(1:2))

180
181
182
183
184
185
186
187
188
189
190
191

! Stress
DO n = 1, nc
IF(inhalo(n) .NE. 0)THEN
DO i = 1,3
DO j = 1,3
stress(i,j) = stress(i,j) + (rvec(n, i) * nl_force(n,j))
END DO
END DO
END IF
END DO
stress(1:3, 1:3) = stress(1:3, 1:3) / (2.0D0 * volume)

192
193
194
195
196
197
198
199
200

DEALLOCATE(density)
DEALLOCATE(density_thread)
DEALLOCATE(fgradA)
DEALLOCATE(fgradB)
DEALLOCATE(dgradA)
DEALLOCATE(dgradB)

201
202

END SUBROUTINE efs

Q.2

Neighbour List Subroutine
Listing Q.2: Energy, Force and Stress subroutine (Fortran)

1
2
3
4
5
6
7
8

SUBROUTINE nl(clabels, cin, a0, uv, rcut, nl_labels, r, rvec, nlhalo, nlsize)
!############################################################
IMPLICIT NONE
!############################################################
INTEGER(kind=StandardInteger), INTENT(IN) :: clabels(:)
REAL(kind=DoubleReal), INTENT(IN) :: cin(:,:)
REAL(kind=DoubleReal), INTENT(IN) :: a0
REAL(kind=DoubleReal), INTENT(IN) :: uv(1:3,1:3)

455

Q.2. NEIGHBOUR LIST SUBROUTINE

9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29

APPENDIX Q. EAMPA CODE

REAL(kind=DoubleReal), INTENT(IN) :: rcut
INTEGER(kind=StandardInteger), INTENT(INOUT) :: nl_labels(:,:)
REAL(kind=DoubleReal), INTENT(INOUT) :: r(:)
REAL(kind=DoubleReal), INTENT(INOUT) :: rvec(:, :)
INTEGER(kind=StandardInteger), INTENT(INOUT) :: nlhalo(:)
INTEGER(kind=StandardInteger), INTENT(OUT) :: nlsize
!############################################################
REAL(kind=DoubleReal) :: ccoords(1:SIZE(cin,1),1:3)
REAL(kind=DoubleReal) :: gcoords(1:27*SIZE(cin,1),1:3)
INTEGER(kind=StandardInteger) :: glabels(1:27*SIZE(cin,1))
INTEGER(kind=StandardInteger) :: gids(1:27*SIZE(cin,1))
INTEGER(kind=StandardInteger) :: halo(1:27*SIZE(cin,1))
REAL(kind=DoubleReal) :: rcutsq
REAL(kind=DoubleReal) :: rsq
REAL(kind=DoubleReal) :: shift(1:3)
REAL(kind=DoubleReal) :: rvect(1:3)
INTEGER(kind=StandardInteger) :: m, n, i, j, k
!############################################################
DO n=1,SIZE(cin, 1)
ccoords(n, :) = a0 * MATMUL(uv, cin(n, :))
END DO

30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47

m = 0
DO i=-1,1
DO j=-1,1
DO k=-1,1
DO n=1, SIZE(cin, 1)
m = m + 1
shift(1) = i
shift(2) = j
shift(3) = k
gcoords(m, :) = a0 * MATMUL(uv, cin(n, :) + shift(:))
glabels(m) = clabels(n)
gids(m) = n
halo(m) = i + 3 * j + 9 * k
END DO
END DO
END DO
END DO

48
49

rcutsq = rcut * rcut

50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69

k = 0
DO n=1, SIZE(ccoords, 1)
DO m=1, SIZE(gcoords, 1)
IF(gids(m) .GT. n)THEN
rvect(:) = gcoords(m, :) - ccoords(n, :)
rsq = SUM(rvect(:)**2)
IF(rsq .LE. rcutsq)THEN
k = k + 1
nl_labels(k, 1) = clabels(n)
nl_labels(k, 2) = glabels(m)
nl_labels(k, 3) = n
nl_labels(k, 4) = gids(m)
r(k) = sqrt(rsq)
rvec(k, :) = rvect(:) / r(k)
nlhalo(k) = halo(m)
END IF
END IF
END DO
END DO

456

APPENDIX Q. EAMPA CODE

70

Q.3. FORTRAN PROGRAMMED FUNCTIONS

nlsize = k

71
72
73

!############################################################
END SUBROUTINE nl

Q.3

Fortran Programmed Functions
Listing Q.3: Polynomial Embedding (Fortran)

1
2
3
4

!# Polynomial embedding
!# General function for embedding functions
!# like F(r) = sqrt(r)
!#
F(r) = A sqrt(r) + B r**2 + C r**3

5
6
7
8
9
10
11
12
13
14
15
16
17
18
19

SUBROUTINE polynomial_embedding(r, p, p_fixed, y)
!############################################################
! f(x) = (N r^3 e^(-z r))^2
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
!# Coeff
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:) !# Power
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
INTEGER(kind=StandardInteger) :: n
!############################################################
y = 0.0D0

20
21
22
23

IF(SIZE(p,1) .NE. SIZE(p_fixed,1))THEN
RETURN
END IF

24
25
26
27

DO n = 1, SIZE(p,1)
y = y + p(n) * r**p_fixed(n)
END DO

28
29

END SUBROUTINE polynomial_embedding

30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47

SUBROUTINE polynomial_embedding_v(r, p, p_fixed, y)
!############################################################
!
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
DO n = 1, SIZE(r,1)
CALL polynomial_embedding(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE polynomial_embedding_v

Listing Q.4: Polynomial Embedding Gradient (Fortran)
1

!# Polynomial embedding (GRAD)

457

Q.3. FORTRAN PROGRAMMED FUNCTIONS

2
3
4

APPENDIX Q. EAMPA CODE

!# General function for embedding functions
!# like F(r) = sqrt(r)
!#
F(r) = A sqrt(r) + B r**2 + C r**3

5
6
7
8
9
10
11
12
13
14
15
16
17
18
19

SUBROUTINE polynomial_embedding_grad(r, p, p_fixed, y)
!############################################################
! f(x) = (N r^3 e^(-z r))^2
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
!# Coeff
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:) !# Power
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
INTEGER(kind=StandardInteger) :: n
!############################################################
y = 0.0D0

20
21
22
23

IF(SIZE(p,1) .NE. SIZE(p_fixed,1))THEN
RETURN
END IF

24
25
26
27

DO n = 1, SIZE(p,1)
y = y + (p(n) * p_fixed(n)) * r**(p_fixed(n) - 1.0D0)
END DO

28
29

END SUBROUTINE polynomial_embedding_grad

30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47

SUBROUTINE polynomial_embedding_grad_v(r, p, p_fixed, y)
!############################################################
!
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
DO n = 1, SIZE(r,1)
CALL polynomial_embedding_grad(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE polynomial_embedding_grad_v

Listing Q.5: Spline (Fortran)
1
2
3

! POWER SPLINE
! sum (ai (r - ri)^3 H(ri - r)) - cubic example
! sum (ai (r - ri)^5 H(ri - r)) - quintic example

4
5
6
7
8
9
10
11
12
13

! SCALAR SUBROUTINE
SUBROUTINE spline(r, p, p_fixed, y)
!############################################################
! p coefficients
! pf r cutoffs
! they must be the same size
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r

458

APPENDIX Q. EAMPA CODE

14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37

Q.3. FORTRAN PROGRAMMED FUNCTIONS

REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
INTEGER(kind=StandardInteger) :: ps, pfs, ss
REAL(kind=DoubleReal) :: settings(1:10)
REAL(kind=DoubleReal) :: nodes(1:SIZE(p,1))
REAL(kind=DoubleReal) :: rk
INTEGER(kind=StandardInteger) :: n, k
! Settings
INTEGER(kind=StandardInteger) :: power_lower
INTEGER(kind=StandardInteger) :: power_upper
INTEGER(kind=StandardInteger) :: rkoption
REAL(kind=DoubleReal) :: zbl_qa
REAL(kind=DoubleReal) :: zbl_qb
REAL(kind=DoubleReal) :: h_node_r = 0.0D0
REAL(kind=DoubleReal) :: h_node_c = 0.0D0
INTEGER(kind=StandardInteger) :: h_node_p
REAL(kind=DoubleReal) :: yzbl
!############################################################
y = 0.0D0
ss = 10
ps = SIZE(p,1)
pfs = SIZE(p_fixed,1)

38
39
40
41

IF(pfs .LT. ss)THEN
RETURN
END IF

42
43
44
45
46
47
48
49
50
51
52

!Read Settings
settings(1:ss) = p_fixed(1:ss)
power_lower = INT(settings(1)) ! 3, 5 etc
power_upper = INT(settings(2)) !
rkoption = INT(settings(3)) ! 0 = (rk - r)^n 1 = (r - rk)^n
zbl_qa = settings(4)
zbl_qb = settings(5)
h_node_r = settings(6) ! Hardening node rcutoff
h_node_c = settings(7) ! Hardening node coefficient
h_node_p = INT(settings(8)) ! Hardening node power

53
54
55
56
57
58

IF(pfs .NE. (ps + ss))THEN
RETURN
END IF
nodes(1:ps) = p_fixed(ss+1:pfs)

59
60
61
62

IF(r .GT. nodes(ps))THEN
RETURN
END IF

63
64
65
66
67

! Hardening node (See G. Bonny 2012 code)
IF(h_node_r .GT. 0.0D0 .AND. r .LE. h_node_r)Then
y = y + h_node_c * (h_node_r - r)**h_node_p
END IF

68
69
70
71
72
73
74

! Power spline
k = power_lower
DO n = 1, ps
rk = nodes(n)
IF((rk - r) .GE. 0.0D0)THEN
IF(rkoption .EQ. 0)THEN

459

Q.4. MAIN FITTING CLASS

75
76
77
78
79
80
81
82
83
84
85

APPENDIX Q. EAMPA CODE

y = y + p(n) * (rk - r)**k
ELSE
y = y + p(n) * (r - rk)**k
END IF
END IF
IF(k .LT. power_upper)THEN
k = k + 1
ELSE
k = power_lower
END IF
END DO

86
87
88
89
90
91

! Add ZBL
IF(zbl_qa .GT. 0.0D0 .AND. zbl_qb .GT. 0.0D0)THEN
CALL fzbl(r, zbl_qa, zbl_qb, yzbl)
y = y + yzbl
END IF

92
93
94
95
96
97
98

END SUBROUTINE spline

99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118

! VECTOR SUBROUTINE
SUBROUTINE spline_v(r, p, p_fixed, y)
!############################################################
! CUBIC SPLINE
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
! Loop through all the values in r(:), calculate and store in y(:)
DO n = 1, SIZE(r,1)
CALL spline(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE spline_v

Q.4

Main fitting class
Listing Q.6: Fitting Class (Python)

1

#!/bin/python3

2
3
4
5
6

import
import
import
import

numpy
time
os
sys

7
8
9

from scipy.optimize import minimize
from scipy.optimize import basinhopping

10

460

APPENDIX Q. EAMPA CODE

11
12
13

Q.4. MAIN FITTING CLASS

from f_toolbox import atom
from f_toolbox import math
from f_toolbox import transforms

14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33

from
from
from
from
from
from
from
from
from
from
from
from
from
from
from
from
from
from
from

g import g
ds import ds
display import display
configs import configs
nl import nl
output import output
plot import plot
relax import relax
eos import eos
bp import bp
units import units
potential import potential
rss import rss
search_step import search_step
simulated_annealing import simulated_annealing
genetic_algorithm import ga
random_search import random_search
hybrid_search import hybrid_search
wide_search import wide_search

34
35

class potfit:

36
37
38
39
40
41

@staticmethod
def run():
# Log
output.log("Potfit", verbose=0)

42
43
44

# Make dirs
potfit.make_dirs()

45
46
47

# Turn off terminal log
g.verbose[’print’] = -1

48
49
50

# Create storage dictionary
potfit.set_potfit_store()

51
52
53

# Parameters
p = potential.get_p()

54
55
56
57
58
59

if(p is None):
output.log("No parameters to optimise", verbose=0)
output.log("End", verbose=0)
exit()

60
61
62
63
64
65
66

g.potfit[’potfit_start_time’] = time.time()
for sn in range(len(g.potfit_steps)):
if(sn > 0):
p = ds.potential_p(g.potfit[’p_best’])
g.potfit[’sn’] = sn
g.potfit[’sn_counter’] = 0

67
68
69
70
71

g.potfit_steps[sn][’stats_rss’][0] = g.potfit[’rss_best’]
g.potfit_steps[sn][’stats_start_time’] = time.time()
g.potfit_steps[sn][’stats_start_counter’] = g.calc_counter

461

Q.4. MAIN FITTING CLASS

APPENDIX Q. EAMPA CODE

72
73
74
75
76
77
78
79
80
81

82
83

84
85
86
87
88
89
90
91
92
93
94
95
96
97

# Run
if(g.potfit_steps[sn][’type’].lower() == ’rand’):
p = random_search.run(potfit.get_rss, p, niter=g.potfit_steps[sn][’niter’])
elif(g.potfit_steps[sn][’type’].lower() == ’ws’):
p = wide_search.run(potfit.get_rss, p)
elif(g.potfit_steps[sn][’type’].lower() == ’sa’):
p = simulated_annealing.run(potfit.get_rss, p,
niter=g.potfit_steps[sn][’niter’], titer=g.potfit_steps[sn][’titer’], tstart=g.
potfit_steps[sn][’tstart’], tend=g.potfit_steps[sn][’tend’], pfact=g.
potfit_steps[sn][’pfact’], pvar=g.potfit_steps[sn][’pvar’], vartype=g.
potfit_steps[sn][’vartype’], gaussian=g.potfit_steps[sn][’gaussian’])
elif(g.potfit_steps[sn][’type’].lower() == ’ga’):
p = ga.run(potfit.get_rss, p, niter=g.potfit_steps[sn][’niter’], popsize=g.potfit_steps[sn][’popsize’],
fresh=g.potfit_steps[sn][’fresh’], threshold=1.0e20, min_final=True)
elif(g.potfit_steps[sn][’type’].lower() == ’hs’):
p = hybrid_search.run(potfit.get_rss, p,
pool_size=g.potfit_steps[sn][’poolsize’],
sample_size=g.potfit_steps[sn][’samplesize’],
minima_size=g.potfit_steps[sn][’minsize’])
elif(g.potfit_steps[sn][’type’].lower() == ’bh’):
res = basinhopping(potfit.get_rss, p, niter=g.potfit_steps[sn][’niter’], T=10.0, stepsize=1.0)
p = res[’x’]
elif(g.potfit_steps[sn][’type’].lower() == ’bfgs’):
res = minimize(potfit.get_rss, p, method=’BFGS’, options={’gtol’: 1.0e-6, ’maxiter’: 4, })
p = res[’x’]
elif(g.potfit_steps[sn][’type’].lower() == ’cg’):
res = minimize(potfit.get_rss, p, method=’cg’, options={’gtol’: 1.0e-6, ’maxiter’: 4, })
p = res[’x’]

98
99
100
101
102
103
104

# Record stats
g.potfit_steps[sn][’stats_rss’][1] = g.potfit[’rss_best’]
g.potfit_steps[sn][’stats_time’] = time.time() - g.potfit_steps[sn][’stats_start_time’]
g.potfit_steps[sn][’stats_counter’] = g.calc_counter - g.potfit_steps[sn][’stats_start_counter’]
g.potfit_steps[sn][’stats_speed’] = g.potfit_steps[sn][’stats_counter’] / g.potfit_steps[sn][’stats_time’]
g.potfit_steps[sn][’stats_complete’] = True

105
106
107
108

# End fitting
potfit.end()

109
110
111
112
113
114

@staticmethod
def end(interupt=False):
g.potfit[’potfit_end_time’] = time.time()

115
116
117
118
119
120
121
122

if(interupt):
sn = g.potfit[’sn’]
g.potfit_steps[sn][’stats_rss’][1] = g.potfit[’rss_best’]
g.potfit_steps[sn][’stats_time’] = time.time() - g.potfit_steps[sn][’stats_start_time’]
g.potfit_steps[sn][’stats_counter’] = g.calc_counter - g.potfit_steps[sn][’stats_start_counter’]
g.potfit_steps[sn][’stats_speed’] = g.potfit_steps[sn][’stats_counter’] / g.potfit_steps[sn][’stats_time’]
g.potfit_steps[sn][’stats_complete’] = False

123
124
125
126
127
128

output.log("##################################################", verbose=0)
output.log("Ending of Potential Fit", verbose=0)
output.log("##################################################", verbose=0)
output.log("", verbose=0)

462

APPENDIX Q. EAMPA CODE

129
130
131
132
133

Q.4. MAIN FITTING CLASS

if(interupt):
output.log("Reached maximum time limit", verbose=0)
else:
output.log("Completed within maximum time limit", verbose=0)
output.log("", verbose=0)

134
135
136
137

# Set parameters for potential
p = ds.potential_p(g.potfit[’p_best’])
potential.update_p(p)

138
139
140
141

# Run calculation
efs_rss, bp_rss, total_rss = potfit.get_rss_calc()
output.log("", verbose=0)

142
143
144
145
146
147
148
149
150
151
152
153

output.log("Best Parameters", verbose=0)
output.log("--------------------------------------------------", verbose=0)
line = ’’
for i in range(len(g.potfit[’p_best’])):
line = line + "{:10.3e} ".format(g.potfit[’p_best’][i])
if((i + 1) % 10 == 0 and i != len(g.potfit[’p_best’])-1):
output.log(line, verbose=0)
line = ’’
if(line != ’’):
output.log(line, verbose=0)

154
155
156
157
158
159
160
161
162

t = g.potfit[’potfit_end_time’] - g.potfit[’potfit_start_time’]
output.log("Stats", verbose=0)
output.log("--------------------------------------------------", verbose=0)
output.log("{:12s} {:16.2f}".format("Time: ", t), verbose=0)
output.log("{:12s} {:16d} {:16.2f}".format("Steps: ", g.potfit[’counter’], g.potfit[’counter’]/ t), verbose=0)
output.log("{:12s} {:16d} {:16.2f}".format("Configs: ", g.calc_counter, g.calc_counter/ t), verbose=0)
output.log("{:12s} {:16.2f}".format("Best RSS: ", g.potfit[’rss_best’]), verbose=0)
output.log(’’, verbose=0)

163
164
165

# Make tabulated
potential.tab_for_output()

166
167
168
169
170

# Output potentials - analytic, tab, and plots
output.potentials(g.dir[’fit_best_pot’])
output.potentials_tabulated(g.dir[’fit_best_pottab’])
plot.potentials(g.dir[’fit_best_plot’])

171
172
173
174
175
176
177

# Output bp and other plots
output.bp(g.dir[’fit_best’])
plot.plot_eos(g.dir[’fit_best_plots’])
plot.plot_ec(g.dir[’fit_best_plots’])
plot.plot_rose(g.dir[’fit_best_plots’])
plot.plot_msp(g.dir[’fit_best_plots’])

178
179

output.potfit_summary(g.dir[’fit’])

180
181
182
183
184
185
186

# Turn on terminal log
g.verbose[’print’] = 1
exit()
sys.exit()

187
188
189

463

Q.4. MAIN FITTING CLASS

190
191

APPENDIX Q. EAMPA CODE

@staticmethod
def make_dirs():

192
193
194
195
196
197

g.dir[’fit_best’] = os.path.join(g.dir[’fit’], "best")
g.dir[’fit_best_pot’] = os.path.join(g.dir[’fit_best’], "pot")
g.dir[’fit_best_pottab’] = os.path.join(g.dir[’fit_best’], "pot_tab")
g.dir[’fit_best_plot’] = os.path.join(g.dir[’fit_best’], "pot_plot")
g.dir[’fit_best_plots’] = os.path.join(g.dir[’fit_best’], "plots")

198
199

g.dir[’fit_temp_best’] = os.path.join(g.dir[’fit’], "temp")

200
201
202

for k in g.dir.keys():
os.makedirs(g.dir[k], exist_ok=True)

203
204
205
206
207
208
209
210
211
212

@staticmethod
def temporary_save():
tp = g.potfit_bestsaveperiod
dirroot = g.dir[’fit_temp_best’]
tn = str(int(tp * numpy.ceil((time.time() - g.start) / tp)))
while(len(tn) < 8):
tn = "0" + tn

213
214
215
216
217
218
219
220
221

tndir = os.path.join(dirroot, tn)
tndir_pot = os.path.join(tndir, "pot")
tndir_pottab = os.path.join(tndir, "pot_tab")
tndir_plot = os.path.join(tndir, "pot_plot")
os.makedirs(tndir, exist_ok=True)
os.makedirs(tndir_pot, exist_ok=True)
os.makedirs(tndir_pottab, exist_ok=True)
os.makedirs(tndir_plot, exist_ok=True)

222
223
224
225
226
227

output.potentials(tndir_pot)
potential.tab_for_output()
output.potentials_tabulated(tndir_pottab)
plot.potentials(tndir_plot)
output.bp(tndir_pot)

228
229
230
231
232
233
234
235

# Function to minimise
@staticmethod
def get_rss(p_in):
# End
if((time.time() - g.start) > g.maxtime):
potfit.end(interupt=True)

236
237
238
239

# Set parameters for potential
p = ds.potential_p(p_in)
potential.update_p(p)

240
241
242

# Run calculation
efs_rss, bp_rss, total_rss = potfit.get_rss_calc()

243
244
245
246
247
248
249
250

# Save results
g.potfit[’counter’] = g.potfit[’counter’] + 1
g.potfit[’improvement_counter’] = g.potfit[’improvement_counter’] + 1
g.potfit[’sn_counter’] = g.potfit[’sn_counter’] + 1
g.potfit_steps[g.potfit[’sn’]][’counter’] = g.potfit_steps[g.potfit[’sn’]][’counter’] + 1
g.potfit[’p_current’] = numpy.copy(p)
g.potfit[’efs_rss_current’] = efs_rss

464

APPENDIX Q. EAMPA CODE

251
252

Q.4. MAIN FITTING CLASS

g.potfit[’bp_rss_current’] = bp_rss
g.potfit[’rss_current’] = total_rss

253
254
255
256
257
258
259
260
261

for n in range(len(g.bp)):
g.potfit[’bp_current’][n][’a0’] = g.bp[n][’c_a0’]
g.potfit[’bp_current’][n][’e0’] = g.bp[n][’c_e0’]
g.potfit[’bp_current’][n][’v0’] = g.bp[n][’c_v0’]
g.potfit[’bp_current’][n][’b0_gpa’] = g.bp[n][’c_b0_gpa’]
g.potfit[’bp_current’][n][’ec_gpa’] = numpy.copy(g.bp[n][’c_ec_gpa’])
g.potfit[’bp_current’][n][’mspec_gpa’] = numpy.copy(g.bp[n][’c_msp_ec_gpa’])
g.potfit[’bp_current’][n][’rss_details’] = g.bp[n][’rss_details’]

262
263
264
265
266
267
268
269

# Save best
if((g.potfit[’rss_best’] is None or total_rss < g.potfit[’rss_best’]) and not numpy.isnan(total_rss)):
g.potfit[’improvement_counter’] = 0
g.potfit[’p_best’] = numpy.copy(p)
g.potfit[’efs_rss_best’] = efs_rss
g.potfit[’bp_rss_best’] = bp_rss
g.potfit[’rss_best’] = total_rss

270
271
272
273
274
275
276
277
278

# Save best values
for n in range(len(g.bp)):
g.potfit[’bp_best’][n][’a0’] = g.bp[n][’c_a0’]
g.potfit[’bp_best’][n][’e0’] = g.bp[n][’c_e0’]
g.potfit[’bp_best’][n][’v0’] = g.bp[n][’c_v0’]
g.potfit[’bp_best’][n][’b0_gpa’] = g.bp[n][’c_b0_gpa’]
g.potfit[’bp_best’][n][’ec_gpa’] = numpy.copy(g.bp[n][’c_ec_gpa’])
g.potfit[’bp_best’][n][’mspec_gpa’] = numpy.copy(g.bp[n][’c_msp_ec_gpa’])

279
280

potfit.temporary_save()

281
282
283
284
285

# Display results
display.show()

286
287
288
289

# Log
output.log("Total rss: " + str(total_rss) + " " + str(g.potfit[’rss_best’]), verbose=2)
output.log("Total rss: " + str(p), verbose=2)

290
291
292

#
return total_rss

293
294
295
296
297
298
299
300
301
302
303
304
305

@staticmethod
def get_rss_calc():
efs_rss = 0.0
if(configs.count(’efs’) > 0 and g.rss_w[’configs’] != 0.0):
configs.calc(’efs’)
efs_rss = configs.rss(config_tag=’efs’)
bp_rss = 0.0
if(len(g.bp) > 0 and g.rss_w[’bp’] != 0.0):
bp_rss = bp.run_rss()
total_rss = bp_rss + efs_rss

306
307
308

return efs_rss, bp_rss, total_rss

309
310
311

465

Q.5. GLOBAL FITTING ALGORITHMS

312
313
314

APPENDIX Q. EAMPA CODE

@staticmethod
def set_potfit_store():
g.potfit = ds.potfit()

315
316
317
318
319
320

# BP current
if(g.potfit[’bp_current’] is None):
g.potfit[’bp_current’] = []
for n in range(len(g.bp)):
g.potfit[’bp_current’].append(ds.potfit_bp())

321
322
323
324
325
326

# BP best
if(g.potfit[’bp_best’] is None):
g.potfit[’bp_best’] = []
for n in range(len(g.bp)):
g.potfit[’bp_best’].append(ds.potfit_bp())

Q.5

Global Fitting Algorithms
Listing Q.7: Simulated Annealing Class (Python)

1

#!/bin/python3

2
3
4
5

import numpy
import time
import copy

6
7
8

from g import g
from ds import ds

9
10

class simulated_annealing:

11
12
13
14

@staticmethod
def run(f, p, niter=1000, titer=10, tstart=100, tend=0.01, pfact=0.7, pvar=None, vartype=None, gaussian=False):

15
16
17
18
19
20
21
22
23
24
25

if(pvar == None or vartype == None):
g.displaynote = ’Initializing pvar’
p, pvar = simulated_annealing.pvar(f, p)
elif(vartype == ’add’):
pvar = pvar + numpy.zeros((len(p),), dtype=numpy.float64)
elif(vartype == ’mult’):
pvar = pvar * p
p = simulated_annealing.optimize(f, p, pvar, niter, titer, tstart, tend, pfact, gaussian)
g.displaynote = ’’
return p

26
27
28

@staticmethod
def optimize(f, p, pvar, niter=1000, titer=10, tstart=100, tend=0.01, pfact=0.7, gaussian=False):

29
30

temp = numpy.linspace(tstart, tend, titer)

31
32
33
34

rss = f(p)
rss_best = rss
p_best = numpy.copy(p)

35
36
37
38

for tn in range(titer):
t = temp[tn]
dp = pfact**(tn) * 10.0 * pvar[:]

39

466

APPENDIX Q. EAMPA CODE

40
41

42

Q.5. GLOBAL FITTING ALGORITHMS

for n in range(niter):
g.displaynote = ’T Loop ’ + str(tn) + " N Loop " + str(n) + " t="+str("{0:7.3f}".format(t)) + " pfact="+
str("{0:7.3f}".format(pfact**(tn)))
p_new = numpy.copy(p)

43
44
45
46
47

if(gaussian):
p_new[:] = p_new[:] + dp * numpy.random.normal(0.0, 0.1, len(p_new[:]))
else:
p_new[:] = p_new[:] + dp * (0.5 - numpy.random.rand(len(p_new[:])))

48
49
50
51
52
53
54
55
56
57
58
59

rss_new = f(p_new)
if(rss_new < rss or numpy.random.uniform() < numpy.exp((rss_new - rss) / t)):
rss = rss_new
p = numpy.copy(p_new)
if(rss < rss_best):
rss_best = rss_new
p_best = numpy.copy(p_new)
p = numpy.copy(p_best)
rss = rss_best
return p_best

60
61
62
63
64
65

@staticmethod
def pvar(f, p):
p_upper = numpy.zeros((len(p),), dtype=numpy.float64)
p_lower = numpy.zeros((len(p),), dtype=numpy.float64)

66
67
68
69
70

rss_initial = f(p)
var = numpy.zeros((14,), dtype=numpy.float64)
for n in range(14):
var[n] = 10**(-7 + n)

71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88

for pn in range(len(p)):
for n in range(14):
p_new = numpy.copy(p)
p_new[pn] = p_new[pn] + var[n]
rss = f(p_new)
if(rss > 10.0 * rss_initial):
p_upper[pn] = p_new[pn]
break
for pn in range(len(p)):
for n in range(14):
p_new = numpy.copy(p)
p_new[pn] = p_new[pn] - var[n]
rss = f(p_new)
if(rss > 10.0 * rss_initial):
p_lower[pn] = p_new[pn]
break

89
90
91
92
93

pvar = p_upper - p_lower
p = p_lower + 0.5 * pvar
return p, pvar

Listing Q.8: Genetic Algorithm Class (Python)
1

#!/bin/python3

2
3
4

import numpy
import time

467

Q.5. GLOBAL FITTING ALGORITHMS

5
6

APPENDIX Q. EAMPA CODE

import copy
from scipy.optimize import minimize

7
8

from g import g

9
10

class ga:

11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31

f = None
p_in = None
p_best = None
rss_best = None
psize = 0
popsize = 0
c_popsize = 0
pop = None
pop_rss = None
f_pop = None
f_pop_rss = None
f_popsize = 0
c_pop = None
c_pop_rss = None
threshold = 1.0e20
parents = None
populate_counter = 0
evolve_period = 10
evolve_amount = 3
search = None

32
33
34
35
36
37
38
39
40
41
42
43
44

@staticmethod
def run(f, p, niter=1000, popsize=1000, fresh=0.1, threshold=1.0e20, min_final=True, search=None):
ga.f = f
ga.p_in = numpy.copy(p)
ga.psize = len(p)
ga.popsize = popsize
ga.c_popsize = popsize
ga.f_popsize = int(popsize * fresh)
if(search is None):
ga.search = ’w’
else:
ga.search = search

45
46
47

ga.setup()
ga.pop, ga.pop_rss = ga.populate(ga.pop, ga.pop_rss)

48
49
50
51
52
53
54

for gn in range(niter):
ga.generation(gn)
p = numpy.copy(ga.pop[0, :])
if(min_final):
res = minimize(ga.rss, p, method=’BFGS’, options={’gtol’: 1.0e-8, ’maxiter’: 10, })
p = res[’x’]

55
56
57
58

# Clear note
g.displaynote = ’’
return p

59
60
61
62
63
64
65

@staticmethod
def rss(p):
rss = ga.f(p)
if(ga.rss_best is None):
ga.p_best = numpy.copy(p)
ga.rss_best = rss

468

APPENDIX Q. EAMPA CODE

66
67
68
69

Q.5. GLOBAL FITTING ALGORITHMS

if(rss < ga.rss_best):
ga.p_best = numpy.copy(p)
ga.rss_best = rss
return rss

70
71
72
73
74
75

@staticmethod
def generation(gn):
# Shuffle parent list
ga.parents = numpy.arange(ga.popsize)
numpy.random.shuffle(ga.parents)

76
77

# Breed

78
79
80
81
82
83
84
85
86
87
88
89

g.displaynote = ’gen ’ + str(gn) + ’ breed parents’
for n in range(ga.popsize // 2):
pa = numpy.copy(ga.pop[ga.parents[2 * n], :])
pb = numpy.copy(ga.pop[ga.parents[2 * n + 1], :])
ca, cb = ga.breed(pa, pb)
ca = ga.no_clones(ca)
cb = ga.no_clones(cb)
ga.c_pop[2 * n, :] = numpy.copy(ca[:])
ga.c_pop[2 * n+1, :] = numpy.copy(cb[:])
ga.c_pop_rss[2 * n] = ga.rss(ca)
ga.c_pop_rss[2 * n+1] = ga.rss(cb)

90
91
92

# Merge
ga.merge(ga.pop, ga.pop_rss, ga.c_pop, ga.c_pop_rss)

93
94
95
96
97

# Shuffle parent list
ga.parents = numpy.arange(ga.popsize)
numpy.random.shuffle(ga.parents)

98
99
100
101

# Fresh
g.displaynote = ’gen ’ + str(gn) + ’ populate fresh’
ga.f_pop, ga.f_pop_rss = ga.populate(ga.f_pop, ga.f_pop_rss)

102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120

g.displaynote = ’gen ’ + str(gn) + ’ breed fresh’
# Breed
for n in range(ga.f_popsize):
loop = True
while(loop):
try:
pa = numpy.copy(ga.pop[ga.parents[n], :])
pb = numpy.copy(ga.f_pop[n, :])
ca, cb = ga.breed(pa, pb)
ca = ga.no_clones(ca)
cb = ga.no_clones(cb)
ga.c_pop[2 * n, :] = numpy.copy(ca[:])
ga.c_pop[2 * n+1, :] = numpy.copy(cb[:])
ga.c_pop_rss[2 * n] = ga.rss(ca)
ga.c_pop_rss[2 * n+1] = ga.rss(cb)
loop = False
except:
pass

121
122
123

# Merge
ga.merge(ga.pop, ga.pop_rss, ga.c_pop[:2*ga.f_popsize, :], ga.c_pop_rss[:2 * ga.f_popsize])

124
125
126

if(ga.evolve_period is not None):
if(gn > 0 and (gn+1)%ga.evolve_period == 0):

469

Q.5. GLOBAL FITTING ALGORITHMS

APPENDIX Q. EAMPA CODE

127
128
129
130

# Shuffle parent list
ga.parents = numpy.arange(ga.popsize)
numpy.random.shuffle(ga.parents[2:])

131
132
133
134
135
136
137
138

for en in range(ga.evolve_amount):
g.displaynote = ’gen ’ + str(gn) + ’ evolve ’ + str(en)
pa = numpy.copy(ga.pop[ga.parents[en], :])
res = minimize(ga.rss, pa, method=’CG’, options={’gtol’: 1.0e-4, ’maxiter’: 1, })
pe = res[’x’]
ga.e_pop[en, :] = pe[:]
ga.e_pop_rss[en] = ga.rss(pe[:])

139
140
141

# Merge
ga.merge(ga.pop, ga.pop_rss, ga.e_pop[:, :], ga.e_pop_rss[:])

142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160

@staticmethod
def breed(pa, pb):
ca = numpy.zeros((ga.psize,), dtype=numpy.float64,)
cb = numpy.zeros((ga.psize,), dtype=numpy.float64,)
state = 0
for n in range(ga.psize):
if(state == 0):
ca[n] = pa[n]
cb[n] = pb[n]
else:
cb[n] = pa[n]
ca[n] = pb[n]
if(numpy.random.uniform() > 0.5):
if(state == 0):
state = 1
else:
state = 0
return ca, cb

161
162
163
164
165
166
167
168
169

@staticmethod
def no_clones(p):
for n in range(ga.popsize):
if(p[:].all() == ga.pop[n,:].all()):
p[:] = numpy.random.uniform() * p[:]
return p[:]
return p[:]

170
171
172
173
174
175
176
177
178
179
180

@staticmethod
def setup():
ga.pop = numpy.zeros((ga.popsize, ga.psize,), dtype=numpy.float64,)
ga.pop_rss = numpy.zeros((ga.popsize,), dtype=numpy.float64,)
ga.c_pop = numpy.zeros((ga.popsize, ga.psize,), dtype=numpy.float64,)
ga.c_pop_rss = numpy.zeros((ga.popsize,), dtype=numpy.float64,)
ga.f_pop = numpy.zeros((ga.f_popsize, ga.psize,), dtype=numpy.float64,)
ga.f_pop_rss = numpy.zeros((ga.f_popsize,), dtype=numpy.float64,)
ga.e_pop = numpy.zeros((ga.evolve_amount, ga.psize,), dtype=numpy.float64,)
ga.e_pop_rss = numpy.zeros((ga.evolve_amount,), dtype=numpy.float64,)

181
182
183
184
185
186
187

@staticmethod
def populate(pop, pop_rss):
g.displaynote = ’populating (’ + str(len(pop)) + ’)’
ga.populate_counter = ga.populate_counter + 1
ns = 0

470

APPENDIX Q. EAMPA CODE

188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231

Q.5. GLOBAL FITTING ALGORITHMS

if(ga.populate_counter == 1):
ns = 1
pop[0,:] = ga.p_in[:]
pop_rss[0] = ga.rss(pop[0,:])
for n in range(ns, len(pop_rss)):
loop = True
while(loop):
r = numpy.random.uniform()
# n narrow search
if(ga.search.lower() == ’n’):
if(r < 0.05):
p_new = ga.p_in + 10**(-4*numpy.random.uniform()) * ga.p_in * (0.5 - numpy.random.rand(ga.psize))
elif(r < 0.25):
p_new = ga.p_best + 0.01 * ga.p_best * (0.5 - numpy.random.rand(ga.psize))
elif(r < 0.75):
p_new = ga.p_best + 10**(-1-4*numpy.random.uniform()) * ga.p_best * (0.5 - numpy.random.rand(ga.psize))
elif(r < 0.90):
p_new = ga.p_best + 10**(-1-6*numpy.random.uniform()) * ga.p_best * (0.5 - numpy.random.rand(ga.psize))
# 10% from random
else:
p_new = (0.5 - numpy.random.rand(ga.psize)) * 10**(7.0 * (0.5 - numpy.random.rand(ga.psize)))
# w wider search
else:
if(r < 0.05):
p_new = ga.p_in + 10**(-4*numpy.random.uniform()) * ga.p_in * (0.5 - numpy.random.rand(ga.psize))
elif(r < 0.12):
p_new = ga.p_best + 0.01 * ga.p_best * (0.5 - numpy.random.rand(ga.psize))
elif(r < 0.24):
p_new = ga.p_best + 10**(-1-4*numpy.random.uniform()) * ga.p_best * (0.5 - numpy.random.rand(ga.psize))
elif(r < 0.3):
p_new = ga.p_best + 10**(-1-6*numpy.random.uniform()) * ga.p_best * (0.5 - numpy.random.rand(ga.psize))
# 10% small parameters
elif(r < 0.4):
p_new = 1.0e-5 * (0.5 - numpy.random.rand(ga.psize))
# 10% large parameters
elif(r < 0.5):
p_new = 1.0e3 * (0.5 - numpy.random.rand(ga.psize))
# 25% random
elif(r < 0.75):
p_new = (0.5 - numpy.random.rand(ga.psize)) * 10**(5.0 * (0.5 - numpy.random.uniform()))
# 25% random
elif(r <= 1.0):
p_new = (0.5 - numpy.random.rand(ga.psize)) * 10**(7.0 * (0.5 - numpy.random.rand(ga.psize)))
rss = ga.rss(p_new)

232
233
234
235
236

if(rss <
loop =
pop[n,:] =
pop_rss[n]

ga.threshold or numpy.isnan(rss)):
False
p_new[:]
= rss

237
238

return pop, pop_rss

239
240
241
242
243
244
245
246

@staticmethod
def merge(pop_a, rss_a, pop_b, rss_b):
ax = pop_a.shape[0]
ay = pop_a.shape[1]
bx = pop_b.shape[0]
by = pop_b.shape[1]

247
248

t = numpy.zeros((ax + bx, by + 1,), dtype=numpy.float64,)

471

Q.6. BULK PROPERTIES

249
250
251
252

APPENDIX Q. EAMPA CODE

t[:ax,0] = rss_a[:]
t[ax:,0] = rss_b[:]
t[:ax,1:] = pop_a[:,:]
t[ax:,1:] = pop_b[:,:]

253
254
255
256

t = t[t[:, 0].argsort()]
rss_a[:] = t[:ax,0]
pop_a[:,:] = t[:ax, 1:]

257
258
259
260

rss_b[:] = 0.0
pop_b[:,:] = 0.0

Q.6

Bulk Properties
Listing Q.9: Bulk Properties Class (Python)

1

#!/bin/python3

2
3
4
5

import numpy
import time
import os

6
7
8
9

from f_toolbox import atom
from f_toolbox import math
from f_toolbox import transforms

10
11
12
13
14
15
16
17
18
19
20
21
22

from
from
from
from
from
from
from
from
from
from
from
from

g import g
ds import ds
configs import configs
potential import potential
nl import nl
output import output
plot import plot
relax import relax
eos import eos
units import units
rose import rose
msp import msp

23
24

class bp:

25
26

log = []

27
28
29
30
31

@staticmethod
def run():
output.log("Run BP Calculation", verbose=0)

32
33
34
35
36
37
38
39

bp.make_dirs()
bp.build()
bp.calc()
bp.rss()
bp.output()
output.log("End", verbose=0)
exit()

40
41
42

472

APPENDIX Q. EAMPA CODE

43
44
45
46
47

Q.6. BULK PROPERTIES

@staticmethod
def run_rss():
bp.build()
bp.calc()
return bp.rss()

48
49
50
51
52

@staticmethod
def output():
bp.make_dirs()

53
54
55
56

# Output summary
d = output.bp(g.dir[’bp’])
output.log(d, verbose=0)

57
58
59
60
61
62

# EoS, EC, Rose, MSP plots
plot.plot_eos(g.dir[’bp_plots’])
plot.plot_ec(g.dir[’bp_plots’])
plot.plot_rose(g.dir[’bp_plots’])
plot.plot_msp(g.dir[’bp_plots’])

63
64
65
66
67
68

# Potential data and plots
potential.tab_for_output()
output.potentials(g.dir[’bp_pot’])
output.potentials_tabulated(g.dir[’bp_pot_data’])
plot.potentials(g.dir[’bp_pot_plots’])

69
70
71
72
73

# Make additional directories for bp
@staticmethod
def make_dirs():

74
75
76
77
78

g.dir[’bp_plots’] = os.path.join(g.dir[’bp’], "plots")
g.dir[’bp_pot’] = os.path.join(g.dir[’bp’], "pot")
g.dir[’bp_pot_plots’] = os.path.join(g.dir[’bp’], "pot_plots")
g.dir[’bp_pot_data’] = os.path.join(g.dir[’bp’], "pot_data")

79
80
81

for k in g.dir.keys():
os.makedirs(g.dir[k], exist_ok=True)

82
83
84
85
86

"""
Calculate RSS
######################################################"""

87
88
89
90
91
92
93
94
95
96
97

@staticmethod
def rss():
total_rss = 0.0
output.log("Calculate BP RSS", verbose=3)
for n in range(len(g.bp)):
rss_v = bp.rss_inner(n)
output.log("BP " + str(n) + " " + str(rss_v), verbose=2)
total_rss = total_rss + rss_v
output.log("BP total rss " + str(total_rss), verbose=2)
return total_rss

98
99
100
101
102
103

@staticmethod
def rss_inner(n):
g.bp[n][’rss_details’] = ds.bp_rss_details()
d = g.bp[n]

473

Q.6. BULK PROPERTIES

APPENDIX Q. EAMPA CODE

104
105
106
107
108
109
110
111
112
113
114

# RSS to specific values (EoS and 9 strains)
if(d[’a0’] is not None and d[’c_a0’] is not None):
g.bp[n][’rss_details’][’a0’] = g.rss_w[’a0’] * (d[’a0’] - d[’c_a0’])**2
if(d[’e0’] is not None and d[’c_e0’] is not None):
g.bp[n][’rss_details’][’e0’] = g.rss_w[’e0’] * (d[’e0’] - d[’c_e0’])**2
if(d[’b0’] is not None and d[’c_b0’] is not None):
g.bp[n][’rss_details’][’b0’] = g.rss_w[’b0’] * (d[’b0’] - d[’c_b0’])**2
if(d[’ec’] is not None and d[’c_ec’] is not None):
g.bp[n][’rss_details’][’ec’] = g.rss_w[’ec’] * sum(sum((d[’ec’] - d[’c_ec’])**2))

115
116
117
118

# Match to Rose eos over a wider parameter range
if(d[’rose_eos’] and d[’rose_e’] is not None and d[’c_rose_e’] is not None):
g.bp[n][’rss_details’][’rose’] = g.rss_w[’rose’] * sum((d[’rose_e’] - d[’c_rose_e’])**2)

119
120
121
122
123
124
125

# Match to MSP, MKP cubic elastic constants over strain
if(d[’msp_ec’] and d[’msp_e’] is not None and d[’c_msp_e’] is not None):
msp_e_zeroed = d[’msp_e’][:,:] - d[’msp_e’][0,:]
c_msp_e_zeroed = d[’c_msp_e’][:,:] - d[’c_msp_e’][0,:]
g.bp[n][’rss_details’][’msp_shape’] = g.rss_w[’msp’][0] * sum(sum((msp_e_zeroed - c_msp_e_zeroed)**2))
g.bp[n][’rss_details’][’msp_values’] = g.rss_w[’msp’][1] * sum(sum((d[’msp_e’] - d[’c_msp_e’])**2))

126
127
128
129

130
131

# Fitting to BM EoS points
if(d[’bm_eos’] and d[’bm_eos_e_known_z’] is not None and d[’bm_eos_e_potential_z’] is not None):
g.bp[n][’rss_details’][’bm_eos_shape’] = g.rss_w[’bm_eos’][0] * sum((d[’bm_eos_e_known_z’] - d[’
bm_eos_e_potential_z’])**2)
if(d[’bm_eos’] and d[’bm_eos_e_known’] is not None and d[’bm_eos_e_potential’] is not None):
g.bp[n][’rss_details’][’bm_eos_values’] = g.rss_w[’bm_eos’][1] * sum((d[’bm_eos_e_known’] - d[’
bm_eos_e_potential’])**2)

132
133
134
135
136
137
138
139
140
141
142
143
144
145

# Penalties for negative values and instabilities
penalty = 0.0
if(d[’c_b0’] < 0.0):
penalty = penalty + 1.0e3
for i in range(6):
for j in range(6):
if(d[’c_ec’][i,j] < 0.0):
penalty = penalty + 1.0e2
if(not d[’c_cubic_stability’]):
penalty = penalty + 1.0e3
g.bp[n][’rss_details’][’bp_penalty’] = penalty

146
147
148
149
150
151
152
153
154
155
156

# Weight
t = 0.0
for k in g.bp[n][’rss_details’].keys():
g.bp[n][’rss_details’][k] = g.bp[n][’weight’] * g.rss_w[’bp’] * g.bp[n][’rss_details’][k]
t = t + g.bp[n][’rss_details’][k]
g.bp[n][’rss_details’][’bp_total’] = t
g.bp[n][’rss’] = t
#print(g.bp[n][’rss_details’])
return g.bp[n][’rss’]

157
158
159
160
161
162

"""
Build configurations
######################################################"""

474

APPENDIX Q. EAMPA CODE

Q.6. BULK PROPERTIES

163
164
165
166
167
168

@staticmethod
def build():
output.log("Create BP configurations", verbose=3)
for n in range(len(g.bp)):
bp.build_inner(n)

169
170
171
172
173
174

@staticmethod
def build_inner(n):
if(g.bp[n][’built’]):
bp.reset()
return False

175
176
177
178
179
180

# Get details for structure
structure = g.bp[n][’structure’]
label = g.bp[n][’label’]
a0 = g.bp[n][’a0’]
uv = g.bp[n][’uv’]

181
182
183
184
185
186
187

# Create original unedited structure and build neighbour list
rcut = g.bp_settings[’eos_rcut’]
cell_size = g.bp_settings[’eos_cell_size’]
eos_bm_original_id = configs.add_common(structure, label, a0, uv, [cell_size], rcut, ’bp’, ’e’)
g.bp[n][’eos_bm_original_id’] = eos_bm_original_id
nl.build_nl(g.bp[n][’eos_bm_original_id’])

188
189
190
191
192

"""
Configs to relax and find a0 for the potential
######################################################"""

193
194
195

# Create Relax
g.bp[n][’relax_id’] = configs.duplicate(eos_bm_original_id)

196
197
198
199
200
201

"""
BM EoS configs to calculate values E0 V0 B0 for
this potential
######################################################"""

202
203
204
205

eos_strain = g.bp_settings[’eos_strain’]
eos_steps = g.bp_settings[’eos_steps’]
eoss = 2 * eos_steps + 1

206
207
208
209
210

g.bp[n][’eos_ids’] = []
g.bp[n][’eos_strains’] = ds.bp_eos_arr(eoss)
g.bp[n][’eos_volumes’] = ds.bp_eos_arr(eoss)
g.bp[n][’eos_energies’] = ds.bp_eos_arr(eoss)

211
212
213
214
215
216
217

k = 0
for i in range(-eos_steps, eos_steps+1):
s = eos_strain * (i / eos_steps)
g.bp[n][’eos_strains’][k] = s
g.bp[n][’eos_ids’].append(configs.duplicate(eos_bm_original_id))
k = k + 1

218
219
220
221
222
223

"""
! FOR COMPUTE VALUE CALCULATIONS
! Ravindran, Fast, Korzhavyi, Johansson 1998
! Density functional theory for calculation of elastic properties of

475

Q.6. BULK PROPERTIES

224
225
226

APPENDIX Q. EAMPA CODE

! orthorhombic crystals: application to TiSi2
!
######################################################"""

227
228
229
230
231

rcut = g.bp_settings[’ec_rcut’]
cell_size = g.bp_settings[’ec_cell_size’]
ec_strain = g.bp_settings[’ec_strain’]
ec_steps = g.bp_settings[’ec_steps’]

232
233
234
235
236

# Create original unedited structure and build neighbour list
ec_rfkj_original_id = configs.add_common(structure, label, a0, uv, [cell_size], rcut, ’bp’, ’e’)
g.bp[n][’ec_rfkj_original_id’] = ec_rfkj_original_id
nl.build_nl(g.bp[n][’ec_rfkj_original_id’])

237
238

ecs = 2 * ec_steps + 1

239
240
241
242
243

g.bp[n][’ec_ids’] = []
g.bp[n][’ec_strains’] = ds.bp_ec_arr(ecs)
g.bp[n][’ec_volumes’] = ds.bp_ec_arr(ecs)
g.bp[n][’ec_energies’] = ds.bp_ec_arr(ecs)

244
245
246

g.bp[n][’c_ec’] = ds.bp_ec()
g.bp[n][’c_ec_gpa’] = ds.bp_ec()

247
248
249
250
251
252
253
254
255

for di in range(9):
k = 0
g.bp[n][’ec_ids’].append([])
for i in range(-ec_steps, ec_steps+1):
s = ec_strain * (i / ec_steps)
g.bp[n][’ec_strains’][di, k] = s
g.bp[n][’ec_ids’][di].append(configs.duplicate(ec_rfkj_original_id))
k = k + 1

256
257
258
259
260
261
262
263

"""
Rose equation of state
Generate predicted energy vs lattice parameter data
points for fitting
(See G. Bonny exact parameter fitting code)
######################################################"""

264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280

if(g.bp[n][’rose_eos’]):
# Create rose configs
rcut = g.bp_settings[’rose_rcut’]
steps = g.bp_settings[’rose_steps’]
cell_size = g.bp_settings[’rose_cell_size’]
a0_start = a0 + g.bp_settings[’rose_a0_d1’]
a0_mid = a0 - g.bp_settings[’rose_a0_d1’]
a0_end = a0 + g.bp_settings[’rose_a0_d2’]
xa = int(2/3 * steps)
xb = steps - xa
g.bp[n][’rose_a’] = ds.bp_rose_a_arr(steps)
g.bp[n][’rose_e’] = ds.bp_rose_e_arr(steps)
g.bp[n][’c_rose_e’] = ds.bp_rose_e_arr(steps)
g.bp[n][’rose_ids’] = []
g.bp[n][’rose_a’][:xa] = numpy.linspace(a0_start, a0_mid, xa)
g.bp[n][’rose_a’][xa:] = numpy.linspace(a0_mid, a0_end, xb + 1)[1:]

281
282
283
284

for i in range(steps):
r_a0 = g.bp[n][’rose_a’][i]
rose_id = configs.add_common(structure, label, r_a0, uv, [cell_size], rcut, ’bp’, ’e’)

476

APPENDIX Q. EAMPA CODE

285
286

Q.6. BULK PROPERTIES

g.bp[n][’rose_ids’].append(rose_id)
nl.build_nl(rose_id)

287
288
289
290
291
292

# Fill in rose computed e
known_a0 = g.bp[n][’a0’]
known_e0 = g.bp[n][’e0’]
known_v0 = g.bp[n][’v0’]
known_b0 = g.bp[n][’b0’]

293
294
295

# Calculate energy based on b0, a0, ecoh, vol
g.bp[n][’rose_e’] = rose.calc(g.bp[n][’rose_a’], known_a0, known_b0, known_e0, known_v0)

296
297
298
299
300
301
302
303
304
305
306

"""
! For Fitting Points
! Mehl Singh Papaconstantopoulos strains 1993
! Properties of ordered intermetallic alloys: first-principles
! and approximate methods
!
! Mehl Klein Papaconstantopoulos 1993
! First principles calculations of elastic properties of metals
######################################################"""

307
308
309

if(g.bp[n][’msp_ec’]):
g.bp[n][’msp_ids’] = [[],[]]

310
311
312

rcut = g.bp_settings[’msp_rcut’]
cell_size = g.bp_settings[’msp_cell_size’]

313
314
315

# set strains
g.bp[n][’msp_strains’] = numpy.linspace(0.0, g.bp_settings[’msp_ec_strain’], g.bp_settings[’msp_ec_steps’])

316
317
318
319

# set energy arrays
g.bp[n][’msp_e’] = ds.bp_msp_e_arr(g.bp_settings[’msp_ec_steps’])
g.bp[n][’c_msp_e’] = ds.bp_msp_e_arr(g.bp_settings[’msp_ec_steps’])

320
321
322
323
324
325

# C11-C12 strains
for i in range(g.bp_settings[’msp_ec_steps’]):
uv_ortho = ds.uv_msp_orthorhombic(g.bp[n][’msp_strains’][i])
msp_id = configs.add_common(structure, label, a0, uv_ortho, [cell_size], rcut, ’bp’, ’e’)
g.bp[n][’msp_ids’][0].append(msp_id)

326
327
328
329
330
331

# C44 strains
for i in range(g.bp_settings[’msp_ec_steps’]):
uv_mono = ds.uv_msp_monoclinic(g.bp[n][’msp_strains’][i])
msp_id = configs.add_common(structure, label, a0, uv_mono, [cell_size], rcut, ’bp’, ’e’)
g.bp[n][’msp_ids’][1].append(msp_id)

332
333
334
335
336
337
338
339

# Calculate predicted energy-strain for C11-C12 and C44
known_e0 = g.bp[n][’e0’]
known_v0 = g.bp[n][’v0’]
known_c11 = g.bp[n][’ec’][0,0]
known_c12 = g.bp[n][’ec’][0,1]
known_c44 = g.bp[n][’ec’][3,3]

340
341
342
343

# Calculate energy based on b0, a0, ecoh, vol
g.bp[n][’msp_e’][:,0] = msp.calc_c11_c12(g.bp[n][’msp_strains’], known_e0, known_v0, known_c11, known_c12)
g.bp[n][’msp_e’][:,1] = msp.calc_c44(g.bp[n][’msp_strains’], known_e0, known_v0, known_c44)

344
345

477

Q.6. BULK PROPERTIES

APPENDIX Q. EAMPA CODE

346
347
348
349
350
351
352
353

"""
! Ravindran, Fast, Korzhavyi, Johansson 1998
! Density functional theory for calculation of elastic properties of
! orthorhombic crystals: application to TiSi2
!
######################################################"""

354
355
356
357
358
359
360
361

# Mark as built
g.bp[n][’built’] = True

362
363
364

#configs.index()
return True

365
366
367
368
369
370
371
372
373
374
375
376
377
378

"""
Reset BP Configurations
######################################################"""
@staticmethod
def reset():
output.log("Reset BP configurations", verbose=3)
for n in range(len(g.bp)):
configs.duplicate(g.bp[n][’eos_bm_original_id’], g.bp[n][’relax_id’])
for k in range(len(g.bp[n][’eos_ids’])):
configs.duplicate(g.bp[n][’eos_bm_original_id’], g.bp[n][’eos_ids’][k])
for di in range(9):
for k in range(len(g.bp[n][’ec_ids’][di])):
configs.duplicate(g.bp[n][’ec_rfkj_original_id’], g.bp[n][’ec_ids’][di][k])

379
380
381
382
383

"""
Compute EoS and Elastic Constants
######################################################"""

384
385
386

@staticmethod
def calc():

387
388
389
390

output.log("Calculate BP", verbose=3)
for n in range(len(g.bp)):
bp.calc_inner(n)

391
392
393
394
395

@staticmethod
def calc_inner(n):
output.log("BP " + str(n), verbose=3)

396
397
398
399

# Relax
#################################

400
401

relax_id = g.bp[n][’relax_id’]

402
403
404
405

# Relax
relax.run_relax(relax_id, pmin=’e’, pvar=g.bp_settings[’relax’])

406

478

APPENDIX Q. EAMPA CODE

407
408

Q.6. BULK PROPERTIES

a0 = g.configs[relax_id][’a0’]
uv = g.configs[relax_id][’uv’]

409
410
411

g.bp[n][’c_a0’] = a0
g.bp[n][’c_uv’] = uv

412
413
414
415

v0 = math.cellvolume(a0, uv) / (1.0 * g.configs[relax_id][’count’])
g.bp[n][’volrelaxed’] = v0

416
417
418
419

# Compute EoS
##################################################################

420
421
422
423

for eos_n in range(len(g.bp[n][’eos_ids’])):
# Get id
config_id = g.bp[n][’eos_ids’][eos_n]

424
425
426
427

# Make transformation
s = g.bp[n][’eos_strains’][eos_n]
uvt = transforms.orthorhombic(uv, s)

428
429
430
431

# Change cell and calculate energy
nl.change_cell(config_id, a0=a0, uv=uvt, scale_uv=False)
configs.calc_efs(config_id)

432
433
434
435

# Save data
g.bp[n][’eos_volumes’][eos_n] = math.cellvolume(a0, uvt) / (1.0 * g.configs[config_id][’count’])
g.bp[n][’eos_energies’][eos_n] = g.configs[config_id][’c_energy’] / (1.0 * g.configs[config_id][’count’])

436
437
438
439
440
441
442

eos_p = eos.fit(g.bp[n][’eos_volumes’], g.bp[n][’eos_energies’])
g.bp[n][’c_v0’] = eos_p[’v0’]
g.bp[n][’c_e0’] = eos_p[’e0’]
g.bp[n][’c_b0’] = eos_p[’b0’]
g.bp[n][’c_b0_gpa’] = eos_p[’b0_gpa’]
g.bp[n][’c_b0p’] = eos_p[’b0p’]

443
444
445
446
447

# Make BM EoS points used to fit to the correct curve
if(g.bp[n][’bm_eos’]):
# Volume arrays
g.bp[n][’bm_eos_v’] = numpy.linspace(g.bp[n][’eos_volumes’][0], g.bp[n][’eos_volumes’][-1], g.bp_settings[’
bm_eos_points’])

448
449
450
451
452

# Known arrays
g.bp[n][’bm_eos_e_known’] = numpy.zeros((g.bp_settings[’bm_eos_points’], 3,), dtype=numpy.float64)
p = [g.bp[n][’v0’], g.bp[n][’e0’], g.bp[n][’b0’], 2.0]
g.bp[n][’bm_eos_e_known’] = eos.bm_calc(p, g.bp[n][’bm_eos_v’])

453
454
455
456
457

# Based on potential
g.bp[n][’bm_eos_e_potential’] = numpy.zeros((g.bp_settings[’bm_eos_points’], 3,), dtype=numpy.float64)
p = [g.bp[n][’c_v0’], g.bp[n][’c_e0’], g.bp[n][’c_b0’], 2.0]
g.bp[n][’bm_eos_e_potential’] = eos.bm_calc(p, g.bp[n][’bm_eos_v’])

458
459
460
461
462

463
464
465

# Known arrays
g.bp[n][’bm_eos_v_known_z’] = numpy.linspace(0.98 * g.bp[n][’v0’], 1.02 * g.bp[n][’v0’], g.bp_settings[’
bm_eos_points’])
p = [g.bp[n][’v0’], g.bp[n][’e0’], g.bp[n][’b0’], 2.0]
g.bp[n][’bm_eos_e_known_z’] = eos.bm_calc(p, g.bp[n][’bm_eos_v_known_z’])
g.bp[n][’bm_eos_e_known_z’] = g.bp[n][’bm_eos_e_known_z’] - g.bp[n][’e0’]

479

Q.6. BULK PROPERTIES

466

APPENDIX Q. EAMPA CODE

g.bp[n][’bm_eos_v_known_z’] = g.bp[n][’bm_eos_v_known_z’] - g.bp[n][’v0’]

467
468
469
470

471
472
473
474

# Known arrays
g.bp[n][’bm_eos_v_potential_z’] = numpy.linspace(0.98 * g.bp[n][’c_v0’], 1.02 * g.bp[n][’c_v0’], g.
bp_settings[’bm_eos_points’])
p = [g.bp[n][’c_v0’], g.bp[n][’c_e0’], g.bp[n][’c_b0’], 2.0]
g.bp[n][’bm_eos_e_potential_z’] = eos.bm_calc(p, g.bp[n][’bm_eos_v_potential_z’])
g.bp[n][’bm_eos_e_potential_z’] = g.bp[n][’bm_eos_e_potential_z’] - g.bp[n][’c_e0’]
g.bp[n][’bm_eos_v_potential_z’] = g.bp[n][’bm_eos_v_potential_z’] - g.bp[n][’c_v0’]

475
476
477
478
479
480
481
482

# Compute EC
##################################################################

483
484
485
486
487
488
489

if(g.bp[n][’rfkj_ec’]):
for di in range(len(g.bp[n][’ec_ids’])):
for i in range(len(g.bp[n][’ec_ids’][0])):
# Get id
config_id = g.bp[n][’ec_ids’][di][i]

490
491
492
493

# Make transformation
s = g.bp[n][’ec_strains’][di, i]
uvt = transforms.dn(uv, s, di + 1)

494
495
496
497

# Change cell and calculate energy
nl.change_cell(config_id, a0=a0, uv=uvt, scale_uv=False)
configs.calc_efs(config_id)

498
499
500

501

# Save data
g.bp[n][’ec_volumes’][di, i] = a0**3 * math.tripleproduct(uvt[:,0], uvt[:,1], uvt[:,2]) / g.configs[
config_id][’count’]
g.bp[n][’ec_energies’][di, i] = g.configs[config_id][’c_energy’] / g.configs[config_id][’count’]

502
503
504
505
506
507

# Distortion data
d = ds.bp_d()
for di in range(len(g.bp[n][’ec_ids’])):
p = numpy.polyfit(g.bp[n][’ec_strains’][di, :], g.bp[n][’ec_energies’][di, :], 2)
d[di] = p[0]

508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524

A = numpy.zeros((9,9,), dtype=numpy.float64)
A[0,0] = v0/2
A[1,1] = v0/2
A[2,2] = v0/2
A[3,3] = 2*v0
A[4,4] = 2*v0
A[5,5] = 2*v0
A[6,6] = -1.0*v0
A[7,7] = -1.0*v0
A[8,8] = -1.0*v0
A[6,0] = v0 / 2
A[6,1] = v0 / 2
A[7,0] = v0 / 2
A[7,2] = v0 / 2
A[8,1] = v0 / 2
A[8,2] = v0 / 2

480

APPENDIX Q. EAMPA CODE

525
526
527

Q.6. BULK PROPERTIES

C = numpy.asarray(d, dtype=numpy.float64)
A_inv = numpy.linalg.inv(A)
B = numpy.matmul(A_inv, C)

528
529
530
531
532
533
534
535
536
537
538
539
540

g.bp[n][’c_ec’][0,0]
g.bp[n][’c_ec’][1,1]
g.bp[n][’c_ec’][2,2]
g.bp[n][’c_ec’][3,3]
g.bp[n][’c_ec’][4,4]
g.bp[n][’c_ec’][5,5]
g.bp[n][’c_ec’][0,1]
g.bp[n][’c_ec’][1,0]
g.bp[n][’c_ec’][0,2]
g.bp[n][’c_ec’][2,0]
g.bp[n][’c_ec’][1,2]
g.bp[n][’c_ec’][2,1]

=
=
=
=
=
=
=
=
=
=
=
=

B[0]
B[1]
B[2]
B[3]
B[4]
B[5]
B[6]
B[6]
B[7]
B[7]
B[8]
B[8]

541
542
543

# Calculate in GPA
g.bp[n][’c_ec_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_ec’])

544
545
546
547

# Compliance tensor
g.bp[n][’c_sc’] = math.minverse(g.bp[n][’c_ec’])

548
549
550
551
552
553
554
555
556
557
558
559

# Properties from Elastic Constants
g.bp[n][’c_b0_r’] = bp.bulk_r(g.bp[n][’c_sc’])
g.bp[n][’c_b0_v’] = bp.bulk_v(g.bp[n][’c_ec’])
g.bp[n][’c_b0_avg’] = 0.5 * (g.bp[n][’c_b0_r’] + g.bp[n][’c_b0_v’])
g.bp[n][’c_g_r’] = bp.shear_g_r(g.bp[n][’c_sc’])
g.bp[n][’c_g_v’] = bp.shear_g_v(g.bp[n][’c_ec’])
g.bp[n][’c_g_avg’] = 0.5 * (g.bp[n][’c_g_r’] + g.bp[n][’c_g_v’])
g.bp[n][’c_e’] = bp.youngs_e(g.bp[n][’c_b0_avg’], g.bp[n][’c_g_avg’])
g.bp[n][’c_melting_temperature’] = bp.melting_temperature(g.bp[n][’c_ec’])
g.bp[n][’c_cubic_stability’] = bp.cubic_stability(g.bp[n][’c_ec’])
g.bp[n][’c_stability’] = bp.stability(g.bp[n][’c_ec’])

560
561
562
563
564
565
566
567
568

# Convert to GPA
g.bp[n][’c_b0_r_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_b0_r’])
g.bp[n][’c_b0_v_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_b0_v’])
g.bp[n][’c_b0_avg_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_b0_avg’])
g.bp[n][’c_g_r_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_g_r’])
g.bp[n][’c_g_v_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_g_v’])
g.bp[n][’c_g_avg_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_g_avg’])
g.bp[n][’c_e_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_e’])

569
570
571
572
573
574
575
576

"""
Rose equation of state
Run calculations to compare to known
energy-lattice parameter points
######################################################"""

577
578
579
580
581
582
583

if(g.bp[n][’rose_eos’]):
for i in range(len(g.bp[n][’rose_ids’])):
rose_id = g.bp[n][’rose_ids’][i]
configs.calc_efs(rose_id)
g.bp[n][’c_rose_e’][i] = g.configs[rose_id][’c_energy’] / g.configs[rose_id][’count’]

584
585

481

Q.6. BULK PROPERTIES

APPENDIX Q. EAMPA CODE

586
587
588
589
590
591
592
593
594

"""
MSP MKP strains C11-C12, C44
Run calculations to compare to known
energy-lattice parameter points
######################################################"""

595
596
597
598
599
600
601
602
603
604
605
606
607

if(g.bp[n][’msp_ec’]):
# C11-C12
for i in range(len(g.bp[n][’msp_ids’][0])):
msp_id = g.bp[n][’msp_ids’][0][i]
configs.calc_efs(msp_id)
g.bp[n][’c_msp_e’][i,0] = g.configs[msp_id][’c_energy’] / g.configs[msp_id][’count’]
# C44
for i in range(len(g.bp[n][’msp_ids’][1])):
msp_id = g.bp[n][’msp_ids’][1][i]
configs.calc_efs(msp_id)
g.bp[n][’c_msp_e’][i,1] = g.configs[msp_id][’c_energy’] / g.configs[msp_id][’count’]

608
609
610

# Array to store temporary results
ec_temp = numpy.zeros((3,), dtype=numpy.float64)

611
612
613
614
615

# Fit polynomial for c11_c12
s_c11_c12 = g.bp[n][’msp_strains’][:]
e_c11_c12 = g.bp[n][’c_msp_e’][:,0]
p_c11_c12 = numpy.polyfit(s_c11_c12, e_c11_c12, 2)

616
617
618
619
620

# Fit
s_c44
e_c44
p_c44

polynomial for c44
= g.bp[n][’msp_strains’][:]
= g.bp[n][’c_msp_e’][:,1]
= numpy.polyfit(s_c44, e_c44, 2)

621
622
623
624
625
626

# Get bulk modulus and
b0 = g.bp[n][’c_b0’]
v0 = g.bp[n][’c_v0’]
if(v0 == 0.0):
v0 = 1.0e-20

627
628
629
630
631
632
633
634
635
636
637

# Solve
a_mat= numpy.zeros((2,2,), dtype=numpy.float64)
a_mat[0,0] = 1.0
a_mat[0,1] = -1.0
a_mat[1,0] = 1.0/3.0
a_mat[1,1] = 2.0/3.0
b_mat= numpy.zeros((2,), dtype=numpy.float64)
b_mat[0] = p_c11_c12[0] / v0
b_mat[1] = b0
c_mat = numpy.linalg.solve(a_mat, b_mat)

638
639
640
641

ec_temp[0] = c_mat[0]
ec_temp[1] = c_mat[1]
ec_temp[2] = (2 * p_c44[0]) / v0

642
643
644

g.bp[n][’c_msp_ec’] = ds.bp_ec(ec_temp)
g.bp[n][’c_msp_ec_gpa’] = units.convert(’EV/ANG3’, ’GPA’, g.bp[n][’c_msp_ec’])

645
646

482

APPENDIX Q. EAMPA CODE

647
648
649
650
651

652

653

654
655
656
657
658
659

Q.6. BULK PROPERTIES

output.log("", verbose=3)
output.log("BP Results " + str(n), verbose=3)
output.log("===========================================", verbose=3)
output.log("a0
" + str(g.bp[n][’c_a0’]), verbose=3)
output.log("uv
" + str(g.bp[n][’c_uv’][0,0]) + " " + str(g.bp[n][’c_uv’][0,1]) + " " + str(g.bp[n][’c_uv’
][0,2]), verbose=3)
output.log("
" + str(g.bp[n][’c_uv’][1,0]) + " " + str(g.bp[n][’c_uv’][1,1]) + " " + str(g.bp[n][’c_uv’
][1,2]), verbose=3)
output.log("
" + str(g.bp[n][’c_uv’][2,0]) + " " + str(g.bp[n][’c_uv’][2,1]) + " " + str(g.bp[n][’c_uv’
][2,2]), verbose=3)
output.log("v0
" + str(g.bp[n][’c_v0’]), verbose=3)
output.log("e0
" + str(g.bp[n][’c_e0’]), verbose=3)
output.log("b0
" + str(g.bp[n][’c_b0’]), verbose=3)
output.log("b0gpa " + str(g.bp[n][’c_b0_gpa’]), verbose=3)
output.log("", verbose=3)
output.log("", verbose=3)

660
661
662
663
664

@staticmethod
def bulk_r(sc):
return 1.0 / (sc[0,0] + sc[1,1] + sc[2,2] + 2.0 * (sc[0,1] + sc[0,2] + sc[1,2]))

665
666
667
668

@staticmethod
def bulk_v(ec):
return ((1.0 / 9.0) * (ec[0,0] + ec[1,1] + ec[2,2]) + (2.0 / 9.0) * (ec[0,1] + ec[0,2] + ec[1,2]))

669
670
671
672
673

@staticmethod
def shear_g_r(sc):
return (15.0 / (4*(sc[0,0]+sc[1,1]+sc[2,2]) - 4*(sc[0,1]+sc[0,2]+sc[1,2]) + 3* (sc[3,3]+sc[4,4]+sc[5,5])))

674
675
676
677

@staticmethod
def shear_g_v(ec):
return (1.0/15.0) * (ec[0,0]+ec[1,1]+ec[2,2]-ec[0,1]-ec[0,2]-ec[1,2]) + (1.0/5.0) * (ec[3,3] + ec[4,4] + ec
[5,5])

678
679
680
681
682
683
684
685

@staticmethod
def shear_g_vec(sc):
gvec = numpy.zeros((3,), dtype=numpy.float64)
gvec[0] = 1.0 / (2.0 * sc[3,3])
gvec[1] = 1.0 / (2.0 * sc[4,4])
gvec[2] = 1.0 / (2.0 * sc[5,5])
return gvec

686
687
688
689

@staticmethod
def youngs_e(b0_avg, g_avg):
return (9 * b0_avg * g_avg) / (3 * b0_avg + g_avg)

690
691
692
693
694
695
696
697

@staticmethod
def shear_e_vec(sc):
evec = numpy.zeros((3,), dtype=numpy.float64)
evec[0] = 1.0 / sc[0,0]
evec[1] = 1.0 / sc[1,1]
evec[2] = 1.0 / sc[2,2]
return evec

698
699
700
701

@staticmethod
def melting_temperature(ec):
return 598.0 + 6.66 * (ec[0,0]+ec[1,1]+ec[2,2]) - 0.003 * (ec[0,0]+ec[1,1]+ec[2,2])**2

702
703

483

Q.7. INTERPOLATION

704
705
706
707
708

APPENDIX Q. EAMPA CODE

@staticmethod
def cubic_stability(ec):
if((ec[0,0] + 2 * ec[0,1]) > 0 and (ec[0,0] - ec[0,1]) > 0 and ec[3,3] > 0):
return True
return False

709
710
711
712
713
714
715
716
717
718
719
720

@staticmethod
def stability(ec):
if((ec[0,0] > 0.0) and (ec[1,1] > 0.0) and (ec[2,2] > 0.0) and
(ec[3,3] > 0.0) and (ec[4,4] > 0.0) and (ec[5,5] > 0.0) and
(ec[0,0] + ec[1,1] - 2 * ec[0,1]) > 0.0 and
(ec[0,0] + ec[2,2] - 2 * ec[0,2]) > 0.0 and
(ec[1,1] + ec[2,2] - 2 * ec[1,2]) > 0.0 and
(ec[0,0] + ec[1,1] + ec[2,2] + 2 * ec[0,1] + 2 * ec[0,2] + 2 * ec[1,2]) > 0):
return True
return False

Q.7

Interpolation

Lagrange polynomial interpolation was programmed in Fortran and was used in a number of places throughout
the program (listing Q.10).
Listing Q.10: Lagrange polynomial interpolation
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27

SUBROUTINE interpn(xi, x, y, yi)
! INTERP N SIZES DATA ARRAY
IMPLICIT NONE
! IN/OUT
REAL(kind=DoubleReal), INTENT(IN) :: xi
REAL(kind=DoubleReal), INTENT(IN) :: x(:)
REAL(kind=DoubleReal), INTENT(IN) :: y(:)
REAL(kind=DoubleReal), INTENT(OUT) :: yi
! PRIVATE
INTEGER(kind=StandardInteger) :: i, j, n
REAL(kind=DoubleReal) :: li
!############################################################
n = SIZE(x,1)
yi = 0.0D0
IF (SIZE(x,1) .EQ. SIZE(y,1)) THEN
DO i = 1, n
li = 1.0D0
DO j = 1, n
IF(i .NE. j) THEN
li = li * (xi - x(j)) / (x(i) - x(j))
END IF
END DO
yi = yi + li * y(i)
END DO
END IF
!############################################################
END SUBROUTINE interpn

Q.8

Interpolation (Gradient)

A modified version of the Lagrange polynomial interpolation was programmed in Fortran to interpolate the
derivative of a set of data points at a given position between (and including) the start and end point (listing
484

APPENDIX Q. EAMPA CODE

Q.8. INTERPOLATION (GRADIENT)

Q.11).
Listing Q.11: Lagrange polynomial interpolation (Gradients)
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35

SUBROUTINE interpndydx(xi, x, y, ypi)
! Interpolate and return derivative at xi
IMPLICIT NONE
! IN/OUT
REAL(kind=DoubleReal), INTENT(IN) :: xi
REAL(kind=DoubleReal), INTENT(IN) :: x(:)
REAL(kind=DoubleReal), INTENT(IN) :: y(:)
REAL(kind=DoubleReal), INTENT(OUT) :: ypi
! PRIVATE
INTEGER(kind=StandardInteger) :: i, j, k, n
REAL(kind=DoubleReal) :: fx, gx, psum
!############################################################
n = SIZE(x,1)
IF (SIZE(x,1) .EQ. SIZE(y,1)) THEN
ypi = 0.0D0
Do i=1,SIZE(x,1)
fx = 1.0D0
gx = 0.0D0
Do j=1,SIZE(x,1)
If(i .NE. j) Then
fx = fx / (x(i) - x(j))
psum = 1.0D0
Do k=1,SIZE(x,1)
If((i .NE. k) .AND. (j .NE. k))Then
psum = psum * (xi - x(k))
End If
End Do
gx = gx + psum
End If
End Do
ypi = ypi + fx * gx * y(i)
End Do
END IF
!############################################################
END SUBROUTINE interpndydx

485

Appendix R

Potential Functions
R.1

Introduction

This section of the appendix covers the types of potential function and common choices of function used and
details on how to use these in the potential fitting code.

R.2
R.2.1

Functions
Ackland Embedding
Listing R.1: Ackland Embedding Fortran code

1
2

!# Olsson/Walenius
!# Ackland Mendelev 2004

3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20

SUBROUTINE ackland_embedding(r, p, p_fixed, y)
!############################################################
! f(x) = -sqrt(r) + A * r**2 + B * r**4
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
!############################################################
IF(r .LT. 0.0D0)THEN
y = 0.0D0
ELSE
y = -1.0D0 * sqrt(r) + p(1) * (r)**2 + p(2) * (r)**4
END IF
END SUBROUTINE ackland_embedding

21
22
23
24
25
26
27
28
29

SUBROUTINE ackland_embedding_v(r, p, p_fixed, y)
!############################################################
! f(x) = A * sqrt(r) + B * r**2 + C * r**4
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)

486

APPENDIX R. POTENTIAL FUNCTIONS

30
31
32
33
34
35
36
37
38

R.2. FUNCTIONS

REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
DO n = 1, SIZE(r,1)
CALL ackland_embedding(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE ackland_embedding_v

Listing R.2: Ackland Embedding EAMPA input file
1
2
3

#TYPE
#P
#PF

ackland_embedding
-0.5 1.0
0.0

Plot: ackland_embedding

10.0

energy
gradient

Energy (eV) (den ity for den )

7.5
5.0
2.5
0.0
−2.5
−5.0
−7.5
−10.0

0

1

2
3
4
5
Radius (ang ) (den ity for embe)
Figure R.1: Ackland Mendelev

R.2.2

Buckingham
Listing R.3: Buckingham Fortran code

1

! Buckingham Potential

2
3
4
5
6
7
8
9
10
11
12
13
14

SUBROUTINE buckingham(r, p, p_fixed, y)
!############################################################
! BUCKINGHAM POTENTIAL
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(1:3)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(1:1)
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
y = p(1) * exp(-1 * p(2) * r) - p(3) / r**6
END SUBROUTINE buckingham

15

487

6

7

R.2. FUNCTIONS

APPENDIX R. POTENTIAL FUNCTIONS

16
17
18
19
20
21
22
23
24
25
26
27
28
29

SUBROUTINE buckingham_v(r, p, p_fixed, y)
!############################################################
! BUCKINGHAM POTENTIAL
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(1:3)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(1:1)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
!############################################################
y(:) = p(1) * exp(-1 * p(2) * r(:)) - p(3) / r(:)**6
END SUBROUTINE buckingham_v

Listing R.4: Buckingham EAMPA input file
1
2
3

#TYPE
#P
#PF

buckingham
6.0 0.5 12.0
0.0

Plot: buckingham

10.0

energy
gradient

Energy (eV) (den ity for den )

7.5
5.0
2.5
0.0
−2.5
−5.0
−7.5
−10.0

0

1

2
3
4
5
Radius (ang ) (den ity for embe)
Figure R.2: Buckingham

R.2.3

Lennard Jones
Listing R.5: Lennard Jones Fortran code

1
2
3
4
5
6
7
8
9
10

SUBROUTINE lennard_jones(r, p, p_fixed, y)
!############################################################
! LENNARD JONES FUNCTION
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(1:2)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(1:1)

488

6

7

APPENDIX R. POTENTIAL FUNCTIONS

11
12
13
14

R.2. FUNCTIONS

REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
y = p(1) * ((p(2) / r)**12 - 2 * (p(2)/r)**6)
END SUBROUTINE lennard_jones

15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31

SUBROUTINE lennard_jones_v(r, p, p_fixed, y)
!############################################################
! LENNARD JONES VECTOR FUNCTION
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(1:2)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(1:1)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
!############################################################
INTEGER(kind=StandardInteger) :: n
!############################################################
DO n = 1, SIZE(r,1)
CALL lennard_jones(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE lennard_jones_v

Listing R.6: Lennard Jones EAMPA input file
1
2
3

#TYPE
#P
#PF

lennard_jones
2.3 3.5
0.0

Plo : lennard_jones

10.0

energy
gradien

Energy (eV) (densi y for dens)

7.5
5.0
2.5
0.0
−2.5
−5.0
−7.5
−10.0

0

1

2
3
4
5
Radius (angs) (densi y for embe)
Figure R.3: Lennard Jones

R.2.4

Mishin Density
Listing R.7: Mishin Density Fortran code

1

!# Mishin

2
3

SUBROUTINE mishin_density(r, p, p_fixed, y)

489

6

7

R.2. FUNCTIONS

4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24

APPENDIX R. POTENTIAL FUNCTIONS

!############################################################
! f(x) = (N r^3 e^(-z r))^2
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(1:7)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(1:1)
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
REAL(kind=DoubleReal) :: rc, r0, h
REAL(kind=DoubleReal) :: A, B, C, gamma, yb
REAL(kind=DoubleReal) :: psi, e, x, z
!############################################################
rc = p_fixed(1)
r0 = p(1)
h = p(2)
A = p(3)
B = p(4)
C = p(5)
gamma = p(6)
yb = p(7)

25
26
27
28
29
30
31
32
33
34
35

IF(r .GT. rc)THEN
y = 0.0D0
ELSE
x = ((r - rc) / h)**4
psi = x / (1 + x)
z = r - r0
e = exp(-1.0D0 * gamma * z)
y = psi * (A * z**yb * e * (1 + B * e) + C)
END IF
END SUBROUTINE mishin_density

36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52

SUBROUTINE mishin_density_v(r, p, p_fixed, y)
!############################################################
! f(x) = (N r^3 e^(-z r))^2
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
DO n = 1, SIZE(r,1)
CALL mishin_density(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE mishin_density_v

Listing R.8: Mishin Density EAMPA input file
1
2
3
4

#TYPE
#P
#PF

mishin_density
0.5 0.3 1.0 1.0 1.0 &
1.0 1.0
6.0

490

APPENDIX R. POTENTIAL FUNCTIONS

R.2. FUNCTIONS

Plo : mishin_densi y

Energy (eV) (densi y for dens)

8

energy
gradien

6
4
2
0
−2
−4

0

1

2
3
4
5
Radius (angs) (densi y for embe)

6

Figure R.4: Mishin Density

R.2.5

Morse
Listing R.9: Morse Fortran code

1
2
3
4
5
6
7
8
9
10
11
12
13
14

SUBROUTINE morse(r, p, p_fixed, y)
!############################################################
! MORSE FUNCTION
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(1:3)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(1:1)
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
y = p(1) * (exp(-2.0D0 * p(2) * (r - p(3))) - 2.0D0 * exp(-p(2)*(r - p(3))))
END SUBROUTINE morse

15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30

SUBROUTINE morse_v(r, p, p_fixed, y)
!############################################################
! MORSE FUNCTION
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(1:3)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(1:1)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
!############################################################
y(:) = p(1) * (exp(-2.0D0 * p(2) * (r(:) - p(3))) - 2.0D0 * exp(-p(2)*(r(:) - p(3))))
END SUBROUTINE morse_v

Listing R.10: Mishin Density EAMPA input file
491

7

R.2. FUNCTIONS

1
2
3

#TYPE
#P
#PF

APPENDIX R. POTENTIAL FUNCTIONS

morse
4.669 1.256 2.8
0.0

Plot: morse

10.0

energ
gradient

Energ (eV) (densit for dens)

7.5
5.0
2.5
0.0
−2.5
−5.0
−7.5
−10.0

0

1

2
3
4
5
Radius (angs) (densit for embe)

6

Figure R.5: Morse

R.2.6

Polynomial Embedding
Listing R.11: Polynomial Embedding Fortran code

1
2
3
4

!# Polynomial embedding
!# General function for embedding functions
!# like F(r) = sqrt(r)
!#
F(r) = A sqrt(r) + B r**2 + C r**3

5
6
7
8
9
10
11
12
13
14
15
16
17
18
19

SUBROUTINE polynomial_embedding(r, p, p_fixed, y)
!############################################################
! f(x) = (N r^3 e^(-z r))^2
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
!# Coeff
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:) !# Power
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
INTEGER(kind=StandardInteger) :: n
!############################################################
y = 0.0D0

20
21
22
23

IF(SIZE(p,1) .NE. SIZE(p_fixed,1))THEN
RETURN
END IF

24
25
26

DO n = 1, SIZE(p,1)
y = y + p(n) * r**p_fixed(n)

492

7

APPENDIX R. POTENTIAL FUNCTIONS

27

R.2. FUNCTIONS

END DO

28
29

END SUBROUTINE polynomial_embedding

30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47

SUBROUTINE polynomial_embedding_v(r, p, p_fixed, y)
!############################################################
!
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
DO n = 1, SIZE(r,1)
CALL polynomial_embedding(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE polynomial_embedding_v

Listing R.12: Polynomial Embedding EAMPA input file
1
2
3
4
5

#TYPE polynomial_embedding
#P &
0.038121933276638625 -1.1405198957613036 0.5042566260031044
#PF &
0.0 0.5 2.0

Plo : polynomial_embedding

10.0

energy
gradien

Energy (eV) (densi y for dens)

7.5
5.0
2.5
0.0
−2.5
−5.0
−7.5
−10.0

0

1

2
3
4
5
Radius (angs) (densi y for embe)
Figure R.6: Polynomial Embedding

R.2.7

Spline
Listing R.13: Spline Fortran code

1

! POWER SPLINE

493

6

7

R.2. FUNCTIONS

2
3

APPENDIX R. POTENTIAL FUNCTIONS

! sum (ai (r - ri)^3 H(ri - r)) - cubic example
! sum (ai (r - ri)^5 H(ri - r)) - quintic example

4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37

! SCALAR SUBROUTINE
SUBROUTINE spline(r, p, p_fixed, y)
!############################################################
! p coefficients
! pf r cutoffs
! they must be the same size
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
INTEGER(kind=StandardInteger) :: ps, pfs, ss
REAL(kind=DoubleReal) :: settings(1:10)
REAL(kind=DoubleReal) :: nodes(1:SIZE(p,1))
REAL(kind=DoubleReal) :: rk
INTEGER(kind=StandardInteger) :: n, k
! Settings
INTEGER(kind=StandardInteger) :: power_lower
INTEGER(kind=StandardInteger) :: power_upper
INTEGER(kind=StandardInteger) :: rkoption
REAL(kind=DoubleReal) :: zbl_qa
REAL(kind=DoubleReal) :: zbl_qb
REAL(kind=DoubleReal) :: h_node_r = 0.0D0
REAL(kind=DoubleReal) :: h_node_c = 0.0D0
INTEGER(kind=StandardInteger) :: h_node_p
REAL(kind=DoubleReal) :: yzbl
!############################################################
y = 0.0D0
ss = 10
ps = SIZE(p,1)
pfs = SIZE(p_fixed,1)

38
39
40
41

IF(pfs .LT. ss)THEN
RETURN
END IF

42
43
44
45
46
47
48
49
50
51
52

!Read Settings
settings(1:ss) = p_fixed(1:ss)
power_lower = INT(settings(1)) ! 3, 5 etc
power_upper = INT(settings(2)) !
rkoption = INT(settings(3)) ! 0 = (rk - r)^n 1 = (r - rk)^n
zbl_qa = settings(4)
zbl_qb = settings(5)
h_node_r = settings(6) ! Hardening node rcutoff
h_node_c = settings(7) ! Hardening node coefficient
h_node_p = INT(settings(8)) ! Hardening node power

53
54
55
56
57
58

IF(pfs .NE. (ps + ss))THEN
RETURN
END IF
nodes(1:ps) = p_fixed(ss+1:pfs)

59
60
61
62

IF(r .GT. nodes(ps))THEN
RETURN
END IF

494

APPENDIX R. POTENTIAL FUNCTIONS

R.2. FUNCTIONS

63
64
65
66
67

! Hardening node (See G. Bonny 2012 code)
IF(h_node_r .GT. 0.0D0 .AND. r .LE. h_node_r)Then
y = y + h_node_c * (h_node_r - r)**h_node_p
END IF

68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85

! Power spline
k = power_lower
DO n = 1, ps
rk = nodes(n)
IF((rk - r) .GE. 0.0D0)THEN
IF(rkoption .EQ. 0)THEN
y = y + p(n) * (rk - r)**k
ELSE
y = y + p(n) * (r - rk)**k
END IF
END IF
IF(k .LT. power_upper)THEN
k = k + 1
ELSE
k = power_lower
END IF
END DO

86
87
88
89
90
91

! Add ZBL
IF(zbl_qa .GT. 0.0D0 .AND. zbl_qb .GT. 0.0D0)THEN
CALL fzbl(r, zbl_qa, zbl_qb, yzbl)
y = y + yzbl
END IF

92
93
94
95
96
97
98

END SUBROUTINE spline

99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118

! VECTOR SUBROUTINE
SUBROUTINE spline_v(r, p, p_fixed, y)
!############################################################
! CUBIC SPLINE
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
! Loop through all the values in r(:), calculate and store in y(:)
DO n = 1, SIZE(r,1)
CALL spline(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE spline_v

Listing R.14: Spline EAMPA input file
1
2
3

#TYPE spline
#P &
-0.02824709259353992 -0.0038975302342977554 0.009294738388828702 3.9855208652451597 0.0028557787639382896&

495

R.2. FUNCTIONS

4
5
6
7
8
9
10
11
12
13
14
15
16
17

APPENDIX R. POTENTIAL FUNCTIONS

0.0018722262741587487 0.011903683205418056 2.259132956719706 0.008337580816090939 0.03536382246217887&
-0.006621737018652023 -0.004848655783835753 -0.006622894344592526 -0.026680695834797048 -0.009536352529412656&
0.06589011969329195 -0.02061858362766938 -0.01996275803193492 -0.005684409326651412 -0.008274484883510824&
-0.011570387361426513 -0.06063410167907909 0.013200239389132591 -0.03653817989122159 0.029218155517063922&
0.02710172178454872 -0.024774791113409026
#PF &
3.0 3.0 0.0 26.0 26.0&
1.8 1000.0 3.0 0.0 0.0&
2.1 2.2 2.3 2.4 2.5&
2.6 2.7 2.8 2.9 3.0&
3.1 3.2 3.3 3.4 3.5&
3.6 3.7 3.8 3.9 4.0&
4.4 4.6 4.8 5.2 5.6&
6.0 6.3

Plot: spline

10.0

energy
gradient

Energy (eV) (density for dens)

7.5
5.0
2.5
0.0
−2.5
−5.0
−7.5
−10.0

0

1

2
3
4
5
Radius (angs) (density for embe)
Figure R.7: Spline

R.2.8

Slater 4s
Listing R.15: Slater 4s Fortran code

1

!# Slater 4S

2
3
4
5
6
7
8
9
10
11
12
13

SUBROUTINE slater_4s(r, p, p_fixed, y)
!############################################################
! f(x) = (N r^3 e^(-z r))^2
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
!############################################################

14
15
16

IF(SIZE(p) .EQ. 2)THEN
y = (p(1) * r**3 * exp(-1.0D0 * p(2) * r))**2

496

6

7

APPENDIX R. POTENTIAL FUNCTIONS

17
18
19
20

R.2. FUNCTIONS

ELSE IF(SIZE(p) .EQ. 4)THEN
y = (p(1) * r**3 * exp(-1.0D0 * p(2) * r))**2 + &
(p(3) * r**3 * exp(-1.0D0 * p(4) * r))**2
END IF

21
22
23
24
25
26

IF(SIZE(p_fixed) .EQ. 1)THEN
IF(p_fixed(1) .GT. 0.0D0)THEN
CALL cutoff(r, p_fixed(1), 3, y)
END IF
END IF

27
28
29

END SUBROUTINE slater_4s

30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46

SUBROUTINE slater_4s_v(r, p, p_fixed, y)
!############################################################
! f(x) = (N r^3 e^(-z r))^2
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
DO n = 1, SIZE(r,1)
CALL slater_4s(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE slater_4s_v

Listing R.16: Slater 4s EAMPA input file
#TYPE
#P
#PF

slater_4s
5.0 1.323
0.0

Plot: slater_4s

10.0

energy
gradient

7.5
Energy (eV) (density for dens)

1
2
3

5.0
2.5
0.0
−2.5
−5.0
−7.5
−10.0

0

1

2
3
4
5
Radius (angs) (density for embe)
Figure R.8: Slater 4s

497

6

7

R.2. FUNCTIONS

R.2.9

APPENDIX R. POTENTIAL FUNCTIONS

Zero
Listing R.17: Zero Fortran code

1
2
3

! Just a zero function
! f(x) = 0
! Can be used to turn off certain potential functions

4
5
6
7
8
9
10
11
12
13
14
15
16
17

SUBROUTINE zero(r, p, p_fixed, y)
!############################################################
! f(x) = 0
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y
!############################################################
!############################################################
y = 0.0D0
END SUBROUTINE zero

18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35

SUBROUTINE zero_v(r, p, p_fixed, y)
!############################################################
! f(x) = 0
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: r(:)
REAL(kind=DoubleReal), INTENT(IN) :: p(:)
REAL(kind=DoubleReal), INTENT(IN) :: p_fixed(:)
REAL(kind=DoubleReal), INTENT(OUT) :: y(1:SIZE(r,1))
INTEGER(kind=StandardInteger) :: n
!############################################################
DO n = 1, SIZE(r,1)
CALL zero(r(n), p, p_fixed, y(n))
END DO
END SUBROUTINE zero_v

Listing R.18: Zero EAMPA input file
1
2
3

#TYPE
#P
#PF

zero
0.0
0.0

498

APPENDIX R. POTENTIAL FUNCTIONS

R.2. FUNCTIONS

Plot: zero
energ
gradient

Energ (eV) (densit for dens)

0.04

0.02

0.00

−0.02

−0.04
0

1

2
3
4
5
Radius (angs) (densit for embe)
Figure R.9: Zero

499

6

7

Appendix S

Fe-Pd and Fe-Ru Structures

Figure S.1: FePd Structure 01

Figure S.2: FePd Structure 02

500

APPENDIX S. FE-PD AND FE-RU STRUCTURES

Figure S.3: FePd Structure 03

Figure S.4: FePd Structure 04

501

APPENDIX S. FE-PD AND FE-RU STRUCTURES

Figure S.5: FePd Structure 05

502

Appendix T

Fe-Pd Potential
This potential has been developed specifically for Fe and Pd where the atoms are in an FCC structure. Particular
weighting was given to the relaxed configurations of each pure element, those with small additions of Pd to Fe
and surface/slab configurations.

T.1

Tabulated Potential

The files for the potential are large, with the LAMMPS version being over 7,000 lines long containing 35,000+
data points. They are not included here but are available to download from:
https://github.com/BenPalmer1983/fepd feru potential

503

T.2. POTENTIAL FUNCTION PLOTS

T.2

APPENDIX T. FE-PD POTENTIAL

Potential Function Plots

The seven functions that make up the potential are plotted in figure T.1.
10

10

10

8

8

8

6

6

6

4

4

4

2

2

2

0

0

0

−2

−2

−2

−4

−4
0

1

2

3

4

5

6

−4
0

1

(a) Fe-Fe Pair

2

3

4

5

6

0

(b) Fe-Pd Pair
10

10

8

8

8

6

6

6

4

4

4

2

2

2

0

0

0

−2

−2

−2

−4

−4
1

2

3

4

5

6

(d) Fe Density

1

2

3

4

5

6

(e) Fe Embed

8
6
4
2
0
−2
−4
1

2

3

4

3

4

5

6

5

6

−4
0

10

0

2

(c) Pd-Pd Pair

10

0

1

5

(g) Pd Embed

Figure T.1: Binary Alloy Potential for Fe-Pd

504

0

1

2

3

4

(f) Pd Density

APPENDIX T. FE-PD POTENTIAL

T.3

T.3. POTENTIAL VS DFT

Potential vs DFT

The potentials were derived with a larger weight applied to a smaller set of configurations. How well the
potential fits to the DFT results in terms of energy is given in figure T.2.
Known vs Potential Ene gy
−3.5

Known vs Po en ial Energy

Known vs potential
Known vs known

−3.6

10.0

Calcula ed Energy per A om (eV)

Calculated Ene gy pe Atom (eV)

Known vs po en ial
Known vs known

12.5

−3.7

−3.8

−3.9

−4.0

−4.1

7.5

5.0

2.5

0.0

−2.5

−4.2

−4.2

−4.1

−4.0

−3.9

−3.8

−3.7

Potential Ene gy pe Atom (eV)

−3.6

−5.0

−3.5

−4

(a) DFT vs Potential, highly weighted configurations

−2

0

2

4

6

8

Potential Energy per A om (eV)

10

12

(b) DFT vs Potential, all configurations

Figure T.2: Fe-Pd - a measure of how well the potential fits to first principles calculations

The DFT computed surface energy, as the slab forms from the increased gap between two surfaces, is given in
figure T.3.
Surface energy fr m bulk t slab

(3.7

Kn wn energy
P tential energy

(3.8

Calculated Energy per At m (eV)

(3.8

Calculated Energy per At m (eV)

Surface energy fr m bulk t slab

(3.7

Kn wn energy
P tential energy

(3.9

(4.0

(4.1

(4.2

(3.9

(4.0

(4.1

(4.2

0

1

2

3

Surface separati n a0 (angstr m)

4

5

0

(a) Fe surface energy at a range of surface separations

1

2

3

Surface separati n a0 (angstr m)

4

5

(b) Pd surface energy at a range of surface separations

Figure T.3: Equation of State plots from this potential for FCC Fe

505

T.4. BULK PROPERTIES

T.4

APPENDIX T. FE-PD POTENTIAL

Bulk Properties

T.4.1

Iron FCC

Bulk Property Values

Property

DFT Computed

This Potential

𝑎0 (angs)

3.42
⎤
0.0 0.0
⎥
1.05 0.0⎦
0.0 1.0
-4.26
226.1(a) 222.0(b)
⎤
⎡
364.6 141.6 233.8
0
0
0
⎥
⎢
0
0
0 ⎥
⎢141.6 298.7 130.40
⎥
⎢
⎢233.8 130.4 364.6
0
0
0 ⎥
⎥
⎢
⎢ 0
0
0
186.3
0
0 ⎥
⎥
⎢
⎥
⎢
⎣ 0
0
0
0
266.8
0 ⎦
0
0
0
0
0
186.3
⎡
1.0
⎢
⎣0.0
0.0

Basis
𝐸𝑐𝑜ℎ (eV)
𝐵0 (GPa)

Stiff.1 (GPa)

⎡
312.6
⎢
⎢182.3
⎢
⎢222.8
⎢
⎢ 0
⎢
⎢
⎣ 0
0
⎡
329.3
⎢
⎢205.3
⎢
⎢205.3
⎢
⎢ 0
⎢
⎢
⎣ 0
0

Stiff.2 (GPa)

3.42
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.05 0.0⎦
0.0 0.0 1.0
-4.27
246.6(a) 235.2(b)
⎤
182.3 222.8
0
0
0
⎥
321.6 182.3
0
0
0 ⎥
⎥
182.3 312.6
0
0
0 ⎥
⎥
0
0
171.9
0
0 ⎥
⎥
⎥
0
0
0
223.1
0 ⎦
0
0
0
0
171.9
⎤
205.3 205.3
0
0
0
⎥
329.3 205.3
0
0
0 ⎥
⎥
205.3 329.3
0
0
0 ⎥
⎥
0
0
198.4
0
0 ⎥
⎥
⎥
0
0
0
198.4
0 ⎦
0
0
0
0
198.4

Table T.1: The lattice parameter, cohesive energy and bulk modulus were determined by fitting the Birch-Murnaghan
equation of state. The bulk modulus is computed from the Birch-Murnaghan equation of state (a) and the average Reuss
and Voight Bulk Moduldus (b). The elastic constants computed for the potential in stiffness (1) were computed using
the method by Ravindran et al[109] and in stiffness (2) by Mehl et al[104][110].

Equation of State Plots
Both the Birch-Murnaghan and Rose-Vinet equation of states are used in the fitting process.
Equa ion of S a e

Rose Equation of State
This potential
Rose predicted energy-volume

20

−4.05
Energy (ev/a om)

Energy (ev/atom)

15
10
5

−4.10
−4.15
−4.20

0
−5

Po en ial EoS
Known EoS B0'=2.0
Known EoS B0'=3.0
Known EoS B0'=4.0

−4.00

−4.25

3

4
5
6
Lattice Constant (ang)

7

9.0

(a) Rose-Vinet

9.5

10.0
10.5
11.0
Volume (ang^3/a om)

11.5

(b) Birch Murnaghan

Figure T.4: Equation of State plots from this potential for FCC Fe

506

12.0

APPENDIX T. FE-PD POTENTIAL

T.4. BULK PROPERTIES

Elastic Constant Plots

Elastic Constant Curves

0.00
Strain / a0

0.05

−4.22

Energy / e0

Energy / e0

Distortion D4
−4.24
−4.26
−0.05

0.00
Strain / a0

0.05

−4.24
−4.26
−0.05

0.00
Strain / a0

−4.20

0.05

0.00
Strain / a0

0.05

−4.24
−4.26
−0.05

Distortion D5

−4.24
−4.26
−0.05

0.00
Strain / a0

0.05

−4.24
−4.26
−0.05

0.00
Strain / a0

0.05

Distortion D9

−4.255
−4.260
0.00
Strain / a0

0.05

−4.22

Distortion D8

−0.05

0.00
Strain / a0

Distortion D6

−4.22

−4.250
Energy / e0

Energy / e0

Distortion D7

−4.26
−0.05

Energy / e0

−4.26
−0.05

−4.24

Energy / e0

−4.24

Distortion D3
Energy / e0

Distortion D2
Energy / e0

Energy / e0

Distortion D1

−4.24
−4.26

0.05

−0.05

0.00
Strain / a0

0.05

Figure T.5: Ravindran et al[109] distortion-energy plots for FCC Fe
MSP Cubic Elastic Constant C11-C12

MSP Cubic Elastic Constant C44

−4.225

−4.230
−4.235

−4.235

Energy (ev/atom)

Energy (e /atom)

−4.230
−4.240
−4.245
−4.250

−4.240
−4.245
−4.250
−4.255

−4.255

−4.260

−4.260
0.00

0.01

0.02

Strain

0.03

0.04

0.05

0.00

(a) C11-C12 orthorhombic distortion

0.01

0.02

Strain

0.03

0.04

0.05

(b) C44 monoclinic distortion

Figure T.6: MSKP elastic constant strains, where the solid line is the known value and the points the values for this
potential - FCC Fe

507

T.4. BULK PROPERTIES

T.4.2

APPENDIX T. FE-PD POTENTIAL

Palladium FCC

Property

DFT Computed

𝑎0 (angs)
Basis
𝐸𝑐𝑜ℎ (eV)
𝐵0 (GPa)

⎡
218.5
⎢
⎢151.4
⎢
⎢151.4
⎢
⎢ 0
⎢
⎢
⎣ 0
0

Stiff.1 (GPa)

This Potential

3.93
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-3.91
184.4(a) 173.7(b)
⎤
151.4 151.4
0
0
0
⎥
218.5 151.3
0
0
0 ⎥
⎥
151.3 218.4
0
0
0 ⎥
⎥
0
0
80.3
0
0 ⎥
⎥
⎥
0
0
0
80.3
0 ⎦
0
0
0
0
80.2

Stiff.2 (GPa)

3.89
⎤
0.0 0.0
⎥
1.0 0.0⎦
0.0 1.0
-3.78
165.0(a) 156.0(b)
⎤
140.3 140.3
0
0
0
⎥
187.1 140.3
0
0
0 ⎥
⎥
140.3 187.1
0
0
0 ⎥
⎥
0
0
68.0
0
0 ⎥
⎥
⎥
0
0
0
68.0
0 ⎦
0
0
0
0
68.0
⎤
152.0 152.0
0
0
0
⎥
191.1 152.0
0
0
0 ⎥
⎥
152.0 191.1
0
0
0 ⎥
⎥
0
0
58.8
0
0 ⎥
⎥
⎥
0
0
0
58.8
0 ⎦
0
0
0
0
58.8
⎡
1.0
⎢
⎣0.0
0.0

⎡
187.1
⎢
⎢140.3
⎢
⎢140.3
⎢
⎢ 0
⎢
⎢
⎣ 0
0
⎡
191.1
⎢
⎢152.0
⎢
⎢152.0
⎢
⎢ 0
⎢
⎢
⎣ 0
0

Table T.2: The lattice parameter, cohesive energy and bulk modulus were determined by fitting the Birch-Murnaghan
equation of state. The bulk modulus is computed from the Birch-Murnaghan equation of state (a) and the average Reuss
and Voight Bulk Moduldus (b). The elastic constants computed for the potential in stiffness (1) were computed using
the method by Ravindran et al[109] and in stiffness (2) by Mehl et al[104][110].

Equation of State Plots
Both the Birch-Murnaghan and Rose-Vinet equation of states are used in the fitting process.
Rose Equation of State
This p tential
R se predicted energ(-volume

12.5
10.0

(3.70

7.5

(3.75

Energy (ev/at m)

Energ( (ev/at m)

Equati n f State

5.0
2.5

(3.80

0.0

(3.85

)2.5

(3.90

3

4

5
6
Lattice C nstant (ang)

7

P tential E S
Kn wn E S B0'=2.0
Kn wn E S B0'=3.0
Kn wn E S B0'=4.0

8

13

(a) Rose-Vinet

14

15
16
Volume (ang^3/at m)

17

(b) Birch Murnaghan

Figure T.7: Equation of State plots from this potential for FCC Pd

508

APPENDIX T. FE-PD POTENTIAL

T.4. BULK PROPERTIES

Elastic Constant Plots

Elastic Constant Curves

0.00
Strain / a0

0.05

Distortion D4

−3.88
−3.89
−3.90
−3.91
−0.05

0.00
Strain / a0

0.05

Distortion D7
Energy / e0

−3.910
−0.05

0.00
Strain / a0

−3.90
−3.91
−0.05

−3.88

0.05

0.00
Strain / a0

0.05

Distortion D5

−3.89
−3.90
−3.91
−0.05

−3.900

−3.905

Energy / e0

−3.91
−0.05

−3.89

Energy / e0

−3.90

Distortion D3

0.00
Strain / a0

0.05

Distortion D8

−3.905
−3.910
−0.05

0.00
Strain / a0

−3.89
−3.90
−3.91
−0.05

0.00
Strain / a0

0.05

Distortion D6

−3.88
−3.89
−3.90
−3.91
−0.05

0.00
Strain / a0

0.05

Distortion D9

−3.900
Energy / e0

Energy / e0

−3.89

−3.900
Energy / e0

Distortion D2

Energy / e0

Energy / e0

Energy / e0

Distortion D1

−3.905
−3.910

0.05

−0.05

0.00
Strain / a0

0.05

Figure T.8: Ravindran et al[109] distortion-energy plots for FCC Pd
MSP Cubic Elastic Constant C11-C12

MSP C bic Elastic Constant C44

−3.894
−3.896

−3.902
Energy (ev/atom)

Energy (ev/atom)

−3.898
−3.900
−3.902
−3.904
−3.906

−3.904
−3.906
−3.908

−3.908

−3.910

−3.910
0.00

0.01

0.02

Strain

0.03

0.04

0.05

0.00

(a) C11-C12 orthorhombic distortion

0.01

0.02

Strain

0.03

0.04

0.05

(b) C44 monoclinic distortion

Figure T.9: MSKP elastic constant strains, where the solid line is the known value and the points the values for this
potential - FCC Pd

509

T.4. BULK PROPERTIES

T.4.3

APPENDIX T. FE-PD POTENTIAL

Iron BCC

Property

DFT Computed

𝑎0 (angs)
Basis
𝐸𝑐𝑜ℎ (eV)
𝐵0 (GPa)

Stiff.1 (GPa)

⎡
250.1
⎢
⎢182.3
⎢
⎢183.2
⎢
⎢ 0
⎢
⎢
⎣ 0
0

This Potential

2.80
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-4.32
239.2(a) 205.3(b)
⎤
182.3 183.3
0
0
0
⎥
249.1 182.9
0
0
0 ⎥
⎥
182.9 251.2
0
0
0 ⎥
⎥
0
0
139.2
0
0 ⎥
⎥
⎥
0
0
0
139.7
0 ⎦
0
0
0
0
139.3

2.76
⎤
0.0 0.0
⎥
1.0 0.0⎦
0.0 1.0
-4.16
229.0(a) 207.6(b)
⎤
222.0 222.0
0
0
0
⎥
178.8 222.0
0
0
0 ⎥
⎥
222.0 178.8
0
0
0 ⎥
⎥
0
0
215.2
0
0 ⎥
⎥
⎥
0
0
0
215.2
0 ⎦
0
0
0
0
215.2
⎤
248.5 248.5
0
0
0
⎥
190.1 248.5
0
0
0 ⎥
⎥
248.5 190.1
0
0
0 ⎥
⎥
0
0
168.7
0
0 ⎥
⎥
⎥
0
0
0
168.7
0 ⎦
0
0
0
0
168.7
⎡
1.0
⎢
⎣0.0
0.0

⎡
178.8
⎢
⎢222.0
⎢
⎢222.0
⎢
⎢ 0
⎢
⎢
⎣ 0
0
⎡
190.1
⎢
⎢248.5
⎢
⎢248.5
⎢
⎢ 0
⎢
⎢
⎣ 0
0

Stiff.2 (GPa)

Table T.3: The lattice parameter, cohesive energy and bulk modulus were determined by fitting the Birch-Murnaghan
equation of state. The bulk modulus is computed from the Birch-Murnaghan equation of state (a) and the average Reuss
and Voight Bulk Moduldus (b). The elastic constants computed for the potential in stiffness (1) were computed using
the method by Ravindran et al[109] and in stiffness (2) by Mehl et al[104][110].

Equation of State Plots
Both the Birch-Murnaghan and Rose-Vinet equation of states are used in the fitting process.
Rose Equation of State
−3.90

This potential
Rose predicted energy-volume

50

Po en ial EoS
Known EoS B0'=2.0
Known EoS B0'=3.0
Known EoS B0'=4.0

−3.95
−4.00

40

Energy (ev/a om)

Energy (ev/atom)

Equa ion of S a e

30
20
10

−4.05
−4.10
−4.15
−4.20
−4.25

0

−4.30

2

3

4
5
Lattice Constant (ang)

6

7

9.0

(a) Rose-Vinet

9.5

10.0

10.5
11.0
11.5
Volume (ang^3/a om)

12.0

(b) Birch Murnaghan

Figure T.10: Equation of State plots from this potential for FCC Pd

510

12.5

APPENDIX T. FE-PD POTENTIAL

T.4. BULK PROPERTIES

Elastic Constant Plots

Elastic Constant Curves

0.05

Distortion D4

−4.10
−4.12
−4.14
−0.05

0.00
Strain / a0

0.05

Energy / e0

−4.160
0.00
Strain / a0

0.05

Energy / e0
0.00
Strain / a0

−4.14

0.00
Strain / a0

0.05

−4.12
−4.14
−0.05

Distortion D8

0.00
Strain / a0

0.05

Distortion D9

−4.156

−4.160

0.00
Strain / a0

Distortion D6

−4.10

0.05

−4.158

−0.05

−4.15
−0.05

Distortion D5

0.00
Strain / a0

−4.14

0.05

−4.12

−4.156

−4.158

−0.05

−4.10

−0.05

Distortion D7

−4.156

−4.15
−0.05

Energy / e0

Energy / e0

0.00
Strain / a0

−4.14

Energy / e0

−4.15

Distortion D3

Energy / e0

−4.14

−0.05

Energy / e0

Distortion D2
Energy / e0

Energy / e0

Distortion D1

−4.158
−4.160

0.05

−0.05

0.00
Strain / a0

0.05

Figure T.11: Ravindran et al[109] distortion-energy plots for FCC Pd
MSP Cubic Elastic Constant C11-C12

MSP Cubic Elastic Constant C44

−4.10

−4.10

Energy (ev/atom)

Energy (ev/atom)

−4.15
−4.20
−4.25
−4.30

−4.15
−4.20
−4.25
−4.30

0.00

0.01

0.02

Strain

0.03

0.04

0.05

0.00

(a) C11-C12 orthorhombic distortion

0.01

0.02

Strain

0.03

0.04

0.05

(b) C44 monoclinic distortion

Figure T.12: MSKP elastic constant strains, where the solid line is the known value and the points the values for this
potential - BCC Fe

511

Appendix U

Fe-Ru Potential
This potential has been developed specifically for Fe and Ru where the atoms are in an FCC structure. Particular
weighting was given to the relaxed configurations of each pure element, those with small additions of Ru to Fe
and surface/slab configurations.

U.1

Tabulated Potential

The files for the potential are large, with the LAMMPS version being over 7,000 lines long containing 35,000+
data points. They are not included here but are available to download from:
https://github.com/BenPalmer1983/fepd feru potential

512

APPENDIX U. FE-RU POTENTIAL

U.2

U.2. POTENTIAL FUNCTION PLOTS

Potential Function Plots

The seven functions that make up the potential are plotted in figure U.1.
10

10

10

8

8

8

6

6

6

4

4

4

2

2

2

0

0

0

−2

−2

−2

−4

−4
0

1

2

3

4

5

6

−4
0

1

(a) Fe-Fe Pair

2

3

4

5

6

0

(b) Fe-Ru Pair
10

10

8

8

8

6

6

6

4

4

4

2

2

2

0

0

0

−2

−2

−2

−4

−4
1

2

3

4

5

6

1

2

3

4

5

6

(e) Fe Embed

10

8

6

4

2

0

−2

−4

0.0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

3

4

5

6

5

6

−4
0

(d) Fe Density

2

(c) Ru Ru Pair

10

0

1

4.0

(g) Ru Embed

Figure U.1: Binary Alloy Potential for Fe-Ru

513

0

1

2

3

4

(f) Ru Density

U.3. POTENTIAL VS DFT

U.3

APPENDIX U. FE-RU POTENTIAL

Potential vs DFT

The potentials were derived with a larger weight applied to a smaller set of configurations. How well the
potential fits to the DFT results in terms of energy is given in figure U.2.
Known vs Potential Energ

Kno n vs Potential Energy

Known vs potential
Known vs known
−4.0

10.0

Calculated Energy per Atom (eV)

Calculated Energ per Atom (eV)

Kno n vs potential
Kno n vs kno n

12.5

−4.5

−5.0

−5.5

−6.0

7.5

5.0

2.5

0.0

−2.5

−5.0
−6.5
−6.5

−6.0

−5.5

−5.0

Potential Energ per Atom (eV)

−4.5

−7.5

−4.0

(a) DFT vs Potential, highly weighted configurations

−7.5

−5.0

−2.5

0.0

2.5

5.0

Potential Energy per Atom (eV)

7.5

10.0

12.5

(b) DFT vs Potential, all configurations

Figure U.2: Fe-Ru - a measure of how well the potential fits to first principles calculations

The DFT computed surface energy, as the slab forms from the increased gap between two surfaces, is given in
figure U.3.
Surface energy fr m bulk t slab

(3.7

Surface energy from bulk to slab

Kn wn energy
P tential energy

−6.0

(3.8

−6.1

Calculated Energy er Atom (eV)

Calculated Energy per At m (eV)

Known energy
Potential energy

(3.9

(4.0

(4.1

−6.2

−6.3

−6.4

−6.5

−6.6
(4.2
−6.7
0

1

2

3

Surface separati n a0 (angstr m)

4

5

0

(a) Fe surface energy at a range of surface separations

1

2

3

4

Surface se aration a0 (angstrom)

5

6

(b) Ru surface energy at a range of surface separations

Figure U.3: Equation of State plots from this potential for FCC Fe

514

APPENDIX U. FE-RU POTENTIAL

U.4

U.4. BULK PROPERTIES

Bulk Properties

U.4.1

Iron FCC

Bulk Property Values

Property

DFT Computed

This Potential

𝑎0 (angs)

3.42
⎤
0.0 0.0
⎥
1.05 0.0⎦
0.0 1.0
-4.26
226.1(a) 222.0(b)
⎤
⎡
364.6 141.6 233.8
0
0
0
⎥
⎢
0
0
0 ⎥
⎢141.6 298.7 130.40
⎥
⎢
⎢233.8 130.4 364.6
0
0
0 ⎥
⎥
⎢
⎢ 0
0
0
186.3
0
0 ⎥
⎥
⎢
⎥
⎢
⎣ 0
0
0
0
266.8
0 ⎦
0
0
0
0
0
186.3
⎡
1.0
⎢
⎣0.0
0.0

Basis
𝐸𝑐𝑜ℎ (eV)
𝐵0 (GPa)

Stiff.1 (GPa)

Stiff.2 (GPa)

⎡
312.6
⎢
⎢182.3
⎢
⎢222.8
⎢
⎢ 0
⎢
⎢
⎣ 0
0
⎡
329.3
⎢
⎢205.3
⎢
⎢205.3
⎢
⎢ 0
⎢
⎢
⎣ 0
0

3.42
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.05 0.0⎦
0.0 0.0 1.0
-4.27
246.6(a) 235.2(b)
⎤
182.3 222.8
0
0
0
⎥
321.6 182.3
0
0
0 ⎥
⎥
182.3 312.6
0
0
0 ⎥
⎥
0
0
171.9
0
0 ⎥
⎥
⎥
0
0
0
223.1
0 ⎦
0
0
0
0
171.9
⎤
205.3 205.3
0
0
0
⎥
329.3 205.3
0
0
0 ⎥
⎥
205.3 329.3
0
0
0 ⎥
⎥
0
0
198.4
0
0 ⎥
⎥
⎥
0
0
0
198.4
0 ⎦
0
0
0
0
198.4

Table U.1: The lattice parameter, cohesive energy and bulk modulus were determined by fitting the Birch-Murnaghan
equation of state. The bulk modulus is computed from the Birch-Murnaghan equation of state (a) and the average Reuss
and Voight Bulk Moduldus (b). The elastic constants computed for the potential in stiffness (1) were computed using
the method by Ravindran et al[109] and in stiffness (2) by Mehl et al[104][110].

Equation of State Plots
Both the Birch-Murnaghan and Rose-Vinet equation of states are used in the fitting process.
Equati n f State

Rose Equation of State
This potential
Rose predicted energy-volume

20

Energy (ev/at m)

Energy (ev/atom)

15
10
5
0
−5

P tential E S
Kn wn E S B0'=2.0
Kn wn E S B0'=3.0
Kn wn E S B0'=4.0

(4.18
(4.20
(4.22
(4.24
(4.26

3

4
5
6
Lattice Constant (ang)

7

9.75

(a) Rose-Vinet

10.00 10.25 10.50 10.75 11.00 11.25 11.50
Volume (ang^3/at m)

(b) Birch Murnaghan

Figure U.4: Equation of State plots from this potential for FCC Fe

515

U.4. BULK PROPERTIES

APPENDIX U. FE-RU POTENTIAL

Elastic Constant Plots

Elastic Constant Curves
Distortion D2

−0.02

−4.255
−4.260

0.00 0.02
Strain / a0

−0.02

−4.24
Energy / e0

Energy / e0

Distortion D4
−4.25
−4.26
−0.02

Energy / e0

Energy / e0

−4.26
−0.02

0.00 0.02
Strain / a0

−4.260
−0.02

−4.25
−4.26

0.00 0.02
Strain / a0

−0.02

Distortion D8

0.00 0.02
Strain / a0

Distortion D9

−4.260
−4.262
−0.02

0.00 0.02
Strain / a0

Distortion D6

−4.26

−4.258

−4.255

Distortion D5

−0.02

Distortion D7

−4.250

0.00 0.02
Strain / a0

−4.25

0.00 0.02
Strain / a0

−4.25

Energy / e0

−4.260

−4.250

Energy / e0

−4.255

Distortion D3

Energy / e0

−4.250

Energy / e0

Energy / e0

Distortion D1

−4.25
−4.26

0.00 0.02
Strain / a0

−0.02

0.00 0.02
Strain / a0

Figure U.5: Ravindran et al[109] distortion-energy plots for FCC Fe
MSP Cubic Elastic Constant C11-C12

MSP Cubic Elastic Constant C44

−4.235
−4.240

−4.245

Energy (ev/atom)

Energy (e /atom)

−4.240

−4.250
−4.255

−4.245
−4.250
−4.255
−4.260

−4.260
0.000

0.005

0.010

0.015
Strain

0.020

0.025

0.030

0.000

(a) C11-C12 orthorhombic distortion

0.005

0.010

0.015
Strain

0.020

0.025

0.030

(b) C44 monoclinic distortion

Figure U.6: MSKP elastic constant strains, where the solid line is the known value and the points the values for this
potential - FCC Fe

516

APPENDIX U. FE-RU POTENTIAL

U.4.2

U.4. BULK PROPERTIES

Ruthenium FCC

Property

DFT Computed

𝑎0 (angs)
Basis
𝐸𝑐𝑜ℎ (eV)
𝐵0 (GPa)

Stiff.1 (GPa)

⎡
471.5
⎢
⎢219.1
⎢
⎢219.2
⎢
⎢ 0
⎢
⎢
⎣ 0
0

This Potential

3.81
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-6.62
307.8(a) 303.3(b)
⎤
219.1 219.2
0
0
0
⎥
471.5 219.2
0
0
0 ⎥
⎥
219.2 471.7
0
0
0 ⎥
⎥
0
0
245.0
0
0 ⎥
⎥
⎥
0
0
0
245.0
0 ⎦
0
0
0
0
245.0

Stiff.2 (GPa)

3.79
⎤
0.0 0.0
⎥
1.0 0.0⎦
0.0 1.0
-6.61
331.1(a) 320.4(b)
⎤
⎡
368.3 296.5 296.5
0
0
0
⎥
⎢
0
0
0 ⎥
⎢296.5 368.3 296.5
⎥
⎢
⎢296.5 296.5 368.3
0
0
0 ⎥
⎥
⎢
⎢ 0
0
0
104.0
0
0 ⎥
⎥
⎢
⎥
⎢
⎣ 0
0
0
0
104.0
0 ⎦
0
0
0
0
0
104.0
⎤
⎡
375.0 309.2 309.2
0
0
0
⎥
⎢
0
0
0 ⎥
⎢309.2 375.0 309.2
⎥
⎢
⎢309.2 309.2 375.0
0
0
0 ⎥
⎥
⎢
⎢ 0
0
0
97.5
0
0 ⎥
⎥
⎢
⎥
⎢
⎣ 0
0
0
0
97.5
0 ⎦
0
0
0
0
0
97.5
⎡
1.0
⎢
⎣0.0
0.0

Table U.2: The lattice parameter, cohesive energy and bulk modulus were determined by fitting the Birch-Murnaghan
equation of state. The bulk modulus is computed from the Birch-Murnaghan equation of state (a) and the average Reuss
and Voight Bulk Moduldus (b). The elastic constants computed for the potential in stiffness (1) were computed using
the method by Ravindran et al[109] and in stiffness (2) by Mehl et al[104][110].

Equation of State Plots
Both the Birch-Murnaghan and Rose-Vinet equation of states are used in the fitting process.
Equation of State

Rose Equation of State
−6.46

This otential
Rose redicted energy-volume

20
15

−6.50
Ene gy (ev/atom)

Energy (ev/atom)

Potential EoS
Known EoS B0'=2.0
Known EoS B0'=3.0
Known EoS B0'=4.0

−6.48

10
5
0

−6.52
−6.54
−6.56
−6.58
−6.60

(5

−6.62

3

4

5
6
Lattice Constant (ang)

7

8

12.5

(a) Rose-Vinet

13.0

13.5
14.0
Volume (ang^3/atom)

14.5

(b) Birch Murnaghan

Figure U.7: Equation of State plots from this potential for FCC Ru

517

U.4. BULK PROPERTIES

APPENDIX U. FE-RU POTENTIAL

Elastic Constant Plots

Elastic Constant Curves

Distortion D4

−6.600
−6.605

−0.02

−6.600
−6.605

0.00 0.02
Strain / a0

−6.595

−6.595

−6.590
−6.600

−6.600

−6.600
−6.602
−6.604
0.00 0.02
Strain / a0

−6.595
−6.600
−0.02

0.00 0.02
Strain / a0

Distortion D9

−6.600
−6.602
−6.604
−0.02

0.00 0.02
Strain / a0

Distortion D6

−6.590

−6.605

0.00 0.02
Strain / a0

−0.02

Distortion D8
Energy / e0

Energy / e0

Distortion D7

−0.02

Distortion D5

−0.02

−6.595
−6.605

0.00 0.02
Strain / a0

−6.595
−6.605

0.00 0.02
Strain / a0

−0.02

Energy / e0

−6.590

−0.02

Distortion D3

−6.590
Energy / e0

−6.600

Distortion D2

Energy / e0

Energy / e0

−6.590

−6.595
−6.605

Energy / e0

Distortion D1

Energy / e0

Energy / e0

−6.590

−6.600
−6.602
−6.604

0.00 0.02
Strain / a0

−0.02

0.00 0.02
Strain / a0

Figure U.8: Ravindran et al[109] distortion-energy plots for FCC Ru
MSP Cubic Elastic Constant C11-C12

MSP Cubic Elastic Constant C44

−6.595
−6.600
Energy (ev/atom)

Energy (e /atom)

−6.600
−6.605
−6.610

−6.605
−6.610
−6.615

−6.615
−6.620

−6.620

0.000

0.005

0.010

0.015
Strain

0.020

0.025

0.030

0.000

(a) C11-C12 orthorhombic distortion

0.005

0.010

0.015
Strain

0.020

0.025

0.030

(b) C44 monoclinic distortion

Figure U.9: MSKP elastic constant strains, where the solid line is the known value and the points the values for this
potential - FCC Ru

518

APPENDIX U. FE-RU POTENTIAL

U.4.3

U.4. BULK PROPERTIES

Iron BCC

Property

DFT Computed

𝑎0 (angs)
Basis
𝐸𝑐𝑜ℎ (eV)
𝐵0 (GPa)

Stiff.1 (GPa)

⎡
250.1
⎢
⎢182.3
⎢
⎢183.2
⎢
⎢ 0
⎢
⎢
⎣ 0
0

This Potential

2.80
⎤
⎡
1.0 0.0 0.0
⎥
⎢
⎣0.0 1.0 0.0⎦
0.0 0.0 1.0
-4.32
239.2(a) 205.3(b)
⎤
182.3 183.3
0
0
0
⎥
249.1 182.9
0
0
0 ⎥
⎥
182.9 251.2
0
0
0 ⎥
⎥
0
0
139.2
0
0 ⎥
⎥
⎥
0
0
0
139.7
0 ⎦
0
0
0
0
139.3

2.76
⎤
0.0 0.0
⎥
1.0 0.0⎦
0.0 1.0
-4.16
229.0(a) 207.6(b)
⎤
222.0 222.0
0
0
0
⎥
178.8 222.0
0
0
0 ⎥
⎥
222.0 178.8
0
0
0 ⎥
⎥
0
0
215.2
0
0 ⎥
⎥
⎥
0
0
0
215.2
0 ⎦
0
0
0
0
215.2
⎤
248.5 248.5
0
0
0
⎥
190.1 248.5
0
0
0 ⎥
⎥
248.5 190.1
0
0
0 ⎥
⎥
0
0
168.7
0
0 ⎥
⎥
⎥
0
0
0
168.7
0 ⎦
0
0
0
0
168.7
⎡
1.0
⎢
⎣0.0
0.0

⎡
178.8
⎢
⎢222.0
⎢
⎢222.0
⎢
⎢ 0
⎢
⎢
⎣ 0
0
⎡
190.1
⎢
⎢248.5
⎢
⎢248.5
⎢
⎢ 0
⎢
⎢
⎣ 0
0

Stiff.2 (GPa)

Table U.3: The lattice parameter, cohesive energy and bulk modulus were determined by fitting the Birch-Murnaghan
equation of state. The bulk modulus is computed from the Birch-Murnaghan equation of state (a) and the average Reuss
and Voight Bulk Moduldus (b). The elastic constants computed for the potential in stiffness (1) were computed using
the method by Ravindran et al[109] and in stiffness (2) by Mehl et al[104][110].

Equation of State Plots
Both the Birch-Murnaghan and Rose-Vinet equation of states are used in the fitting process.
Rose Equation of State
This potential
Rose predicted energy-volume

50
40

−4.10

Energy (ev/atom)

Energy (ev/atom)

Eq ation of State

30
20
10
0

−4.15
−4.20
−4.25
−4.30

2

3

4
5
Lattice Constant (ang)

6

7

Potential EoS
Known EoS B0'=2.0
Known EoS B0'=3.0
Known EoS B0'=4.0

10.0

(a) Rose-Vinet

10.5
11.0
Volume (ang^3/atom)

11.5

(b) Birch Murnaghan

Figure U.10: Equation of State plots from this potential for BCC Fe

519

12.0

U.4. BULK PROPERTIES

APPENDIX U. FE-RU POTENTIAL

Elastic Constant Plots

Elastic Constant Curves
Distortion D2

−4.152
−4.154

−4.152
−4.154
−4.156

0.00 0.02
Strain / a0

−4.14
−4.15
−0.02

−0.02

−4.156

−4.157
−4.158
0.00 0.02
Strain / a0

−4.14
−4.15

0.00 0.02
Strain / a0

−0.02

Distortion D8

−4.158

0.00 0.02
Strain / a0

Distortion D9

−4.156

−4.157

−0.02

0.00 0.02
Strain / a0

Distortion D6

−4.15
−0.02

Distortion D7

−0.02

−4.154
−4.156

0.00 0.02
Strain / a0

−4.14

0.00 0.02
Strain / a0

Energy / e0

Energy / e0

−4.156

−4.152

Distortion D5
Energy / e0

Energy / e0

Distortion D4

−0.02

−4.150

Energy / e0

−0.02

−4.150

Energy / e0

−4.156

Distortion D3
Energy / e0

−4.150

Energy / e0

Energy / e0

Distortion D1

−4.157
−4.158

0.00 0.02
Strain / a0

−0.02

0.00 0.02
Strain / a0

Figure U.11: Ravindran et al[109] distortion-energy plots for FCC Ru
MSP Cubic Elastic Constant C44

−4.10

−4.10

−4.15

−4.15

Energy (ev/atom)

Energy (ev/atom)

MSP Cubic Elastic Constant C11-C12

−4.20
−4.25
−4.30

−4.20
−4.25
−4.30

0.000

0.005

0.010

0.015
Strain

0.020

0.025

0.030

0.000

(a) C11-C12 orthorhombic distortion

0.005

0.010

0.015
Strain

0.020

0.025

0.030

(b) C44 monoclinic distortion

Figure U.12: MSKP elastic constant strains, where the solid line is the known value and the points the values for this
potential - BCC Ru

520

Appendix V

Contribution to the DLPOLY Source
Code
V.1

Contribution to DLPOLY 4.04

I originally downloaded the 4.03 version of DL POLY while conducting my literature review. As a result of
reading work on 2BEAM I made modifications to the Fortran code, specifically changing the arrays used to
hold the potentials and retrieve the energy and forces from this modified metal potential. Dr. Todorov assited
me and adjusted my modifications such that the code worked across domains when running DL POLY over
multiple processes.
Listing V.1: Add two numbers function
1
2
3
4
5
6
7
8
9
10

NEW FEATURES & IMPROVEMENTS
--------------------------1. New two band (2B) EAM and EEAM potentials for metals (TEST45 and
TEST46).
Acknowledgements
---------------Ben Palmer @ University of Birmingham (UK) for contributing to the
development and testing of the 2BEAM for metals;

Listing V.2: Add two numbers function
1

Subroutine metal_table_read(l_top)

2
3
4
5
6
7
8
9
10
11
12
13
14

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
! dl_poly_4 subroutine for reading potential energy and force arrays
! from TABEAM file (for metal EAM & EEAM forces only)
!
! copyright - daresbury laboratory
! author - w.smith march 2006
! amended - i.t.todorov march 2016
! contrib - r.davidchak (eeam) june 2012
! contrib - b.palmer (2band) may 2013
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

15
16
17

Use kinds_f90
Use comms_module, Only : idnode,mxnode,gsum

521

V.1. CONTRIBUTION TO DLPOLY 4.04

18
19
20
21

Use
Use
Use
Use

APPENDIX V. CONTRIBUTION TO THE DLPOLY SOURCE CODE

setup_module, Only : ntable,nrite,mxgmet,engunit
site_module, Only : ntpatm,unqatm
metal_module, Only : ntpmet,tabmet,lstmet,vmet,dmet,dmes,fmet,fmes
parse_module, Only : get_line,get_word,lower_case,word_2_real

22
23

Implicit None

24
25

Logical, Intent( In ) :: l_top

26
27
28
29
30
31
32
33
34

Logical
Character(
Character(
Character(
Character(
Integer

:: safe
200 ) :: record
40 ) :: word
4 ) :: keyword
8 ) :: atom1,atom2
:: fail(1:2),i,j,ipot,numpot,ktype,ngrid, &
cp,cd,cds,ce,ces,katom1,katom2,keymet,k0,jtpatm
Real( Kind = wp )
:: start,finish
Len
Len
Len
Len

=
=
=
=

35
36
37
38

Integer,

Dimension( : ), Allocatable :: cpair, cdens,cdnss, &
cembed,cembds
Real( Kind = wp ), Dimension( : ), Allocatable :: buffer

39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65

fail=0
If
(tabmet == 1) Then ! EAM
Allocate (cpair(1:(ntpmet*(ntpmet+1))/2),cdens(1:ntpmet),
&
cembed(1:ntpmet),
Stat=fail(1))
Else If (tabmet == 2) Then ! EEAM
Allocate (cpair(1:(ntpmet*(ntpmet+1))/2),cdens(1:ntpmet**2),
&
cembed(1:ntpmet),
Stat=fail(1))
Else If (tabmet == 3) Then ! 2BEAM
Allocate (cpair(1:(ntpmet*(ntpmet+1))/2),cdens(1:ntpmet),cdnss(1:ntpmet*(ntpmet+1)/2), &
cembed(1:ntpmet),cembds(1:ntpmet), Stat=fail(1))
Else If (tabmet == 4) Then ! 2BEEAM
Allocate (cpair(1:(ntpmet*(ntpmet+1))/2),cdens(1:ntpmet**2),cdnss(1:ntpmet**2), &
cembed(1:ntpmet),cembds(1:ntpmet), Stat=fail(1))
End If
Allocate (buffer(1:mxgmet),
Stat=fail(2))
If (Any(fail > 0)) Then
Write(nrite,’(/,1x,a,i0)’) ’metal_table_read allocation failure, node: ’, idnode
Call error(0)
End If
cpair=0 ; cp=0
cdens=0 ; cd=0
cembed=0 ; ce=0
If (tabmet == 3 .or. tabmet == 4) Then
cdnss=0 ; cds=0
cembds=0 ; ces=0
End If

66
67

If (idnode == 0) Open(Unit=ntable, File=’TABEAM’)

68
69

! skip header record

70
71
72

Call get_line(safe,ntable,record)
If (.not.safe) Go To 100

73
74

! read number of potential functions in file

75
76
77
78

Call get_line(safe,ntable,record)
If (.not.safe) Go To 100
Call get_word(record,word)

522

APPENDIX V. CONTRIBUTION TO THE DLPOLY SOURCE CODE

79

V.1. CONTRIBUTION TO DLPOLY 4.04

numpot = Nint(word_2_real(word))

80
81

Do ipot=1,numpot

82
83

! read data type, atom labels, number of points, start and end

84
85
86

Call get_line(safe,ntable,record)
If (.not.safe) Go To 100

87
88

! identify data type

89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104

Call get_word(record,keyword)
Call lower_case(keyword)
If
(keyword == ’pair’) Then
ktype = 1
Else If (keyword == ’dens’ .or. keyword == ’dden’) Then
ktype = 2
Else If (keyword == ’embe’ .or. keyword == ’demb’) Then
ktype = 3
Else If (keyword == ’sden’) Then
ktype = 4
Else If (keyword == ’semb’) Then
ktype = 5
Else
Call error(151)
End If

105
106

! identify atom types

107
108
109
110
111
112
113
114
115

Call get_word(record,atom1)
If (ktype == 1 .or.
& ! pair
(ktype == 2 .and. (tabmet == 2 .or. tabmet == 4)) .or. & ! den for EEAM and dden for 2BEEAM
(ktype == 4 .and. (tabmet == 3 .or. tabmet == 4))) Then ! sden for 2B(EAM and EEAM)
Call get_word(record,atom2)
Else
atom2 = atom1
End If

116
117

! data specifiers

118
119
120
121
122
123
124

Call get_word(record,word)
ngrid = Nint(word_2_real(word))
Call get_word(record,word)
start = word_2_real(word)
Call get_word(record,word)
finish = word_2_real(word)

125
126

! check atom identities

127
128
129

katom1=0
katom2=0

130
131
132
133
134

Do jtpatm=1,ntpatm
If (atom1 == unqatm(jtpatm)) katom1=jtpatm
If (atom2 == unqatm(jtpatm)) katom2=jtpatm
End Do

135
136
137
138
139

If (katom1 == 0 .or. katom2 == 0) Then
If (idnode == 0 .and. l_top) &
Write(nrite,’(a)’) ’****’,atom1,’***’,atom2,’**** entry in TABEAM’
Call error(81)

523

V.1. CONTRIBUTION TO DLPOLY 4.04

APPENDIX V. CONTRIBUTION TO THE DLPOLY SOURCE CODE

End If

140
141
142

! store working parameters

143

buffer(1)=Real(ngrid+4,wp) ! as if there are 4 extra elements after finish
buffer(4)=(finish-start)/Real(ngrid-1,wp)
buffer(2)=start-5.0_wp*buffer(4)
buffer(3)=finish

144
145
146
147
148

If (idnode == 0 .and. l_top) &
Write(nrite,"(1x,i10,4x,2a8,3x,2a4,2x,i6,1p,3e15.6)") &
ipot,atom1,atom2,’EAM-’,keyword,ngrid,start,finish,buffer(4)

149
150
151
152
153

! check array dimensions

154

If (ngrid+4 > mxgmet) Then
Call warning(270,Real(ngrid+4,wp),Real(mxgmet,wp),0.0_wp)
Call error(48)
End If

155
156
157
158
159

keymet=(Max(katom1,katom2)*(Max(katom1,katom2)-1))/2 + Min(katom1,katom2)
k0=lstmet(keymet)

160
161
162
163

! check for undefined potential

164

If (k0 == 0) Call error(508)

165
166
167

! read in potential arrays

168

Do i=1,(ngrid+3)/4
j=Min(4,ngrid-(i-1)*4)
If (idnode == 0) Then
Read(Unit=ntable, Fmt=*, End=100) buffer(4*i+1:4*i+j)
Else
buffer(4*i+1:4*i+j)=0.0_wp
End If
End Do

169
170
171
172
173
174
175
176
177

If (mxnode > 1) Call gsum(buffer(5:ngrid+4))

178
179
180

! copy data to internal arrays

181

If

182

(ktype == 1) Then

183
184

! pair potential terms

185
186

! Set indices

187
188

!

k0=lstmet(keymet)

189
190
191
192
193
194
195

cp=cp+1
If (Any(cpair(1:cp-1) == k0)) Then
Call error(509)
Else
cpair(cp)=k0
End If

196
197
198
199
200

vmet(1,k0,1)=buffer(1)
vmet(2,k0,1)=buffer(2)
vmet(3,k0,1)=buffer(3)
vmet(4,k0,1)=buffer(4)

524

APPENDIX V. CONTRIBUTION TO THE DLPOLY SOURCE CODE

201
202
203
204
205
206
207
208
209

Do i=5,mxgmet
If (i-4 > ngrid) Then
vmet(i,k0,1)=0.0_wp
Else
buffer(i)=buffer(i)*engunit
vmet(i,k0,1)=buffer(i)
End If
End Do

210
211

! calculate derivative of pair potential function

212
213

Call metal_table_derivatives(k0,buffer,Size(vmet,2),vmet)

214
215

! adapt derivatives for use in interpolation

216
217
218
219

Do i=5,ngrid+4
vmet(i,k0,2)=-(Real(i,wp)*buffer(4)+buffer(2))*vmet(i,k0,2)
End Do

220
221

Else If (ktype == 2) Then

222
223
224
225

! density function terms
! s-density density function terms for EAM & EEAM
! d-density density function terms for 2B(EAM & EEAM)

226
227

! Set indices

228
229
230
231
232
233

If

(tabmet == 1 .or. tabmet == 3) Then ! EAM
k0=katom1
Else If (tabmet == 2 .or. tabmet == 4) Then ! EEAM
k0=(katom1-1)*ntpatm+katom2
End If

234
235
236
237
238
239
240

cd=cd+1
If (Any(cdens(1:cd-1) == k0)) Then
Call error(510)
Else
cdens(cd)=k0
End If

241
242
243
244
245

dmet(1,k0,1)=buffer(1)
dmet(2,k0,1)=buffer(2)
dmet(3,k0,1)=buffer(3)
dmet(4,k0,1)=buffer(4)

246
247
248
249
250
251
252
253

Do i=5,mxgmet
If (i-4 > ngrid) Then
dmet(i,k0,1)=0.0_wp
Else
dmet(i,k0,1)=buffer(i)
End If
End Do

254
255

! calculate derivative of density function

256
257

Call metal_table_derivatives(k0,buffer,Size(dmet,2),dmet)

258
259

! adapt derivatives for use in interpolation

260
261

dmet(1,k0,2)=0.0_wp

525

V.1. CONTRIBUTION TO DLPOLY 4.04

V.1. CONTRIBUTION TO DLPOLY 4.04

APPENDIX V. CONTRIBUTION TO THE DLPOLY SOURCE CODE

dmet(2,k0,2)=0.0_wp
dmet(3,k0,2)=0.0_wp
dmet(4,k0,2)=0.0_wp

262
263
264
265

Do i=5,ngrid+4
dmet(i,k0,2)=-(Real(i,wp)*buffer(4)+buffer(2))*dmet(i,k0,2)
End Do

266
267
268
269

Else If (ktype == 3) Then

270
271
272
273
274

! embedding function terms
! s-density embedding function terms for EAM & EEAM
! d-density embedding function terms for 2B(EAM & EEAM)

275
276

! Set indices

277

k0=katom1

278
279

ce=ce+1
If (Any(cembed(1:ce-1) == k0)) Then
Call error(511)
Else
cembed(ce)=k0
End If

280
281
282
283
284
285
286

fmet(1,k0,1)=buffer(1)
fmet(2,k0,1)=buffer(2)
fmet(3,k0,1)=buffer(3)
fmet(4,k0,1)=buffer(4)

287
288
289
290
291

Do i=5,mxgmet
If (i-4 > ngrid) Then
fmet(i,k0,1)=0.0_wp
Else
buffer(i)=buffer(i)*engunit
fmet(i,k0,1)=buffer(i)
End If
End Do

292
293
294
295
296
297
298
299
300
301

! calculate derivative of embedding function

302

Call metal_table_derivatives(k0,buffer,Size(fmet,2),fmet)

303
304

Else If (ktype == 4) Then

305
306
307

! s-density function terms

308
309
310
311
312

!
!
!
!

The 2BM formalism for alloys allows for a mixed s-band density: rho_{atom1,atom2} /= 0
(and in general for the EEAM it may be non-symmetric: rho_{atom1,atom2} may be /= rho_{atom2,atom2})
Some 2BM models rho_{atom1,atom1}=rho_{atom2,atom2}==0 with rho_{atom1,atom2} /= 0
whereas others choose not to have mixed s-band densities.

313
314

! Set indices

315
316
317
318
319
320

!

If (tabmet == 3) Then ! 2BMEAM
k0=lstmet(keymet)
Else If (tabmet == 4) Then ! 2BMEEAM
k0=(katom1-1)*ntpatm+katom2
End If

321
322

cds=cds+1

526

APPENDIX V. CONTRIBUTION TO THE DLPOLY SOURCE CODE

323
324
325
326
327

If (Any(cdnss(1:cds-1) == k0)) Then
Call error(510)
Else
cdnss(cds)=k0
End If

328
329
330
331
332

dmes(1,k0,1)=buffer(1)
dmes(2,k0,1)=buffer(2)
dmes(3,k0,1)=buffer(3)
dmes(4,k0,1)=buffer(4)

333
334

If (Nint(buffer(1)) > 5) Then

335
336
337
338
339
340
341
342
343

Do i=5,mxgmet
If (i-4 > ngrid) Then
dmes(i,k0,1)=0.0_wp
Else
dmes(i,k0,1)=buffer(i)
End If
End Do
! calculate derivative of density function

344
345

Call metal_table_derivatives(k0,buffer,Size(dmes,2),dmes)

346
347

! adapt derivatives for use in interpolation

348
349
350
351
352

dmes(1,k0,2)=0.0_wp
dmes(2,k0,2)=0.0_wp
dmes(3,k0,2)=0.0_wp
dmes(4,k0,2)=0.0_wp

353
354
355
356

Do i=5,ngrid+4
dmes(i,k0,2)=-(Real(i,wp)*buffer(4)+buffer(2))*dmes(i,k0,2)
End Do

357
358

End If

359
360

Else If (ktype == 5) Then

361
362

! s-embedding function terms

363
364

! Set index

365
366

k0=katom1

367
368
369
370
371
372
373

ces=ces+1
If (Any(cembds(1:ces-1) == k0)) Then
Call error(511)
Else
cembds(ces)=k0
End If

374
375
376
377
378

fmes(1,k0,1)=buffer(1)
fmes(2,k0,1)=buffer(2)
fmes(3,k0,1)=buffer(3)
fmes(4,k0,1)=buffer(4)

379
380
381
382
383

Do i=5,mxgmet
If (i-4 > ngrid) Then
fmes(i,k0,1)=0.0_wp
Else

527

V.1. CONTRIBUTION TO DLPOLY 4.04

V.1. CONTRIBUTION TO DLPOLY 4.04

APPENDIX V. CONTRIBUTION TO THE DLPOLY SOURCE CODE

buffer(i)=buffer(i)*engunit
fmes(i,k0,1)=buffer(i)
End If
End Do

384
385
386
387
388
389

! calculate derivative of embedding function

390

Call metal_table_derivatives(k0,buffer,Size(fmes,2),fmes)

391
392

End If

393
394
395

End Do

396
397
398

If (idnode == 0) Close(Unit=ntable)
If (idnode == 0 .and. l_top) Write(nrite,’(/,1x,a)’) ’potential tables read from TABEAM file’

399
400
401
402
403
404
405
406
407
408
409

If

(tabmet == 1 .or. tabmet == 2) Then ! EAM & EEAM
Deallocate (cpair,cdens,cembed,
Stat=fail(1))
Else If (tabmet == 3 .or. tabmet == 4) Then ! 2B(EAM & EEAM)
Deallocate (cpair,cdens,cdnss,cembed,cembds, Stat=fail(1))
End If
Deallocate (buffer,
Stat=fail(2))
If (Any(fail > 0)) Then
Write(nrite,’(/,1x,a,i0)’) ’metal_table_read deallocation failure, node: ’, idnode
Call error(0)
End If

410
411

Return

412
413

! end of file error exit

414
415

100 Continue

416
417
418

If (idnode == 0) Close(Unit=ntable)
Call error(24)

419
420

End Subroutine metal_table_read

528

